import{r as L,u as C,j as e,b as h,A}from"./index-8fbc1d6c.js";import{l as D}from"./index-6768925e.js";import{c as E,a as N,u as P,F as w,b as $}from"./index.esm-b7202724.js";import{S as v,a as z,L as B}from"./LoadingButton-e9f65630.js";import"./TextField-bdd3bed4.js";import{P as K}from"./Page-080a86ca.js";import{B as H}from"./Breadcrumb-0ec2aeb5.js";import{u as x}from"./useQuery-1f01400e.js";const W=()=>{var q;const r=L.useRef(),m=D.useReactToPrint({content:()=>r.current}),{api_class:u,api_fy:F,api_fee_report:j,api_month_active_all:l,api_fee_search_fee_receipt:S}=A,{data:o,isLoading:p,error:b}=x({queryKey:["month"],queryFn:async()=>(await h.post(`${l}`,{})).data.data}),{data:d,isLoading:f,error:g}=x({queryKey:["fy"],queryFn:async()=>(await h.post(`${F}`,{})).data.data}),{data:i,isLoading:n,error:c}=x({queryKey:["class"],queryFn:async()=>(await h.post(`${u}`,{})).data.data});E({fyId:N().required("Required"),classId:N().required("Required"),monthId:N().required("Required")});const a=P({initialValues:{fyId:"",classId:"",monthId:"",admissionNo:""},onSubmit:async s=>{try{await I()}catch(y){console.log(y)}console.log("on submit",s)}}),{data:t,isLoading:M,error:T,refetch:I,isFetching:V}=x({queryKey:["viewReceipt"],queryFn:async()=>(await h.post(`${S}`,{fyId:a.values.fyId,classId:a.values.classId,monthId:a.values.monthId,admissionNo:a.values.admissionNo})).data.data,enabled:!1}),{collapsed:k}=C();return e.jsxs(K,{title:"Search Receipt",pageName:"Search Receipt",children:[e.jsx(H,{list:[{title:"Home",path:"/home"},{title:"Search Receipt",path:"#"}]}),e.jsx("div",{className:"border p-6 mx-auto w-[96%]",children:e.jsx(w,{value:a,children:e.jsx($,{onSubmit:a.handleSubmit,children:e.jsx("div",{className:"lg:px-24 mx-auto px-6 justify-center lg:ml-28",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-5 content-center",children:[e.jsx("div",{children:e.jsx(v,{name:"fyId",label:"Financial Year",formik:a,isRequiredLabel:!0,size:"xs",children:d&&(d==null?void 0:d.map(s=>e.jsx("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.financial_year})))})}),e.jsx("div",{children:e.jsx(v,{name:"classId",label:"Select Class",formik:a,isRequiredLabel:!0,size:"xs",children:i&&(i==null?void 0:i.map(s=>e.jsx("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.class_name})))})}),e.jsx("div",{children:e.jsxs(v,{name:"monthId",label:"Month",formik:a,isRequiredLabel:!0,size:"xs",isBlankSelect:!0,children:[e.jsx("option",{value:"",children:"Select All"}),o&&(o==null?void 0:o.map((s,y)=>e.jsx("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.month_name},y)))]})}),e.jsx("div",{children:e.jsx(z,{name:"admissionNo",label:"Admission No",formik:a,isRequiredLabel:!0,size:"xs",isBlankSelect:!0})}),e.jsx("div",{children:e.jsx("div",{className:"mt-7",children:e.jsxs(B,{color:"primary",type:"submit",size:"xs",className:"rounded-lg",isLoading:!1,children:[" ","Search"," "]})})})]})})})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2 content-center",children:[e.jsx("div",{children:e.jsx(_,{viewReceipt:t,copyName:"School Copy",componentRef:r,collapsed:k})}),e.jsx("div",{children:e.jsx(_,{viewReceipt:t,copyName:"Student Copy",componentRef:r,collapsed:k})})]}),((q=t==null?void 0:t.feeDetails)==null?void 0:q.length)>0&&e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:m,className:"text-white bg-[red] px-2 py-2 rounded-lg ",children:"Download Pdf"})})]})},_=({viewReceipt:r,copyName:m,componentRef:u,collapsed:F})=>{var j;return e.jsx("div",{ref:u,className:"flex flex-wrap ",children:(j=r==null?void 0:r.feeDetails)==null?void 0:j.map((l,S)=>{var o,p,b,d,f,g,i;return e.jsxs("div",{className:`border  border-black mt-[4vh] ml-[4vh] mb-2 rounded-md ')] 

             bg-opacity-80 w-[92%]
              `,children:[e.jsxs("div",{className:"text-center tracking-wider",children:[e.jsxs("div",{className:"flex justify-between font-semibold p-2",children:[e.jsxs("h1",{children:["Receipt No: ",l==null?void 0:l.receiptNo]}),e.jsx("h1",{children:m})]}),e.jsx("h1",{className:"text-3xl mt-[2vh] font-bold",children:"St. Xavier's Public School"}),e.jsx("h1",{className:"text-xl font-semibold",children:"Samlong,Namkum,Ranchi-834010"})]}),e.jsxs("div",{className:"tracking-wider text-xl mt-[2vh] ml-[2vh] font-semibold",children:[e.jsxs("label",{htmlFor:"",children:["Name",e.jsxs("span",{children:[": ",(o=r==null?void 0:r.stdDetails)==null?void 0:o.full_name]})]}),e.jsxs("div",{className:"flex flex-wrap mt-[2vh] gap-x-7",children:[e.jsxs("label",{htmlFor:"",children:["Class: ",e.jsx("span",{children:(p=r==null?void 0:r.stdDetails)==null?void 0:p.class_name})]}),e.jsxs("label",{htmlFor:"",children:["Section: ",e.jsx("span",{children:(b=r==null?void 0:r.stdDetails)==null?void 0:b.section_name})]}),e.jsxs("label",{htmlFor:"",children:["Roll no: ",e.jsx("span",{children:(d=r==null?void 0:r.stdDetails)==null?void 0:d.roll_no})]})]})]}),e.jsx("h1",{className:"font-bold text-center mt-[2vh] uppercase text-3xl ",children:l==null?void 0:l.monthName}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex w-[60%] gap-y-3 ml-[5vh] flex-col tracking-wider text-xl mt-[5vh] font-semibold",children:[(f=l==null?void 0:l.details)==null?void 0:f.map((n,c)=>e.jsx(e.Fragment,{children:e.jsx("label",{htmlFor:"",children:n==null?void 0:n.feeHeadName})})),e.jsx("label",{className:"flex justify-end",htmlFor:"",children:"Total"})]}),e.jsx("div",{className:"w-[20%] mt-[2vh] mr-[7vh]",children:e.jsxs("div",{className:"border-2 w-[10rem] h-auto  rounded-lg border-black",children:[e.jsx("h1",{className:"border-b-2  tracking-wider text-xl text-center font-semibold  border-black",children:"Amount"}),e.jsx("div",{className:"h-[60%] tracking-wider text-xl flex text-center flex-col gap-y-3 border-b-2  border-black ",children:(g=l==null?void 0:l.details)==null?void 0:g.map((n,c)=>e.jsx(e.Fragment,{children:e.jsx("h1",{children:n==null?void 0:n.receivedAmount})}))}),e.jsx("div",{className:"h-[40%] font-bold text-center tracking-wider text-xl flex flex-col gap-y-3   border-black ",children:(i=l==null?void 0:l.details)==null?void 0:i.map((n,c)=>n.receivedAmount).reduce((n,c)=>n+c)})]})})]}),e.jsxs("div",{className:"flex justify-between tracking-wider text-xl mt-[5vh] mb-[4vh] font-semibold",children:[e.jsxs("label",{className:"ml-[2vh]",htmlFor:"",children:["Date:"," ",e.jsx("span",{children:new Date().toLocaleDateString()})]}),e.jsx("label",{className:"mr-[3vh]",htmlFor:"",children:"Cashier"})]})]})})})};export{W as default};
