import{r as s,u as T,j as i}from"./index-39011a05.js";import{R as O,L as U}from"./index.esm-ddd75ed6.js";import{c as G,a as J,u as K}from"./index.esm-17815669.js";import{R as Q}from"./Hourglass-e49ef29e.js";import{P as X}from"./axios-b369a557.js";import{g as m,a as r,d as Y}from"./PowerupFunctions-c3ce5154.js";import{u as Z}from"./useSetTitle-5fcc3578.js";import{A as v}from"./AxiosInterceptors-a7ee5726.js";import{A as b}from"./ApiHeader-6d683756.js";import"./index-ec745bad.js";import"./index-387d7a00.js";import"./index.esm-4e0ef58a.js";import"./iconBase-f907c59a.js";import"./index.esm-3f4354fc.js";import"./ShimmerEffectInline-8c2a6752.js";const bt=()=>{Z("Violation Wise Report");const{api_ViolationWiseReport:j,api_getViolationList:tt,api_getSectionList:w,api_getDepartmentList:ot,api_violationMasterList:S}=X(),[y,N]=s.useState([]),[it,_]=s.useState([]);s.useState([]);const[L,l]=s.useState(!1),C=T(),D=[{Header:"Sl.No.",Cell:({row:t})=>i.jsx("div",{children:(t==null?void 0:t.index)+1})},{Header:"Name",accessor:"full_name",Cell:({cell:t})=>{var o;return r((o=t.row.original)==null?void 0:o.full_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:t})=>{var o;return r((o=t.row.original)==null?void 0:o.mobile)}},{Header:"Challan No",accessor:"challan_no",Cell:({cell:t})=>{var o;return i.jsx("div",{className:"underline cursor-pointer",onClick:()=>{var a,e,d,p;return((e=(a=t==null?void 0:t.row)==null?void 0:a.original)==null?void 0:e.challan_id)&&C(`/challan/${(p=(d=t==null?void 0:t.row)==null?void 0:d.original)==null?void 0:p.challan_id}`)},children:r((o=t.row.original)==null?void 0:o.challan_no)})}},{Header:"Violation Made",accessor:"violation_name",Cell:({cell:t})=>{var o;return r((o=t.row.original)==null?void 0:o.violation_name)}},{Header:"Violation Section",accessor:"violation_section",Cell:({cell:t})=>{var o;return r((o=t.row.original)==null?void 0:o.violation_section)}},{Header:"Violation Place",accessor:"violation_place",Cell:({cell:t})=>{var o;return r((o=t.row.original)==null?void 0:o.violation_place)}},{Header:"Penalty Amount",accessor:"total_amount",Cell:({cell:t})=>{var o;return Y((o=t.row.original)==null?void 0:o.total_amount)}}],[h,V]=s.useState({}),[A,R]=s.useState(0),[k,F]=s.useState(!1),[at,H]=s.useState(!1),z="text-gray-800 text-sm",f="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm",c=[{title:"From Date",key:"fromDate",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""},{title:"Upto Date",key:"uptoDate",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""},{title:"Violation Made",key:"violationMade",width:"md:w-[20%] w-full",type:"select",hint:"Enter your name",options:y,okey:"id",ovalue:"violation_name"}],q=(t,o="",a,e="",d="",p=!1,u=[],E="",B="")=>i.jsxs("div",{className:`flex flex-col ${e} `,children:[o!=""&&i.jsxs("label",{htmlFor:t,className:z,children:[o," ",p&&i.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),a!="select"&&a!="file"&&i.jsx("input",{...n.getFieldProps(t),type:a,className:f+` ${n.touched[t]&&n.errors[t]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:t,id:"",placeholder:d}),a=="select"&&i.jsx("select",{...n.getFieldProps(t),className:f+` ${n.touched[t]&&n.errors[t]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:L?i.jsx("option",{children:"Loading..."}):i.jsxs(i.Fragment,{children:[i.jsx("option",{value:"",children:"All"}),u==null?void 0:u.map(g=>i.jsx("option",{className:"",value:g[E],children:g[B]}))]})})]}),M=G().shape([...c].reduce((t,o)=>(o!=null&&o.required&&(t[o.key]=J().required(o==null?void 0:o.hint)),t),{})),P={fromDate:m(),uptoDate:m(),department:"",violationMade:"",violationSection:""},n=K({initialValues:P,enableReinitialize:!0,validationSchema:M,onSubmit:t=>{$(t)}}),$=t=>{H(!0),V({fromDate:t==null?void 0:t.fromDate,uptoDate:t==null?void 0:t.uptoDate,violationId:t==null?void 0:t.violationMade}),R(o=>o+1)},I=t=>{console.log(t),l(!0),v.post(w,{departmentId:t},b()).then(o=>{var a,e;(a=o==null?void 0:o.data)!=null&&a.status&&_((e=o==null?void 0:o.data)==null?void 0:e.data),console.log("fp violation section list response => ",o)}).catch(o=>{console.log("error fp violation section list => ",o)}).finally(()=>{l(!1)})},x=t=>{l(!0),n.values.department,v.post(S,{},b()).then(o=>{var a,e;(a=o==null?void 0:o.data)!=null&&a.status&&N((e=o==null?void 0:o.data)==null?void 0:e.data),console.log("fp violation list response => ",o)}).catch(o=>{console.log("error fp violation list => ",o)}).finally(()=>{l(!1)})},W=t=>{const o=t.target.name,a=t.target.value;o=="violationSection"&&x(a),o=="department"&&I(a)};return s.useEffect(()=>{x()},[]),i.jsxs(i.Fragment,{children:[i.jsxs("form",{onChange:t=>(n.handleChange(t),W(t)),onSubmit:n.handleSubmit,className:"w-full h-full p-4 mb-6 border border-zinc-200 bg-zinc-50",children:[i.jsx("h1",{className:"text-xl font-semibold uppercase text-center text-gray-700 border-b border-gray-400 mb-4 pb-1",children:"Violation Wise Report"}),i.jsxs("section",{className:"flex gap-4 flex-wrap my-6",children:[c==null?void 0:c.map(t=>q(t==null?void 0:t.key,t==null?void 0:t.title,t==null?void 0:t.type,t==null?void 0:t.width,t==null?void 0:t.hint,t==null?void 0:t.required,t==null?void 0:t.options,t==null?void 0:t.okey,t==null?void 0:t.ovalue)),i.jsx("div",{className:"mt-4 w-full md:w-[30%] flex flex-row flex-wrap items-center gap-x-4 gap-y-2 md:mt-4",children:i.jsx("div",{className:" ",children:k?i.jsx(i.Fragment,{children:i.jsx("div",{className:"flex justify-center",children:i.jsx(Q,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):i.jsxs("button",{type:"submit",className:" flex items-center border border-green-600 bg-green-500 hover:bg-green-600 text-white shadow-md rounded-sm  text-sm px-5 py-1",children:[i.jsx("span",{className:"",children:i.jsx(O,{fontSize:""})}),i.jsx("span",{children:"Search Record"})]})})})]})]}),Object.keys(h).length!==0&&i.jsx(U,{api:j,columns:D,requestBody:h,changeData:A,search:!1,loader:t=>F(t)})]})};export{bt as default};
