import{c as B,a as p,r as b,b as X,u as M,n as d,d as Q,g as q,j as e,e as T,R as z,i as Y,f as Z,A as I,s as ee,h as f,k as ae,l as te,m as le,P as re}from"./index-c1b9b2fc.js";import{a as se}from"./download-99e943e8.js";const{api_login:ie,api_getFreeMenuList:oe}=re(),ne=B({username:p().required("Enter Username"),password:p().required("Enter Password")});function me(){var k,S,F,C,L;const{setmenuList:H,setuserDetails:W,setheartBeatCounter:$}=b.useContext(X),[j,i]=b.useState(!1),g=b.useRef(),s=M({initialValues:{username:"",password:""},onSubmit:l=>{K()},validationSchema:ne}),r=M({initialValues:{email:"",mobile:""},onSubmit:l=>{console.log(l),U(l)},validationSchema:B().shape({email:p().test("email-or-mobile","Please provide an email or mobile number",function(l){const{mobile:t}=this.parent;return!(!l&&!t)}),mobile:p().test("email-or-mobile","Please provide an email or mobile number",function(l){const{email:t}=this.parent;return!(!l&&!t)})})}),U=l=>{i(!0);let t={mobileNo:l==null?void 0:l.mobile,email:l==null?void 0:l.email};console.log("--1--before reset send...",t),axios.post("",t,N).then(function(a){var o,n;console.log("reset password response => ",a.data),a.data.status==!0?(d.success((o=a==null?void 0:a.data)==null?void 0:o.message),g.current.close(),r.resetForm()):(console.log("false..."),i(!1),d.error((n=a==null?void 0:a.data)==null?void 0:n.message))}).catch(function(a){i(!1),console.log("reset password error => ",a),d.error("Server Error")})},w=Q();b.useEffect(()=>{q("token")!="null"&&q("token")!=null&&w("/home")},[]);const v="text-gray-800 text-sm",y="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm",N={headers:{Accept:"application/json"}},K=l=>{i(!0);let t={email:s.values.username,password:s.values.password};console.log("--1--before login send...",t),I.post(ie,t,N).then(function(a){var o,n,c,m,h,x,u,R,P,A,E,_,V,D;console.log("message check login ",a.data),a.data.status==!0?(ee("token",(n=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:n.token),f("userDetails",(m=(c=a==null?void 0:a.data)==null?void 0:c.data)==null?void 0:m.userDetails),((u=(x=(h=a==null?void 0:a.data)==null?void 0:h.data)==null?void 0:x.userDetails)==null?void 0:u.user_type)=="CO"&&f("menuList",[{name:"Home",path:"/home",children:[]},{name:"Application List",path:"/fp-list",children:[]},{name:"Search Challan",path:"/search-challan",children:[]},{name:"Workflow",path:"/fp-workflow",children:[]}]),((A=(P=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:P.userDetails)==null?void 0:A.user_type)=="EC"&&f("menuList",[{name:"Home",path:"/home",children:[]},{name:"Application List",path:"/fp-list",children:[]},{name:"Search Challan",path:"/search-challan",children:[]},{name:"Violation Master",path:"/violation-master",children:[]},{name:"User Role Master",path:"/user-master",children:[]},{name:"Cash Verification",path:"/cash-verification",children:[]},{name:"Reports",path:"",children:[{name:"Challan Generated Report",path:"/challan-generated-report"},{name:"Violation Wise Report",path:"/violation-wise-report"},{name:"Collection Report",path:"/collection-report"},{name:"Comparision Report",path:"/comparision-report"}]}]),((V=(_=(E=a==null?void 0:a.data)==null?void 0:E.data)==null?void 0:_.userDetails)==null?void 0:V.user_type)=="JSK"&&f("menuList",[{name:"Home",path:"/home",children:[]},{name:"Application List",path:"/fp-list",children:[]},{name:"Search Challan",path:"/search-challan",children:[]}]),O(),$(J=>J+1),w("/home"),d.success("Login Successfull")):(console.log("false..."),i(!1),d.error((D=a==null?void 0:a.data)==null?void 0:D.message))}).catch(function(a){i(!1),console.log("--2--login error...",a),d.error("Server Error")})},O=()=>{let l={moduleId:10};console.log("request body",l),I.post(oe,l,ae()).then(function(t){var a,o,n,c,m,h,x,u;console.log("fetched menu list.....",(n=(o=(a=t==null?void 0:t.data)==null?void 0:a.data)==null?void 0:o.userDetails)==null?void 0:n.roles),t.data.status==!0?(H((m=(c=t==null?void 0:t.data)==null?void 0:c.data)==null?void 0:m.permission),W((x=(h=t==null?void 0:t.data)==null?void 0:h.data)==null?void 0:x.userDetails)):(console.log("false menu list => ",(u=t==null?void 0:t.data)==null?void 0:u.message),i(!1),seterrorMsg(te(t.data.message)))}).catch(function(t){i(!1),console.log("--2--login error...",t)})},G=l=>{let t=l.target.name,a=l.target.value;console.log("first",t),t=="email"&&(r.setFieldValue("mobile",""),r.setFieldValue("email",a)),t=="mobile"&&(r.setFieldValue("email",""),r.setFieldValue("mobile",le(a,r==null?void 0:r.values.mobile,10)))};return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:" border-b border-gray-200 bg-white darks:bg-gray-800 darks:border-gray-800",children:e.jsx("div",{className:"container mx-auto xl:max-w-6xl ",children:e.jsxs("nav",{className:"flex flex-row flex-nowrap items-center justify-between mt-0 py-4 ",id:"desktop-menu",children:[e.jsx("a",{className:"flex items-center py-2 ltr:mr-4 rtl:ml-4 text-xl cursor-default",children:e.jsxs("div",{className:"flex gap-2",children:[" ",e.jsx("span",{className:"w-7",children:e.jsx("img",{src:(k=T())==null?void 0:k.ulb_logo,alt:"",srcset:""})})," ",e.jsx("span",{className:"font-bold text-xl",children:"Ranchi Nagar Nigam, Ranchi"})]})}),e.jsx("div",{className:" flex justify-center h-max select-none",children:e.jsxs("a",{href:"./Fines.apk",download:!0,className:"h-[40%] cursor-pointer py-2 flex items-center gap-4 text-gray-100 bg-gray-800 pl-4 pr-6 drop-shadow-lg transition-all duration-200 hover:scale-105 rounded-md",children:[e.jsx("div",{className:"h-[70%] ",children:e.jsx("img",{src:se,alt:"",className:"h-8 cursor-pointer",srcset:""})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Download"}),e.jsx("span",{className:"text-sm font-semibold",children:"Android APK"})]})]})})]})})}),e.jsx("main",{className:" bg-gray-100 flex justify-center items-center md:h-[80vh]",children:e.jsx("div",{className:"pt-8 bg-gray-100 darks:bg-gray-900 darks:bg-opacity-40",children:e.jsx("div",{className:"mx-auto px-4 ",children:e.jsxs("div",{className:"flex flex-wrap flex-row justify-center gap-2 items-center",children:[e.jsx("div",{className:" px-4 w-full md:w-[30%]",children:e.jsx("div",{className:"max-w-full w-full px-2 sm:px-12 lg:pr-20 mb-10 lg:mb-0",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"p-6 sm:py-8 sm:px-12 rounded-lg bg-white darks:bg-gray-800 shadow-xl",children:e.jsxs("form",{onSubmit:s.handleSubmit,children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl leading-normal mb-3 font-bold text-gray-800 darks:text-gray-300 text-center",children:"Login"})}),e.jsx("hr",{className:"block w-12 h-0.5 mx-auto my-5 bg-gray-700 border-gray-700"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"inputemail",className:"inline-block mb-2",children:"E-mail"}),e.jsx("input",{...s.getFieldProps("username"),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600",defaultValue:!0,"aria-label":"email",type:"email",required:!0}),e.jsx("span",{className:"text-red-600 text-xs",children:s.touched.username&&s.errors.username?s.errors.username:null})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex flex-wrap flex-row",children:e.jsx("div",{className:"flex-shrink max-w-full w-1/2",children:e.jsx("label",{htmlFor:"inputpass",className:"inline-block mb-2",children:"Password"})})}),e.jsx("input",{...s.getFieldProps("password"),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600","aria-label":"password",type:"password",defaultValue:!0,required:!0}),e.jsx("span",{className:"text-red-600 text-xs",children:s.touched.password&&s.errors.password?s.errors.password:null})]}),e.jsxs("div",{className:"grid",children:[j?e.jsx("div",{className:"flex justify-center",children:e.jsx(z,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsxs("button",{type:"submit",className:"py-2 px-4 inline-block text-center rounded leading-normal text-gray-100 bg-indigo-500 border border-indigo-500 hover:text-white hover:bg-indigo-600 hover:ring-0 hover:border-indigo-600 focus:bg-indigo-600 focus:border-indigo-600 focus:outline-none focus:ring-0",children:[e.jsxs("svg",{xmlnsXlink:"http://www.w3.org/2000/svg",fill:"currentColor",className:"inline-block w-4 h-4 ltr:mr-2 rtl:ml-2 bi bi-box-arrow-in-right",viewBox:"0 0 16 16",children:[e.jsx("path",{fillRule:"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),e.jsx("path",{fillRule:"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})]}),"Login"]}),e.jsx("div",{onClick:()=>g.current.showModal(),className:"select-none py-4 text-center font-semibold hover:text-blue-600 hover:underline cursor-pointer",children:"Forgot Password"})]})]})})})})}),e.jsx("div",{className:"px-4 w-full md:w-[45%]",children:e.jsxs("div",{className:"text-center mt-6 lg:mt-0",children:[e.jsx("img",{src:Y,alt:"welcome",className:"w-[60%] h-auto mx-auto hue-rotate-[90deg]"}),e.jsx("div",{className:"px-4 mt-12",children:e.jsx("h1",{className:"text-bold text-4xl mb-2",children:"Fines & Penalties Admin Portal"})})]})})]})})})}),e.jsx("footer",{className:" bg-white py-6 border-t border-gray-200 darks:bg-gray-800 darks:border-gray-800",children:e.jsx("div",{className:"container mx-auto px-4 xl:max-w-6xl ",children:e.jsx("div",{className:"mx-auto px-4",children:e.jsxs("div",{className:"flex flex-wrap flex-row -mx-4",children:[e.jsx("div",{className:"flex-shrink max-w-full px-4 w-full md:w-1/2 text-center md:ltr:text-left md:rtl:text-right"}),e.jsx("div",{className:"flex-shrink max-w-full px-4 w-full md:w-1/2 text-center md:ltr:text-right md:rtl:text-left"})]})})})}),e.jsxs("dialog",{ref:g,className:"relative overflow-clip animate__animated animate__zoomIn animate__faster w-[20rem] backdrop:backdrop-blur-sm p-4 px-6",children:[e.jsx("span",{onClick:()=>(g.current.close(),r.resetForm()),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:e.jsx(Z,{})}),e.jsx("div",{children:e.jsxs("form",{onSubmit:r.handleSubmit,onChange:l=>G(l),children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl border-b pb-1 leading-normal mb-4 font-semibold text-gray-800 darks:text-gray-300 text-center",children:"Reset Password"})}),e.jsxs("div",{className:" flex flex-col",children:[e.jsx("label",{htmlFor:"email",className:v,children:"E-mail : "}),e.jsx("input",{...s.getFieldProps("email"),value:r.values.email,type:"text",className:y+` ${(S=r.touched)!=null&&S.email&&((F=r.errors)!=null&&F.email)?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:"email",id:"",placeholder:"Enter email"})]}),e.jsx("div",{className:"my-4 text-center font-semibold ",children:"OR"}),e.jsxs("div",{className:" flex flex-col mb-6",children:[e.jsx("label",{htmlFor:"mobile",className:v,children:"Mobile No. : "}),e.jsx("input",{...s.getFieldProps("mobile"),value:r.values.mobile,type:"text",className:y+` ${(C=r.touched)!=null&&C.mobile&&((L=r.errors)!=null&&L.mobile)?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:"mobile",id:"",placeholder:"Enter mobile no."})]}),e.jsx("div",{className:"grid mb-2",children:j?e.jsx("div",{className:"flex justify-center",children:e.jsx(z,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsx("button",{onClick:r.handleSubmit,className:"py-2 px-4 inline-block text-center rounded leading-normal text-white bg-slate-500 border border-slate-500 hover:text-white hover:bg-slate-600 hover:ring-0 hover:border-indigo-600 focus:bg-slate-600 focus:border-slate-600 focus:outline-none focus:ring-0",children:"Reset"})})]})})]})]})}export{me as default};
