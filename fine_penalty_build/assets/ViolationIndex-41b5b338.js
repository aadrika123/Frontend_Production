import{j as t,r as a,E as oe,H as ne,I as re,G as le,m as de,c as ce,a as xe,u as he,B as pe,J as ue,K as me,F as ge,v as z,C as be,A as G,f as Z,h as U,n as fe,P as je}from"./index-7f040d82.js";import{r as V,C as Ne}from"./index-9f15ac44.js";import{S as ye}from"./ShimmerEffectInline-1def86bf.js";function ve({filter:n,setFilter:g}){return t.jsxs(t.Fragment,{children:["Search : "," ",t.jsx("input",{className:"border-2 border-gray-600 px-2 bg-gray-200",type:"text",value:n||"",onChange:p=>g(p.target.value)})]})}function we(n){const[g,p]=a.useState("hidden"),A=a.useMemo(()=>n.columns,[]),D=a.useMemo(()=>n.dataList,[n.dataList]);a.useEffect(()=>{w(10)},[]);const{getTableProps:K,getTableBodyProps:F,headerGroups:x,page:h,nextPage:L,previousPage:N,canNextPage:u,canPreviousPage:b,prepareRow:y,pageOptions:M,gotoPage:v,pageCount:P,setPageSize:w,state:c,setGlobalFilter:H}=V.useTable({columns:A,data:D,initialState:{pageIndex:0}},V.useGlobalFilter,V.useSortBy,V.usePagination),{globalFilter:_,pageIndex:E,pageSize:f}=c;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex mb-2 pb-2",children:[t.jsx("div",{className:"flex-initial",children:t.jsx(ve,{filter:_,setFilter:H})}),(n==null?void 0:n.exportStatus)!==!1&&t.jsx("div",{className:"flex-initial ml-2",children:t.jsxs("button",{className:"bg-sky-400 px-3 pr-3  shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onMouseEnter:()=>p(""),onMouseLeave:()=>p("hidden"),children:[t.jsx(Ne,{data:n.dataList,children:"Export"}),t.jsx("div",{className:g+" absolute h-full top-3 text-sm left-0 text-center animate-bounce",children:t.jsx(oe,{})})]})}),t.jsx("div",{className:"flex-1",children:n.children}),n.assessmentType&&t.jsxs("div",{className:"flex-initial flex",children:[t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-initial h-4 w-4 text-green-900 text-xs font-semibold text-center bg-green-200 rounded-full ml-4 ",children:"N"}),t.jsx("div",{className:"flex-initial text-xs ml-2",children:" New Assessment"}),t.jsx("div",{className:"flex-initial h-4 w-4 bg-blue-200  text-blue-900 text-xs font-semibold text-center rounded-full ml-4",children:"R"}),t.jsx("div",{className:"flex-initial text-xs ml-2",children:" Re-Assessment"}),t.jsx("div",{className:"flex-initial h-4 w-4 bg-red-200  text-red-900 text-xs font-semibold text-center rounded-full ml-4",children:"M"}),t.jsx("div",{className:"flex-initial text-xs ml-2",children:" Mutation"})]}),t.jsx("div",{}),t.jsx("div",{})]})]}),t.jsx("div",{className:" p-4 overflow-x-auto bg-white",children:t.jsxs("div",{className:"inline-block min-w-full rounded-lg overflow-hidden bg-white",children:[t.jsxs("table",{...F,className:"min-w-full leading-normal",children:[t.jsx("thead",{className:"font-bold text-left text-sm bg-sky-50",children:x==null?void 0:x.map(o=>t.jsx("tr",{...o.getHeaderGroupProps(),children:o.headers.map(l=>t.jsxs("th",{...l.getHeaderProps(l.getSortByToggleProps()),className:(l==null?void 0:l.className)+" px-2 py-3 border-b border-gray-200 text-gray-800  text-left text-xs capitalize",children:[l.render("Header"),t.jsx("span",{children:l.isSorted?l.isSortedDesc?"⬆️":"⬇️":""})]}))}))}),t.jsxs("tbody",{...F(),className:"text-sm",children:[" ",h==null?void 0:h.map(o=>{var l;return y(o),t.jsx("tr",{...o.getRowProps(),className:"bg-white shadow-lg border-b border-gray-200",children:(l=o==null?void 0:o.cells)==null?void 0:l.map(B=>t.jsx("td",{...B.getCellProps(),className:"px-2 py-2 text-sm text-left",children:B.render("Cell")}))})}),t.jsx("tr",{children:t.jsx("td",{})})]})]}),t.jsxs("div",{className:"mt-3 grid grid-cols-12",children:[t.jsxs("div",{className:"col-span-2",children:["  ",t.jsx("select",{className:"h-10 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:f,onChange:o=>w(Number(o.target.value)),children:[5,10,25,50].map(o=>t.jsxs("option",{value:o,children:["show ",o]},o))})]}),t.jsxs("div",{className:"col-span-4 text-center col-start-5",children:["   ",t.jsxs("span",{children:["page ","",t.jsxs("strong",{children:[E+1," of ",M.length]}),""]})]}),t.jsxs("div",{className:"col-span-4 text-right",children:[t.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>v(0),disabled:!b,children:[t.jsx(ne,{})," "]}),t.jsx("button",{className:(b?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>N(),disabled:!b,children:"⬅️"}),t.jsx("button",{className:(u?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>L(),disabled:!u,children:"➡️"}),t.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>v(P-1),disabled:!u,children:["  ",t.jsx(re,{})]})]})]})]})})]})}function J(n){return le({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M2 5H14V7H2V5Z",fill:"currentColor"}},{tag:"path",attr:{d:"M2 9H14V11H2V9Z",fill:"currentColor"}},{tag:"path",attr:{d:"M10 13H2V15H10V13Z",fill:"currentColor"}},{tag:"path",attr:{d:"M16 9H18V13H22V15H18V19H16V15H12V13H16V9Z",fill:"currentColor"}}]})(n)}const Ae=()=>{de("Violation Master");const{api_violationMasterList:n,api_updateViolation:g,api_deleteViolation:p,api_addViolation:A,api_getViolationList:D,api_getSectionList:K,api_getDepartmentList:F}=je(),x=a.useRef(),[h,L]=a.useState([]),[N,u]=a.useState(!1),[b,y]=a.useState(!1),[M,v]=a.useState(""),[P,w]=a.useState(!1),[c,H]=a.useState(""),[_,E]=a.useState(null),[f,o]=a.useState(null);a.useState([]),a.useState([]),a.useState([]);const[l,B]=a.useState(!1),Y="border border-red-300 text-red-400 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-red-800 hover:text-white",I="float-right bg-[#1A4D8C] px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-[#113766] hover:text-white text-white flex items-center",Q="text-gray-800 text-sm",R="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm",W=e=>`px-4 py-1 text-sm bg-${e}-500 hover:bg-${e}-600 select-none rounded-sm hover:drop-shadow-md text-white`,j=(e,s)=>{w(e),v(s)},T=(e,s=null)=>{switch(H(e),console.log(e,":::::::::",s),e){case"add":break;case"edit":o(s),d.setFieldValue("violationName",s==null?void 0:s.violation_name),d.setFieldValue("violationSection",s==null?void 0:s.violation_section),d.setFieldValue("penaltyAmount",s==null?void 0:s.penalty_amount);break;case"delete":E(s);break}x.current.showModal()},X=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Department",Cell:({cell:e})=>{var s;return z((s=e.row.original)==null?void 0:s.department_name)}},{Header:"Violation Section",Cell:({cell:e})=>{var s;return z((s=e.row.original)==null?void 0:s.violation_section)}},{Header:"Violation Name",Cell:({cell:e})=>{var s;return z((s=e.row.original)==null?void 0:s.violation_name)}},{Header:"Penalty Amount",Cell:({cell:e})=>{var s;return be((s=e.row.original)==null?void 0:s.penalty_amount)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>t.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:t.jsx("button",{onClick:()=>{var s,r;return T("delete",(r=(s=e==null?void 0:e.row)==null?void 0:s.original)==null?void 0:r.id)},className:Y,children:"Delete"})})}],S=[{title:"Department",key:"department",width:"md:w-[20%] w-full",type:"text",hint:"Enter department",required:!0,options:"departmentList",okey:"id",ovalue:"department_name"},{title:"Violation Section",key:"violationSection",width:"md:w-[20%] w-full",type:"text",hint:"Enter violation section",required:!0,options:"violationSectionList",okey:"id",ovalue:"section"},{title:"Violation Name",key:"violationMade",width:"md:w-[20%] w-full",type:"text",hint:"Enter violation name",required:!0,options:"violationList",okey:"id",ovalue:"violation_name"},{title:"Penalty Amount",key:"penaltyAmount",type:"number",hint:"Enter penalty Amount",required:!0}],ee=ce().shape([...S].reduce((e,s)=>(s!=null&&s.required&&(e[s.key]=xe().required(s==null?void 0:s.hint)),e),{})),d=he({initialValues:{department:"",violationMade:"",violationSection:"",penaltyAmount:""},enableReinitialize:!0,validationSchema:ee,onSubmit:e=>{q(e)}}),$=()=>{u(!0),G.post(n,{},Z()).then(e=>{var s,r,i;(s=e==null?void 0:e.data)!=null&&s.status?L((r=e==null?void 0:e.data)==null?void 0:r.data):j(!0,U((i=e==null?void 0:e.data)==null?void 0:i.message)),console.log("fp violation list response => ",e)}).catch(e=>{j(!0,"Server Error! Please try again later."),console.log("error fp violation list => ",e)}).finally(()=>{u(!1)})},te=(e,s="",r,i="",C="",k=!1,m=[],ae="",ie="")=>t.jsxs("div",{className:`flex flex-col ${i} `,children:[s!=""&&t.jsxs("label",{htmlFor:e,className:Q,children:[s," ",k&&t.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),r!="select"&&r!="file"&&t.jsx("input",{...d.getFieldProps(e),type:r,className:R+` ${d.touched[e]&&d.errors[e]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:e,id:"",placeholder:C}),r=="select"&&t.jsx("select",{...d.getFieldProps(e),className:R+` ${d.touched[e]&&d.errors[e]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:l?t.jsx("option",{children:"Loading..."}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:null,children:"Select"}),m==null?void 0:m.map(O=>t.jsx("option",{className:"",value:O[ae],children:O[ie]}))]})})]}),q=e=>{y(!0),x.current.close(),console.log(c,e);let s,r;switch(c){case"add":s={violationName:e==null?void 0:e.violationMade,violationSection:e==null?void 0:e.violationSection,penaltyAmount:e==null?void 0:e.penaltyAmount,department:e==null?void 0:e.department},r=A;break;case"edit":s={id:f==null?void 0:f.id,violationName:e==null?void 0:e.violationMade,violationSection:e==null?void 0:e.violationSection,penaltyAmount:e==null?void 0:e.penaltyAmount,department:e==null?void 0:e.department},r=g;break;case"delete":s={id:_},r=p;break}G.post(r,s,Z()).then(i=>{var C,k,m;(C=i==null?void 0:i.data)!=null&&C.status?(fe.success((k=i==null?void 0:i.data)==null?void 0:k.message),$()):j(!0,U((m=i==null?void 0:i.data)==null?void 0:m.message)),console.log("fp violation response => ",i)}).catch(i=>{j(!0,"Server Error! Please try again later."),console.log("error violation list => ",i)}).finally(()=>{y(!1),d.resetForm()})},se=e=>{};return a.useEffect(()=>{$()},[]),t.jsxs(t.Fragment,{children:[b&&t.jsx(pe,{}),P&&t.jsx(ue,{activateBottomErrorCard:j,errorTitle:M}),t.jsxs("div",{className:"poppins p-4 px-6",children:[t.jsx("div",{className:"uppercase font-semibold text-gray-700 text-2xl py-2 text-center tracking-[0.7rem]",children:"Violation   Master"}),t.jsx("div",{className:"w-full h-[0.15rem] bg-gray-400 mb-6"}),N&&t.jsx(ye,{}),!N&&t.jsx(t.Fragment,{children:(h==null?void 0:h.length)>0?t.jsx(t.Fragment,{children:t.jsx(we,{columns:X,dataList:h,children:t.jsxs("button",{onClick:()=>T("add"),className:I,children:[t.jsx(J,{})," Add Violation"]})})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex justify-end mb-2",children:t.jsxs("button",{onClick:()=>T("add"),className:I,children:[t.jsx(J,{})," Add Violation"]})}),t.jsx("div",{className:"bg-red-100 text-red-500 py-2 text-lg font-semibold text-center border border-red-500 drop-shadow-sm",children:"Oops! No Data Found."})]})})]}),t.jsxs("dialog",{ref:x,className:`relative overflow-clip animate__animated animate__zoomIn animate__faster ${c!="delete"&&" w-[90vw] md:max-w-[1080px]"}`,children:[c!="delete"&&t.jsx("span",{onClick:()=>(x.current.close(),d.resetForm()),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:t.jsx(me,{})}),c!="delete"&&t.jsxs("form",{onChange:e=>(d.handleChange(e),se()),onSubmit:d.handleSubmit,className:"p-4 px-8 py-6 shadow-lg",children:[t.jsxs("section",{className:"flex gap-4 flex-wrap",children:[t.jsxs("header",{className:"w-full font-semibold text-xl capitalize text-sky-700 border-b pb-1 text-center",children:[c," Violation"]}),S==null?void 0:S.map(e=>te(e==null?void 0:e.key,e==null?void 0:e.title,e==null?void 0:e.type,e==null?void 0:e.width,e==null?void 0:e.hint,e==null?void 0:e.required,e==null?void 0:e.options,e==null?void 0:e.okey,e==null?void 0:e.ovalue))]}),t.jsx("footer",{className:"mt-4 flex justify-center",children:t.jsxs("button",{type:"submit",className:W("green"),children:[c=="add"&&"Add",c=="edit"&&"Update"]})})]}),c=="delete"&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:" z-50 px-6 py-4 flex flex-col gap-4 ",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsx("span",{className:"text-red-500 bg-red-100 p-2 block rounded-full drop-shadow-md shadow-red-300",children:t.jsx(ge,{size:25})}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("span",{className:"text-xl font-semibold border-b pb-1",children:"Confirmation Box"}),t.jsx("span",{className:"text-base",children:"Are you sure want to delete ?"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{className:"text-white bg-slate-400 hover:bg-slate-500 px-4 py-1 text-sm ",onClick:()=>x.current.close(),children:"No"}),t.jsx("button",{className:"text-white bg-red-500 hover:bg-red-600 px-4 py-1 text-sm ",onClick:()=>q(),children:"Yes"})]})]})})]})]})};export{Ae as default};
