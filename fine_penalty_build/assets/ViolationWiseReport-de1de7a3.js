import{v as J,r as s,d as K,c as Q,a as X,x as m,u as Y,j as e,R as Z,P as tt,C as c,H as ot,A as h,k as f}from"./index-b41787ee.js";import{R as et,L as at}from"./index.esm-b6cbb191.js";import"./index.esm-e79c22da.js";const lt=()=>{J("Violation Wise Report");const{api_ViolationWiseReport:b,api_getViolationList:w,api_getSectionList:y,api_listDepartment:j,api_violationMasterList:it}=tt(),[S,_]=s.useState([]),[N,L]=s.useState([]),[D,C]=s.useState([]),V=K(),k=[{Header:"Sl.No.",Cell:({row:t})=>e.jsx("div",{children:(t==null?void 0:t.index)+1})},{Header:"Name",accessor:"full_name",Cell:({cell:t})=>{var o;return c((o=t.row.original)==null?void 0:o.full_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:t})=>{var o;return c((o=t.row.original)==null?void 0:o.mobile)}},{Header:"Challan No",accessor:"challan_no",Cell:({cell:t})=>{var o;return e.jsx("div",{className:"underline cursor-pointer",onClick:()=>{var a,i,r,p;return((i=(a=t==null?void 0:t.row)==null?void 0:a.original)==null?void 0:i.challan_id)&&V(`/challan/${(p=(r=t==null?void 0:t.row)==null?void 0:r.original)==null?void 0:p.challan_id}`)},children:c((o=t.row.original)==null?void 0:o.challan_no)})}},{Header:"Violation Made",accessor:"violation_name",Cell:({cell:t})=>{var o;return c((o=t.row.original)==null?void 0:o.violation_name)}},{Header:"Violation Section",accessor:"violation_section",Cell:({cell:t})=>{var o;return c((o=t.row.original)==null?void 0:o.violation_section)}},{Header:"Violation Place",accessor:"violation_place",Cell:({cell:t})=>{var o;return c((o=t.row.original)==null?void 0:o.violation_place)}},{Header:"Penalty Amount",accessor:"total_amount",Cell:({cell:t})=>{var o;return ot((o=t.row.original)==null?void 0:o.total_amount)}}],[x,R]=s.useState({}),[H,F]=s.useState(0),[z,A]=s.useState(!1),[q,l]=s.useState(!1),M="text-gray-800 text-sm",g="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm",d=[{title:"From Date",key:"fromDate",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""},{title:"Upto Date",key:"uptoDate",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""},{title:"Department",key:"department",width:"md:w-[20%] w-full",type:"select",hint:"Enter your name",options:D,okey:"id",ovalue:"department_name"},{title:"Violation Section",key:"violationSection",width:"md:w-[20%] w-full",type:"select",hint:"Enter your name",options:N,okey:"id",ovalue:"violation_section"},{title:"Violation Made",key:"violationMade",width:"md:w-[20%] w-full",type:"select",hint:"Enter your name",options:S,okey:"id",ovalue:"violation_name"}],E=(t,o="",a,i="",r="",p=!1,u=[],U="",G="")=>e.jsxs("div",{className:`flex flex-col ${i} `,children:[o!=""&&e.jsxs("label",{htmlFor:t,className:M,children:[o," ",p&&e.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),a!="select"&&a!="file"&&e.jsx("input",{...n.getFieldProps(t),type:a,className:g+` ${n.touched[t]&&n.errors[t]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:t,id:"",placeholder:r}),a=="select"&&e.jsx("select",{...n.getFieldProps(t),className:g+` ${n.touched[t]&&n.errors[t]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:q?e.jsx("option",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"All"}),u==null?void 0:u.map(v=>e.jsx("option",{className:"",value:v[U],children:v[G]}))]})})]}),P=Q().shape([...d].reduce((t,o)=>(o!=null&&o.required&&(t[o.key]=X().required(o==null?void 0:o.hint)),t),{})),$={fromDate:m(),uptoDate:m(),department:"",violationMade:"",violationSection:""},n=Y({initialValues:$,enableReinitialize:!0,validationSchema:P,onSubmit:t=>{I(t)}}),I=t=>{R({fromDate:t==null?void 0:t.fromDate,uptoDate:t==null?void 0:t.uptoDate,violationId:t==null?void 0:t.violationMade}),F(o=>o+1)},W=()=>{l(!0),h.post(j,{},f()).then(t=>{var o,a;(o=t==null?void 0:t.data)!=null&&o.status&&C((a=t==null?void 0:t.data)==null?void 0:a.data),console.log("fp department list response => ",t)}).catch(t=>{console.log("error fp department list => ",t)}).finally(()=>{l(!1)})},B=t=>{console.log(t),l(!0),h.post(y,{departmentId:t},f()).then(o=>{var a,i;(a=o==null?void 0:o.data)!=null&&a.status&&L((i=o==null?void 0:o.data)==null?void 0:i.data),console.log("fp violation section list response => ",o)}).catch(o=>{console.log("error fp violation section list => ",o)}).finally(()=>{l(!1)})},T=t=>{l(!0);let o={sectionId:t,departmentId:n.values.department};h.post(w,o,f()).then(a=>{var i,r;(i=a==null?void 0:a.data)!=null&&i.status&&_((r=a==null?void 0:a.data)==null?void 0:r.data),console.log("fp violation list response => ",a)}).catch(a=>{console.log("error fp violation list => ",a)}).finally(()=>{l(!1)})},O=t=>{const o=t.target.name,a=t.target.value;o=="violationSection"&&T(a),o=="department"&&B(a)};return s.useEffect(()=>{W()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("form",{onChange:t=>(n.handleChange(t),O(t)),onSubmit:n.handleSubmit,className:"w-full h-full p-4 mb-6 border border-zinc-200 bg-zinc-50",children:[e.jsx("h1",{className:"text-xl font-semibold uppercase text-center text-gray-700 border-b border-gray-400 mb-4 pb-1",children:"Violation Wise Report"}),e.jsxs("section",{className:"flex gap-4 flex-wrap my-6",children:[d==null?void 0:d.map(t=>E(t==null?void 0:t.key,t==null?void 0:t.title,t==null?void 0:t.type,t==null?void 0:t.width,t==null?void 0:t.hint,t==null?void 0:t.required,t==null?void 0:t.options,t==null?void 0:t.okey,t==null?void 0:t.ovalue)),e.jsx("div",{className:"mt-4 w-full md:w-[30%] flex flex-row flex-wrap items-center gap-x-4 gap-y-2 md:mt-4",children:e.jsx("div",{className:" ",children:z?e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex justify-center",children:e.jsx(Z,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):e.jsxs("button",{type:"submit",className:" flex items-center border border-green-600 bg-green-500 hover:bg-green-600 text-white shadow-md rounded-sm  text-sm px-5 py-1",children:[e.jsx("span",{className:"",children:e.jsx(et,{fontSize:""})}),e.jsx("span",{children:"Search Record"})]})})})]})]}),Object.keys(x).length!==0&&e.jsx(at,{api:b,columns:k,requestBody:x,changeData:H,search:!1,loader:t=>A(t)})]})};export{lt as default};
