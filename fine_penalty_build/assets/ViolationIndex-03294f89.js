import{j as t,r as s,D as ke,E as Ve,H as _e,G as Ae,o as He,c as Le,a as Me,u as Fe,B as Pe,I as De,J as Ee,F as Ie,w as b,p as Y,C as ze,A as P,f as D,h as ne,n as Te,P as $e}from"./index-fd92219b.js";import{r as E,C as Be}from"./index-3270dd37.js";import{S as Re}from"./ShimmerEffectInline-50722016.js";function Oe({filter:d,setFilter:j}){return t.jsxs(t.Fragment,{children:["Search : "," ",t.jsx("input",{className:"border-2 border-gray-600 px-2 bg-gray-200",type:"text",value:d||"",onChange:u=>j(u.target.value)})]})}function K(d){const[j,u]=s.useState("hidden"),I=s.useMemo(()=>d.columns,[]),z=s.useMemo(()=>d.dataList,[d.dataList]);s.useEffect(()=>{v(10)},[]);const{getTableProps:Q,getTableBodyProps:V,headerGroups:N,page:y,nextPage:T,previousPage:$,canNextPage:w,canPreviousPage:S,prepareRow:B,pageOptions:h,gotoPage:p,pageCount:_,setPageSize:v,state:A,setGlobalFilter:R}=E.useTable({columns:I,data:z,initialState:{pageIndex:0}},E.useGlobalFilter,E.useSortBy,E.usePagination),{globalFilter:H,pageIndex:O,pageSize:q}=A;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex mb-2 pb-2",children:[t.jsx("div",{className:"flex-initial",children:t.jsx(Oe,{filter:H,setFilter:R})}),(d==null?void 0:d.exportStatus)!==!1&&t.jsx("div",{className:"flex-initial ml-2",children:t.jsxs("button",{className:"bg-sky-400 px-3 pr-3  shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onMouseEnter:()=>u(""),onMouseLeave:()=>u("hidden"),children:[t.jsx(Be,{data:d.dataList,children:"Export"}),t.jsx("div",{className:j+" absolute h-full top-3 text-sm left-0 text-center animate-bounce",children:t.jsx(ke,{})})]})}),t.jsx("div",{className:"flex-1",children:d.children}),d.assessmentType&&t.jsxs("div",{className:"flex-initial flex",children:[t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-initial h-4 w-4 text-green-900 text-xs font-semibold text-center bg-green-200 rounded-full ml-4 ",children:"N"}),t.jsx("div",{className:"flex-initial text-xs ml-2",children:" New Assessment"}),t.jsx("div",{className:"flex-initial h-4 w-4 bg-blue-200  text-blue-900 text-xs font-semibold text-center rounded-full ml-4",children:"R"}),t.jsx("div",{className:"flex-initial text-xs ml-2",children:" Re-Assessment"}),t.jsx("div",{className:"flex-initial h-4 w-4 bg-red-200  text-red-900 text-xs font-semibold text-center rounded-full ml-4",children:"M"}),t.jsx("div",{className:"flex-initial text-xs ml-2",children:" Mutation"})]}),t.jsx("div",{}),t.jsx("div",{})]})]}),t.jsx("div",{className:" p-4 overflow-x-auto bg-white",children:t.jsxs("div",{className:"inline-block min-w-full rounded-lg overflow-hidden bg-white",children:[t.jsxs("table",{...V,className:"min-w-full leading-normal",children:[t.jsx("thead",{className:"font-bold text-left text-sm bg-sky-50",children:N==null?void 0:N.map(l=>t.jsx("tr",{...l.getHeaderGroupProps(),children:l.headers.map(c=>t.jsxs("th",{...c.getHeaderProps(c.getSortByToggleProps()),className:(c==null?void 0:c.className)+" px-2 py-3 border-b border-gray-200 text-gray-800  text-left text-xs capitalize",children:[c.render("Header"),t.jsx("span",{children:c.isSorted?c.isSortedDesc?"⬆️":"⬇️":""})]}))}))}),t.jsxs("tbody",{...V(),className:"text-sm",children:[" ",y==null?void 0:y.map(l=>{var c;return B(l),t.jsx("tr",{...l.getRowProps(),className:"bg-white shadow-lg border-b border-gray-200",children:(c=l==null?void 0:l.cells)==null?void 0:c.map(x=>t.jsx("td",{...x.getCellProps(),className:"px-2 py-2 text-sm text-left",children:x.render("Cell")}))})}),t.jsx("tr",{children:t.jsx("td",{})})]})]}),t.jsxs("div",{className:"mt-3 grid grid-cols-12",children:[t.jsxs("div",{className:"col-span-2",children:["  ",t.jsx("select",{className:"h-10 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:q,onChange:l=>v(Number(l.target.value)),children:[5,10,25,50].map(l=>t.jsxs("option",{value:l,children:["show ",l]},l))})]}),t.jsxs("div",{className:"col-span-4 text-center col-start-5",children:["   ",t.jsxs("span",{children:["page ","",t.jsxs("strong",{children:[O+1," of ",h.length]}),""]})]}),t.jsxs("div",{className:"col-span-4 text-right",children:[t.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>p(0),disabled:!S,children:[t.jsx(Ve,{})," "]}),t.jsx("button",{className:(S?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>$(),disabled:!S,children:"⬅️"}),t.jsx("button",{className:(w?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>T(),disabled:!w,children:"➡️"}),t.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>p(_-1),disabled:!w,children:["  ",t.jsx(_e,{})]})]})]})]})})]})}function ae(d){return Ae({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M2 5H14V7H2V5Z",fill:"currentColor"}},{tag:"path",attr:{d:"M2 9H14V11H2V9Z",fill:"currentColor"}},{tag:"path",attr:{d:"M10 13H2V15H10V13Z",fill:"currentColor"}},{tag:"path",attr:{d:"M16 9H18V13H22V15H18V19H16V15H12V13H16V9Z",fill:"currentColor"}}]})(d)}const Ye=()=>{He("Violation Master");const{api_violationMasterList:d,api_updateViolation:j,api_deleteViolation:u,api_addViolation:I,api_listDepartment:z,api_addDepartment:Q,api_updateDepartment:V,api_deleteDepartment:N,api_listSection:y,api_addSection:T,api_updateSection:$,api_deleteSection:w,api_getSectionList:S,api_getDepartmentList:B}=$e(),h=s.useRef(),[p,_]=s.useState([]),[v,A]=s.useState(!1),[R,H]=s.useState(!1),[O,q]=s.useState(""),[l,c]=s.useState(!1),[x,oe]=s.useState(""),[G,se]=s.useState(null),[m,re]=s.useState(null),[le,de]=s.useState([]),[ce,xe]=s.useState([]),[pe,qe]=s.useState([]),[me,L]=s.useState(!1),[n,U]=s.useState("department"),Z="border border-red-300 text-red-400 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-red-800 hover:text-white",W="float-right bg-[#1A4D8C] px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-[#113766] hover:text-white text-white flex items-center",he="text-gray-800 text-sm",X="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm",ge=e=>`px-4 py-1 text-sm bg-${e}-500 hover:bg-${e}-600 select-none rounded-sm hover:drop-shadow-md text-white`,J=e=>`border border-slate-700 ${e?"bg-slate-700 text-white":"text-slate-700 shadow-2xl shadow-slate-700"} mx-1 px-3 py-1 rounded-sm hover:bg-slate-700 hover:text-white text-sm`,C=(e,i)=>{c(e),q(i)},k=(e,i=null)=>{switch(oe(e),console.log(e,":::::::::",i),e){case"add":break;case"edit":re(i),n=="department"&&r.setFieldValue("department",i==null?void 0:i.department_name),n=="section"&&(r.setFieldValue("violationSection",i==null?void 0:i.violation_section),r.setFieldValue("department",i==null?void 0:i.department_id)),n=="violation"&&(r.setFieldValue("violationName",i==null?void 0:i.violation_name),r.setFieldValue("violationSection",i==null?void 0:i.violation_section_id),r.setFieldValue("department",i==null?void 0:i.department_id),r.setFieldValue("penaltyAmount",i==null?void 0:i.penalty_amount));break;case"delete":se(i);break}h.current.showModal()},fe=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Department",Cell:({cell:e})=>{var i;return b((i=e.row.original)==null?void 0:i.department_name)}},{Header:"Created At",Cell:({cell:e})=>{var i;return Y((i=e.row.original)==null?void 0:i.date)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>t.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:t.jsx("button",{onClick:()=>{var i,a;return k("delete",(a=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:a.id)},className:Z,children:"Delete"})})}],ue=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Department",Cell:({cell:e})=>{var i;return b((i=e.row.original)==null?void 0:i.department_name)}},{Header:"Violation Section",Cell:({cell:e})=>{var i;return b((i=e.row.original)==null?void 0:i.violation_section)}},{Header:"Created At",Cell:({cell:e})=>{var i;return Y((i=e.row.original)==null?void 0:i.date)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>t.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:t.jsx("button",{onClick:()=>{var i,a;return k("delete",(a=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:a.id)},className:Z,children:"Delete"})})}],be=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Department",Cell:({cell:e})=>{var i;return b((i=e.row.original)==null?void 0:i.department_name)}},{Header:"Violation Section",Cell:({cell:e})=>{var i;return b((i=e.row.original)==null?void 0:i.violation_section)}},{Header:"Violation Name",Cell:({cell:e})=>{var i;return b((i=e.row.original)==null?void 0:i.violation_name)}},{Header:"Penalty Amount",Cell:({cell:e})=>{var i;return ze((i=e.row.original)==null?void 0:i.penalty_amount)}},{Header:"Created At",Cell:({cell:e})=>{var i;return Y((i=e.row.original)==null?void 0:i.date)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>t.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:t.jsx("button",{onClick:()=>{var i,a;return k("delete",(a=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:a.id)},className:Z,children:"Delete"})})}],M=[{title:"Department",key:"department",width:`${n=="department"?" md:w-full ":n=="section"?" md:w-[45%] ":" md:w-[20%] "} w-full `,type:n=="department"?"text":"select",hint:"Enter department",required:!0,options:ce,okey:"id",ovalue:"department_name"},{title:"Violation Section",key:"violationSection",width:`${n=="section"?" md:w-[45%] ":" md:w-[20%] "} w-full ${n!="department"?"block ":"hidden "}`,type:n=="section"?"text":"select",hint:"Enter violation section",required:n!="department"&&!0,options:le,okey:"id",ovalue:"violation_section"},{title:"Violation Name",key:"violationMade",width:`md:w-[20%] w-full ${n!="department"&&n!="section"?"block ":"hidden "}`,type:"text",hint:"Enter violation name",required:n!="department"&&n!="section"&&!0,options:pe,okey:"id",ovalue:"violation_name"},{title:"Penalty Amount",key:"penaltyAmount",width:`md:w-[20%] w-full ${n=="violation"?"block ":"hidden "}`,type:"number",hint:"Enter penalty Amount",required:n=="violation"&&!0}],je=Le().shape([...M].reduce((e,i)=>(i!=null&&i.required&&(e[i.key]=Me().required(i==null?void 0:i.hint)),e),{})),r=Fe({initialValues:{department:"",violationMade:"",violationSection:"",penaltyAmount:""},enableReinitialize:!0,validationSchema:je,onSubmit:e=>{te(e)}}),ee=()=>{_([]),A(!0);let e;n=="department"&&(e=z),n=="section"&&(e=y),n=="violation"&&(e=d),P.post(e,{},D()).then(i=>{var a,o,g;(a=i==null?void 0:i.data)!=null&&a.status?_((o=i==null?void 0:i.data)==null?void 0:o.data):C(!0,ne((g=i==null?void 0:i.data)==null?void 0:g.message)),console.log("fp violation list response => ",i)}).catch(i=>{C(!0,"Server Error! Please try again later."),console.log("error fp violation list => ",i)}).finally(()=>{A(!1)})},Ne=(e,i="",a,o="",g="",F=!1,f=[],ve="",Ce="")=>t.jsxs("div",{className:`flex flex-col ${o} `,children:[i!=""&&t.jsxs("label",{htmlFor:e,className:he,children:[i," ",F&&t.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),a!="select"&&a!="file"&&t.jsx("input",{...r.getFieldProps(e),type:a,className:X+` ${r.touched[e]&&r.errors[e]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:e,id:"",placeholder:g}),a=="select"&&t.jsx("select",{...r.getFieldProps(e),className:X+` ${r.touched[e]&&r.errors[e]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:me?t.jsx("option",{children:"Loading..."}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:null,children:"Select"}),typeof f=="object"&&(f==null?void 0:f.map(ie=>t.jsx("option",{className:"",value:ie[ve],children:ie[Ce]})))]})})]}),te=e=>{H(!0),h.current.close(),console.log(x,e);let i,a;switch(x){case"add":n=="department"&&(i={departmentName:e==null?void 0:e.department},a=Q),n=="section"&&(i={violationSection:e==null?void 0:e.violationSection,departmentId:e==null?void 0:e.department},a=T),n=="violation"&&(i={violationName:e==null?void 0:e.violationMade,sectionId:e==null?void 0:e.violationSection,penaltyAmount:e==null?void 0:e.penaltyAmount,departmentId:e==null?void 0:e.department},a=I);break;case"edit":n=="department"&&(i={id:m==null?void 0:m.id,departmentName:e==null?void 0:e.department},a=V),n=="section"&&(i={id:m==null?void 0:m.id,violationSection:e==null?void 0:e.violationSection,department:e==null?void 0:e.department},a=$),n=="violation"&&(i={id:m==null?void 0:m.id,violationName:e==null?void 0:e.violationMade,violationSection:e==null?void 0:e.violationSection,penaltyAmount:e==null?void 0:e.penaltyAmount,department:e==null?void 0:e.department},a=j);break;case"delete":n=="department"&&(a=N,i={departmentId:G}),n=="section"&&(a=w,i={sectionId:G}),n=="violation"&&(a=u,i={id:G});break}P.post(a,i,D()).then(o=>{var g,F,f;(g=o==null?void 0:o.data)!=null&&g.status?(Te.success((F=o==null?void 0:o.data)==null?void 0:F.message),ee()):C(!0,ne((f=o==null?void 0:o.data)==null?void 0:f.message)),console.log("fp violation response => ",o)}).catch(o=>{C(!0,"Server Error! Please try again later."),console.log("error violation list => ",o)}).finally(()=>{H(!1),r.resetForm()})},ye=()=>{L(!0),P.post(B,{},D()).then(e=>{var i,a;(i=e==null?void 0:e.data)!=null&&i.status&&xe((a=e==null?void 0:e.data)==null?void 0:a.data),console.log("fp department list response => ",e)}).catch(e=>{console.log("error fp department list => ",e)}).finally(()=>{L(!1)})},we=e=>{console.log(e),L(!0),P.post(S,{departmentId:e},D()).then(i=>{var a,o;(a=i==null?void 0:i.data)!=null&&a.status&&de((o=i==null?void 0:i.data)==null?void 0:o.data),console.log("fp violation section list response => ",i)}).catch(i=>{console.log("error fp violation section list => ",i)}).finally(()=>{L(!1)})},Se=e=>{const i=e.target.name,a=e.target.value;console.log(i),i=="department"&&we(a)};return s.useEffect(()=>{n!="department"&&ye(),ee()},[n]),t.jsxs(t.Fragment,{children:[R&&t.jsx(Pe,{}),l&&t.jsx(De,{activateBottomErrorCard:C,errorTitle:O}),t.jsxs("div",{className:"poppins p-4 px-6",children:[t.jsx("div",{className:"uppercase font-semibold text-gray-700 text-2xl py-2 text-center tracking-[0.7rem]",children:"Violation   Master"}),t.jsx("div",{className:"w-full h-[0.15rem] bg-gray-400 mb-6"}),t.jsxs("div",{className:"flex gap-1 w-full flex-wrap my-6",children:[t.jsx("button",{onClick:()=>U("department"),className:J(n=="department"),children:"Department Master"}),t.jsx("button",{onClick:()=>U("section"),className:J(n=="section"),children:"Section Master"}),t.jsx("button",{onClick:()=>U("violation"),className:J(n=="violation"),children:"Violation Master"})]}),v&&t.jsx(Re,{}),!v&&t.jsx(t.Fragment,{children:(p==null?void 0:p.length)>0?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>k("add"),className:W+"capitalize flex gap-1 items-center",children:[t.jsx(ae,{})," Add ",t.jsx("span",{className:"capitalize",children:n})]}),n=="department"&&t.jsx(K,{columns:fe,dataList:p}),n=="section"&&t.jsx(K,{columns:ue,dataList:p}),n=="violation"&&t.jsx(K,{columns:be,dataList:p})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex justify-end mb-2",children:t.jsxs("button",{onClick:()=>k("add"),className:W+"capitalize flex gap-1 items-center",children:[t.jsx(ae,{})," Add ",t.jsx("span",{className:"capitalize",children:n})]})}),t.jsx("div",{className:"bg-red-100 text-red-500 py-2 text-lg font-semibold text-center border border-red-500 drop-shadow-sm",children:"Oops! No Data Found."})]})})]}),t.jsxs("dialog",{ref:h,className:`relative overflow-clip animate__animated animate__zoomIn animate__faster ${x!="delete"&&n=="violation"&&" w-[90vw] md:max-w-[1080px]"}`,children:[x!="delete"&&t.jsx("span",{onClick:()=>(h.current.close(),r.resetForm()),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:t.jsx(Ee,{})}),x!="delete"&&t.jsxs("form",{onChange:e=>(r.handleChange(e),Se(e)),onSubmit:r.handleSubmit,className:"p-4 px-8 py-6 shadow-lg",children:[t.jsxs("section",{className:"flex gap-4 flex-wrap",children:[t.jsxs("header",{className:"w-full font-semibold text-xl capitalize text-sky-700 border-b pb-1 text-center",children:[x," ",n]}),M==null?void 0:M.map(e=>Ne(e==null?void 0:e.key,e==null?void 0:e.title,e==null?void 0:e.type,e==null?void 0:e.width,e==null?void 0:e.hint,e==null?void 0:e.required,e==null?void 0:e.options,e==null?void 0:e.okey,e==null?void 0:e.ovalue))]}),t.jsx("footer",{className:"mt-4 flex justify-center",children:t.jsxs("button",{type:"submit",className:ge("green"),children:[x=="add"&&"Add",x=="edit"&&"Update"]})})]}),x=="delete"&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:" z-50 px-6 py-4 flex flex-col gap-4 ",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsx("span",{className:"text-red-500 bg-red-100 p-2 block rounded-full drop-shadow-md shadow-red-300",children:t.jsx(Ie,{size:25})}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("span",{className:"text-xl font-semibold border-b pb-1",children:"Confirmation Box"}),t.jsx("span",{className:"text-base",children:"Are you sure want to delete ?"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{className:"text-white bg-slate-400 hover:bg-slate-500 px-4 py-1 text-sm ",onClick:()=>h.current.close(),children:"No"}),t.jsx("button",{className:"text-white bg-red-500 hover:bg-red-600 px-4 py-1 text-sm ",onClick:()=>te(),children:"Yes"})]})]})})]})]})};export{Ye as default};
