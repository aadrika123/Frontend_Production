import{Q as Lr,j as e,I as B,A as P,H as W,d as V,o as Q,r as I,F as X,C as L,a4 as Or,ab as F,a2 as J,O as Gr,J as Z,B as D,c as ee,a as se,P as Qr,g as w,_ as h,w as G,S as Br,K as _,ad as Xr,ae as Jr,a5 as o,a6 as z,a7 as q,a8 as H,a9 as M,L as Ur,x as Zr,z as Dr,n as ea,U as kr}from"./index-D1hQ8xza.js";import{P as sa}from"./index-DFoLzx-l.js";import{p as Pr,M as Y,a as da,b as ra,c as aa,d as la,e as ca,f as na,g as ta,h as ia,i as xa,j as oa,k as ha,l as ja,m as ua,n as Na}from"./module.config-B4zAVPDx.js";import{g as O}from"./services-KQnp_8oA.js";import{I as Fr,F as fa}from"./info-DXCSsduV.js";import{T as Wr,a as $r,b as $,c as U,d as Kr,e as k}from"./table-D7omZFZF.js";import{C as ga}from"./chevron-down-BOV_6_t9.js";import{M as va}from"./move-right-CXCMCxuY.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=Lr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=Lr("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function ya({commentData:a}){var r,g,t;return e.jsx("div",{children:e.jsxs("div",{className:"max-w-lg mx-auto border px-6 py-2 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center mb-4 space-x-2",children:[e.jsx(B,{src:((r=a==null?void 0:a.userId)==null?void 0:r.fullImgUrl)||Pr,alt:"Student",className:"h-6 w-6 rounded-full"})," ",e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-800 font-semibold",children:((g=a==null?void 0:a.userId)==null?void 0:g.fullName)||""}),e.jsx("div",{className:"text-xs italic text-gray-500",children:`(${(t=a==null?void 0:a.roleId)==null?void 0:t.roleName})`||""}),e.jsx("div",{className:"text-xs text-gray-500",children:P(a==null?void 0:a.timeStamp).format("DD-MM-YYYY hh:mm a")})]})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-6",children:a==null?void 0:a.comment})]})})}const wa=ee().shape({comment:se().required("Write comment"),resolveDocs:Qr().required("Please upload a document")});function Ta({setisDialogOpen:a,complaintData:r,actionPermissions:g}){const t=W({}),i=V({resolver:Q(wa)}),[u,N]=I.useState(null),[T,b]=I.useState(null),x=async n=>{const j=n.target.files[0];if(j)if(N(j),i.setValue("resolveDocs",j),j.type.startsWith("image/")){const v=URL.createObjectURL(j);b(v)}else b(null)},c=async n=>{var v,s;const j=new FormData;j.append("complaintId",(s=(v=r==null?void 0:r.data)==null?void 0:v.data)==null?void 0:s._id),j.append("comment",n.comment),j.append("resolveDocs",n.resolveDocs);try{const l=await t.mutateAsync({api:w.resolveComplaint,data:j});l.data.success?(h.success(l.data.message),g.refetch(),r==null||r.refetch(),a(!1)):h.error(l.data.message)}catch(l){h.error(O(l))}};return e.jsx(X,{methods:i,onSubmit:i.handleSubmit(c),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs(L,{className:"mb-6 flex items-center justify-between text-2xl font-bold",children:[e.jsxs("div",{children:[e.jsx("span",{className:"mr-2 inline-flex h-7 w-7 items-center justify-center rounded-full bg-green-600 text-white",children:e.jsx(Or,{className:"inline"})}),"Resolve Grievance"]}),e.jsx("div",{children:e.jsx(F,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>a(!1)})})]}),e.jsxs(J,{className:"flex items-center opacity-70",children:[e.jsx(Fr,{size:20,className:"mr-1 inline"}),e.jsx("span",{children:"This comment will be visible to the citizen."})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Gr,{className:"cursor-pointer",accept:"image/jpeg,image/jpg,image/png,application/pdf",name:"resolveDocs",placeholder:"Select document",onChange:x})}),u&&e.jsxs("div",{className:"mt-4 rounded-md border p-4 shadow-lg",children:[u&&e.jsx("p",{className:"font-semibold",children:u.name}),T?e.jsx("img",{src:T,alt:"Preview",className:"mt-2 h-32 w-32 rounded-md object-cover"}):e.jsx("p",{className:"text-gray-500"})]}),e.jsx(Z,{className:"mt-2 h-40 w-full rounded-md border bg-background p-4",name:"comment",placeholder:"Comment"}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{isLoading:i.formState.isSubmitting,type:"submit",className:"w-full",children:"Resolve"})})]})})}const pa=ee().shape({comment:se().required("Select comment")});function _a({setisDialogOpen:a,complaintData:r,actionPermissions:g}){const t=W({}),i=V({resolver:Q(pa)}),u=async N=>{var b,x;let T={complaintId:(x=(b=r==null?void 0:r.data)==null?void 0:b.data)==null?void 0:x._id,comment:N==null?void 0:N.comment};try{const c=await t.mutateAsync({api:w.rejectComplaint,data:T});c.data.success?(h.success(c.data.message),g.refetch(),r==null||r.refetch(),a(!1)):h.error(c.data.message)}catch(c){h.error(O(c))}};return e.jsx(X,{methods:i,onSubmit:i.handleSubmit(u),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"w-7 h-7 bg-red-600 rounded-full bg-red-5500 text-white inline-flex justify-center items-center mr-2",children:e.jsx(F,{})})," Reject Grievance"]}),e.jsx("div",{children:e.jsx(F,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),e.jsxs(J,{className:"opacity-70 flex items-center",children:[e.jsx("div",{children:e.jsx(Fr,{size:20,className:"inline mr-1"})}),e.jsx("div",{children:"This comment will be visible to citizen."})]}),e.jsx(Z,{className:"bg-background w-full rounded-md p-4 h-40 border mt-2",name:"comment",placeholder:"Comment"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{isLoading:i.formState.isSubmitting,type:"submit",className:" w-full",children:"Reject"})})]})})}function Ia({setisDialogOpen:a,complaintData:r,actionPermissions:g}){var N,T,b,x,c;const t=W({}),i=G({api:`${w.getAllWFUserMappingToTransfer}?workflowId=${(T=(N=r==null?void 0:r.data)==null?void 0:N.data)==null?void 0:T.wf_currentWorkflowId}`,key:"getWorkflowMembers",value:[],options:{enabled:!0}}),u=async n=>{var v,s,l;let j={complaintId:(s=(v=r==null?void 0:r.data)==null?void 0:v.data)==null?void 0:s._id,workflowId:null,userId:n};try{const E=await t.mutateAsync({api:(l=w)==null?void 0:l.transferComplaintToUlb,data:j});E.data.success?(h.success(E.data.message),r==null||r.refetch(),g.refetch(),a(!1)):h.error(E.data.message)}catch(E){h.error(O(E))}};return e.jsx("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsx("div",{children:"Transfer to any Members"}),e.jsx("div",{children:e.jsx(F,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),i.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Br,{})}):e.jsx(e.Fragment,{children:e.jsxs(Wr,{children:[e.jsx($r,{children:e.jsxs($,{children:[e.jsx(U,{className:"",children:"#"}),e.jsx(U,{className:"",children:"Member"}),e.jsx(U,{className:"",children:"Workflow Role"}),e.jsx(U,{children:"Action"})]})}),e.jsx(Kr,{children:(c=(x=(b=i==null?void 0:i.data)==null?void 0:b.data)==null?void 0:x.docs)==null?void 0:c.map((n,j)=>e.jsxs($,{children:[e.jsx(k,{children:j+1}),e.jsx(k,{children:n==null?void 0:n.UserName}),e.jsx(k,{children:n==null?void 0:n.workflowRoleName}),e.jsx(k,{className:"space-x-2",children:e.jsx(_,{name:"bts",type:"button",className:"mr-4",onClick:()=>u(n==null?void 0:n.userId),children:"Transfer"})})]},n._id))})]})})]})})}function Ea({setisDialogOpen:a,complaintData:r}){var u,N,T,b,x;const g=W({}),t=G({api:`${(u=w)==null?void 0:u.getAllUlbDirect}?page=1&limit=10000`,key:"getAllUlbDirect",options:{enabled:!0}}),i=async c=>{var n,j,v;try{let s={complaintId:(j=(n=r==null?void 0:r.data)==null?void 0:n.data)==null?void 0:j._id,ulbId:c};const l=await g.mutateAsync({api:(v=w)==null?void 0:v.transferComplaintToUlbSpecific,data:s});l.data.success?(h.success(l.data.message),r.refetch(),a(!1)):h.error(l.data.message)}catch(s){h.error(O(s))}};return e.jsx("div",{className:"gap-x-2 gap-y-4 px-10 py-10 h-[600px] overflow-y-scroll",children:e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:["Transfer to ULB(",(T=(N=t==null?void 0:t.data)==null?void 0:N.data)==null?void 0:T.length,")"]}),e.jsx("div",{children:e.jsx(F,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),t.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Br,{})}):e.jsx(e.Fragment,{children:e.jsxs(Wr,{children:[e.jsx($r,{children:e.jsxs($,{children:[e.jsx(U,{className:"",children:"#"}),e.jsx(U,{className:"",children:"ULB"}),e.jsx(U,{children:"Action"})]})}),e.jsx(Kr,{children:(x=(b=t==null?void 0:t.data)==null?void 0:b.data)==null?void 0:x.map((c,n)=>e.jsxs($,{children:[e.jsx(k,{children:n+1}),e.jsx(k,{children:c==null?void 0:c.ulbName}),e.jsx(k,{className:"space-x-2",children:e.jsx(_,{name:"bts",type:"button",className:"mr-4",onClick:()=>i(c==null?void 0:c._id),children:"Transfer"})})]},c._id))})]})})]})})}const Sa="https://jharkhandegovernance.com/property/search/fresh/direct/direct",Ca="https://jharkhandegovernance.com/water/waterApplicationSearch",Ra="",Aa="",Ma="",Ua="",ka="",La="",Oa="",Ga="",Ba="",Pa="",Fa="",Wa="",$a="",Ka=ee().shape({comment:se().required("Comment is required")});function za({setsearchLink:a,setsearchLabel:r}){var de,re,ae,le,ce,ne,te,ie,xe,oe,he,je,ue,Ne,fe,ge,ve,me,be,ye,we,Te,pe,_e,Ie,Ee,Se,Ce,Re,Ae,Me,Ue,ke,Le,Oe,Ge,Be,Pe,Fe,We,$e,Ke,ze,qe,He,Ye,Ve,Qe,Xe,Je,Ze,De,es,ss,ds,rs,as,ls,cs,ns,ts,is,xs,os,hs,js,us,Ns,fs,gs,vs,ms,bs,ys,ws,Ts,ps,_s,Is,Es,Ss,Cs,Rs,As,Ms,Us,ks,Ls,Os,Gs,Bs,Ps,Fs,Ws,$s,Ks,zs,qs,Hs,Ys,Vs,Qs,Xs,Js,Zs,Ds,ed,sd,dd,rd,ad,ld,cd,nd,td,id,xd,od,hd,jd,ud,Nd,fd,gd,vd,md,bd,yd,wd,Td,pd,_d,Id,Ed,Sd,Cd,Rd,Ad,Md,Ud,kd,Ld,Od,Gd,Bd,Pd,Fd,Wd,$d,Kd,zd,qd,Hd,Yd,Vd,Qd,Xd,Jd,Zd,Dd,er,sr,dr,rr,ar,lr,cr,nr,tr,ir,xr;const[g,t]=I.useState(!1),[i,u]=I.useState(0),[N,T]=I.useState(!1),[b,x]=I.useState(!1),c=W({}),v=new URLSearchParams(ea().search).get("complaintId"),s=G({api:`${w.getComplaintDetailsById}/${v}`,key:"ComplaintDetails",options:{enabled:!0}}),l=G({api:`${w.checkWfActions}/${v}`,key:"actionPermission",options:{enabled:!0}}),E=G({api:`${w.complaintApplicationLog}/${v}`,key:"complaintApplicationLog",options:{enabled:!0}}),S=G({api:`${w.getAllCommentsByComplaintId}/${v}`,key:"getAllComments",options:{enabled:!0}}),K=V({defaultValues:{comment:""},resolver:Q(Ka)}),{handleSubmit:zr}=K,qr=async(d,m)=>{var C,R;const y=m.nativeEvent.submitter.name;let f="";y==="comment"&&(f=w.openComment);let p={comment:d.comment,complaintId:(R=(C=s==null?void 0:s.data)==null?void 0:C.data)==null?void 0:R._id};try{const A=await c.mutateAsync({api:f,data:p});A.data.success?(h.success(A.data.message),s==null||s.refetch(),S==null||S.refetch(),l.refetch(),K.reset()):h.error(A.data.message)}catch(A){h.error(O(A))}},Hr=async()=>{kr("Are you sure?","Do you want to move this Grievance to your panel",async()=>{var m,y;let d={complaintId:(y=(m=s==null?void 0:s.data)==null?void 0:m.data)==null?void 0:y._id,comment:""};try{const f=await c.mutateAsync({api:w.moveComplaintToMe,data:d});f.data.success?(t(!0),s==null||s.refetch(),S==null||S.refetch(),l.refetch()):h.error(f.data.message)}catch(f){h.error(O(f))}})},Yr=async d=>{kr("Are you sure?",`Do you want to ${d.target.checked?"Escalate":"De-Escalate"} this complaint`,async()=>{var y,f;let m={complaintId:(f=(y=s==null?void 0:s.data)==null?void 0:y.data)==null?void 0:f._id};try{const p=await c.mutateAsync({api:w.escalateAction,data:m});p.data.success?(t(!0),s.refetch()):h.error(p.data.message)}catch(p){h.error(O(p))}})},Vr=()=>{var d,m,y,f,p,C,R,A,or,hr,jr,ur,Nr,fr,gr,vr,mr,br,yr,wr,Tr,pr,_r,Ir,Er,Sr,Cr,Rr,Ar,Mr;((m=(d=s==null?void 0:s.data)==null?void 0:d.data)==null?void 0:m.moduleId)===da&&(a(Sa),r("Search Property Details")),((f=(y=s==null?void 0:s.data)==null?void 0:y.data)==null?void 0:f.moduleId)===ra&&(a(Ca),r("Search Water Details")),((C=(p=s==null?void 0:s.data)==null?void 0:p.data)==null?void 0:C.moduleId)===aa&&(a(Ra),r("Search Trade Details")),((A=(R=s==null?void 0:s.data)==null?void 0:R.data)==null?void 0:A.moduleId)===la&&(a(Aa),r("Search Pet Registration Details")),((hr=(or=s==null?void 0:s.data)==null?void 0:or.data)==null?void 0:hr.moduleId)===Y&&(a(Ma),r("Search Other Details")),((ur=(jr=s==null?void 0:s.data)==null?void 0:jr.data)==null?void 0:ur.moduleId)===ca&&(a(Ua),r("Search Grievance Details")),((fr=(Nr=s==null?void 0:s.data)==null?void 0:Nr.data)==null?void 0:fr.moduleId)===na&&(a(ka),r("Search SWM Details")),((vr=(gr=s==null?void 0:s.data)==null?void 0:gr.data)==null?void 0:vr.moduleId)===ta&&(a(La),r("Search Water Tanker Details")),((br=(mr=s==null?void 0:s.data)==null?void 0:mr.data)==null?void 0:br.moduleId)===ia&&(a(Oa),r("Search Advertisement Details")),((wr=(yr=s==null?void 0:s.data)==null?void 0:yr.data)==null?void 0:wr.moduleId)===xa&&(a(Ga),r("Search Septic Tank Details")),((pr=(Tr=s==null?void 0:s.data)==null?void 0:Tr.data)==null?void 0:pr.moduleId)===oa&&(a(Ba),r("Search Lodge/Banquet Details")),((Ir=(_r=s==null?void 0:s.data)==null?void 0:_r.data)==null?void 0:Ir.moduleId)===ha&&(a(Pa),r("Search Marriage Details")),((Sr=(Er=s==null?void 0:s.data)==null?void 0:Er.data)==null?void 0:Sr.moduleId)===ja&&(a(Fa),r("Search Public Transport Details")),((Rr=(Cr=s==null?void 0:s.data)==null?void 0:Cr.data)==null?void 0:Rr.moduleId)===ua&&(a(Wa),r("Search Parking Details")),((Mr=(Ar=s==null?void 0:s.data)==null?void 0:Ar.data)==null?void 0:Mr.moduleId)===Na&&(a($a),r("Search Rig Details"))};return I.useEffect(()=>{Vr()},[s==null?void 0:s.data]),I.useEffect(()=>{setTimeout(()=>{t(!1)},1600)},[g]),e.jsxs("main",{className:"grid flex-1 items-start",children:[g&&e.jsx("div",{style:{zIndex:1001},className:"fixed left-0 top-0 z-50 flex h-full w-full items-center justify-center bg-white",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(Xr,{className:"w-24",animationData:Jr,loop:!0}),e.jsx("div",{className:"font-semibold",children:"Grievance Moved successfully."})]})}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-8 lg:col-span-2",children:[e.jsx("div",{className:"",children:e.jsx("div",{className:" bg-background",children:e.jsxs("div",{className:"mx-auto max-w-7xl  rounded-lg p-8 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h1",{className:"mb-6 text-xl font-bold uppercase text-blue-800",children:["Grievance No : ",(re=(de=s==null?void 0:s.data)==null?void 0:de.data)==null?void 0:re.complaintRefNo]}),((ce=(le=(ae=s==null?void 0:s.data)==null?void 0:ae.data)==null?void 0:le.workflow)==null?void 0:ce.workFlowName)&&e.jsxs("h1",{className:"text- Capitalize  mb-6 font-bold",children:[e.jsx("span",{className:"opacity-60",children:"Current Stage : "}),(ie=(te=(ne=s==null?void 0:s.data)==null?void 0:ne.data)==null?void 0:te.workflow)==null?void 0:ie.workFlowName]}),!((he=(oe=(xe=s==null?void 0:s.data)==null?void 0:xe.data)==null?void 0:oe.workflow)!=null&&he.workFlowName)&&e.jsxs("h1",{className:"text- Capitalize  mb-6 font-bold",children:[e.jsx("span",{className:"opacity-60",children:"Current Stage : "}),((ue=(je=s==null?void 0:s.data)==null?void 0:je.data)==null?void 0:ue.currentUser)&&`${(ge=(fe=(Ne=s==null?void 0:s.data)==null?void 0:Ne.data)==null?void 0:fe.currentUser)==null?void 0:ge.fullName} `,((me=(ve=s==null?void 0:s.data)==null?void 0:ve.data)==null?void 0:me.currentWorkflow)&&`(${(we=(ye=(be=s==null?void 0:s.data)==null?void 0:be.data)==null?void 0:ye.currentWorkflow)==null?void 0:we.workFlowName})`,!((pe=(Te=s==null?void 0:s.data)==null?void 0:Te.data)!=null&&pe.currentWorkflow)&&!((Ie=(_e=s==null?void 0:s.data)==null?void 0:_e.data)!=null&&Ie.currentUser)&&((Se=(Ee=s==null?void 0:s.data)==null?void 0:Ee.data)==null?void 0:Se.moduleId)===Y&&"State GRO",!((Re=(Ce=s==null?void 0:s.data)==null?void 0:Ce.data)!=null&&Re.currentWorkflow)&&!((Me=(Ae=s==null?void 0:s.data)==null?void 0:Ae.data)!=null&&Me.currentUser)&&((ke=(Ue=s==null?void 0:s.data)==null?void 0:Ue.data)==null?void 0:ke.moduleId)!==Y&&"ULB GRO"]}),e.jsx("h1",{className:"text-md mb-6  flex items-center font-bold",children:e.jsxs("span",{children:["Status -",((Oe=(Le=s==null?void 0:s.data)==null?void 0:Le.data)==null?void 0:Oe.wf_status)===0&&e.jsx(o,{className:"ml-2 bg-yellow-500",children:"Pending"}),((Be=(Ge=s==null?void 0:s.data)==null?void 0:Ge.data)==null?void 0:Be.wf_status)===1&&e.jsx(o,{className:"ml-2 bg-green-500",children:"Resolved"}),((Fe=(Pe=s==null?void 0:s.data)==null?void 0:Pe.data)==null?void 0:Fe.wf_status)===2&&e.jsx(o,{className:"ml-2 bg-red-500",children:"Rejected"}),(($e=(We=s==null?void 0:s.data)==null?void 0:We.data)==null?void 0:$e.wf_status)===3&&e.jsx(o,{className:"ml-2 bg-yellow-500",children:"Pending(re-opened)"}),((ze=(Ke=s==null?void 0:s.data)==null?void 0:Ke.data)==null?void 0:ze.wf_status)===4&&e.jsx(o,{variant:"destructive",children:"Closed"})]})})]}),e.jsxs("p",{className:"mb-2 text-gray-600",children:["Registered on"," ",P((He=(qe=s==null?void 0:s.data)==null?void 0:qe.data)==null?void 0:He.createdAt).format("DD-MM-YYYY")]}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),e.jsxs("div",{className:"mt-4  grid grid-cols-1 space-y-4   md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Full Name : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Ve=(Ye=s==null?void 0:s.data)==null?void 0:Ye.data)==null?void 0:Ve.citizenName)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Mobile No : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Xe=(Qe=s==null?void 0:s.data)==null?void 0:Qe.data)==null?void 0:Xe.mobileNo)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Email : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((es=(De=(Ze=(Je=s==null?void 0:s.data)==null?void 0:Je.data)==null?void 0:Ze.email)==null?void 0:De.replace("@","[at]"))==null?void 0:es.replace(".","[dot]"))||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"ULB : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(rs=(ds=(ss=s==null?void 0:s.data)==null?void 0:ss.data)==null?void 0:ds.ulb)==null?void 0:rs.ulbName})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((cs=(ls=(as=s==null?void 0:s.data)==null?void 0:as.data)==null?void 0:ls.problemType)==null?void 0:cs.problem)||"N/A"})," "]})]}),(((ts=(ns=s==null?void 0:s.data)==null?void 0:ns.data)==null?void 0:ts.holdingNo)||((xs=(is=s==null?void 0:s.data)==null?void 0:is.data)==null?void 0:xs.safNo)||((hs=(os=s==null?void 0:s.data)==null?void 0:os.data)==null?void 0:hs.consumerNo))&&e.jsxs(e.Fragment,{children:[((us=(js=s==null?void 0:s.data)==null?void 0:js.data)==null?void 0:us.holdingNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Holding No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.holdingNo})})]}),((fs=(Ns=s==null?void 0:s.data)==null?void 0:Ns.data)==null?void 0:fs.safNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"SAF No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.safNo})})]}),((vs=(gs=s==null?void 0:s.data)==null?void 0:gs.data)==null?void 0:vs.consumerNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Consumer No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.consumerNo})})]})]}),((bs=(ms=s==null?void 0:s.data)==null?void 0:ms.data)==null?void 0:bs.fixedNo)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsxs("div",{className:"font-semibold",children:[(ws=(ys=s==null?void 0:s.data)==null?void 0:ys.data)==null?void 0:ws.fixedNoLabel," :"," "]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ps=(Ts=s==null?void 0:s.data)==null?void 0:Ts.data)==null?void 0:ps.fixedNo})," "]})]}),((Is=(_s=s==null?void 0:s.data)==null?void 0:_s.data)==null?void 0:Is.tempNo)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsxs("div",{className:"font-semibold",children:[(Ss=(Es=s==null?void 0:s.data)==null?void 0:Es.data)==null?void 0:Ss.tempNoLabel," :"," "]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Rs=(Cs=s==null?void 0:s.data)==null?void 0:Cs.data)==null?void 0:Rs.tempNo})," "]})]}),(((Ms=(As=s==null?void 0:s.data)==null?void 0:As.data)==null?void 0:Ms.wf_status)===0||((ks=(Us=s==null?void 0:s.data)==null?void 0:Us.data)==null?void 0:ks.wf_status)===3)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Pending From : "}),e.jsxs("div",{children:[e.jsxs("p",{className:"opacity-90",children:[P().diff(P((Os=(Ls=s==null?void 0:s.data)==null?void 0:Ls.data)==null?void 0:Os.createdAt),"days")," ","days"]})," "]})]}),((Bs=(Gs=s==null?void 0:s.data)==null?void 0:Gs.data)==null?void 0:Bs.priorityType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Priority Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Ws=(Fs=(Ps=s==null?void 0:s.data)==null?void 0:Ps.data)==null?void 0:Fs.priorityType)==null?void 0:Ws.priorityName})," "]})]}),((Ks=($s=s==null?void 0:s.data)==null?void 0:$s.data)==null?void 0:Ks.targetType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Target Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Hs=(qs=(zs=s==null?void 0:s.data)==null?void 0:zs.data)==null?void 0:qs.targetType)==null?void 0:Hs.targetType)||"N/A"})," "]})]}),((Vs=(Ys=s==null?void 0:s.data)==null?void 0:Ys.data)==null?void 0:Vs.complaintType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Js=(Xs=(Qs=s==null?void 0:s.data)==null?void 0:Qs.data)==null?void 0:Xs.complaintType)==null?void 0:Js.complaintTypeName})," "]})]}),e.jsx("div",{className:"col-span-3 my-20 border-b border-[#99B37C]"}),e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Description : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Ds=(Zs=s==null?void 0:s.data)==null?void 0:Zs.data)==null?void 0:Ds.complaintDescription})," "]})]}),((sd=(ed=s==null?void 0:s.data)==null?void 0:ed.data)==null?void 0:sd.wf_currentReopenComment)&&e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Remark :"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.wf_currentReopenComment})})]}),((rd=(dd=s==null?void 0:s.data)==null?void 0:dd.data)==null?void 0:rd.customAddress)&&e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Address : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ld=(ad=s==null?void 0:s.data)==null?void 0:ad.data)==null?void 0:ld.customAddress})," "]})]}),e.jsxs("div",{className:"col-span-3 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Document:"}),e.jsxs(z,{children:[e.jsx(q,{}),e.jsx(H,{className:"sm:max-w-[500px]",children:e.jsx("div",{className:"py-4",children:(nd=(cd=s==null?void 0:s.data)==null?void 0:cd.data)!=null&&nd.imgUrl&&((id=(td=s==null?void 0:s.data)==null?void 0:td.data)!=null&&id.imgUrl.includes(".pdf"))?e.jsx("iframe",{src:(od=(xd=s==null?void 0:s.data)==null?void 0:xd.data)==null?void 0:od.imgUrl,width:"100%",height:"400px",title:"Document Preview"}):e.jsx(B,{src:(jd=(hd=s==null?void 0:s.data)==null?void 0:hd.data)==null?void 0:jd.imgUrl,className:"w-80"})})}),e.jsx(M,{asChild:!0,children:e.jsx("div",{className:"cursor-pointer",children:(Nd=(ud=s==null?void 0:s.data)==null?void 0:ud.data)!=null&&Nd.imgUrl&&((gd=(fd=s==null?void 0:s.data)==null?void 0:fd.data)!=null&&gd.imgUrl.includes(".pdf"))?e.jsxs("div",{className:"flex h-20  w-20 items-center justify-center",children:[" ",e.jsx(fa,{className:"h-20 w-20 "})]}):e.jsx(B,{src:(md=(vd=s==null?void 0:s.data)==null?void 0:vd.data)==null?void 0:md.imgUrl,className:"w-40"})})})]})]})]}),e.jsxs("section",{className:"mt-8",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-blue-800",children:["Grievance Flow History"," ",e.jsxs("span",{onClick:()=>T(!N),className:"cursor-pointer",children:[!N&&e.jsxs("span",{className:"rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-400 hover:bg-gray-200 ",children:["Show ",e.jsx(ma,{size:15,className:"inline"})]}),N&&e.jsxs("span",{className:"rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-400 hover:bg-gray-200 ",children:["Hide ",e.jsx(ga,{size:15,className:"inline"})]})]})," "]}),e.jsx("h1",{className:"text-md mb-6  flex items-center font-bold",children:e.jsxs("span",{children:["Reminder -",e.jsxs(o,{className:"ml-2 w-20 rounded-lg bg-blue-600 text-lg font-semibold text-white shadow-md transition duration-300 hover:bg-blue-700",children:[(yd=(bd=s==null?void 0:s.data)==null?void 0:bd.data)==null?void 0:yd.reminder,"Times"]})]})}),((Td=(wd=l==null?void 0:l.data)==null?void 0:wd.permission)==null?void 0:Td.canMoveComplaint)&&e.jsx(_,{onClick:Hr,children:"Move Grievance to my Panel"}),((_d=(pd=l==null?void 0:l.data)==null?void 0:pd.permission)==null?void 0:_d.canUpdate)&&e.jsx(Ur,{to:`/grievance/dashboard/management-complaint-form?complaintId=${(Ed=(Id=s==null?void 0:s.data)==null?void 0:Id.data)==null?void 0:Ed._id}`,children:e.jsx(_,{children:"Update Details"})})]}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),N&&e.jsx("div",{className:"mt-4 flex flex-col space-y-4",children:(Cd=(Sd=E==null?void 0:E.data)==null?void 0:Sd.data)==null?void 0:Cd.map((d,m)=>{var y,f,p,C,R;return e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{children:m+1}),e.jsxs("div",{children:[(d==null?void 0:d.actionStatus)===0&&e.jsx(o,{className:"text-dark bg-gray-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===1&&e.jsx(o,{className:"bg-green-400 text-white",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===2&&e.jsx(o,{className:"bg-red-400 text-white",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===3&&e.jsx(o,{children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===4&&e.jsx(o,{className:"text-dark bg-amber-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===5&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===6&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===7&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===8&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===9&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===10&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===11&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===12&&e.jsx(o,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),e.jsx("div",{className:"mt-1 text-xs font-semibold text-gray-600",children:P((f=(y=s==null?void 0:s.data)==null?void 0:y.data)==null?void 0:f.createdAt).format("DD-MM-YYYY hh:mm a")})]}),e.jsx(va,{}),e.jsxs("div",{children:[e.jsxs(z,{children:[e.jsx(q,{}),e.jsx(H,{className:"sm:max-w-[500px]",children:e.jsx("div",{className:"py-4",children:e.jsx(B,{src:(p=d==null?void 0:d.actionBy)==null?void 0:p.fullImgUrl,className:"w-60"})})}),e.jsx(M,{asChild:!0,children:e.jsx("div",{className:"h-10 w-10 cursor-pointer overflow-hidden rounded-full border",children:e.jsx(B,{src:((C=d==null?void 0:d.actionBy)==null?void 0:C.fullImgUrl)||Pr,className:"w-10 cursor-pointer hover:scale-105"})})})]}),e.jsxs("div",{className:"text-xs text-gray-700",children:["Action by"," ",e.jsx("span",{className:"text-md font-semibold text-black",children:(d==null?void 0:d.actionByUserId)===null?"Direct Citizen":(R=d==null?void 0:d.actionBy)==null?void 0:R.fullName})]})]})]},`flow${m}`)})})]})]})})}),e.jsx(Zr,{"x-chunk":"dashboard-05-chunk-3",children:e.jsxs(Dr,{className:"grid grid-cols-3 py-10",children:[e.jsx("div",{className:"col-span-2 pr-10",children:e.jsxs(X,{methods:K,onSubmit:zr(qr),children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-4",children:e.jsx("div",{className:"col-span-4",children:e.jsx(Z,{className:"w-full rounded-lg border bg-background p-4",label:"Comment",name:"comment",placeholder:"Enter comment"})})}),e.jsxs(z,{open:b,children:[e.jsx(q,{}),e.jsx(H,{className:"sm:max-w-[500px]",children:e.jsxs("div",{className:"py-4",children:[i===1&&e.jsx(Ta,{setisDialogOpen:x,actionPermissions:l,complaintData:s}),i===2&&e.jsx(_a,{setisDialogOpen:x,actionPermissions:l,complaintData:s}),i===3&&e.jsx(Ia,{setisDialogOpen:x,complaintData:s,actionPermissions:l}),i===4&&e.jsx(Ea,{setisDialogOpen:x,complaintData:s})]})}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between",children:[e.jsxs("div",{className:"mr-10",children:[((Ad=(Rd=s==null?void 0:s.data)==null?void 0:Rd.data)==null?void 0:Ad.wf_status)===1&&e.jsxs(L,{className:"mb-4 flex items-center",children:[e.jsx(Or,{className:"mr-2 inline text-green-500"}),"Grievance Resolved"]}),((Ud=(Md=s==null?void 0:s.data)==null?void 0:Md.data)==null?void 0:Ud.wf_status)===2&&e.jsxs(L,{className:"mb-4 flex items-center",children:[e.jsx(ba,{className:"mr-2 inline text-red-500"}),"Grievance Rejected"]}),(((Ld=(kd=s==null?void 0:s.data)==null?void 0:kd.data)==null?void 0:Ld.wf_status)===0||((Gd=(Od=s==null?void 0:s.data)==null?void 0:Od.data)==null?void 0:Gd.wf_status)===3)&&e.jsxs("div",{className:"mb-4 flex items-center space-x-2",children:[e.jsx(Gr,{checked:(Pd=(Bd=s==null?void 0:s.data)==null?void 0:Bd.data)==null?void 0:Pd.isEscalated,onChange:d=>Yr(d),className:"h-5 w-5 cursor-pointer",type:"checkbox",name:"isTransactionIssue",placeholder:""}),e.jsx(J,{className:"text-amber-700 opacity-80",children:(Wd=(Fd=s==null?void 0:s.data)==null?void 0:Fd.data)!=null&&Wd.isEscalated?"De-Escalate":"Escalate"})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(D,{variant:"secondary",name:"comment",className:"mr-4",type:"submit",disabled:c.isPending,isLoading:c.isPending,children:"Direct Comment"})}),(((Kd=($d=s==null?void 0:s.data)==null?void 0:$d.data)==null?void 0:Kd.wf_status)===0||((qd=(zd=s==null?void 0:s.data)==null?void 0:zd.data)==null?void 0:qd.wf_status)===3)&&e.jsxs(e.Fragment,{children:[((Yd=(Hd=l==null?void 0:l.data)==null?void 0:Hd.permission)==null?void 0:Yd.isNeededMoreDocuments)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{x(!0),u(1)},asChild:!0,children:e.jsx(_,{variant:"secondary",name:"bts",className:"mr-4",disabled:c.isPending,children:"Need More Documents"})})}),((Qd=(Vd=l==null?void 0:l.data)==null?void 0:Vd.permission)==null?void 0:Qd.canResolve)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{x(!0),u(1)},asChild:!0,children:e.jsx(_,{variant:"secondary",name:"bts",className:"mr-4",disabled:c.isPending,children:"Resolve"})})}),((Jd=(Xd=l==null?void 0:l.data)==null?void 0:Xd.permission)==null?void 0:Jd.canReject)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{x(!0),u(2)},asChild:!0,children:e.jsx(_,{variant:"secondary",name:"reject",className:"mr-4",disabled:c.isPending,children:"Reject"})})}),((Dd=(Zd=l==null?void 0:l.data)==null?void 0:Zd.permission)==null?void 0:Dd.canTransferToMember)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{x(!0),u(3)},asChild:!0,children:e.jsx(_,{name:"approve",disabled:c.isPending,className:"mr-4",children:"Transfer to Current Member"})})}),((sr=(er=l==null?void 0:l.data)==null?void 0:er.permission)==null?void 0:sr.canSendToUlb)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{x(!0),u(4)},asChild:!0,children:e.jsx(_,{name:"approve",disabled:c.isPending,type:"button",className:"mr-4",children:"Transfer to Ulb"})})}),((rr=(dr=l==null?void 0:l.data)==null?void 0:dr.permission)==null?void 0:rr.canTransferToWorkflow)&&e.jsx("div",{className:"col-span-4",children:e.jsx(Ur,{to:`/grievance/dashboard/transfer-complaint?parentId=null&levelSerial=1&complaintId=${(lr=(ar=s==null?void 0:s.data)==null?void 0:ar.data)==null?void 0:lr._id}&complaintRefNo=${(nr=(cr=s==null?void 0:s.data)==null?void 0:cr.data)==null?void 0:nr.complaintRefNo}`,children:e.jsx(_,{name:"approve",disabled:c.isPending,type:"button",children:"Transfer to Workflow"})})})]})]})]})]})]})}),e.jsxs("div",{className:"col-span-1 h-80 overflow-y-scroll md:px-4",children:[e.jsx(L,{className:"mb-2",children:"Comments"}),(xr=(ir=(tr=S==null?void 0:S.data)==null?void 0:tr.data)==null?void 0:ir.data)==null?void 0:xr.map((d,m)=>e.jsx(ya,{commentData:d},`comment${m}`))]})]})})]})]})}function Da(){const[a,r]=I.useState(""),[g,t]=I.useState("");return e.jsx(sa,{title:"Workflow Details",subTitle:"",searchLink:a,searchLabel:g,children:e.jsx("div",{className:"",children:e.jsx(za,{setsearchLink:r,setsearchLabel:t})})})}export{Da as default};
