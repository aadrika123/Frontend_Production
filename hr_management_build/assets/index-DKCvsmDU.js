import{h as N,e as A,r as o,j as e,_ as p,B as L}from"./index-CMq8gJQc.js";import{P as Y}from"./index-DeOesTU9.js";import{D as U,S as V,a as z,C as G,b as J,c as K,d as Q,e as W,T as X,f as Z,g as I,h,i as ee,j as x,k as ae,q as se,L as re,P as ne}from"./index-BSOWoXPQ.js";import{a as H,h as R,b as ce,o as te,F as le,R as T,B as de,d as oe,e as w,g as ie}from"./useCustomQuery-B3dC_oGG.js";const ue=oe().shape({ddo_code:w().required().label("DDO Code"),ddo_name:w().required().label("DDO Name"),office_name:w().required().label("Office Name"),treasury_name:w().required().label("Treasury Name")});function he({open:O,setOpen:f,title:M,id:g,edit:i,setEdit:j,refetch:P}){var m;const b=H({}),{data:r,isFetching:$}=R({api:`${(m=N)==null?void 0:m.getDDoMstrById}/${A(String(g))}`,key:"getDDoMstrById",options:{enabled:i}}),l=ce({defaultValues:{ddo_code:"",ddo_name:"",office_name:"",treasury_name:""},resolver:te(ue)}),v=async c=>{var d,s,u,E,y,S,D,_;try{if(i&&c){const n=await b.mutateAsync({api:`${(d=N)==null?void 0:d.updateDDoMstrById}`,data:{id:A(String(g)),...c}});(s=n.data)!=null&&s.success?p.success((u=n==null?void 0:n.data)==null?void 0:u.message):p.error(((E=n.data)==null?void 0:E.message)||"Employee Type not updated successfully")}else{const n=await b.mutateAsync({api:(y=N)==null?void 0:y.createDDoMstr,data:c});(S=n.data)!=null&&S.success?p.success((D=n==null?void 0:n.data)==null?void 0:D.message):p.error(((_=n.data)==null?void 0:_.message)||"Employee Type not created successfully"),l.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})}f(!1),j(!1),P()}catch(n){console.log(n)}};return o.useEffect(()=>{var c,d,s,u;i&&r?l.reset({ddo_code:(c=r==null?void 0:r.data)==null?void 0:c.ddo_code,ddo_name:(d=r==null?void 0:r.data)==null?void 0:d.ddo_name,office_name:(s=r==null?void 0:r.data)==null?void 0:s.office_name,treasury_name:(u=r==null?void 0:r.data)==null?void 0:u.treasury_name}):l.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})},[i,r]),e.jsx(U,{open:O,setOpen:f,title:M,setEdit:j,edit:i,isLoading:$,children:e.jsx(le,{methods:l,onSubmit:l.handleSubmit(v),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(T,{name:"ddo_code",placeholder:"Enter DDO Code",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(T,{name:"ddo_name",placeholder:"Enter DDO Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(T,{name:"office_name",placeholder:"Enter Office Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(T,{name:"treasury_name",placeholder:"Enter Treasury Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(V,{}),e.jsx("div",{children:e.jsx(de,{isLoading:l.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function xe(){var y,S,D,_,n,B;const O=H({}),[f,M]=o.useState(1),[g,i]=o.useState(10),[j,P]=o.useState(""),[b,r]=o.useState(!1),[$,l]=o.useState(""),[v,m]=o.useState(!1),[c,d]=o.useState(null),s=R({api:`${N.getAllDDoMstr}?page=${f}&limit=${g}&q=${j}`,key:"getAllDDoList",value:[f,g],options:{enabled:!0}}),u=a=>{m(!0),r(!0),l(a)},E=async a=>{var C,F,k,q;d(a);try{const t=await O.mutateAsync({api:`${(C=N)==null?void 0:C.toggleDDoMstr}`,data:{id:A(String(a))}});(F=t==null?void 0:t.data)!=null&&F.success?(s.refetch(),p.success((k=t==null?void 0:t.data)==null?void 0:k.message)):p.error((q=t.data)==null?void 0:q.message)}catch(t){p.error(ie(t))}finally{d(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(he,{open:b,setOpen:r,title:v?"Edit Employee Type":"Add Employee Type",id:$,edit:v,setEdit:m,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(z,{search:j,setSearch:P,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(L,{className:"flex items-center gap-2",onClick:()=>r(!0),children:"Add New"})})]}),e.jsxs(G,{children:[e.jsx(J,{className:"px-7",children:e.jsxs(K,{children:["Employee Type List (",(S=(y=s==null?void 0:s.data)==null?void 0:y.pagination)==null?void 0:S.total,")"]})}),e.jsx(Q,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(W,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(I,{children:[e.jsx(h,{className:"",children:"#"}),e.jsx(h,{className:"",children:"DDO Code"}),e.jsx(h,{className:"",children:"DDO Name"}),e.jsx(h,{className:"",children:"Office Name"}),e.jsx(h,{className:"",children:"Created at"}),e.jsx(h,{className:"",children:"Status"}),e.jsx(h,{children:"Action"})]})}),e.jsx(ee,{children:(_=(D=s==null?void 0:s.data)==null?void 0:D.data)==null?void 0:_.map((a,C)=>e.jsxs(I,{children:[e.jsx(x,{children:C+1}),e.jsx(x,{children:a==null?void 0:a.ddo_code}),e.jsx(x,{children:a==null?void 0:a.ddo_name}),e.jsx(x,{children:a==null?void 0:a.office_name}),e.jsx(x,{children:ae(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{checked:(a==null?void 0:a.status)==1,onChange:()=>E(String(a==null?void 0:a.id)),disabled:c===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),c===String(a==null?void 0:a.id)&&e.jsx(re,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(x,{children:e.jsx(L,{className:"bg-primary",onClick:()=>u(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(V,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ne,{page:f,limit:g,totalPages:(B=(n=s==null?void 0:s.data)==null?void 0:n.pagination)==null?void 0:B.totalPages,setPage:M,setLimit:i})})]})})]})]})]})}function me(){return e.jsx(Y,{title:"DDO List",subTitle:"Manage all the DDo List",children:e.jsx("div",{className:"py-12",children:e.jsx(xe,{})})})}export{me as default};
