import{h as N,e as A,r as i,j as e,_ as o,B as q}from"./index-CMq8gJQc.js";import{P as U}from"./index-DeOesTU9.js";import{D as V,S as H,a as z,C as G,b as J,c as K,d as O,e as Q,T as W,f as X,g as I,h as S,i as Z,j as b,k as L,q as ee,L as ae,P as se}from"./index-BSOWoXPQ.js";import{a as R,h as Y,b as ne,o as re,F as te,R as le,B as ce,d as ie,e as de,g as oe}from"./useCustomQuery-B3dC_oGG.js";const ge=ie().shape({designation_name:de().required("Designation is required")});function he({open:E,setOpen:g,title:P,id:h,edit:d,setEdit:u,refetch:$}){var x;const v=R({}),{data:r,isFetching:_}=Y({api:`${(x=N)==null?void 0:x.getDesignationMstrById}/${A(String(h))}`,key:"getDesignationMstrById",options:{enabled:d}}),c=ne({defaultValues:{designation_name:""},resolver:re(ge)}),w=async t=>{var p,s,C,M,j,f,m,y;try{if(d&&t){const n=await v.mutateAsync({api:`${(p=N)==null?void 0:p.updateDesignationMstrById}`,data:{id:A(String(h)),...t}});(s=n.data)!=null&&s.success?o.success((C=n==null?void 0:n.data)==null?void 0:C.message):o.error(((M=n.data)==null?void 0:M.message)||"Designation not updated successfully")}else{const n=await v.mutateAsync({api:(j=N)==null?void 0:j.createDesignationMstr,data:t});(f=n.data)!=null&&f.success?o.success((m=n==null?void 0:n.data)==null?void 0:m.message):o.error(((y=n.data)==null?void 0:y.message)||"Designation not created successfully"),c.reset({designation_name:""})}g(!1),u(!1),$()}catch(n){console.log(n)}};return i.useEffect(()=>{var t;d&&r?c.reset({designation_name:(t=r==null?void 0:r.data)==null?void 0:t.designation_name}):c.reset({designation_name:""})},[d,r]),e.jsx(V,{open:E,setOpen:g,title:P,setEdit:u,edit:d,isLoading:_,children:e.jsx(te,{methods:c,onSubmit:c.handleSubmit(w),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(le,{name:"designation_name",placeholder:"Enter Designation",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(H,{}),e.jsx("div",{children:e.jsx(ce,{isLoading:c.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function ue(){var j,f,m,y,n,B;const E=R({}),[g,P]=i.useState(1),[h,d]=i.useState(10),[u,$]=i.useState(""),[v,r]=i.useState(!1),[_,c]=i.useState(""),[w,x]=i.useState(!1),[t,p]=i.useState(null),s=Y({api:`${N.getAllDesignationMstr}?page=${g}&limit=${h}&q=${u}`,key:"getAllDesignationMstr",value:[g,h],options:{enabled:!0}}),C=a=>{x(!0),r(!0),c(a)},M=async a=>{var T,F,k,D;p(a);try{const l=await E.mutateAsync({api:`${(T=N)==null?void 0:T.toggleDesignationMstr}`,data:{id:A(String(a))}});(F=l==null?void 0:l.data)!=null&&F.success?(s==null||s.refetch(),o.success((k=l==null?void 0:l.data)==null?void 0:k.message)):o.error((D=l.data)==null?void 0:D.message)}catch(l){o.error(oe(l))}finally{p(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(he,{open:v,setOpen:r,title:w?"Edit Employee Type":"Add Employee Type",id:_,edit:w,setEdit:x,refetch:s==null?void 0:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(z,{search:u,setSearch:$,refetch:s==null?void 0:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(q,{className:"flex items-center gap-2",onClick:()=>r(!0),children:"Add New"})})]}),e.jsxs(G,{children:[e.jsx(J,{className:"px-7",children:e.jsxs(K,{children:["Department List (",(f=(j=s==null?void 0:s.data)==null?void 0:j.pagination)==null?void 0:f.total,")"]})}),e.jsx(O,{children:s!=null&&s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Q,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(I,{children:[e.jsx(S,{className:"",children:"#"}),e.jsx(S,{className:"",children:"Designation"}),e.jsx(S,{className:"",children:"Created at"}),e.jsx(S,{className:"",children:"Status"}),e.jsx(S,{children:"Action"})]})}),e.jsx(Z,{children:(y=(m=s==null?void 0:s.data)==null?void 0:m.data)==null?void 0:y.map((a,T)=>e.jsxs(I,{children:[e.jsx(b,{children:T+1}),e.jsx(b,{children:a==null?void 0:a.designation_name}),e.jsx(b,{children:L(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ee,{checked:(a==null?void 0:a.status)==1,onChange:()=>M(String(a==null?void 0:a.id)),disabled:t===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),t===String(a==null?void 0:a.id)&&e.jsx(ae,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(b,{children:e.jsx(q,{className:"bg-primary",onClick:()=>C(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(H,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(se,{page:g,limit:h,totalPages:(B=(n=s==null?void 0:s.data)==null?void 0:n.pagination)==null?void 0:B.totalPages,setPage:P,setLimit:d})})]})})]})]})]})}function me(){return e.jsx(U,{title:"Designation Type List",subTitle:"Manage all the Designation here",children:e.jsx("div",{className:"py-12",children:e.jsx(ue,{})})})}export{me as default};
