import{M,r as b,l as R,h as E,e as z,j as e}from"./index-CzH94V9M.js";import{b as B,P as F}from"./index-C8L4Yc_u.js";import{b as q}from"./useCustomQuery-Dhej8C9V.js";import{P as G}from"./pen-DPcMQBMB.js";import{T as H}from"./trash-2-CC_MdCV2.js";const J=()=>{var y,p,j,f,N,u,v,w,k,S,D,_,A,O;const[W]=M(),L=W.get("department_id"),[i,g]=b.useState(null),o=B(),[a,T]=b.useState(L),h=R(),r=q({api:`${(y=E)==null?void 0:y.getAllWeekOffsByDepartment}?department_id=${z(String(a))}`,value:[a],options:{enabled:!!a}}),c={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"},x=b.useMemo(()=>{var s;return(s=r==null?void 0:r.data)!=null&&s.data?r.data.data.reduce((t,d)=>(t[d.day_off]||(t[d.day_off]=[]),t[d.day_off].push(d),t),{}):{}},[(p=r==null?void 0:r.data)==null?void 0:p.data]),n=b.useMemo(()=>x?Object.keys(x).map(Number).sort((s,t)=>s-t):[],[x]),l=i?x[i]:(j=r==null?void 0:r.data)==null?void 0:j.data,$=s=>{h(`/hrms/dashboard/edit-weekly-off/${s.id}`)},C=s=>{window.confirm("Are you sure you want to delete this record?")&&alert(`Record with ID ${s} deleted (not really, this is a placeholder).`)};return e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-purple-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Select Department"})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("select",{value:a||"",onChange:s=>T(s.target.value),className:"w-full max-w-xs border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Department"}),(f=o==null?void 0:o.data)==null?void 0:f.data.map(s=>e.jsx("option",{value:String(s.id),children:s.department_name},s.id))]}),a&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected:"," ",e.jsx("span",{className:"font-semibold",children:((u=(N=o==null?void 0:o.data)==null?void 0:N.data.find(s=>String(s.id)===a))==null?void 0:u.department_name)||"N/A"})]})]}),e.jsx("div",{className:"p-4",children:e.jsx("button",{onClick:()=>h("/hrms/dashboard/create-weekly-off"),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:"Add Weekly Off"})})]})]}),(r==null?void 0:r.isLoading)&&e.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:e.jsx("div",{className:"text-gray-600",children:"Loading day off records..."})}),!a&&!(r!=null&&r.isLoading)&&e.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:e.jsx("div",{className:"text-gray-600",children:"Please select a department to view day off schedules"})}),a&&!(r!=null&&r.isLoading)&&((w=(v=r==null?void 0:r.data)==null?void 0:v.data)==null?void 0:w.length)===0&&e.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:e.jsx("div",{className:"text-gray-600",children:"No day off records found for this department"})}),a&&!(r!=null&&r.isLoading)&&((S=(k=r==null?void 0:r.data)==null?void 0:k.data)==null?void 0:S.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-blue-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Filter by Day"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>g(null),className:`border px-4 py-2 font-medium ${i===null?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:["All Days (",(_=(D=r==null?void 0:r.data)==null?void 0:D.data)==null?void 0:_.length,")"]}),n.map(s=>{var t;return e.jsxs("button",{onClick:()=>g(s),className:`border px-4 py-2 font-medium ${i===s?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:[c[s]," (",(t=x[s])==null?void 0:t.length,")"]},s)})]})})]}),e.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-green-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Summary"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"border border-gray-300 bg-blue-50 p-3",children:[e.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Total Records"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:l==null?void 0:l.length})]}),e.jsxs("div",{className:"border border-gray-300 bg-green-50 p-3",children:[e.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Days Scheduled"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:n==null?void 0:n.length})]}),e.jsxs("div",{className:"border border-gray-300 bg-yellow-50 p-3",children:[e.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Department ID"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:((O=(A=r==null?void 0:r.data)==null?void 0:A.data[0])==null?void 0:O.department_name)||"N/A"})]})]})})]}),e.jsxs("div",{className:"border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-blue-900 px-4 py-3 text-white",children:e.jsx("h2",{className:"text-lg font-semibold",children:i?`${c[i]} Schedule`:"All Day Off Records"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-400 bg-gray-200",children:[e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"S.No"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Day Off"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Week Number"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Department Name"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Created Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Action"})]})}),e.jsx("tbody",{children:l==null?void 0:l.map((s,t)=>e.jsxs("tr",{className:`border-b border-gray-300 ${t%2===0?"bg-white":"bg-gray-50"} hover:bg-blue-50`,children:[e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:t+1}),e.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:c[s.day_off]}),e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",s.day_off,")"]})]}),e.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:["Week ",s.week_number]}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:s==null?void 0:s.department_name}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm",children:e.jsx("span",{className:"inline-block border border-green-300 bg-green-100 px-2 py-1 text-xs font-semibold text-green-800",children:s.status===1?"Active":"Inactive"})}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:new Date(s.created_at).toLocaleDateString("en-IN")}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(s),className:"rounded p-1.5 text-blue-600 hover:bg-blue-100",title:"Edit",children:e.jsx(G,{size:18})}),e.jsx("button",{onClick:()=>C(s.id),className:"rounded p-1.5 text-red-600 hover:bg-red-100",title:"Delete",children:e.jsx(H,{size:18})})]})})]},s.id))})]})}),e.jsx("div",{className:"border-t border-gray-300 bg-gray-100 px-4 py-3",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Total Records:"," ",e.jsx("span",{className:"font-semibold",children:l==null?void 0:l.length})]})})]}),!i&&e.jsxs("div",{className:"mt-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-orange-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Day-wise Distribution"})}),e.jsx("div",{className:"p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-300 bg-gray-200",children:[e.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Day"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Total Schedules"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Weeks Covered"})]})}),e.jsx("tbody",{children:n.map((s,t)=>{const d=x[s],P=d.map(m=>m.week_number).sort((m,I)=>m-I);return e.jsxs("tr",{className:`border-b border-gray-300 ${t%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm font-medium text-gray-800",children:c[s]}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:d==null?void 0:d.length}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:P.join(", ")})]},s)})})]})})]})]})]})})},K=J;function Z(){return e.jsx(F,{title:"Weekly Off List",subTitle:"Manage all the Weekly Off schedules here",children:e.jsx("div",{className:"py-2",children:e.jsx(K,{})})})}export{Z as default};
