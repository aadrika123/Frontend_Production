import{i as O,r as n,h as E,j as e,e as le}from"./index-CzH94V9M.js";import{b as ne,P as ie}from"./index-C8L4Yc_u.js";import{u as oe,b as de}from"./useCustomQuery-Dhej8C9V.js";import{C as Y,S as ce}from"./search-BzkXz1M5.js";import{C}from"./calendar-C6DUOQUF.js";import{B}from"./briefcase-DNo2RxrE.js";import{U as me}from"./users-DaVtBTXR.js";import{C as xe}from"./chevron-left-SUyCln0V.js";import{C as pe}from"./chevron-right-ND9HNMoq.js";import{C as ge}from"./clock-jNjEhJVW.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=O("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=O("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),he=()=>{var M,P,I,T,$,R;const c=new Date,[g,U]=n.useState(c.toLocaleString("en-IN",{month:"long"})),[u,J]=n.useState(c.getFullYear()),[l,_]=n.useState(1),[i,z]=n.useState(20),[m,X]=n.useState(c.toISOString().split("T")[0]),q=oe({}),[h,G]=n.useState(""),[b,K]=n.useState(""),[f,Q]=n.useState("all"),[fe,A]=n.useState({present:0,absent:0,halfDay:0,leave:0,total:0}),[x,L]=n.useState(null),v=ne(),V=()=>{const t=new URLSearchParams;return g&&t.append("month",g),u&&t.append("year",u.toString()),m&&t.append("date",m),h&&t.append("department_id",le(String(h))),b&&t.append("search",b),f!=="all"&&t.append("status",f.toString()),t.append("page",l.toString()),t.append("limit",i.toString()),t.toString()},s=de({api:`${(M=E)==null?void 0:M.getAllAttendance}?${V()}`,value:[l,i,g,u,m,h,b,f],options:{enabled:!0}});n.useEffect(()=>{W()},[s==null?void 0:s.data]);const W=()=>{var r;if(!((r=s==null?void 0:s.data)!=null&&r.data)){A({present:0,absent:0,halfDay:0,leave:0,total:0});return}const t=s.data.data.reduce((a,d)=>{switch(d.attendance_status){case 1:a.present++;break;case 0:a.absent++;break;case 2:a.halfDay++;break;case 3:a.leave++;break}return a},{present:0,absent:0,halfDay:0,leave:0,total:s.data.data.length});A(t)},y=async(t,r)=>{var a,d,N,D;try{const p=await q.mutateAsync({api:(a=E)==null?void 0:a.createAttendance,data:{emp_id:t,date:m||c.toISOString().split("T")[0],attendance_status:r}});(d=p.data)!=null&&d.success?(w("success",((N=p.data)==null?void 0:N.message)||"Status updated successfully"),s.refetch()):w("error",((D=p.data)==null?void 0:D.message)||"Failed to update status")}catch(p){console.log(p),w("error","An error occurred while updating status")}},w=(t,r)=>{L({type:t,text:r}),setTimeout(()=>L(null),3e3)},Z=t=>{const a={1:{label:"Present",color:"bg-emerald-500",icon:H},0:{label:"Absent",color:"bg-red-500",icon:Y},2:{label:"Half Day",color:"bg-amber-500",icon:ge},3:{label:"Leave",color:"bg-blue-500",icon:B}}[t];return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`${a==null?void 0:a.color} h-2 w-2 rounded-full`}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a==null?void 0:a.label})]})},j=({status:t,currentStatus:r,onClick:a,label:d,color:N})=>e.jsx("button",{onClick:a,className:`rounded-lg px-3 py-1.5 text-xs font-medium transition-all duration-200 ${r===t?`${N} text-white shadow-sm`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:d}),ee=["January","February","March","April","May","June","July","August","September","October","November","December"],te=Array.from({length:10},(t,r)=>c.getFullYear()-r),F=(s==null?void 0:s.isLoading)||(s==null?void 0:s.isFetching),S=((I=(P=s==null?void 0:s.data)==null?void 0:P.pagination)==null?void 0:I.total)||0,o=Math.ceil(S/i),se=(l-1)*i+1,ae=Math.min(l*i,S),k=t=>{_(t)},re=t=>{z(t),_(1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[x&&e.jsxs("div",{className:`mb-6 flex items-center gap-3 rounded-xl p-4 ${x.type==="success"?"border border-emerald-200 bg-emerald-50":"border border-red-200 bg-red-50"} duration-300 animate-in fade-in slide-in-from-top-2`,children:[x.type==="success"?e.jsx(H,{className:"h-5 w-5 text-emerald-600"}):e.jsx(Y,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:`text-sm font-medium ${x.type==="success"?"text-emerald-800":"text-red-800"}`,children:x.text})]}),e.jsx("div",{className:"mb-6 rounded-xl border border-gray-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold text-gray-600",children:"Select Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 transform text-gray-400"}),e.jsx("input",{type:"date",value:m,onChange:t=>X(t.target.value),className:"w-full appearance-none rounded-lg border border-gray-300 bg-white py-2.5 pl-11 pr-4 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold text-gray-600",children:"Select Month"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 transform text-gray-400"}),e.jsx("select",{value:g,onChange:t=>U(t.target.value),className:"w-full appearance-none rounded-lg border border-gray-300 bg-white py-2.5 pl-11 pr-4 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500",children:ee.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold text-gray-600",children:"Select Year"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 transform text-gray-400"}),e.jsx("select",{value:u,onChange:t=>J(parseInt(t.target.value)),className:"w-full appearance-none rounded-lg border border-gray-300 bg-white py-2.5 pl-11 pr-4 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500",children:te.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold text-gray-600",children:"Department"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 transform text-gray-400"}),e.jsxs("select",{value:h,onChange:t=>G(t.target.value),className:"w-full appearance-none rounded-lg border border-gray-300 bg-white py-2.5 pl-11 pr-4 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"All Departments"}),($=(T=v==null?void 0:v.data)==null?void 0:T.data)==null?void 0:$.map(t=>e.jsx("option",{value:t.id,children:t.department_name},t.id))]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold text-gray-600",children:"Search Employee"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 transform text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Name, code...",value:b,onChange:t=>K(t.target.value),className:"w-full rounded-lg border border-gray-300 py-2.5 pl-11 pr-4 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold text-gray-600",children:"Filter by Status"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 transform text-gray-400"}),e.jsxs("select",{value:f,onChange:t=>Q(t.target.value==="all"?"all":parseInt(t.target.value)),className:"w-full appearance-none rounded-lg border border-gray-300 bg-white py-2.5 pl-11 pr-4 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"1",children:"Present"}),e.jsx("option",{value:"0",children:"Absent"}),e.jsx("option",{value:"2",children:"Half Day"}),e.jsx("option",{value:"3",children:"Leave"})]})]})]})]})}),e.jsx("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm",children:F?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-indigo-200 border-t-indigo-600"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Loading attendance data..."})]}):!((R=s==null?void 0:s.data)!=null&&R.data)||s.data.data.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(me,{className:"mb-4 h-16 w-16 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-400",children:"No records found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Department"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Check In"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Check Out"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Hours"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:s.data.data.map(t=>e.jsxs("tr",{className:"transition-colors hover:bg-indigo-50/50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:t.emp_name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.emp_code})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center rounded-md bg-gray-100 px-2.5 py-1 text-xs font-medium text-gray-700",children:t.department_name})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:t.emp_in_time?e.jsx("span",{className:"font-medium",children:new Date(t.emp_in_time).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}):e.jsx("span",{className:"text-gray-400",children:"--:--"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:t.emp_out_time?e.jsx("span",{className:"font-medium",children:new Date(t.emp_out_time).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}):e.jsx("span",{className:"text-gray-400",children:"--:--"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"inline-flex items-center rounded-md bg-indigo-50 px-2.5 py-1 text-sm font-bold text-indigo-700",children:[t==null?void 0:t.total_working_hours,"h"]})}),e.jsx("td",{className:"px-6 py-4",children:Z(t.attendance_status)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{status:1,currentStatus:t.attendance_status,onClick:()=>y(t.emp_id,1),label:"Present",color:"bg-emerald-500"}),e.jsx(j,{status:0,currentStatus:t.attendance_status,onClick:()=>y(t.emp_id,0),label:"Absent",color:"bg-red-500"}),e.jsx(j,{status:2,currentStatus:t.attendance_status,onClick:()=>y(t.emp_id,2),label:"Half Day",color:"bg-amber-500"}),e.jsx(j,{status:3,currentStatus:t.attendance_status,onClick:()=>y(t.emp_id,3),label:"Leave",color:"bg-blue-500"})]})})]},t.id))})]})})}),e.jsx("div",{className:"mt-6 rounded-xl border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Rows per page:"}),e.jsxs("select",{value:i,onChange:t=>re(parseInt(t.target.value)),className:"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 transition-all focus:border-transparent focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:se})," ","to"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:ae})," ","of"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:S})," ","entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>k(l-1),disabled:l===1||F,className:"flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 transition-all hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(xe,{className:"h-4 w-4"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,o)},(t,r)=>{let a;return o<=5||l<=3?a=r+1:l>=o-2?a=o-4+r:a=l-2+r,e.jsx("button",{onClick:()=>k(a),disabled:s==null?void 0:s.isFetching,className:`h-8 w-8 rounded-lg text-sm font-medium transition-all disabled:cursor-not-allowed ${l===a?"bg-indigo-600 text-white shadow-sm":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:a},a)})}),e.jsxs("button",{onClick:()=>k(l+1),disabled:l===o||(s==null?void 0:s.isFetching),className:"flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 transition-all hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",e.jsx(pe,{className:"h-4 w-4"})]})]})]})]})}),e.jsx("div",{className:"mt-4 rounded-xl border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Page ",e.jsx("span",{className:"font-semibold text-gray-800",children:l})," of"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:o})]}),e.jsxs("span",{className:"text-gray-500",children:["Last updated: ",new Date().toLocaleTimeString("en-IN")]})]})})]})},be=he;function Le(){return e.jsx(ie,{title:"Attendance List",subTitle:"Manage all the Attendance here",children:e.jsx(be,{})})}export{Le as default};
