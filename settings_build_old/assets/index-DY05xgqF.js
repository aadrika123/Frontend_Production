import{u as v,j as e,a as j,_ as c}from"./index-njValvxg.js";import{P}from"./index-DIf_iQyp.js";import{a as k,b as y,o as N,F as C,R as m,B as L,d as S,e as g,i as x,g as h,h as M}from"./useCrypto-DgML1Xl8.js";const $=S({oldPassword:g().min(8,"Password must be at least 8 characters").required("Old password is required"),newPassword:g().min(8,"Password must be at least 8 characters").required("New password is required").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,"Password must contain at least one uppercase letter, one lowercase letter, one number and one special character").notOneOf([x("oldPassword")],"New password must be different from old password"),confirmPassword:g().required("Confirm password is required").oneOf([x("newPassword")],"Passwords must match")});function z(){const{logout:u}=v(),p=k({}),o=y({defaultValues:{oldPassword:"",newPassword:"",confirmPassword:""},resolver:N($)}),t=s=>(s.preventDefault(),!1),l=s=>{(s.ctrlKey||s.metaKey)&&["c","v","x"].includes(s.key.toLowerCase())&&s.preventDefault()},f=async s=>{var a,d,i;try{const r=await p.mutateAsync({api:j.changePassword,data:{password:h(s.oldPassword),newPassword:h(s.newPassword)}});(a=r==null?void 0:r.data)!=null&&a.status?(c.success((d=r==null?void 0:r.data)==null?void 0:d.message),u(),o.reset()):c.error(((i=r==null?void 0:r.data)==null?void 0:i.message)||"Failed to change password")}catch(r){c.error(M(r.message))}finally{o.reset({oldPassword:"",newPassword:"",confirmPassword:""})}},n=(()=>{const s=o.watch("newPassword");if(!s)return{level:0,text:"",color:""};const a=s.length>=8,d=/[A-Z]/.test(s),i=/[a-z]/.test(s),r=/[0-9]/.test(s),b=/[@$!%*?&]/.test(s),w=[a,d,i,r,b].filter(Boolean).length;return w===5&&s.length>=10?{level:3,text:"Strong",color:"bg-emerald-500"}:w>=3&&a?{level:2,text:"Medium",color:"bg-amber-500"}:a?{level:1,text:"Weak",color:"bg-rose-500"}:{level:0,text:"Too Weak",color:"bg-gray-300"}})();return e.jsx("main",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 px-4 py-8 lg:px-8",children:e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white shadow-2xl",children:[e.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"p-6 sm:p-8 md:p-10",children:[e.jsxs("div",{className:"mb-6 rounded-xl border border-indigo-100 bg-gradient-to-br from-indigo-50 to-purple-50 p-4 dark:border-indigo-900/50 dark:from-indigo-950/30 dark:to-purple-950/30",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-5 w-5 text-indigo-600 dark:text-indigo-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),e.jsx("p",{className:"font-semibold text-indigo-900 dark:text-indigo-300",children:"Password Requirements"})]}),e.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:["Minimum 8 characters","One uppercase letter","One lowercase letter","One number","One special character"].map((s,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-indigo-200 dark:bg-indigo-800",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",className:"h-3 w-3 text-indigo-700 dark:text-indigo-300",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})})}),e.jsx("span",{className:"text-xs text-indigo-800 dark:text-indigo-300",children:s})]},a))})]}),e.jsx(C,{methods:o,onSubmit:o.handleSubmit(f),children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Current Password"}),e.jsx(m,{name:"oldPassword",placeholder:"Enter your current password",autoComplete:"off",onPaste:t,onCopy:t,onCut:t,onKeyDown:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300",children:"New Password"}),e.jsx(m,{name:"newPassword",placeholder:"Enter your new password",autoComplete:"off",onPaste:t,onCopy:t,onCut:t,onKeyDown:l})]}),o.watch("newPassword")&&e.jsxs("div",{className:"rounded-lg bg-gray-50 p-4 dark:bg-gray-900/50",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Password Strength"}),e.jsx("span",{className:`text-sm font-bold ${n.level===3?"text-emerald-600 dark:text-emerald-400":n.level===2?"text-amber-600 dark:text-amber-400":"text-rose-600 dark:text-rose-400"}`,children:n.text})]}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4].map(s=>e.jsx("div",{className:`h-2 flex-1 rounded-full transition-all duration-500 ${s<=n.level*1.3?n.color:"bg-gray-200 dark:bg-gray-700"}`},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),e.jsx(m,{name:"confirmPassword",placeholder:"Re-enter your new password",autoComplete:"off",onPaste:t,onCopy:t,onCut:t,onKeyDown:l})]}),e.jsx("div",{className:"pt-2",children:e.jsxs(L,{type:"submit",isLoading:o.formState.isSubmitting,className:"w-full rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 text-base font-semibold text-white shadow-lg transition-all hover:from-indigo-700 hover:to-purple-700 hover:shadow-xl focus:ring-4 focus:ring-indigo-300 dark:focus:ring-indigo-800",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"mr-2 inline-block h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"})}),"Update Password"]})})]})}),e.jsxs("div",{className:"mt-6 flex items-start gap-3 rounded-lg bg-amber-50 p-3 dark:bg-amber-950/20",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-5 w-5 flex-shrink-0 text-amber-600 dark:text-amber-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-300",children:"You'll be logged out after changing your password. Please sign in again with your new password."})]})]})]})})}function A(){return e.jsx(P,{title:"Change Password",subTitle:"Secure your account with a strong password",children:e.jsx("div",{children:e.jsx(z,{})})})}export{A as default};
