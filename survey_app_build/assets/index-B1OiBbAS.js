import{u as e,H as r,y as t,j as s,z as a}from"./vendor-CX7Sr6rY.js";import{b as i,e as d}from"./useSurveyApi-BI6OzhtC.js";import{T as o}from"./textarea-DmEaNQE7.js";import{y as n,_ as l,z as c,ac as x,V as m}from"./icons--btW49PO.js";import"./query-D-Aji6U-.js";import"./index-BHHC9fLw.js";import"./ui-B_wVOan7.js";import"./axios-Dos3PyFQ.js";import"./zustand-DOMjtRnQ.js";import"./useCustomQuery-khXZmN5i.js";function g(){const g=e(),[u]=r(),h=u.get("type")||"",y=u.get("id")||"",b=u.get("action"),{register:p,handleSubmit:j,formState:{errors:v,isSubmitting:f}}=t({defaultValues:{correction_notes:""}}),k=i(),N=d(),w="verify"===b,S="reject"===b;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 p-4 dark:from-gray-950 dark:to-gray-900 md:p-8",children:[s.jsxs("div",{className:"mb-8 flex items-center gap-4",children:[s.jsx("button",{onClick:()=>g(-1),className:"rounded-lg p-2 hover:bg-gray-200 dark:hover:bg-gray-800",children:s.jsx(n,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:w?"Verify Survey":"Reject Survey"}),s.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[h," Survey â€¢ ID: ",y]})]})]}),s.jsxs("div",{className:"mx-auto max-w-2xl",children:[s.jsx("div",{className:"mb-6 rounded-2xl p-6 "+(w?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"),children:s.jsxs("div",{className:"flex items-start gap-4",children:[w?s.jsx(l,{className:"mt-1 h-6 w-6 flex-shrink-0 text-green-600 dark:text-green-400"}):s.jsx(c,{className:"mt-1 h-6 w-6 flex-shrink-0 text-red-600 dark:text-red-400"}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-bold "+(w?"text-green-900 dark:text-green-300":"text-red-900 dark:text-red-300"),children:w?"Survey Verification":"Survey Rejection"}),s.jsx("p",{className:"mt-1 text-sm "+(w?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"),children:w?"You are about to approve this survey. Please review all details before confirming.":"You are about to reject this survey. Please provide correction notes explaining why."})]})]})}),s.jsxs("div",{className:"rounded-2xl bg-white p-8 shadow-lg dark:bg-gray-900",children:[s.jsxs("form",{onSubmit:j(async e=>{try{const r="Septic"===h?k:N,t={verification_status:"verify"===b?"verified":"rejected",correction_notes:e.correction_notes||""},s={id:Number(y),data:t};await r.mutateAsync(s),a.success("verify"===b?"Survey verified successfully":"Survey rejected successfully"),setTimeout(()=>{g("/survey-app/admin/dashboard-overview")},1500)}catch(r){a.error("Failed to update survey status")}}),className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"mb-2 flex items-center gap-2 text-lg font-semibold text-gray-900 dark:text-white",children:[s.jsx(x,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"}),S?"Correction Notes":"Additional Notes (Optional)"]}),s.jsx("p",{className:"mb-3 text-sm text-gray-600 dark:text-gray-400",children:S?"Please explain what corrections are needed for this survey.":"Add any additional notes or observations about this survey."}),s.jsx(o,{placeholder:S?"e.g., Photo quality is poor, incomplete measurements, etc.":"Add any notes...",...p("correction_notes",{required:!!S&&"Correction notes are required for rejection",minLength:S?{value:10,message:"Notes must be at least 10 characters"}:void 0}),className:"border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white"}),v.correction_notes&&s.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:v.correction_notes.message})]}),s.jsxs("div",{className:"flex flex-col gap-3 pt-4 sm:flex-row",children:[s.jsx("button",{type:"button",onClick:()=>g(-1),className:"rounded-lg border-2 border-gray-300 bg-white px-6 py-3 font-semibold text-gray-900 transition-colors hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:f,className:"flex-1 rounded-lg px-6 py-3 font-semibold text-white transition-colors disabled:opacity-50 "+(w?"bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600":"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-600"),children:f?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),w?"Verifying...":"Rejecting..."]}):w?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx(l,{className:"h-5 w-5"}),"Verify Survey"]}):s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx(c,{className:"h-5 w-5"}),"Reject Survey"]})})]})]}),s.jsx("div",{className:"mt-8 border-t border-gray-200 pt-6 dark:border-gray-700",children:s.jsxs("div",{className:"flex gap-3 rounded-lg bg-blue-50 p-4 dark:bg-blue-900/20",children:[s.jsx(m,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-blue-600 dark:text-blue-400"}),s.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["Once you ",w?"verify":"reject"," this survey, the surveyor will be notified of the status. This action cannot be undone immediately."]})]})})]})]})]})}export{g as default};
