import{u as e,r as s,j as a,z as r}from"./vendor-CX7Sr6rY.js";import{u as t,a as l,b as i}from"./useSurveyApi-BI6OzhtC.js";import{g as d,a as n}from"./useMasters-DxwSyZoR.js";import{b as c,B as o,s as x}from"./index-BHHC9fLw.js";import{T as m,a as h,b as g,c as j,d as p,e as u,A as y,f as v,g as b,h as N,i as k,j as f,k as w,l as _}from"./alert-dialog-BXl4HLQR.js";import{I as C}from"./input-Cd3rHap0.js";import{S as L,a as S,b as z,c as D,d as V}from"./select-Dh03lloP.js";import{D as W,a as M,b as P,c as A,d as B,e as H}from"./dialog-BuwjdHGA.js";import{C as T,a as F,b as $,c as R,B as O}from"./card-DhtAEevg.js";import{T as I}from"./textarea-DmEaNQE7.js";import{u as q}from"./useCustomQuery-khXZmN5i.js";import{H as U}from"./icons--btW49PO.js";import"./query-D-Aji6U-.js";import"./ui-B_wVOan7.js";import"./axios-Dos3PyFQ.js";import"./zustand-DOMjtRnQ.js";const Z=()=>a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),E=()=>a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),Y=()=>a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),G=()=>a.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Q=()=>a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),J=()=>a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),K=()=>a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),X=()=>a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),ee=()=>a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),se=()=>a.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]});function ae(){var ae,re,te,le,ie,de;const ne=e(),{user:ce}=c(),oe=d(Number(null==ce?void 0:ce._id)),xe=n(),[me,he]=s.useState({page:1,limit:10,ward_no:"",zone:"",property_type:"",verification_status:"",owner_name:""}),[ge,je]=s.useState(!1),pe=q({}),[ue,ye]=s.useState(!1),[ve,be]=s.useState(!1),[Ne,ke]=s.useState(!1),[fe,we]=s.useState(null),[_e,Ce]=s.useState(""),[Le,Se]=s.useState(""),{data:ze,isLoading:De,refetch:Ve,isFetching:We}=t(me),Me=l(),Pe=i(),Ae=(null==(ae=null==ze?void 0:ze.data)?void 0:ae.surveys)||[],Be=null==(re=null==ze?void 0:ze.data)?void 0:re.pagination,He=(null==(le=null==(te=null==xe?void 0:xe.data)?void 0:te.data)?void 0:le.property_type)||[],Te=(e,s)=>{he(a=>({...a,[e]:s,page:1}))},Fe=e=>{he(s=>({...s,page:e}))},$e=e=>({submitted:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400",label:"Pending Review"},verified:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-400",label:"Verified"},rejected:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",label:"Rejected"},needs_correction:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400",label:"Needs Correction"}}[e]||{bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-700 dark:text-gray-400",label:e}),Re=e=>{const s=He.find(s=>{var a;return(null==(a=s.property_type)?void 0:a.toLowerCase())===(null==e?void 0:e.toLowerCase())||String(s.id)===e});return(null==s?void 0:s.property_type)||e};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-950 dark:via-gray-900 dark:to-gray-950",children:[a.jsx("header",{className:"sticky top-0 z-30 border-b border-gray-200/60 bg-white/80 shadow-sm backdrop-blur-xl dark:border-gray-800/60 dark:bg-gray-900/80",children:a.jsx("div",{className:"mx-auto max-w-7xl",children:a.jsxs("div",{className:"flex items-center gap-4 px-4 py-4",children:[a.jsx("button",{onClick:()=>ne(-1),className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gray-100 text-gray-600 transition-all hover:scale-105 hover:bg-gray-200 active:scale-95 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700","aria-label":"Go back",children:a.jsx(X,{})}),a.jsx("div",{className:"flex-1",children:a.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Septic Tank Surveys"})}),a.jsxs(o,{onClick:()=>ne("/survey-app"),className:"hidden bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/25 transition-all hover:scale-105 hover:shadow-xl hover:shadow-blue-500/30 active:scale-95 sm:flex",children:[a.jsx(U,{}),a.jsx("span",{className:"ml-2",children:"Home"})]}),a.jsx(o,{onClick:()=>ne("/survey-app"),size:"icon",className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white sm:hidden",children:a.jsx(U,{})})]})})}),a.jsx("div",{className:"mx-auto mt-4 max-w-7xl px-4",children:a.jsxs(T,{className:"border-0 bg-white/80 shadow-lg backdrop-blur-sm dark:bg-gray-800/80",children:[a.jsx(F,{className:"border-b border-gray-100 pb-4 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-indigo-500 text-white",children:a.jsx(E,{})}),a.jsxs("div",{children:[a.jsx($,{className:"text-lg",children:"Search & Filter"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Find surveys quickly by applying filters"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(o,{variant:"outline",size:"sm",onClick:()=>je(!ge),className:"sm:hidden",children:ge?"Hide Filters":"Show Filters"}),a.jsx(o,{variant:"outline",size:"sm",onClick:()=>{he({page:1,limit:10,ward_no:"",zone:"",property_type:"",verification_status:"",owner_name:""})},className:"text-gray-600 dark:text-gray-300",children:"Clear All"}),a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>Ve(),className:"text-blue-600 dark:text-blue-400",disabled:We,children:[a.jsx(Y,{}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Refresh"})]})]})]})}),a.jsx(R,{className:"pt-6 "+(ge?"block":"hidden sm:block"),children:a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:[a.jsxs("div",{className:"relative xl:col-span-2",children:[a.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Owner Name"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:a.jsx(Z,{})}),a.jsx(C,{placeholder:"Search owner name...",value:me.owner_name||"",onChange:e=>Te("owner_name",e.target.value),className:"pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Ward No."}),a.jsxs(L,{value:me.ward_no||"",onValueChange:e=>Te("ward_no","all"===e?"":e),children:[a.jsx(S,{children:a.jsx(z,{placeholder:"All Wards"})}),a.jsxs(D,{children:[a.jsx(V,{value:"all",children:"All Wards"}),null==(de=null==(ie=null==oe?void 0:oe.data)?void 0:ie.data)?void 0:de.map(e=>a.jsxs(V,{value:String(e.ward_name),children:["Ward ",e.ward_name]},e.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Zone"}),a.jsxs(L,{value:me.zone||"",onValueChange:e=>Te("zone","all"===e?"":e),children:[a.jsx(S,{children:a.jsx(z,{placeholder:"All Zones"})}),a.jsxs(D,{children:[a.jsx(V,{value:"all",children:"All Zones"}),a.jsx(V,{value:"north",children:"North"}),a.jsx(V,{value:"south",children:"South"}),a.jsx(V,{value:"east",children:"East"}),a.jsx(V,{value:"west",children:"West"}),a.jsx(V,{value:"central",children:"Central"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Property Type"}),a.jsxs(L,{value:me.property_type||"",onValueChange:e=>Te("property_type","all"===e?"":e),children:[a.jsx(S,{children:a.jsx(z,{placeholder:"All Types"})}),a.jsxs(D,{children:[a.jsx(V,{value:"all",children:"All Types"}),He.map(e=>a.jsx(V,{value:e.property_type,children:e.property_type},e.id)),a.jsx(V,{value:"Residential",children:"Residential"}),a.jsx(V,{value:"Commercial",children:"Commercial"}),a.jsx(V,{value:"Industrial",children:"Industrial"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Status"}),a.jsxs(L,{value:me.verification_status||"",onValueChange:e=>Te("verification_status","all"===e?"":e),children:[a.jsx(S,{children:a.jsx(z,{placeholder:"All Status"})}),a.jsxs(D,{children:[a.jsx(V,{value:"all",children:"All Status"}),a.jsx(V,{value:"submitted",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-amber-500"}),"Pending Review"]})}),a.jsx(V,{value:"verified",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),"Verified"]})}),a.jsx(V,{value:"rejected",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-red-500"}),"Rejected"]})}),a.jsx(V,{value:"needs_correction",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-orange-500"}),"Needs Correction"]})})]})]})]})]})})]})}),a.jsx("div",{className:"mx-auto max-w-7xl px-4 py-6",children:a.jsxs(T,{className:"overflow-hidden border-0 bg-white/80 shadow-lg backdrop-blur-sm dark:bg-gray-800/80",children:[a.jsx(F,{className:"border-b border-gray-100 bg-gray-50/50 dark:border-gray-700 dark:bg-gray-900/50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs($,{className:"text-lg",children:["Survey Records",Be&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400",children:["Showing ",Ae.length," of ",Be.total," records"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Per page:"}),a.jsxs(L,{value:String(me.limit),onValueChange:e=>Te("limit",e),children:[a.jsx(S,{className:"w-20",children:a.jsx(z,{})}),a.jsxs(D,{children:[a.jsx(V,{value:"10",children:"10"}),a.jsx(V,{value:"25",children:"25"}),a.jsx(V,{value:"50",children:"50"}),a.jsx(V,{value:"100",children:"100"})]})]})]})]})}),a.jsx(R,{className:"p-0",children:De?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading surveys..."})]})}):0===Ae.length?a.jsxs("div",{className:"flex h-64 flex-col items-center justify-center gap-4 p-8 text-center",children:[a.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 text-gray-400 dark:bg-gray-700",children:a.jsx("svg",{className:"h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"No surveys found"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Try adjusting your filters or create a new survey"})]}),a.jsxs(o,{onClick:()=>ne("/survey-app/dashboard/septic-tank-survey-form"),className:"mt-2 bg-gradient-to-r from-blue-600 to-indigo-600",children:[a.jsx(ee,{}),a.jsx("span",{className:"ml-2",children:"Create New Survey"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden overflow-x-auto lg:block",children:a.jsxs(m,{children:[a.jsx(h,{children:a.jsxs(g,{className:"bg-gray-50/50 dark:bg-gray-900/50",children:[a.jsx(j,{className:"w-16 font-semibold",children:"S.No"}),a.jsx(j,{className:"font-semibold",children:"Owner Details"}),a.jsx(j,{className:"font-semibold",children:"Location"}),a.jsx(j,{className:"font-semibold",children:"Property Info"}),a.jsx(j,{className:"font-semibold",children:"Tank Details"}),a.jsx(j,{className:"font-semibold",children:"Status"}),a.jsx(j,{className:"text-right font-semibold",children:"Actions"})]})}),a.jsx(p,{children:Ae.map((e,s)=>{const r=$e(e.verification_status);return a.jsxs(g,{className:"group transition-colors hover:bg-blue-50/50 dark:hover:bg-blue-900/10",children:[a.jsx(u,{className:"font-medium text-gray-500",children:(me.page-1)*me.limit+s+1}),a.jsx(u,{children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:e.owner_name}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Holding: ",e.holding_no]})]})}),a.jsx(u,{children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(se,{}),a.jsxs("span",{className:"text-sm",children:["Ward ",e.ward_no]}),e.zone&&a.jsxs("span",{className:"text-gray-400",children:["• ",e.zone]})]}),a.jsx("p",{className:"max-w-[200px] truncate text-xs text-gray-500 dark:text-gray-400",title:e.address,children:e.address})]})}),a.jsx(u,{children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(O,{variant:"outline",className:"font-normal",children:Re(e.property_type)}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.occupants," occupants"]})]})}),a.jsx(u,{children:a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("p",{children:[a.jsx("span",{className:"text-gray-500",children:"Chambers:"})," ",e.chamber_count]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.septic_tank_dimension_or_capacity})]})}),a.jsx(u,{children:a.jsx(O,{className:`${r.bg} ${r.text} border-0`,children:r.label})}),a.jsx(u,{children:a.jsxs("div",{className:"flex flex-wrap justify-end gap-1 opacity-80 transition-opacity group-hover:opacity-100",children:[a.jsx(o,{variant:"ghost",size:"sm",onClick:()=>{we(e),ke(!0)},className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-100 hover:text-blue-700 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"View Details",children:a.jsx(G,{})}),a.jsx(o,{variant:"ghost",size:"sm",onClick:()=>{we(e),be(!0)},className:"h-8 w-8 p-0 text-emerald-600 hover:bg-emerald-100 hover:text-emerald-700 dark:text-emerald-400 dark:hover:bg-emerald-900/30",title:"Verify Survey",children:a.jsx(K,{})}),a.jsx(o,{variant:"ghost",size:"sm",onClick:()=>ne(`/survey-app/dashboard/survey-form?id=${e.id}&idHex=`),className:"h-8 w-8 p-0 text-amber-600 hover:bg-amber-100 hover:text-amber-700 dark:text-amber-400 dark:hover:bg-amber-900/30",title:"Edit Survey",children:a.jsx(Q,{})}),a.jsx(o,{variant:"ghost",size:"sm",onClick:()=>{we(e),ye(!0)},className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100 hover:text-red-700 dark:text-red-400 dark:hover:bg-red-900/30",title:"Delete Survey",children:a.jsx(J,{})})]})})]},e.id)})})]})}),a.jsx("div",{className:"space-y-4 p-4 lg:hidden",children:Ae.map(e=>{const s=$e(e.verification_status);return a.jsx(T,{className:"overflow-hidden border border-gray-200 shadow-sm transition-all hover:shadow-md dark:border-gray-700",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.owner_name}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Holding: ",e.holding_no]})]}),a.jsx(O,{className:`${s.bg} ${s.text} border-0`,children:s.label})]}),a.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Location"}),a.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:["Ward ",e.ward_no,e.zone&&` • ${e.zone}`]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Property"}),a.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Re(e.property_type)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Chambers"}),a.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.chamber_count})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Date"}),a.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:new Date(e.created_at).toLocaleDateString()})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 border-t border-gray-100 pt-3 dark:border-gray-700",children:[a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{we(e),ke(!0)},className:"w-full",children:[a.jsx(G,{}),a.jsx("span",{className:"ml-1",children:"View"})]}),a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{we(e),be(!0)},className:"w-full text-emerald-600 hover:bg-emerald-50 dark:text-emerald-400",children:[a.jsx(K,{}),a.jsx("span",{className:"ml-1",children:"Verify"})]}),a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>ne(`/survey-app/dashboard/survey-form?id=${e.id}&idHex=`),className:"w-full text-amber-600 hover:bg-amber-50 dark:text-amber-400",children:[a.jsx(Q,{}),a.jsx("span",{className:"ml-1",children:"Edit"})]}),a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{we(e),ye(!0)},className:"w-full text-red-600 hover:bg-red-50 dark:text-red-400",children:[a.jsx(J,{}),a.jsx("span",{className:"ml-1",children:"Delete"})]})]})]})},e.id)})}),Be&&Be.pages>1&&a.jsxs("div",{className:"flex items-center justify-between border-t border-gray-100 px-4 py-4 dark:border-gray-700 sm:px-6",children:[a.jsxs("div",{className:"hidden text-sm text-gray-500 dark:text-gray-400 sm:block",children:["Page"," ",a.jsx("span",{className:"font-medium",children:Be.page})," of"," ",a.jsx("span",{className:"font-medium",children:Be.pages})," •"," ",Be.total," total records"]}),a.jsxs("div",{className:"flex flex-1 justify-between gap-2 sm:flex-none sm:justify-end",children:[a.jsxs(o,{variant:"outline",size:"sm",disabled:!Be.hasPrevPage,onClick:()=>Fe(Be.page-1),className:"min-w-[100px]",children:[a.jsx("svg",{className:"mr-1 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),a.jsx("div",{className:"hidden items-center gap-1 sm:flex",children:Array.from({length:Math.min(5,Be.pages)},(e,s)=>{let r;return r=Be.pages<=5||Be.page<=3?s+1:Be.page>=Be.pages-2?Be.pages-4+s:Be.page-2+s,a.jsx(o,{variant:Be.page===r?"default":"ghost",size:"sm",onClick:()=>Fe(r),className:"h-8 w-8 p-0 "+(Be.page===r?"bg-blue-600 text-white hover:bg-blue-700":""),children:r},r)})}),a.jsxs(o,{variant:"outline",size:"sm",disabled:!Be.hasNextPage,onClick:()=>Fe(Be.page+1),className:"min-w-[100px]",children:["Next",a.jsx("svg",{className:"ml-1 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})})]})}),a.jsx(y,{open:ue,onOpenChange:ye,children:a.jsxs(v,{className:"max-w-md",children:[a.jsxs(b,{children:[a.jsx("div",{className:"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30",children:a.jsx(J,{})}),a.jsx(N,{className:"text-center",children:"Delete Survey"}),a.jsxs(k,{className:"text-center",children:["Are you sure you want to delete the survey for"," ",a.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:null==fe?void 0:fe.owner_name}),"? This action cannot be undone."]})]}),a.jsxs(f,{className:"gap-2 sm:justify-center",children:[a.jsx(w,{className:"sm:min-w-[100px]",children:"Cancel"}),a.jsx(_,{onClick:async()=>{var e;if(fe)try{await pe.mutateAsync({api:null==(e=x)?void 0:e.deleteSepticTankSurvey,data:{id:fe.id}}),r.success("Survey deleted successfully"),ye(!1),we(null),Ve()}catch(s){r.error("Failed to delete survey")}},className:"bg-red-600 text-white hover:bg-red-700 sm:min-w-[100px]",disabled:Me.isPending,children:Me.isPending?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsxs("svg",{className:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})}),a.jsx(W,{open:ve,onOpenChange:be,children:a.jsxs(M,{className:"max-w-md",children:[a.jsxs(P,{children:[a.jsx("div",{className:"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-900/30",children:a.jsx(K,{})}),a.jsx(A,{className:"text-center",children:"Verify Survey"}),a.jsxs(B,{className:"text-center",children:["Update the verification status for"," ",a.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:null==fe?void 0:fe.owner_name})]})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Verification Status ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs(L,{value:_e,onValueChange:Ce,children:[a.jsx(S,{children:a.jsx(z,{placeholder:"Select verification status"})}),a.jsxs(D,{children:[a.jsx(V,{value:"verified",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),"Verified - All information is correct"]})}),a.jsx(V,{value:"rejected",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-red-500"}),"Rejected - Survey is invalid"]})}),a.jsx(V,{value:"needs_correction",children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-orange-500"}),"Needs Correction - Some details need to be fixed"]})})]})]})]}),("rejected"===_e||"needs_correction"===_e)&&a.jsxs("div",{children:[a.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Notes / Reason ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(I,{value:Le,onChange:e=>Se(e.target.value),placeholder:"Please provide details about the issue or what needs to be corrected...",rows:4,className:"resize-none"})]})]}),a.jsxs(H,{className:"gap-2",children:[a.jsx(o,{variant:"outline",onClick:()=>{be(!1),Ce(""),Se("")},children:"Cancel"}),a.jsx(o,{onClick:async()=>{if(fe&&_e)try{await Pe.mutateAsync({id:fe.id,data:{verification_status:_e,correction_notes:Le||void 0}}),r.success("Survey verification updated successfully"),be(!1),we(null),Ce(""),Se(""),Ve()}catch(e){r.error("Failed to verify survey")}},disabled:!_e||("rejected"===_e||"needs_correction"===_e)&&!Le||Pe.isPending,className:"bg-gradient-to-r from-emerald-600 to-green-600 text-white",children:Pe.isPending?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsxs("svg",{className:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Status"})]})]})}),a.jsx(W,{open:Ne,onOpenChange:ke,children:a.jsxs(M,{className:"max-h-[85vh] max-w-3xl overflow-y-auto",children:[a.jsx(P,{children:a.jsxs(A,{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-indigo-500 text-white",children:a.jsx(G,{})}),a.jsxs("div",{children:[a.jsx("span",{className:"block",children:"Survey Details"}),fe&&a.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["ID: ",fe.id]})]})]})}),fe&&a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsx("div",{className:`rounded-lg p-4 ${$e(fe.verification_status).bg}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Verification Status"}),a.jsx("p",{className:`text-lg font-bold ${$e(fe.verification_status).text}`,children:$e(fe.verification_status).label})]}),fe.verified_at&&a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Verified on"}),a.jsx("p",{className:"text-sm font-medium",children:new Date(fe.verified_at).toLocaleDateString()})]})]})}),a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:[a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Owner & Property Information"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 rounded-lg border border-gray-200 bg-gray-50/50 p-4 dark:border-gray-700 dark:bg-gray-800/50 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Owner Name"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.owner_name})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Holding No."}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.holding_no})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ward No."}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.ward_no})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Zone"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.zone||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Property Type"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:Re(fe.property_type)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Usage Type"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.usage_type})]}),a.jsxs("div",{className:"col-span-2 md:col-span-3",children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Address"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.address})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Occupants"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.occupants})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:[a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Septic Tank Details"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 rounded-lg border border-gray-200 bg-gray-50/50 p-4 dark:border-gray-700 dark:bg-gray-800/50 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sanitation Type"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.type_of_sanitation})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tank Location"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.septic_tank_location})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Dimension/Capacity"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.septic_tank_dimension_or_capacity})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Chamber Count"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.chamber_count})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Has Soak Pit"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.has_soak?"Yes":"No"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Connected to Drain"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.connected_to_drain?"Yes":"No"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ventilation Condition"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.ventilation_cover_condition})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Desludging Access"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.desludging_accessibility})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Construction Year"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.sanitation_construction_year||"-"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:[a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Desludging Information"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 rounded-lg border border-gray-200 bg-gray-50/50 p-4 dark:border-gray-700 dark:bg-gray-800/50 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Desludging Date"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.last_desludging_date?new Date(fe.last_desludging_date).toLocaleDateString():"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Desludging Frequency"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.desludging_frequency})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Service Provider"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.service_provider})]}),a.jsxs("div",{className:"col-span-2 md:col-span-3",children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Current Practice"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.current_desludging_practice})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:[a.jsx(se,{}),"Location & Photos"]}),a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50/50 p-4 dark:border-gray-700 dark:bg-gray-800/50",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"GPS Coordinates"}),a.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:fe.latitude&&fe.longitude?`${fe.latitude}, ${fe.longitude}`:"Not available"})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[fe.property_front_photo&&a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 text-xs text-gray-500",children:"Property Front"}),a.jsx("img",{src:fe.property_front_photo,alt:"Property Front",className:"h-24 w-full rounded-lg object-cover"})]}),fe.septic_tank_cover_photo&&a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 text-xs text-gray-500",children:"Tank Cover"}),a.jsx("img",{src:fe.septic_tank_cover_photo,alt:"Tank Cover",className:"h-24 w-full rounded-lg object-cover"})]}),fe.timestamp_photo&&a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 text-xs text-gray-500",children:"Timestamp Photo"}),a.jsx("img",{src:fe.timestamp_photo,alt:"Timestamp",className:"h-24 w-full rounded-lg object-cover"})]})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4 text-sm text-gray-500 dark:border-gray-700 dark:text-gray-400",children:[a.jsxs("div",{children:["Submitted by:"," ",a.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:fe.submitted_by_name||"N/A"})]}),a.jsxs("div",{children:["Created:"," ",a.jsx("span",{className:"font-medium",children:new Date(fe.created_at).toLocaleDateString()})]})]}),fe.correction_notes&&a.jsxs("div",{className:"rounded-lg border border-orange-200 bg-orange-50 p-4 dark:border-orange-800 dark:bg-orange-900/20",children:[a.jsx("p",{className:"mb-1 text-sm font-medium text-orange-800 dark:text-orange-300",children:"Correction Notes"}),a.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-400",children:fe.correction_notes})]})]})]})})]})}export{ae as default};
