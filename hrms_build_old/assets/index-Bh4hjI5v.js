import{n as e,h as a,f as s,r as i,j as l,z as t,m as d,B as r}from"./index-CaGgFSeq.js";import{P as n}from"./index-_Ebnz7ZO.js";import{h as c}from"./moment-CBOc1lqT.js";import{C as o,a as u,b as m,c as p}from"./card-DpoqoWLt.js";import{T as x,a as v,b as j,c as y,d as h,e as g}from"./table-Cx7GlPK-.js";import{u as f,b as _}from"./useCustomQuery-kAcgaiYY.js";import{S as b}from"./separator-BjkNEWW3.js";import{S}from"./index-BTP_FOeW.js";import{S as N}from"./Spinner-qexXCl2s.js";import{a as P,o as L,c as B,f as C}from"./yup-CKEuqCyz.js";import{F as E}from"./datetime-picker-BtprqcV1.js";import{R as M}from"./RHFTextField-DnsEykRH.js";import{B as I}from"./ButtonLoading-B22z2lRV.js";import"./select-CIf9vlQt.js";import"./input-D-UmUPn3.js";import"./switch-Dzwmyki0.js";import"./checkbox-BzF0hRJq.js";import"./label-CInbbuF8.js";import{D as k}from"./index-atwvxgXU.js";import"./calendar-B5etLz2h.js";import"./format-BkNqQ0tt.js";import"./chevron-right-CSfpr0N3.js";import"./clock-B2whL4Nd.js";import"./check-DrWmecxK.js";const T=B().shape({cell_index:C().required("Cell Index is required").positive("Cell Index must be positive"),basic_pay:C().required("Basic Pay is required").positive("Basic Pay must be positive")});function $({open:d,setOpen:r,title:n,id:c,edit:o,setEdit:u,empTypeListData:m,payLevelId:p}){var x,v,j,y,h,g;const S=f({}),N=e(String(p)),{data:B,isFetching:C}=_({api:`${null==(x=a)?void 0:x.getPayMatrixById}?id=${s(String(c))}`,key:"getPayMatrixById",options:{enabled:!!o}}),$=(null==m?void 0:m.data)&&(null==(j=null==(v=null==m?void 0:m.data)?void 0:v.data)?void 0:j.length)>0?Math.max(...null==(h=null==(y=null==m?void 0:m.data)?void 0:y.data)?void 0:h.map(e=>null==e?void 0:e.cell_index))+1:1;_({api:`${null==(g=a)?void 0:g.getPayLevelById}?id=${p}`,key:"getPayLevelById",value:[p],options:{enabled:!!p}});const w={pay_level_id:Number(N)||0,cell_index:0,basic_pay:0},A=P({defaultValues:w,resolver:L(T)});return i.useEffect(()=>{o&&(null==B?void 0:B.data)?A.reset(B.data):A.reset(w)},[o,B,A]),i.useEffect(()=>{(null==m?void 0:m.data)&&!o&&A.setValue("cell_index",$)},[m,o,$,A]),l.jsx(k,{open:d,setOpen:r,title:n,setEdit:u,edit:o,isLoading:C,children:l.jsx(E,{methods:A,onSubmit:A.handleSubmit(async e=>{var s,i,l,d,n,p,x,v;try{if(o&&e){const r=await S.mutateAsync({api:`${null==(s=a)?void 0:s.updatePayMatrix}`,data:{id:c,pay_level_id:e.pay_level_id,cell_index:e.cell_index,basic_pay:e.basic_pay}});(null==(i=r.data)?void 0:i.success)?t.success(null==(l=null==r?void 0:r.data)?void 0:l.message):t.error((null==(d=r.data)?void 0:d.message)||"Pay Level Cell not updated successfully")}else{const s=await S.mutateAsync({api:null==(n=a)?void 0:n.createPayMatrix,data:{pay_level_id:e.pay_level_id,cell_index:e.cell_index,basic_pay:e.basic_pay}});(null==(p=s.data)?void 0:p.success)?t.success(null==(x=null==s?void 0:s.data)?void 0:x.message):t.error((null==(v=s.data)?void 0:v.message)||"Pay Level Cell not created successfully"),A.reset(w)}r(!1),u(!1),null==m||m.refetch()}catch(j){t.error("An error occurred. Please try again.")}}),children:l.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[l.jsx("input",{type:"hidden",...A.register("pay_level_id"),value:p||""}),l.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[l.jsx(M,{type:"number",label:"Cell Index",name:"cell_index",placeholder:"Enter Cell Index"}),l.jsx(M,{type:"number",name:"basic_pay",label:"Basic Pay",placeholder:"Enter Basic Pay"})]}),l.jsx(b,{}),l.jsx("div",{children:l.jsx(I,{isLoading:A.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function w(){var e,s,t,n;const[P]=d(),L=P.get("pay_level_id");f({});const[B,C]=i.useState(1),[E,M]=i.useState(10),[I,k]=i.useState(""),[T,w]=i.useState(!1),[A,F]=i.useState(""),[D,Y]=i.useState(!1),[q,O]=i.useState(null),R=_({api:`${a.getAllPayMatrix}?pay_level_id=${L}`,key:"getAllPayMatrix",value:[B,E],options:{enabled:!!L}});return l.jsxs("main",{className:"grid items-start",children:[l.jsx($,{open:T,setOpen:w,title:D?"Edit Employee Type":"Add Employee Type",id:A,edit:D,setEdit:Y,empTypeListData:R,payLevelId:L||void 0}),l.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[l.jsxs("div",{className:"flex w-full justify-between gap-2",children:[l.jsx("div",{children:l.jsx(S,{search:I,setSearch:k,refetch:R.refetch,isFetching:null==R?void 0:R.isLoading})}),l.jsx("div",{children:l.jsx(r,{className:"flex items-center gap-2",onClick:()=>w(!0),children:"Add New"})})]}),l.jsxs(o,{children:[l.jsx(u,{className:"px-7",children:l.jsxs(m,{children:["Employee Type List (",(null==(s=null==(e=null==R?void 0:R.data)?void 0:e.data)?void 0:s.length)||0,")"]})}),l.jsx(p,{children:R.isLoading?l.jsx("div",{className:"flex h-32 items-center justify-center",children:l.jsx(N,{})}):l.jsxs(l.Fragment,{children:[l.jsxs(x,{children:[l.jsx(v,{children:l.jsxs(j,{children:[l.jsx(y,{className:"",children:"#"}),l.jsx(y,{className:"",children:"Level"}),l.jsx(y,{className:"",children:"Cell Index"}),l.jsx(y,{className:"",children:"Basic Pay"}),l.jsx(y,{className:"",children:"Created at"}),l.jsx(y,{children:"Action"})]})}),l.jsx(h,{children:null==(n=null==(t=null==R?void 0:R.data)?void 0:t.data)?void 0:n.map((e,a)=>l.jsxs(j,{children:[l.jsx(g,{children:a+1}),l.jsx(g,{children:`Level ${null==e?void 0:e.pay_level_id}`}),l.jsx(g,{children:null==e?void 0:e.cell_index}),l.jsx(g,{children:null==e?void 0:e.basic_pay}),l.jsx(g,{children:c(null==e?void 0:e.created_at).format("DD-MM-YYYY")}),l.jsx(g,{children:l.jsx(r,{className:"bg-primary",onClick:()=>{return a=String(null==e?void 0:e.id),Y(!0),w(!0),void F(a);var a},children:"Edit"})})]},null==e?void 0:e.id))})]}),l.jsx(b,{className:"mb-2 mt-4"})]})})]})]})]})}function A(){return l.jsx(n,{title:"Pay Matrix",subTitle:"Manage all the Pay Matrices here",children:l.jsx("div",{className:"py-12",children:l.jsx(w,{})})})}export{A as default};
