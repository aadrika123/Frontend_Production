import{h as N,e as B,r as o,j as e,z as d,B as I}from"./index-SDtq6APg.js";import{P as z}from"./index-CrjMXZHz.js";import{C as U,a as V,b as G,c as J,h as K}from"./card-BkXv33Jr.js";import{S as O,T as Q,a as W,b as H,c as S,d as X,e as b}from"./index-DiVzI3Qj.js";import{u as R,b as Y}from"./useCustomQuery-DuxI2f1A.js";import{g as Z}from"./services-KQnp_8oA.js";import{P as L}from"./index-H8LJk4gb.js";import{S as q,a as ee}from"./Spinner-thyyrLKV.js";import{a as ae,o as se,c as re,b as te}from"./yup-V-kjDK18.js";import{F as ne,B as ce}from"./datetime-picker-iopySnZ3.js";import{R as le}from"./RHFTextField-D_VEXMjP.js";import"./select-C_Ik7Cfg.js";import{D as oe}from"./index-CchGxI1X.js";import{L as ie}from"./loader-circle-CqvtqMqY.js";import{t as de}from"./switch-Bhema1nm.js";import"./calendar-C_1_1UGM.js";import"./clock-Cy8xExlC.js";import"./check-CsPaHRb5.js";const pe=re().shape({department_name:te().required("Department is required")});function ue({open:P,setOpen:p,title:T,id:u,edit:i,setEdit:h,refetch:$}){var m;const v=R({}),{data:t,isFetching:A}=Y({api:`${(m=N)==null?void 0:m.getDepartmentMstrById}/${B(String(u))}`,key:"getDepartmentMstrById",options:{enabled:i}}),l=ae({defaultValues:{department_name:""},resolver:se(pe)}),w=async n=>{var x,s,C,E,g,f,j,y;try{if(i&&n){const r=await v.mutateAsync({api:`${(x=N)==null?void 0:x.updateDEpartmentMstrById}`,data:{id:B(String(u)),...n}});(s=r.data)!=null&&s.success?d.success((C=r==null?void 0:r.data)==null?void 0:C.message):d.error(((E=r.data)==null?void 0:E.message)||"Department not updated successfully")}else{const r=await v.mutateAsync({api:(g=N)==null?void 0:g.createDepartmentMstr,data:n});(f=r.data)!=null&&f.success?d.success((j=r==null?void 0:r.data)==null?void 0:j.message):d.error(((y=r.data)==null?void 0:y.message)||"Department not created successfully"),l.reset({department_name:""})}p(!1),h(!1),$()}catch(r){console.log(r)}};return o.useEffect(()=>{var n;i&&t?l.reset({department_name:(n=t==null?void 0:t.data)==null?void 0:n.department_name}):l.reset({department_name:""})},[i,t]),e.jsx(oe,{open:P,setOpen:p,title:T,setEdit:h,edit:i,isLoading:A,children:e.jsx(ne,{methods:l,onSubmit:l.handleSubmit(w),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(le,{name:"department_name",placeholder:"Enter Department",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(q,{}),e.jsx("div",{children:e.jsx(ce,{isLoading:l.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function he(){var g,f,j,y,r,F;const P=R({}),[p,T]=o.useState(1),[u,i]=o.useState(10),[h,$]=o.useState(""),[v,t]=o.useState(!1),[A,l]=o.useState(""),[w,m]=o.useState(!1),[n,x]=o.useState(null),s=Y({api:`${N.getAllDepartmentMstr}?page=${p}&limit=${u}&q=${h}`,key:"getAllDepartmentMstr",value:[p,u],options:{enabled:!0}}),C=a=>{m(!0),t(!0),l(a)},E=async a=>{var M,_,D,k;x(a);try{const c=await P.mutateAsync({api:`${(M=N)==null?void 0:M.toggleDepartmentMstr}`,data:{id:B(String(a))}});(_=c==null?void 0:c.data)!=null&&_.success?(s==null||s.refetch(),d.success((D=c==null?void 0:c.data)==null?void 0:D.message)):d.error((k=c.data)==null?void 0:k.message)}catch(c){d.error(Z(c))}finally{x(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(ue,{open:v,setOpen:t,title:w?"Edit Employee Type":"Add Employee Type",id:A,edit:w,setEdit:m,refetch:s==null?void 0:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(O,{search:h,setSearch:$,refetch:s==null?void 0:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(I,{className:"flex items-center gap-2",onClick:()=>t(!0),children:"Add New"})})]}),e.jsxs(U,{children:[e.jsx(V,{className:"px-7",children:e.jsxs(G,{children:["Department List (",(f=(g=s==null?void 0:s.data)==null?void 0:g.pagination)==null?void 0:f.total,")"]})}),e.jsx(J,{children:s!=null&&s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ee,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(H,{children:[e.jsx(S,{className:"",children:"#"}),e.jsx(S,{className:"",children:"Department"}),e.jsx(S,{className:"",children:"Created at"}),e.jsx(S,{className:"",children:"Status"}),e.jsx(S,{children:"Action"})]})}),e.jsx(X,{children:(y=(j=s==null?void 0:s.data)==null?void 0:j.data)==null?void 0:y.map((a,M)=>e.jsxs(H,{children:[e.jsx(b,{children:M+1}),e.jsx(b,{children:a==null?void 0:a.department_name}),e.jsx(b,{children:K(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(de,{checked:(a==null?void 0:a.status)==1,onChange:()=>E(String(a==null?void 0:a.id)),disabled:n===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),n===String(a==null?void 0:a.id)&&e.jsx(ie,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(b,{children:e.jsx(I,{className:"bg-primary",onClick:()=>C(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(q,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(L,{page:p,limit:u,totalPages:(F=(r=s==null?void 0:s.data)==null?void 0:r.pagination)==null?void 0:F.totalPages,setPage:T,setLimit:i})})]})})]})]})]})}function Be(){return e.jsx(z,{title:"Department List",subTitle:"Manage all the Departments here",children:e.jsx(he,{})})}export{Be as default};
