import{i as E,r as z,l as R,j as e,h as V,z as _}from"./index-SDtq6APg.js";import{g as X,P as L}from"./index-CrjMXZHz.js";import{a as Y,g as B,C as G,o as H,c as S,b as g,h as W,f as C}from"./yup-V-kjDK18.js";import{u as J}from"./useCustomQuery-DuxI2f1A.js";import{C as K}from"./circle-alert-KlGrh2eq.js";import{P as Q}from"./plus-DS1GEcj0.js";import{T as U}from"./trash-2-BJjgVrZW.js";import{C as Z}from"./check-CsPaHRb5.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=E("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),A=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ee=S().shape({department_id:C().transform((c,b)=>b===""?void 0:c).required("Department is required").positive("Please select a valid department").integer("Please select a valid department"),weekly_offs:W().of(S().shape({day:g().required("Day is required").oneOf(A,"Invalid day selected"),weeks:W().of(C()).min(1,"Select at least one week").required("Weeks are required")})).min(1,"At least one weekly off is required").required(),description:g().optional(),department_name:g().optional()});function se(){var j;const[c,b]=z.useState(5),p=X(),n=J({}),O=R(),{register:u,control:y,handleSubmit:P,formState:{errors:r},setValue:D}=Y({resolver:H(ee),defaultValues:{department_id:void 0,department_name:void 0,weekly_offs:[{day:"Saturday",weeks:[]}],description:""}}),{fields:m,append:$,remove:q}=B({control:y,name:"weekly_offs"}),M=async s=>{var t;try{const a={department_id:String(s.department_id),weekly_offs:s.weekly_offs,description:s.description||"",department_name:s.department_name||""};(t=(await n.mutateAsync({api:V.createWeekOff,data:a})).data)!=null&&t.success&&(_.success("Weekly off created successfully!"),O(`/hrms/dashboard/weekly-off-list?department_id=${s.department_id}`))}catch{_.error("Failed to create weekly off. Please try again.")}},F=(s,t,a)=>a.includes(t)?a.filter(o=>o!==t):[...a,t].sort((o,f)=>o-f),I=s=>{s.preventDefault(),P(M)(s)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"mb-6 flex items-start gap-3 rounded border-l-4 border-blue-600 bg-blue-50 p-4",children:[e.jsx(K,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-blue-600"}),e.jsxs("div",{className:"text-sm text-blue-900",children:[e.jsx("p",{className:"font-semibold",children:"Instructions:"}),e.jsx("p",{className:"mt-1",children:"Configure weekly holidays for departments. Select the number of weeks, choose the department, and specify which weeks of the month should have holidays on selected days."})]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-300 bg-white shadow-sm",children:[e.jsxs("div",{className:"border-b border-gray-200 bg-gray-100 px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Weekly Off Configuration Form"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["All fields marked with ",e.jsx("span",{className:"text-red-600",children:"*"})," are mandatory"]})]}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("label",{className:"mb-3 block text-sm font-semibold text-gray-700",children:["1. Number of Weeks in Month"," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("div",{className:"flex gap-3",children:[4,5,6].map(s=>e.jsxs("button",{type:"button",onClick:()=>b(s),className:`rounded border-2 px-6 py-2.5 text-sm font-medium transition-colors ${c===s?"border-blue-900 bg-blue-900 text-white":"border-gray-300 bg-white text-gray-700 hover:border-blue-900 hover:bg-blue-50"}`,children:[s," Weeks"]},s))}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Select the maximum number of weeks in a month for calculation"})]}),e.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["2. Select Department ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{...u("department_id"),onChange:s=>{const a=s.target.options[s.target.selectedIndex].text;D("department_name",a)},className:"w-full rounded border border-gray-400 bg-white px-3 py-2.5 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",children:[e.jsx("option",{value:"",children:"-- Select Department --"}),(j=p==null?void 0:p.data)==null?void 0:j.data.map(s=>e.jsx("option",{value:s.id,children:s.department_name},s.id))]}),r.department_id&&e.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[e.jsx(d,{className:"h-3 w-3"}),r.department_id.message]})]}),e.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["3. Weekly Offs Configuration"," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("button",{type:"button",onClick:()=>$({day:"Monday",weeks:[]}),className:"flex items-center gap-2 rounded border border-blue-900 bg-blue-900 px-4 py-1.5 text-sm font-medium text-white transition-colors hover:bg-blue-800",children:[e.jsx(Q,{className:"h-4 w-4"}),"Add Day"]})]}),e.jsx("div",{className:"space-y-4",children:m.map((s,t)=>{var a,x,o,f,N,k,w,v;return e.jsx("div",{className:"rounded border border-gray-300 bg-white p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-700",children:["Day ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("select",{...u(`weekly_offs.${t}.day`),className:"w-full rounded border border-gray-400 bg-white px-3 py-2 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",children:A.map(l=>e.jsx("option",{value:l,children:l},l))}),((x=(a=r.weekly_offs)==null?void 0:a[t])==null?void 0:x.day)&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-xs text-red-600",children:[e.jsx(d,{className:"h-3 w-3"}),(f=(o=r.weekly_offs[t])==null?void 0:o.day)==null?void 0:f.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-700",children:["Select Weeks ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx(G,{name:`weekly_offs.${t}.weeks`,control:y,render:({field:{value:l,onChange:T}})=>e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:c},(i,h)=>h+1).map(i=>{const h=l==null?void 0:l.includes(i);return e.jsxs("button",{type:"button",onClick:()=>T(F(t,i,l||[])),className:`rounded border-2 px-4 py-1.5 text-sm font-medium transition-colors ${h?"border-green-700 bg-green-700 text-white":"border-gray-300 bg-white text-gray-700 hover:border-green-700 hover:bg-green-50"}`,children:["Week ",i]},i)})})}),((k=(N=r.weekly_offs)==null?void 0:N[t])==null?void 0:k.weeks)&&e.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[e.jsx(d,{className:"h-3 w-3"}),(v=(w=r.weekly_offs[t])==null?void 0:w.weeks)==null?void 0:v.message]})]})]}),(m==null?void 0:m.length)>1&&e.jsx("button",{type:"button",onClick:()=>q(t),className:"rounded border border-red-600 p-2 text-red-600 transition-colors hover:bg-red-50",title:"Remove this day",children:e.jsx(U,{className:"h-4 w-4"})})]})},s.id)})}),r.weekly_offs&&!Array.isArray(r.weekly_offs)&&e.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[e.jsx(d,{className:"h-3 w-3"}),r.weekly_offs.message]})]}),e.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["4. Additional Description"," ",e.jsx("span",{className:"text-xs font-normal text-gray-500",children:"(Optional)"})]}),e.jsx("textarea",{...u("description"),rows:3,className:"w-full resize-none rounded border border-gray-400 px-3 py-2 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",placeholder:"Enter any additional information (e.g., 2nd & 4th Saturday off, All Sundays off)"}),r.description&&e.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[e.jsx(d,{className:"h-3 w-3"}),r.description.message]})]}),n.isSuccess&&e.jsxs("div",{className:"flex items-center gap-3 rounded border-l-4 border-green-600 bg-green-50 p-4 text-green-800",children:[e.jsx(Z,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium",children:"Weekly off configuration has been created successfully!"})]}),n.isError&&e.jsxs("div",{className:"flex items-center gap-3 rounded border-l-4 border-red-600 bg-red-50 p-4 text-red-800",children:[e.jsx(d,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium",children:n.error.message})]})]}),e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Please review all information before submitting"}),e.jsx("button",{type:"button",onClick:I,disabled:n.isPending,className:"rounded bg-green-700 px-8 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-green-800 disabled:cursor-not-allowed disabled:bg-gray-400",children:n.isPending?"Submitting...":"Submit"})]})})]})]})}function ce(){return e.jsx(L,{title:"Create Weekly Off",subTitle:"Manage all the Weekly Offs here",children:e.jsx(se,{})})}export{ce as default};
