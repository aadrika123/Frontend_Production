import{h as e,f as s,r as t,j as a,z as i,B as l,e as n}from"./index-BJ2Di0BB.js";import{P as r}from"./index-L2kacWh6.js";import{h as d}from"./moment-CBOc1lqT.js";import{C as o,a as c,b as m,c as u}from"./card-CrOEotWM.js";import{S as p,T as j,a as h,b as x,c as v,d as g,e as f}from"./index-BxKGIMG5.js";import{u as y,b as S}from"./useCustomQuery-DkqDqiry.js";import{P as b}from"./index-DZvdNKxy.js";import{S as N}from"./separator-BtSn9EpY.js";import{S as D}from"./Spinner-DjUjMlqR.js";import{a as w,o as E,c as M,b as L}from"./yup-BTlf5Wf5.js";import{F as k}from"./datetime-picker-cKnQNXMD.js";import{R as A}from"./RHFTextField-BK1QXo_s.js";import{B as _}from"./ButtonLoading-B5GmY3N3.js";import"./select-4D5dQM-6.js";import{D as C}from"./index-ClKtlEeL.js";import{L as $}from"./loader-circle--1riX2Rm.js";import{t as B}from"./switch-CPa6oSpC.js";import"./calendar-B99NsLtP.js";import"./clock-PqgEqIzL.js";import"./check-DiqtQ1XW.js";const F=M().shape({department_name:L().required("Department is required")});function P({open:l,setOpen:n,title:r,id:d,edit:o,setEdit:c,refetch:m}){var u;const p=y({}),{data:j,isFetching:h}=S({api:`${null==(u=e)?void 0:u.getDepartmentMstrById}/${s(String(d))}`,key:"getDepartmentMstrById",options:{enabled:o}}),x=w({defaultValues:{department_name:""},resolver:E(F)});return t.useEffect(()=>{var e;o&&j?x.reset({department_name:null==(e=null==j?void 0:j.data)?void 0:e.department_name}):x.reset({department_name:""})},[o,j]),a.jsx(C,{open:l,setOpen:n,title:r,setEdit:c,edit:o,isLoading:h,children:a.jsx(k,{methods:x,onSubmit:x.handleSubmit(async t=>{var a,l,r,u,j,h,v,g;try{if(o&&t){const n=await p.mutateAsync({api:`${null==(a=e)?void 0:a.updateDEpartmentMstrById}`,data:{id:s(String(d)),...t}});(null==(l=n.data)?void 0:l.success)?i.success(null==(r=null==n?void 0:n.data)?void 0:r.message):i.error((null==(u=n.data)?void 0:u.message)||"Department not updated successfully")}else{const s=await p.mutateAsync({api:null==(j=e)?void 0:j.createDepartmentMstr,data:t});(null==(h=s.data)?void 0:h.success)?i.success(null==(v=null==s?void 0:s.data)?void 0:v.message):i.error((null==(g=s.data)?void 0:g.message)||"Department not created successfully"),x.reset({department_name:""})}n(!1),c(!1),m()}catch(f){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(A,{name:"department_name",placeholder:"Enter Department",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx(N,{}),a.jsx("div",{children:a.jsx(_,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function T(){var r,w,E,M,L,k;const A=y({}),[_,C]=t.useState(1),[F,T]=t.useState(10),[I,Y]=t.useState(""),[q,O]=t.useState(!1),[R,z]=t.useState(""),[H,Q]=t.useState(!1),[V,G]=t.useState(null),J=S({api:`${e.getAllDepartmentMstr}?page=${_}&limit=${F}&q=${I}`,key:"getAllDepartmentMstr",value:[_,F],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(P,{open:q,setOpen:O,title:H?"Edit Employee Type":"Add Employee Type",id:R,edit:H,setEdit:Q,refetch:null==J?void 0:J.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(p,{search:I,setSearch:Y,refetch:null==J?void 0:J.refetch,isFetching:null==J?void 0:J.isLoading})}),a.jsx("div",{children:a.jsx(l,{className:"flex items-center gap-2",onClick:()=>O(!0),children:"Add New"})})]}),a.jsxs(o,{children:[a.jsx(c,{className:"px-7",children:a.jsxs(m,{children:["Department List (",null==(w=null==(r=null==J?void 0:J.data)?void 0:r.pagination)?void 0:w.total,")"]})}),a.jsx(u,{children:(null==J?void 0:J.isLoading)?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(D,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(j,{children:[a.jsx(h,{children:a.jsxs(x,{children:[a.jsx(v,{className:"",children:"#"}),a.jsx(v,{className:"",children:"Department"}),a.jsx(v,{className:"",children:"Created at"}),a.jsx(v,{className:"",children:"Status"}),a.jsx(v,{children:"Action"})]})}),a.jsx(g,{children:null==(M=null==(E=null==J?void 0:J.data)?void 0:E.data)?void 0:M.map((t,r)=>a.jsxs(x,{children:[a.jsx(f,{children:r+1}),a.jsx(f,{children:null==t?void 0:t.department_name}),a.jsx(f,{children:d(null==t?void 0:t.created_at).format("DD-MM-YYYY")}),a.jsx(f,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(B,{checked:1==(null==t?void 0:t.status),onChange:()=>(async t=>{var a,l,r,d;G(t);try{const n=await A.mutateAsync({api:`${null==(a=e)?void 0:a.toggleDepartmentMstr}`,data:{id:s(String(t))}});(null==(l=null==n?void 0:n.data)?void 0:l.success)?(null==J||J.refetch(),i.success(null==(r=null==n?void 0:n.data)?void 0:r.message)):i.error(null==(d=n.data)?void 0:d.message)}catch(o){i.error(n(o))}finally{G(null)}})(String(null==t?void 0:t.id)),disabled:V===String(null==t?void 0:t.id),className:((null==t?void 0:t.status)?"bg-primary":"bg-gray-200")+" relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50",children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:((null==t?void 0:t.status)?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white"})]}),V===String(null==t?void 0:t.id)&&a.jsx($,{className:"h-4 w-4 animate-spin text-primary"})]})}),a.jsx(f,{children:a.jsx(l,{className:"bg-primary",onClick:()=>{return e=String(null==t?void 0:t.id),Q(!0),O(!0),void z(e);var e},children:"Edit"})})]},null==t?void 0:t.id))})]}),a.jsx(N,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(b,{page:_,limit:F,totalPages:null==(k=null==(L=null==J?void 0:J.data)?void 0:L.pagination)?void 0:k.totalPages,setPage:C,setLimit:T})})]})})]})]})]})}function I(){return a.jsx(r,{title:"Department List",subTitle:"Manage all the Departments here",children:a.jsx(T,{})})}export{I as default};
