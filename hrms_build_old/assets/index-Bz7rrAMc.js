import{k as e,C as a,f as l,r as s,j as t,z as i,e as r,B as d}from"./index-CaGgFSeq.js";import{P as n}from"./index-_Ebnz7ZO.js";import{C as p,a as c,d as o,b as m,c as u}from"./card-DpoqoWLt.js";import{T as x,a as h,b as f,c as y,d as j,e as g}from"./table-Cx7GlPK-.js";import{u as b,b as _}from"./useCustomQuery-kAcgaiYY.js";import{S as v}from"./separator-BjkNEWW3.js";import{S as N}from"./Spinner-qexXCl2s.js";import{a as k,o as S,c as w,d as E,f as M,b as T}from"./yup-CKEuqCyz.js";import{F as C}from"./datetime-picker-BtprqcV1.js";import{R as F}from"./RHFTextField-DnsEykRH.js";import{B as A}from"./ButtonLoading-B22z2lRV.js";import{R as P}from"./RHFSelectField-XaTdgr7j.js";import"./input-D-UmUPn3.js";import"./switch-Dzwmyki0.js";import{R}from"./RHFCheckbox-Ma2BiBD9.js";import{D}from"./index-atwvxgXU.js";import{L as I}from"./label-CInbbuF8.js";import{E as O}from"./employeeTypes-BSpBpKLh.js";import{I as B}from"./info-BkVOitQw.js";import{C as H}from"./circle-alert-2e3QFMXj.js";import{B as L}from"./badge-BIrBucNW.js";import{U as $}from"./users-D_1I5uef.js";import"./select-CIf9vlQt.js";import"./check-DrWmecxK.js";import"./calendar-B5etLz2h.js";import"./format-BkNqQ0tt.js";import"./chevron-right-CSfpr0N3.js";import"./clock-B2whL4Nd.js";import"./checkbox-BzF0hRJq.js";
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),z=[{value:"daily",label:"Daily Wage",description:"Calculate salary based on daily rate and working days"},{value:"contractual",label:"Contractual",description:"Fixed consolidated salary, simpler calculation"},{value:"monthly",label:"Monthly (Regular)",description:"Full salary structure with DA, HRA, and all allowances"}],V={daily:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",contractual:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",monthly:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},W=w().shape({emp_type:T().required("Employee type is required").oneOf(["permanent","contractual","daily_wage","consultant"],"Invalid employee type"),salary_mode:T().required("Salary mode is required").oneOf(["daily","contractual","monthly"],"Invalid salary mode"),default_tds_type:T().oneOf(["slab","flat"]).default("slab"),default_flat_tds_rate:M().default(10),default_pf_applicable:E().default(!0),default_esi_applicable:E().default(!0),default_pt_applicable:E().default(!0),description:T().nullable(),priority:M().default(10),is_active:E().default(!0)});function U({open:e,setOpen:d,title:n,id:p,edit:c,setEdit:o,refetch:m}){const u=b({}),{data:x,isFetching:h}=_({api:`${a.getEmpTypeSalaryMapping}?id=${l(String(p))}`,key:"getEmpTypeMappingById",value:[p],options:{enabled:c&&null!==p}}),f=(null==x?void 0:x.data)&&x.data.length>0?x.data[0]:null,y=s.useMemo(()=>({emp_type:(null==f?void 0:f.emp_type)||"permanent",salary_mode:(null==f?void 0:f.salary_mode)||"monthly",default_tds_type:(null==f?void 0:f.default_tds_type)||"slab",default_flat_tds_rate:Number(null==f?void 0:f.default_flat_tds_rate)||10,default_pf_applicable:(null==f?void 0:f.default_pf_applicable)??!0,default_esi_applicable:(null==f?void 0:f.default_esi_applicable)??!0,default_pt_applicable:(null==f?void 0:f.default_pt_applicable)??!0,description:(null==f?void 0:f.description)||"",priority:(null==f?void 0:f.priority)||10,is_active:1===(null==f?void 0:f.status)}),[f]),j=k({defaultValues:y,resolver:S(W)}),g=j.watch("salary_mode");s.useEffect(()=>{j.reset(y)},[y,j]);const N=z.find(e=>e.value===g);return t.jsx(D,{open:e,setOpen:d,title:n,setEdit:o,edit:c,isLoading:h,children:t.jsx(C,{methods:j,onSubmit:j.handleSubmit(async e=>{var l,s,t;try{const r=await u.mutateAsync({api:a.upsertEmpTypeSalaryMapping,data:{...c&&p?{id:Number(p)}:{},emp_type:e.emp_type,salary_mode:e.salary_mode,default_tds_type:e.default_tds_type,default_flat_tds_rate:e.default_flat_tds_rate,default_pf_applicable:e.default_pf_applicable,default_esi_applicable:e.default_esi_applicable,default_pt_applicable:e.default_pt_applicable,description:e.description||null,priority:e.priority,status:e.is_active?1:0}});(null==(l=r.data)?void 0:l.success)?(i.success((null==(s=null==r?void 0:r.data)?void 0:s.message)||`Employee type mapping ${c?"updated":"created"} successfully`),d(!1),null==o||o(!1),null==m||m(),j.reset({emp_type:"permanent",salary_mode:"monthly",default_tds_type:"slab",default_flat_tds_rate:10,default_pf_applicable:!0,default_esi_applicable:!0,default_pt_applicable:!0,description:"",priority:10,is_active:!0})):i.error((null==(t=r.data)?void 0:t.message)||"Failed to save mapping")}catch(n){i.error(r(n))}}),children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx(I,{className:"mb-3 block text-base font-semibold",children:"Employee Type"}),t.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Select the employee type to configure"}),t.jsx("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:t.jsx("div",{children:t.jsx(P,{name:"emp_type",label:"Employee Type",data:O})})})]}),t.jsx(v,{}),t.jsxs("div",{children:[t.jsx(I,{className:"flex items-center gap-2 text-base font-semibold",children:"Salary Calculation Mode"}),t.jsx("p",{className:"mb-4 mt-1 text-sm text-muted-foreground",children:"Choose how salary should be calculated for this employee type"}),t.jsx("div",{className:"grid grid-cols-1 gap-3",children:z.map(e=>t.jsxs("label",{className:`\n                    flex cursor-pointer items-start gap-3 rounded-lg border-2 p-4 transition-all\n                    ${g===e.value?"border-primary bg-primary/5":"border-border hover:border-primary/50"}\n                  `,children:[t.jsx("input",{type:"radio",value:e.value,checked:g===e.value,onChange:e=>j.setValue("salary_mode",e.target.value),className:"mt-1"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:e.label}),t.jsx("div",{className:"text-sm text-muted-foreground",children:e.description})]})]},e.value))})]}),N&&t.jsxs("div",{className:"flex items-start gap-2 rounded-lg bg-blue-50 p-3 dark:bg-blue-950",children:[t.jsx(B,{className:"mt-0.5 h-4 w-4 text-blue-600"}),t.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:["daily"===g&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Daily Wage:"})," Salary = (Daily Rate × Working Days). Limited allowances apply. Simpler tax calculations."]}),"contractual"===g&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Contractual:"})," Fixed consolidated salary per month. Pro-rated for partial months. Minimal deductions."]}),"monthly"===g&&t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Monthly:"})," Full salary structure with Basic + Grade Pay + DA + HRA + all applicable allowances. Complete PF/NPS, ESI, and IT deductions apply."]})]})]}),t.jsx(v,{}),t.jsxs("div",{children:[t.jsx(I,{className:"mb-3 block text-base font-semibold",children:"Default Statutory Deductions"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(R,{name:"default_pf_applicable",label:"PF Applicable"}),t.jsx(R,{name:"default_esi_applicable",label:"ESI Applicable"}),t.jsx(R,{name:"default_pt_applicable",label:"PT Applicable"})]})]}),t.jsx(v,{}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx("div",{children:t.jsx(F,{name:"priority",label:"Priority",type:"number",placeholder:"Higher = checked first"})}),t.jsx("div",{children:t.jsx(F,{name:"description",label:"Description",placeholder:"Optional notes"})}),t.jsx("div",{className:"flex items-end",children:t.jsx(R,{name:"is_active",label:"Active"})})]}),c&&t.jsxs("div",{className:"flex items-start gap-2 rounded-lg bg-amber-50 p-3 dark:bg-amber-950",children:[t.jsx(H,{className:"mt-0.5 h-4 w-4 text-amber-600"}),t.jsxs("div",{className:"text-sm text-amber-800 dark:text-amber-200",children:[t.jsx("strong",{children:"Warning:"})," Changing the salary mode for an existing employee type will affect salary calculations for all employees of this type."]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(A,{type:"submit",isLoading:u.isPending,children:c?"Update Mapping":"Add Mapping"})})]})})})}function Q(){var e,l,i,r,n;const[b,k]=s.useState(!1),[S,w]=s.useState(null),[E,M]=s.useState(!1),T=_({api:a.getAllEmpTypeSalaryMappings,key:"getAllEmpTypeSalaryMappings",options:{enabled:!0}}),C=()=>{M(!1),w(null),k(!0)},F=null==(l=null==(e=T.data)?void 0:e.data)?void 0:l.reduce((e,a)=>{const l=a.salary_mode;return e[l]||(e[l]=[]),e[l].push(a),e},{});return t.jsxs("main",{className:"grid items-start",children:[t.jsx(U,{open:b,setOpen:k,title:E?"Edit Employee Type Mapping":"Add Employee Type Mapping",id:S,edit:E,setEdit:M,refetch:T.refetch}),t.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[t.jsxs("div",{className:"flex w-full flex-wrap justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx($,{className:"h-5 w-5 text-muted-foreground"}),t.jsxs("span",{className:"text-lg font-medium",children:[(null==(r=null==(i=T.data)?void 0:i.data)?void 0:r.length)||0," Employee Types Configured"]})]}),t.jsxs(d,{className:"flex items-center gap-2",onClick:C,children:[t.jsx(q,{className:"h-4 w-4"}),"Add Mapping"]})]}),t.jsx(v,{}),t.jsxs("div",{className:"flex items-start gap-2 rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-800 dark:bg-amber-950",children:[t.jsx(B,{className:"mt-0.5 h-5 w-5 text-amber-600"}),t.jsxs("div",{className:"text-sm text-amber-800 dark:text-amber-200",children:[t.jsx("strong",{children:"Important:"})," This mapping determines which salary calculation formula and allowance set is used for each employee type. Changing this affects how salaries are computed for all employees of that type."]})]}),F&&Object.keys(F).length>0&&t.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:z.map(e=>{var a,l;const s=(null==(a=F[e.value])?void 0:a.length)||0;return t.jsxs(p,{className:"relative overflow-hidden",children:[t.jsx("div",{className:`absolute left-0 top-0 h-full w-1 ${null==(l=V[e.value])?void 0:l.split(" ")[0]}`}),t.jsxs(c,{className:"pb-2",children:[t.jsx(o,{className:"text-lg",children:e.label}),t.jsx(m,{className:"text-xs",children:e.description})]}),t.jsxs(u,{children:[t.jsx("div",{className:"text-3xl font-bold",children:s}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["employee type",1!==s?"s":""]})]})]},e.value)})}),t.jsxs(p,{children:[t.jsxs(c,{children:[t.jsxs(o,{className:"flex items-center gap-2",children:[t.jsx(q,{className:"h-5 w-5"}),"Employee Type to Salary Mode Mappings"]}),t.jsx(m,{children:"Map each employee type to its corresponding salary calculation mode"})]}),t.jsx(u,{children:(null==T?void 0:T.isLoading)?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(N,{})}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(x,{children:[t.jsx(h,{children:t.jsxs(f,{children:[t.jsx(y,{className:"w-[60px]",children:"Priority"}),t.jsx(y,{children:"Employee Type / Pattern"}),t.jsx(y,{children:"Salary Mode"}),t.jsx(y,{children:"PF"}),t.jsx(y,{children:"ESI"}),t.jsx(y,{children:"PT"}),t.jsx(y,{children:"Status"}),t.jsx(y,{children:"Actions"})]})}),t.jsx(j,{children:(null==(n=null==T?void 0:T.data)?void 0:n.data)&&T.data.data.length>0?T.data.data.map(e=>{return t.jsxs(f,{children:[t.jsx(g,{className:"font-mono text-sm",children:e.priority}),t.jsx(g,{className:"font-medium",children:e.emp_type_label||e.emp_type}),t.jsx(g,{children:t.jsx(L,{className:V[e.salary_mode]||"bg-gray-100 text-gray-800",children:(a=e.salary_mode,(null==(l=z.find(e=>e.value===a))?void 0:l.label)||a)})}),t.jsx(g,{children:t.jsx("span",{className:e.default_pf_applicable?"text-green-600":"text-red-600",children:e.default_pf_applicable?"✓":"✗"})}),t.jsx(g,{children:t.jsx("span",{className:e.default_esi_applicable?"text-green-600":"text-red-600",children:e.default_esi_applicable?"✓":"✗"})}),t.jsx(g,{children:t.jsx("span",{className:e.default_pt_applicable?"text-green-600":"text-red-600",children:e.default_pt_applicable?"✓":"✗"})}),t.jsx(g,{children:t.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold "+(1===e.status?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"),children:1===e.status?"Active":"Inactive"})}),t.jsx(g,{children:t.jsx(d,{variant:"outline",size:"sm",onClick:()=>{return a=e.id,M(!0),w(a),void k(!0);var a},children:"Edit"})})]},e.id);var a,l}):t.jsx(f,{children:t.jsx(g,{colSpan:8,className:"py-8 text-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("p",{className:"text-muted-foreground",children:"No employee type mappings configured"}),t.jsx(d,{variant:"outline",size:"sm",onClick:C,children:"Add First Mapping"})]})})})})]})})})]})]})]})}function X(){return t.jsx(n,{title:"Employee Type Salary Mapping",subTitle:"Configure how each employee type maps to salary calculation mode",children:t.jsx("div",{className:"py-12",children:t.jsx(Q,{})})})}export{X as default};
