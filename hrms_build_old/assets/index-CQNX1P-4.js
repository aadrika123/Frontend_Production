import{m as e,r,q as t,h as s,f as a,j as d,z as l}from"./index-UYY99J9q.js";import{a as i,C as o,P as n}from"./index-Dj741qwl.js";import{u as c,b as x}from"./useCustomQuery-Dp3AX7R2.js";import{P as m}from"./pen-Dsze3v8c.js";import{T as b}from"./trash-2-f5kaasTb.js";const g=()=>{var n,g,y,h,u,p,f,j,v,N,w,k,D,S;const[_]=e(),A=c({}),C=_.get("department_id"),[W,O]=r.useState(null),L=i(),[T,F]=r.useState(C),I=t(),M=x({api:`${null==(n=s)?void 0:n.getAllWeekOffsByDepartment}?department_id=${a(String(T))}`,value:[T],options:{enabled:!!T}}),P={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"},$=r.useMemo(()=>{var e;return(null==(e=null==M?void 0:M.data)?void 0:e.data)?M.data.data.reduce((e,r)=>(e[r.day_off]||(e[r.day_off]=[]),e[r.day_off].push(r),e),{}):{}},[null==(g=null==M?void 0:M.data)?void 0:g.data]),z=r.useMemo(()=>$?Object.keys($).map(Number).sort((e,r)=>e-r):[],[$]),R=W?$[W]:null==(y=null==M?void 0:M.data)?void 0:y.data;return d.jsx("div",{className:"min-h-screen bg-gray-100",children:d.jsxs("div",{children:[d.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[d.jsx("div",{className:"border-b border-gray-300 bg-purple-50 px-4 py-3",children:d.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Select Department"})}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("div",{className:"p-4",children:[d.jsxs("select",{value:T||"",onChange:e=>F(e.target.value),className:"w-full max-w-xs border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"Select Department"}),null==(h=null==L?void 0:L.data)?void 0:h.data.map(e=>d.jsx("option",{value:String(e.id),children:e.department_name},e.id))]}),T&&d.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected:"," ",d.jsx("span",{className:"font-semibold",children:(null==(p=null==(u=null==L?void 0:L.data)?void 0:u.data.find(e=>String(e.id)===T))?void 0:p.department_name)||"N/A"})]})]}),d.jsx("div",{className:"p-4",children:d.jsx("button",{onClick:()=>I("/hrms/dashboard/create-weekly-off"),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:"Add Weekly Off"})})]})]}),(null==M?void 0:M.isLoading)&&d.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:d.jsx("div",{className:"text-gray-600",children:"Loading day off records..."})}),!T&&!(null==M?void 0:M.isLoading)&&d.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:d.jsx("div",{className:"text-gray-600",children:"Please select a department to view day off schedules"})}),T&&!(null==M?void 0:M.isLoading)&&0===(null==(j=null==(f=null==M?void 0:M.data)?void 0:f.data)?void 0:j.length)&&d.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:d.jsx("div",{className:"text-gray-600",children:"No day off records found for this department"})}),T&&!(null==M?void 0:M.isLoading)&&(null==(N=null==(v=null==M?void 0:M.data)?void 0:v.data)?void 0:N.length)>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[d.jsx("div",{className:"border-b border-gray-300 bg-blue-50 px-4 py-3",children:d.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Filter by Day"})}),d.jsx("div",{className:"p-4",children:d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsxs("button",{onClick:()=>O(null),className:"border px-4 py-2 font-medium "+(null===W?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:["All Days (",null==(k=null==(w=null==M?void 0:M.data)?void 0:w.data)?void 0:k.length,")"]}),z.map(e=>{var r;return d.jsxs("button",{onClick:()=>O(e),className:"border px-4 py-2 font-medium "+(W===e?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[P[e]," (",null==(r=$[e])?void 0:r.length,")"]},e)})]})})]}),d.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[d.jsx("div",{className:"border-b border-gray-300 bg-green-50 px-4 py-3",children:d.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Summary"})}),d.jsx("div",{className:"p-4",children:d.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[d.jsxs("div",{className:"border border-gray-300 bg-blue-50 p-3",children:[d.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Total Records"}),d.jsx("div",{className:"text-2xl font-bold text-gray-800",children:null==R?void 0:R.length})]}),d.jsxs("div",{className:"border border-gray-300 bg-green-50 p-3",children:[d.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Days Scheduled"}),d.jsx("div",{className:"text-2xl font-bold text-gray-800",children:null==z?void 0:z.length})]}),d.jsxs("div",{className:"border border-gray-300 bg-yellow-50 p-3",children:[d.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Department ID"}),d.jsx("div",{className:"text-2xl font-bold text-gray-800",children:(null==(S=null==(D=null==M?void 0:M.data)?void 0:D.data[0])?void 0:S.department_name)||"N/A"})]})]})})]}),d.jsxs("div",{className:"border border-gray-300 bg-white",children:[d.jsx("div",{className:"border-b border-gray-300 bg-blue-900 px-4 py-3 text-white",children:d.jsx("h2",{className:"text-lg font-semibold",children:W?`${P[W]} Schedule`:"All Day Off Records"})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b-2 border-gray-400 bg-gray-200",children:[d.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"S.No"}),d.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Day Off"}),d.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Week Number"}),d.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Department Name"}),d.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),d.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Created Date"}),d.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Action"})]})}),d.jsx("tbody",{children:null==R?void 0:R.map((e,r)=>d.jsxs("tr",{className:`border-b border-gray-300 ${r%2==0?"bg-white":"bg-gray-50"} hover:bg-blue-50`,children:[d.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:r+1}),d.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:[d.jsx("span",{className:"font-medium",children:P[e.day_off]}),d.jsxs("span",{className:"ml-1 text-gray-500",children:["(",e.day_off,")"]})]}),d.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:["Week ",e.week_number]}),d.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:null==e?void 0:e.department_name}),d.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm",children:d.jsx("span",{className:"inline-block border border-green-300 bg-green-100 px-2 py-1 text-xs font-semibold text-green-800",children:1===e.status?"Active":"Inactive"})}),d.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:new Date(e.created_at).toLocaleDateString("en-IN")}),d.jsx("td",{className:"px-4 py-3 text-sm",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"button",onClick:()=>{l.error("Edit functionality is not implemented yet.")},className:"rounded p-1.5 text-blue-600 hover:bg-blue-100",title:"Edit",children:d.jsx(m,{size:18})}),d.jsx("button",{onClick:()=>{return r=e.id,void o("Are you sure you want to delete this weekly off?","Please confirm",async()=>{var e,t,a;try{const d=await A.mutateAsync({api:s.deleteWeekOffById,data:{id:r}});(null==(e=d.data)?void 0:e.success)?(l.success((null==(t=null==d?void 0:d.data)?void 0:t.message)||"Weekly off deleted successfully"),M.refetch()):l.error((null==(a=d.data)?void 0:a.message)||"Failed to delete weekly off")}catch(d){l.error("An error occurred while deleting weekly off")}});var r},className:"rounded p-1.5 text-red-600 hover:bg-red-100",title:"Delete",children:d.jsx(b,{size:18})})]})})]},e.id))})]})}),d.jsx("div",{className:"border-t border-gray-300 bg-gray-100 px-4 py-3",children:d.jsxs("p",{className:"text-sm text-gray-600",children:["Total Records:"," ",d.jsx("span",{className:"font-semibold",children:null==R?void 0:R.length})]})})]}),!W&&d.jsxs("div",{className:"mt-6 border border-gray-300 bg-white",children:[d.jsx("div",{className:"border-b border-gray-300 bg-orange-50 px-4 py-3",children:d.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Day-wise Distribution"})}),d.jsx("div",{className:"p-4",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b border-gray-300 bg-gray-200",children:[d.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Day"}),d.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Total Schedules"}),d.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Weeks Covered"})]})}),d.jsx("tbody",{children:z.map((e,r)=>{const t=$[e],s=t.map(e=>e.week_number).sort((e,r)=>e-r);return d.jsxs("tr",{className:"border-b border-gray-300 "+(r%2==0?"bg-white":"bg-gray-50"),children:[d.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm font-medium text-gray-800",children:P[e]}),d.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:null==t?void 0:t.length}),d.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:s.join(", ")})]},e)})})]})})]})]})]})})};function y(){return d.jsx(n,{title:"Weekly Off List",subTitle:"Manage all the Weekly Off schedules here",children:d.jsx("div",{className:"py-2",children:d.jsx(g,{})})})}export{y as default};
