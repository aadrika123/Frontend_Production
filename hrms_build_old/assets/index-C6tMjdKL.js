import{i as H,r as h,j as e,h as E,z as P,B as v,L as O,k as $,e as q}from"./index-Df4ChAN-.js";import{P as z}from"./index-DjNjGvXo.js";import{C as B,a as Y,b as L,c as A,h as I}from"./card-CW8LZ2r1.js";import{S as D,T as G,a as J,b as R,c as f,d as K,e as x}from"./index-Tosm5l2v.js";import{u as Q,b as V}from"./useCustomQuery-BBKf_waA.js";import{S as U,a as W}from"./Spinner-CyN74T25.js";import{a as X,o as Z,c as ee,d as se,b as w,e as F}from"./yup-pPl0eVQc.js";import{F as ae,B as re}from"./datetime-picker-EqBIIAIP.js";import{R as g}from"./RHFTextField-C5PfVKXx.js";import{R as ie}from"./RHFTextArea-bqK8EsA9.js";import{R as oe}from"./RHFSelectField-Cy0QtYHL.js";import"./select-DZKz6XPY.js";import{R as ne}from"./RHFCheckbox-DRpCJmEz.js";import{D as de}from"./index-D4JNSpYb.js";import"./calendar-CMNTAmai.js";import"./clock-BxgzxCOp.js";import"./check-BzewUJFq.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=H("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),te=[{label:"7th CPC",value:"7th_cpc"},{label:"6th CPC",value:"6th_cpc"},{label:"5th CPC",value:"5th_cpc"},{label:"Custom",value:"custom"}],le=ee().shape({commission_name:w().required("Commission Name is required"),commission_type:w().required("Commission Type is required"),effective_from:F().required("Effective From date is required"),effective_to:F().nullable(),government_order_no:w().required("Government Order No is required"),government_order_date:F().required("Government Order Date is required"),description:w().required("Description is required"),is_matrix_based:se().default(!1)});function me({open:M,setOpen:y,title:k,id:p,edit:m,setEdit:b,refetch:N}){var u;const _=Q({}),{data:a,isFetching:C}=V({api:`${(u=E)==null?void 0:u.getPayCommissionById}?id=${p}`,key:"getPayCommissionById",options:{enabled:!!m}}),r=X({defaultValues:{commission_name:"",commission_type:"",effective_from:void 0,effective_to:void 0,government_order_no:"",government_order_date:void 0,description:"",is_matrix_based:!1},resolver:Z(le)}),S=async o=>{var d,c,t,l,s,n,j,T;try{if(m&&o){const i=await _.mutateAsync({api:`${(d=E)==null?void 0:d.updatePayCommissionById}`,data:{id:p,...o}});(c=i.data)!=null&&c.success?P.success((t=i==null?void 0:i.data)==null?void 0:t.message):P.error(((l=i.data)==null?void 0:l.message)||"Pay Commission not updated successfully")}else{const i=await _.mutateAsync({api:(s=E)==null?void 0:s.createPayCommission,data:o});(n=i.data)!=null&&n.success?P.success((j=i==null?void 0:i.data)==null?void 0:j.message):P.error(((T=i.data)==null?void 0:T.message)||"Pay Commission not created successfully"),r.reset({commission_name:"",commission_type:"",effective_from:void 0,effective_to:void 0,government_order_no:"",government_order_date:void 0,description:"",is_matrix_based:!1})}y(!1),b(!1),N()}catch(i){console.log(i)}};return h.useEffect(()=>{var o,d,c,t,l,s,n,j;m&&(a!=null&&a.data)?r.reset({commission_name:((o=a==null?void 0:a.data)==null?void 0:o.commission_name)||"",commission_type:((d=a==null?void 0:a.data)==null?void 0:d.commission_type)||"",effective_from:((c=a==null?void 0:a.data)==null?void 0:c.effective_from)||void 0,effective_to:((t=a==null?void 0:a.data)==null?void 0:t.effective_to)||void 0,government_order_no:((l=a==null?void 0:a.data)==null?void 0:l.government_order_no)||"",government_order_date:((s=a==null?void 0:a.data)==null?void 0:s.government_order_date)||void 0,description:((n=a==null?void 0:a.data)==null?void 0:n.description)||"",is_matrix_based:((j=a==null?void 0:a.data)==null?void 0:j.is_matrix_based)||!1}):r.reset({commission_name:"",commission_type:"",effective_from:void 0,effective_to:void 0,government_order_no:"",government_order_date:void 0,description:"",is_matrix_based:!1})},[m,a,r]),h.useEffect(()=>{r.watch("commission_type")=="7th_cpc"&&r.setValue("is_matrix_based",!0),r.watch("commission_type")=="6th_cpc"&&r.setValue("is_matrix_based",!1)},[r.watch("commission_type")]),e.jsx(de,{open:M,setOpen:y,title:k,setEdit:b,edit:m,isLoading:C,children:e.jsx(ae,{methods:r,onSubmit:r.handleSubmit(S),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(g,{name:"commission_name",placeholder:"Enter Commission Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(oe,{name:"commission_type",data:te})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[e.jsx(g,{type:"date",name:"effective_from",placeholder:"Effective From"}),e.jsx(g,{type:"date",name:"effective_to",placeholder:"Effective To (Optional)"})]}),e.jsx("div",{children:e.jsx(g,{name:"government_order_no",placeholder:"Enter Government Order No"})}),e.jsx("div",{children:e.jsx(g,{type:"date",name:"government_order_date",placeholder:"Government Order Date"})}),e.jsx("div",{children:e.jsx(ie,{name:"description",placeholder:"Enter description",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(ne,{disabled:r.watch("commission_type")!=="custom",name:"is_matrix_based",label:"Is Matrix Based Pay Structure"})}),e.jsx(U,{}),e.jsx("div",{children:e.jsx(re,{isLoading:r.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function xe(){var u,o,d,c,t,l;const[M,y]=h.useState(""),[k,p]=h.useState(!1),[m,b]=h.useState(""),[N,_]=h.useState(!1),[a,C]=h.useState("list"),r=V({api:`${E.getAllPayCommissions}`,key:"getAllPayCommissions",options:{enabled:!0}}),S=s=>{_(!0),p(!0),b(s)};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(me,{open:k,setOpen:p,title:N?"Edit Pay Commission":"Add Pay Commission",id:m,edit:N,setEdit:_,refetch:r.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(D,{search:M,setSearch:y,refetch:r.refetch,isFetching:r==null?void 0:r.isLoading})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex rounded-lg border",children:[e.jsxs(v,{variant:a==="list"?"default":"ghost",size:"sm",onClick:()=>C("list"),className:"rounded-r-none",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"List"]}),e.jsxs(v,{variant:a==="chart"?"default":"ghost",size:"sm",onClick:()=>C("chart"),className:"rounded-l-none",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Chart"]})]}),e.jsx(v,{className:"flex items-center gap-2",onClick:()=>p(!0),children:"Add New"})]})]}),e.jsxs(B,{children:[e.jsx(Y,{className:"px-7",children:e.jsxs(L,{children:["Employee Type List (",(o=(u=r==null?void 0:r.data)==null?void 0:u.pagination)==null?void 0:o.total,")"]})}),e.jsx(A,{children:r.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(W,{})}):e.jsx(e.Fragment,{children:a==="list"?e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(R,{children:[e.jsx(f,{className:"",children:"#"}),e.jsx(f,{className:"",children:"Pay Commission"}),e.jsx(f,{className:"",children:"Description"}),e.jsx(f,{className:"",children:"Is Matrix"}),e.jsx(f,{className:"",children:"Created at"}),e.jsx(f,{children:"Action"})]})}),e.jsx(K,{children:(c=(d=r==null?void 0:r.data)==null?void 0:d.data)==null?void 0:c.map((s,n)=>e.jsxs(R,{children:[e.jsx(x,{children:n+1}),e.jsx(x,{children:s==null?void 0:s.commission_name}),e.jsx(x,{children:s==null?void 0:s.description}),e.jsx(x,{children:s!=null&&s.is_matrix_based?"Yes":"No"}),e.jsx(x,{children:I(s==null?void 0:s.created_at).format("DD-MM-YYYY")}),e.jsx(x,{children:e.jsx(v,{className:"bg-primary",onClick:()=>S(String(s==null?void 0:s.id)),children:"Edit"})}),e.jsx(x,{children:e.jsx($,{className:"rounded-lg bg-green-600 px-4 py-2 text-white",to:`pay-level?commission_id=${q(String(s==null?void 0:s.id))}&is_matrix_based=${s==null?void 0:s.is_matrix_based}&commission_name=${s==null?void 0:s.commission_name}`,children:"View Levels"})})]},s==null?void 0:s.id))})]}):e.jsx("div",{className:"space-y-6",children:(l=(t=r==null?void 0:r.data)==null?void 0:t.data)==null?void 0:l.map((s,n)=>e.jsxs(B,{className:"border-2",children:[e.jsx(Y,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s==null?void 0:s.commission_name}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:s==null?void 0:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{size:"sm",className:"bg-primary",onClick:()=>S(String(s==null?void 0:s.id)),children:"Edit"}),e.jsx($,{className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm text-white",to:`pay-level?commission_id=${q(String(s==null?void 0:s.id))}&is_matrix_based=${s==null?void 0:s.is_matrix_based}&commission_name=${s==null?void 0:s.commission_name}`,children:"View Levels"})]})]})}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Index:"}),e.jsx("span",{className:"ml-2 font-medium",children:n+1})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Matrix Based:"}),e.jsx("span",{className:"ml-2 font-medium",children:s!=null&&s.is_matrix_based?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2 font-medium",children:I(s==null?void 0:s.created_at).format("DD-MM-YYYY")})]})]})})]},s==null?void 0:s.id))})})})]})]})]})}function ke(){return e.jsx(z,{title:"Pay Commission",subTitle:"Manage all the Pay Commissions here",children:e.jsx("div",{className:"py-12",children:e.jsx(xe,{})})})}export{ke as default};
