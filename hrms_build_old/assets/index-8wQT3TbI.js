import{i as Z,r as y,j as e,h as $,z as F,l as D,m as L,B as T,L as ee,k as Q,e as W}from"./index-Df4ChAN-.js";import{P as se}from"./index-DjNjGvXo.js";import{C as Y,a as U,c as O,b as ae,h as re}from"./card-CW8LZ2r1.js";import{S as ne,T as de,a as le,b as J,c as p,d as ce,e as o}from"./index-Tosm5l2v.js";import{u as ie,b as K}from"./useCustomQuery-BBKf_waA.js";import{S as oe,a as te}from"./Spinner-CyN74T25.js";import{a as xe,o as pe,c as X,b as R,f as h}from"./yup-pPl0eVQc.js";import{F as he,B as me}from"./datetime-picker-EqBIIAIP.js";import{R as j}from"./RHFTextField-C5PfVKXx.js";import{R as ue}from"./RHFTextArea-bqK8EsA9.js";import"./select-DZKz6XPY.js";import{D as ye}from"./index-D4JNSpYb.js";import{P as be}from"./pen-Bes7sZ4Y.js";import{E as _e}from"./eye-DyUxIdcn.js";import"./calendar-CMNTAmai.js";import"./clock-BxgzxCOp.js";import"./check-BzewUJFq.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=Z("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),ge=X().shape({pay_commission_id:h().required("Pay Commission is required"),level:h().required("Level is required").positive("Level must be positive"),level_name:R().required("Level Name is required"),min_basic_pay:h().required("Minimum Basic Pay is required").positive("Must be positive"),max_basic_pay:h().required("Maximum Basic Pay is required").positive("Must be positive"),description:R().required("Description is required")}),fe=X().shape({pay_commission_id:h().required("Pay Commission is required"),level:h().required("Level is required").positive("Level must be positive"),level_name:R().required("Level Name is required"),min_basic_pay:h().required("Minimum Basic Pay is required").positive("Must be positive"),max_basic_pay:h().required("Maximum Basic Pay is required").positive("Must be positive"),pay_band_name:R().required("Pay Band Name is required"),grade_pay:h().required("Grade Pay is required").positive("Must be positive"),description:R().nullable()});function Ne({open:g,setOpen:b,title:c,id:V,edit:t,setEdit:I,isMatrixBased:z,payCommissionId:x,payLevelListData:d}){var N,v,P,S,M;const G=ie({}),i=z==="true"||z==="1",{data:m,isFetching:f}=K({api:`${(N=$)==null?void 0:N.getPayLevelById}?id=${V}`,key:"getPayLevelById",options:{enabled:!!t}}),u=d!=null&&d.data&&((P=(v=d==null?void 0:d.data)==null?void 0:v.data)==null?void 0:P.length)>0?Math.max(...(M=(S=d==null?void 0:d.data)==null?void 0:S.data)==null?void 0:M.map(r=>r==null?void 0:r.level))+1:0,a={pay_commission_id:x?Number(x):0,level:0,level_name:"",min_basic_pay:0,max_basic_pay:0,description:""},_={pay_commission_id:x?Number(x):0,level:0,level_name:"",min_basic_pay:0,max_basic_pay:0,pay_band_name:"",grade_pay:0,description:""},n=xe({defaultValues:i?a:_,resolver:pe(i?ge:fe)}),H=async r=>{var q,B,w,C,k,E,A,s;try{if(t&&r){const l=await G.mutateAsync({api:`${(q=$)==null?void 0:q.updatePayLevel}`,data:{id:V,pay_commission_id:r.pay_commission_id,level:r.level,level_name:r.level_name,min_basic_pay:r.min_basic_pay,max_basic_pay:r.max_basic_pay,...!i&&{pay_band_name:r.pay_band_name,pay_band_min:r.min_basic_pay,pay_band_max:r.min_basic_pay,grade_pay:r.grade_pay},description:r.description}});(B=l.data)!=null&&B.success?F.success((w=l==null?void 0:l.data)==null?void 0:w.message):F.error(((C=l.data)==null?void 0:C.message)||"Pay Level not updated successfully")}else{const l=await G.mutateAsync({api:(k=$)==null?void 0:k.createPayLevel,data:{pay_commission_id:r.pay_commission_id,level:u||r.level,level_name:`Level ${u}`||r.level_name,min_basic_pay:r.min_basic_pay,max_basic_pay:r.max_basic_pay,...!i&&{pay_band_name:r.pay_band_name,pay_band_min:r.min_basic_pay,pay_band_max:r.min_basic_pay,grade_pay:r.grade_pay},description:r.description}});(E=l.data)!=null&&E.success?F.success((A=l==null?void 0:l.data)==null?void 0:A.message):F.error(((s=l.data)==null?void 0:s.message)||"Pay Level not created successfully"),n.reset(i?a:_)}b(!1),I(!1),d==null||d.refetch()}catch(l){console.log(l),F.error("An error occurred. Please try again.")}};return y.useEffect(()=>{d!=null&&d.data&&!t&&(n.setValue("level",u),n.setValue("level_name",`Level ${u}`))},[d,t,u,n]),y.useEffect(()=>{t&&(m!=null&&m.data)?n.reset(m.data):n.reset(i?a:_)},[t,m,n]),e.jsx(ye,{open:g,setOpen:b,title:c,setEdit:I,edit:t,isLoading:f,children:e.jsx(he,{methods:n,onSubmit:n.handleSubmit(H),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("input",{type:"hidden",...n.register("pay_commission_id"),value:x||""}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[e.jsx(j,{disabled:!0,type:"number",name:"level",placeholder:"Enter Level"}),e.jsx(j,{disabled:!0,name:"level_name",placeholder:"Enter Level Name",inputValidation:["removeSpecialCharacterExceptSpace"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[e.jsx(j,{type:"number",name:"min_basic_pay",placeholder:"Minimum Basic Pay"}),e.jsx(j,{type:"number",name:"max_basic_pay",placeholder:"Maximum Basic Pay"})]}),!i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(j,{name:"pay_band_name",placeholder:"Enter Pay Band Name (e.g., PB-2)"})}),e.jsx("div",{children:e.jsx(j,{type:"number",name:"grade_pay",placeholder:"Grade Pay"})})]}),e.jsx("div",{children:e.jsx(ue,{name:"description",placeholder:"Enter description",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(oe,{}),e.jsx("div",{children:e.jsx(me,{isLoading:n.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function ve(){var H,N,v,P,S,M,r,q,B,w,C,k,E,A;const[g]=D(),b=g.get("commission_id"),c=g.get("is_matrix_based"),V=g.get("commission_name"),[t,I]=y.useState(""),[z,x]=y.useState(!1),[d,G]=y.useState(""),[i,m]=y.useState(!1),[f,u]=y.useState("chart"),a=K({api:`${(H=$)==null?void 0:H.getAllPayLevels}?pay_commission_id=${b}`,key:"getAllPayLevels",options:{enabled:!!b}});K({api:`${(N=$)==null?void 0:N.getPayLevelById}?id=${d}`,key:"getPayLevelById",value:[d],options:{enabled:!!d}});const _=s=>{m(!0),x(!0),G(s)},n=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s);return e.jsxs("main",{className:"grid items-start",children:[e.jsx(Ne,{open:z,setOpen:x,title:i?"Edit Pay Level":"Add Pay Level",id:d,edit:i,setEdit:m,isMatrixBased:c,payCommissionId:L(b||""),payLevelListData:a}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx(Y,{className:"border-l-4 border-l-blue-500",children:e.jsx(U,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:V}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:c==="true"?"Matrix Based Commission":"Non-Matrix Based Commission"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Total Levels: ",((P=(v=a==null?void 0:a.data)==null?void 0:v.data)==null?void 0:P.length)||0]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(T,{variant:f==="chart"?"default":"outline",size:"sm",onClick:()=>u("chart"),className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Chart View"]}),e.jsxs(T,{variant:f==="list"?"default":"outline",size:"sm",onClick:()=>u("list"),className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"List View"]})]})]})})}),e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ne,{search:t,setSearch:I,refetch:a.refetch,isFetching:a==null?void 0:a.isLoading})}),e.jsx(T,{className:"flex items-center gap-2",onClick:()=>x(!0),children:"Add New Pay Level"})]}),a.isLoading?e.jsx(Y,{children:e.jsx(O,{className:"flex h-64 items-center justify-center",children:e.jsx(te,{})})}):f==="chart"?e.jsxs(Y,{children:[e.jsx(U,{className:"bg-gray-50",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:"PAY SCALE STRUCTURE"})}),e.jsx(O,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-y-2 border-gray-300 bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Level"}),e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Level Name"}),c==="true"?e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Revised Pay Band (Rs.)"}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Pay Band"}),e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Grade Pay (Rs.)"})]}),e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Description"}),e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-center text-sm font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[(M=(S=a==null?void 0:a.data)==null?void 0:S.data)==null?void 0:M.map(s=>e.jsxs("tr",{className:"transition-colors hover:bg-blue-50",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-3",children:e.jsxs("span",{className:"font-bold text-blue-600",children:["Level ",s==null?void 0:s.level]})}),e.jsx("td",{className:"border border-gray-300 px-4 py-3",children:e.jsx("span",{className:"font-medium",children:s==null?void 0:s.level_name})}),c==="true"?e.jsx("td",{className:"border border-gray-300 px-4 py-3",children:e.jsxs("div",{className:"font-medium",children:[n(s==null?void 0:s.min_basic_pay)," -"," ",n(s==null?void 0:s.max_basic_pay)]})}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-3",children:s!=null&&s.pay_band_name?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s==null?void 0:s.pay_band_name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[n((s==null?void 0:s.pay_band_min)||0)," -"," ",n((s==null?void 0:s.pay_band_max)||0)]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"border border-gray-300 px-4 py-3 text-center",children:s!=null&&s.grade_pay?e.jsx("span",{className:"font-semibold",children:n(s==null?void 0:s.grade_pay)}):e.jsx("span",{className:"text-gray-400",children:"-"})})]}),e.jsx("td",{className:"border border-gray-300 px-4 py-3",children:e.jsx("span",{className:"text-sm text-gray-600",children:(s==null?void 0:s.description)||"-"})}),e.jsx("td",{className:"border border-gray-300 px-4 py-3",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsxs(T,{size:"sm",variant:"outline",onClick:()=>_(String(s==null?void 0:s.id)),className:"flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"}),"Edit"]}),c==="true"&&e.jsxs(Q,{className:"flex items-center gap-1 rounded-md bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",to:`pay-matrix?pay_level_id=${W(String(s==null?void 0:s.id))}`,children:[e.jsx(_e,{className:"h-3 w-3"}),"Matrix"]})]})})]},s==null?void 0:s.id)),(!((r=a==null?void 0:a.data)!=null&&r.data)||((B=(q=a==null?void 0:a.data)==null?void 0:q.data)==null?void 0:B.length)===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:c==="true"?5:6,className:"border border-gray-300 py-12 text-center",children:[e.jsx("p",{className:"text-gray-500",children:"No pay levels found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:'Click "Add New Pay Level" to create one'})]})})]})]})})})]}):e.jsxs(Y,{children:[e.jsx(U,{className:"px-7",children:e.jsx(ae,{children:e.jsx("h2",{className:"text-lg font-semibold",children:"Pay Level Details"})})}),e.jsx(O,{children:e.jsxs(de,{children:[e.jsx(le,{children:e.jsxs(J,{children:[e.jsx(p,{children:"#"}),e.jsx(p,{children:"Level"}),e.jsx(p,{children:"Level Name"}),c==="true"&&e.jsx(p,{children:"Pay Range"}),c==="false"&&e.jsxs(e.Fragment,{children:[e.jsx(p,{children:"Pay Band"}),e.jsx(p,{children:"Grade Pay"})]}),e.jsx(p,{children:"Description"}),e.jsx(p,{children:"Created On"}),e.jsx(p,{children:"Actions"})]})}),e.jsxs(ce,{children:[(C=(w=a==null?void 0:a.data)==null?void 0:w.data)==null?void 0:C.map((s,l)=>e.jsxs(J,{children:[e.jsx(o,{children:l+1}),e.jsx(o,{children:e.jsxs("span",{className:"font-semibold",children:["Level ",s==null?void 0:s.level]})}),e.jsx(o,{children:s==null?void 0:s.level_name}),c==="true"&&e.jsx(o,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:n(s==null?void 0:s.min_basic_pay)}),e.jsx("div",{className:"text-muted-foreground",children:"to"}),e.jsx("div",{children:n(s==null?void 0:s.max_basic_pay)})]})}),c==="false"&&e.jsx(o,{children:s!=null&&s.pay_band_name?e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:s==null?void 0:s.pay_band_name}),e.jsxs("div",{className:"text-muted-foreground",children:[n((s==null?void 0:s.pay_band_min)||0)," -"," ",n((s==null?void 0:s.pay_band_max)||0)]})]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),c==="false"&&e.jsx(o,{children:s!=null&&s.grade_pay?n(s==null?void 0:s.grade_pay):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(o,{children:(s==null?void 0:s.description)||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(o,{children:re(s==null?void 0:s.created_at).format("DD MMM YYYY")}),e.jsx(o,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{size:"sm",variant:"outline",onClick:()=>_(String(s==null?void 0:s.id)),children:"Edit"}),c==="true"&&e.jsx(Q,{className:"rounded-lg bg-green-600 px-4 py-2 text-white",to:`pay-matrix?pay_level_id=${W(String(s==null?void 0:s.id))}`,children:"View Matrix"})]})})]},s==null?void 0:s.id)),(!((k=a==null?void 0:a.data)!=null&&k.data)||((A=(E=a==null?void 0:a.data)==null?void 0:E.data)==null?void 0:A.length)===0)&&e.jsx(J,{children:e.jsx(o,{colSpan:9,className:"py-8 text-center text-muted-foreground",children:'No pay levels found. Click "Add New Pay Level" to create one.'})})]})]})})]})]})]})}function Ge(){return e.jsx(se,{title:"Pay Level",subTitle:"Manage all the Pay Levels here",children:e.jsx("div",{className:"py-12",children:e.jsx(ve,{})})})}export{Ge as default};
