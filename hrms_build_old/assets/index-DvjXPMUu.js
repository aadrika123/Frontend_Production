import{aA as e,r as a,j as s,aB as t,al as i}from"./vendor-RyuIgj66.js";import{g as l,P as d}from"./index-DFF4_m_G.js";import{h as r}from"./moment-CBOc1lqT.js";import{h as n,e as o,B as c,g as m}from"./index-ey2GEmQz.js";import{C as u,a as h,c as x}from"./card-u7M7FP5y.js";import{u as p,b as j}from"./useCustomQuery-DTB6aAiD.js";import{P as y}from"./index-BHR1l08i.js";import{S as g}from"./Spinner-BwGzvoRj.js";import{S as v,a as b,b as f,c as N,e as w,f as S,d as H}from"./select-8PAfYjod.js";import{c as _,a as D,e as Y}from"./yup-CH6wvET8.js";import{F as k}from"./datetime-picker-dN6E5dqy.js";import{R as M}from"./RHFTextField-BSZ_cEI3.js";import{R as $}from"./RHFTextArea-DpBxMoiQ.js";import{B as C}from"./ButtonLoading-DDalXO-W.js";import{R as O}from"./RHFSelectField-oISAIiMK.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{S as A}from"./separator-BQijJEjG.js";import{D as E}from"./index-B2ia16z0.js";import{C as B}from"./index-B9zcFpnH.js";import{s as F,O as T,ag as q,af as R,S as L,q as P,T as z}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const I=_().shape({type:D().required().label("Type"),holiday_name:D().required().label("Holiday Name"),description:D().required().label("Description"),date:D().required().label("Date"),days:Y().optional().positive().label("Days"),department_id:D().required().label("Department")});function V({open:d,setOpen:r,title:c,id:m,edit:u,setEdit:h,refetch:x}){var y,g,v;const b=l(),f=p({}),{data:N,isFetching:w}=j({api:`${null==(y=n)?void 0:y.getHolidayById}?id=${o(String(m))}`,key:"getHolidayById",options:{enabled:u}}),S=e({defaultValues:{type:"",holiday_name:"",description:"",date:"",days:1,department_id:""},resolver:t(I)});a.useEffect(()=>{var e,a,s,t,i,l;u&&N?S.reset({type:String(null==(e=null==N?void 0:N.data)?void 0:e.type),holiday_name:null==(a=null==N?void 0:N.data)?void 0:a.holiday_name,description:null==(s=null==N?void 0:N.data)?void 0:s.description,date:null==(t=null==N?void 0:N.data)?void 0:t.date,days:null==(i=null==N?void 0:N.data)?void 0:i.days,department_id:String(null==(l=null==N?void 0:N.data)?void 0:l.department_id)}):S.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})},[u,N]);return s.jsx(E,{open:d,setOpen:r,title:c,setEdit:h,edit:u,isLoading:w,children:s.jsx(k,{methods:S,onSubmit:S.handleSubmit(async e=>{var a,s,t,l,d,o,c,p;try{if(u&&e){const d=await f.mutateAsync({api:`${null==(a=n)?void 0:a.updateHolidayById}`,data:{id:m,...e}});(null==(s=d.data)?void 0:s.success)?i.success(null==(t=null==d?void 0:d.data)?void 0:t.message):i.error((null==(l=d.data)?void 0:l.message)||"Holiday not updated successfully")}else{const a=await f.mutateAsync({api:null==(d=n)?void 0:d.createHoliday,data:e});(null==(o=a.data)?void 0:o.success)?i.success(null==(c=null==a?void 0:a.data)?void 0:c.message):i.error((null==(p=a.data)?void 0:p.message)||"Holiday not created successfully"),S.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})}r(!1),h(!1),x()}catch(j){}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[s.jsx("div",{children:s.jsx(O,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(null==(v=null==(g=null==b?void 0:b.data)?void 0:g.data)?void 0:v.length)?b.data.data.map(e=>({label:String(e.department_name),value:String(e.id)})):[]})}),s.jsx("div",{children:s.jsx(O,{name:"type",data:[{value:"Restricted",label:"Restricted"},{value:"Gazetted",label:"Gazetted"},{value:"Optional",label:"Optional"}]})}),s.jsx("div",{children:s.jsx(M,{name:"holiday_name",placeholder:"Enter Holiday Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),s.jsx("div",{children:s.jsx($,{name:"description",placeholder:"Enter Description"})}),s.jsx("div",{children:s.jsx(M,{name:"date",type:"date",placeholder:"Select Date"})}),!u&&s.jsx("div",{children:s.jsx(M,{name:"days",type:"number",placeholder:"Enter Number of Days"})}),s.jsx(A,{}),s.jsx("div",{children:s.jsx(C,{isLoading:S.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function G(){var e,t,d,_,D,Y;const k=p({}),M=l(),[$,C]=a.useState(1),[O,A]=a.useState(10),[E,I]=a.useState(""),[G,W]=a.useState(!1),[Q,Z]=a.useState(""),[J,K]=a.useState(!1),[U,X]=a.useState(null),[ee,ae]=a.useState(r()),[se,te]=a.useState(""),ie=se?`department_id=${o(se)}`:"",le=j({api:`${n.getAllHolidays}?page=${$}&limit=${O}&q=${E}&${ie}`,key:"getAllHolidayList",value:[$,O,se],options:{enabled:!0}}),de=(()=>{const e=ee.clone().startOf("month"),a=ee.clone().endOf("month"),s=e.clone().startOf("week"),t=a.clone().endOf("week"),i=[];let l=s.clone();for(;l.isSameOrBefore(t);)i.push(l.clone()),l.add(1,"day");return i})();return s.jsxs("main",{className:"grid items-start",children:[s.jsx(V,{open:G,setOpen:W,title:J?"Edit Holiday":"Add Holiday",id:Q,edit:J,setEdit:K,refetch:le.refetch}),s.jsxs("div",{className:"grid auto-rows-max items-start gap-6 md:gap-6 lg:col-span-2",children:[s.jsxs("div",{className:"flex flex-col gap-4 rounded-lg bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-600 p-6 text-white shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"rounded-full bg-white/20 p-3 backdrop-blur-sm",children:s.jsx(F,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Holiday Calendar"}),s.jsxs("p",{className:"text-sm text-blue-100",children:[(null==(t=null==(e=null==le?void 0:le.data)?void 0:e.pagination)?void 0:t.total)||0," holidays scheduled"]})]})]}),s.jsxs(c,{onClick:()=>W(!0),className:"bg-white text-blue-600 hover:bg-blue-50",children:[s.jsx(T,{className:"mr-2 h-4 w-4"}),"Add Holiday"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsxs(v,{onValueChange:e=>te(e),value:se,children:[s.jsx(b,{className:"w-[180px]",children:s.jsx(f,{placeholder:"Select Department"})}),s.jsx(N,{children:s.jsxs(w,{children:[s.jsx(S,{children:"Select Department"}),(null==(_=null==(d=null==M?void 0:M.data)?void 0:d.data)?void 0:_.length)?M.data.data.map(e=>s.jsx(H,{value:String(e.id),children:e.department_name},e.id)):null]})})]})}),s.jsx(c,{variant:"outline",onClick:()=>{ae(r())},className:"border-white/30 bg-white/10 text-white hover:bg-white/20",children:"Today"})]})]}),s.jsxs(u,{className:"overflow-hidden shadow-xl",children:[s.jsx(h,{className:"border-b bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(c,{variant:"outline",size:"icon",onClick:()=>{ae(ee.clone().subtract(1,"month"))},className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:s.jsx(q,{className:"h-5 w-5"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:ee.format("MMMM YYYY")}),s.jsx(c,{variant:"outline",size:"icon",onClick:()=>{ae(ee.clone().add(1,"month"))},className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:s.jsx(R,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Week starts on Sunday"})]})}),s.jsx(x,{className:"p-0",children:le.isLoading?s.jsx("div",{className:"flex h-96 items-center justify-center",children:s.jsx(g,{})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white",children:[s.jsx("div",{className:"grid grid-cols-7 border-b bg-gray-50",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>s.jsx("div",{className:"border-r p-4 text-center text-sm font-semibold uppercase tracking-wide text-gray-600 last:border-r-0",children:e.slice(0,3)},e))}),s.jsx("div",{className:"grid grid-cols-7",children:de.map((e,a)=>{const t=(l=e,(null==(d=null==le?void 0:le.data)?void 0:d.data)?le.data.data.filter(e=>r(e.date).format("YYYY-MM-DD")===l.format("YYYY-MM-DD")):[]);var l,d;const o=e.month()===ee.month(),c=e.isSame(r(),"day"),u=0===e.day()||6===e.day();return s.jsxs("div",{className:`group relative min-h-32 border-b border-r p-3 transition-all last:border-r-0 ${o?u?"bg-blue-50/30":"bg-white hover:bg-gray-50":"bg-gray-50/50"} ${t.length>0?"bg-gradient-to-br from-blue-50 to-indigo-50":""}`,children:[s.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[s.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full text-sm font-semibold transition-all "+(c?"bg-blue-600 text-white shadow-lg":o?"text-gray-700":"text-gray-400"),children:e.format("D")}),t.length>0&&s.jsx("div",{className:"rounded-full bg-blue-600 px-2 py-0.5 text-xs font-semibold text-white shadow-sm",children:t.length})]}),s.jsx("div",{className:"space-y-1.5",children:t.map(e=>s.jsxs("div",{className:"group/item relative overflow-hidden rounded-lg border border-blue-200 bg-white p-2 shadow-sm transition-all hover:shadow-md",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"h-2 w-2 rounded-full "+(1==e.status?"bg-green-500":"bg-gray-400")}),s.jsx("h4",{className:"line-clamp-1 text-xs font-semibold text-gray-900",children:e.name})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[s.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:e.type}),e.days>1&&s.jsxs("span",{className:"text-xs text-gray-600",children:[e.days,"d"]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1 opacity-0 transition-opacity group-hover/item:opacity-100",children:[s.jsx("button",{onClick:()=>{return a=String(e.id),K(!0),W(!0),void Z(a);var a},className:"flex h-7 w-7 items-center justify-center rounded-md bg-blue-600 text-white shadow-sm transition-all hover:bg-blue-700 hover:shadow-md",title:"Edit Holiday",children:s.jsx(L,{className:"h-3.5 w-3.5"})}),s.jsx("button",{onClick:()=>(async e=>{X(e),B("Are you sure you want to delete this holiday?","Please confirm",async()=>{var a,s,t;try{const l=await k.mutateAsync({api:`${n.deleteHolidayById}`,data:{id:e}});(null==(a=null==l?void 0:l.data)?void 0:a.success)?(le.refetch(),i.success(null==(s=null==l?void 0:l.data)?void 0:s.message)):i.error(null==(t=l.data)?void 0:t.message)}catch(l){i.error(m(l))}finally{X(null)}}),X(null)})(String(e.id)),disabled:U===String(e.id),className:"flex h-7 w-7 items-center justify-center rounded-md bg-red-600 text-white shadow-sm transition-all hover:bg-red-700 hover:shadow-md disabled:opacity-50",title:"Delete Holiday",children:U===String(e.id)?s.jsx(P,{className:"h-3.5 w-3.5 animate-spin"}):s.jsx(z,{className:"h-3.5 w-3.5"})})]})]}),e.name&&s.jsx("div",{className:"line-clamp-2 text-xs font-semibold text-gray-600",children:e.name}),e.description&&s.jsx("div",{className:"mt-1 line-clamp-2 text-xs text-gray-600",children:e.description})]},e.id))})]},a)})})]}),s.jsx("div",{className:"border-t bg-gray-50 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Showing holidays for ",ee.format("MMMM YYYY")]}),s.jsx(y,{page:$,limit:O,totalPages:null==(Y=null==(D=null==le?void 0:le.data)?void 0:D.pagination)?void 0:Y.totalPages,setPage:C,setLimit:A})]})})]})})]})]})]})}function W(){return s.jsx(d,{title:"Holiday List",subTitle:"Manage all the Holidays",children:s.jsx(G,{})})}export{W as default};
