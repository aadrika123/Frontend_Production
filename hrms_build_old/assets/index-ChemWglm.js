import{aA as e,r as a,j as s,aB as i,al as l,aC as r,ak as d}from"./vendor-RyuIgj66.js";import{P as t}from"./index-DFF4_m_G.js";import{h as n}from"./moment-CBOc1lqT.js";import{h as c,e as o,d as m,B as x}from"./index-ey2GEmQz.js";import{C as p,a as u,c as v,b as y}from"./card-u7M7FP5y.js";import{T as h,a as j,b,c as _,d as g,e as N}from"./table-B_npepsp.js";import{u as f,b as L}from"./useCustomQuery-DTB6aAiD.js";import{S as P}from"./index-CUStUwt1.js";import{S}from"./Spinner-BwGzvoRj.js";import{c as q,a as B,e as w}from"./yup-CH6wvET8.js";import{F as M}from"./datetime-picker-dN6E5dqy.js";import{R as C}from"./RHFTextField-BSZ_cEI3.js";import{R as E}from"./RHFTextArea-DpBxMoiQ.js";import{B as A}from"./ButtonLoading-DDalXO-W.js";import"./select-8PAfYjod.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{S as k}from"./separator-BQijJEjG.js";import{D as F}from"./index-B2ia16z0.js";import{G as $,L as D,P as R,E as I}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const V=q().shape({pay_commission_id:w().required("Pay Commission is required"),level:w().required("Level is required").positive("Level must be positive"),level_name:B().required("Level Name is required"),min_basic_pay:w().required("Minimum Basic Pay is required").positive("Must be positive"),max_basic_pay:w().required("Maximum Basic Pay is required").positive("Must be positive"),description:B().required("Description is required")}),T=q().shape({pay_commission_id:w().required("Pay Commission is required"),level:w().required("Level is required").positive("Level must be positive"),level_name:B().required("Level Name is required"),min_basic_pay:w().required("Minimum Basic Pay is required").positive("Must be positive"),max_basic_pay:w().required("Maximum Basic Pay is required").positive("Must be positive"),pay_band_name:B().required("Pay Band Name is required"),grade_pay:w().required("Grade Pay is required").positive("Must be positive"),description:B().nullable()});function G({open:r,setOpen:d,title:t,id:n,edit:m,setEdit:x,isMatrixBased:p,payCommissionId:u,payLevelListData:v}){var y,h,j,b,_;const g=f({}),N="true"===p||"1"===p,{data:P,isFetching:S}=L({api:`${null==(y=c)?void 0:y.getPayLevelById}?id=${o(String(n))}`,key:"getPayLevelById",options:{enabled:!!m}}),q=(null==v?void 0:v.data)&&(null==(j=null==(h=null==v?void 0:v.data)?void 0:h.data)?void 0:j.length)>0?Math.max(...null==(_=null==(b=null==v?void 0:v.data)?void 0:b.data)?void 0:_.map(e=>null==e?void 0:e.level))+1:0,B={pay_commission_id:u?Number(u):0,level:0,level_name:"",min_basic_pay:0,max_basic_pay:0,description:""},w={pay_commission_id:u?Number(u):0,level:0,level_name:"",min_basic_pay:0,max_basic_pay:0,pay_band_name:"",grade_pay:0,description:""},$=e({defaultValues:N?B:w,resolver:i(N?V:T)});return a.useEffect(()=>{(null==v?void 0:v.data)&&!m&&($.setValue("level",q),$.setValue("level_name",`Level ${q}`))},[v,m,q,$]),a.useEffect(()=>{m&&(null==P?void 0:P.data)?$.reset(P.data):$.reset(N?B:w)},[m,P,$]),s.jsx(F,{open:r,setOpen:d,title:t,setEdit:x,edit:m,isLoading:S,children:s.jsx(M,{methods:$,onSubmit:$.handleSubmit(async e=>{var a,s,i,r,t,o,p,u;try{if(m&&e){const d=await g.mutateAsync({api:`${null==(a=c)?void 0:a.updatePayLevel}`,data:{id:n,pay_commission_id:e.pay_commission_id,level:e.level,level_name:e.level_name,min_basic_pay:e.min_basic_pay,max_basic_pay:e.max_basic_pay,...!N&&{pay_band_name:e.pay_band_name,pay_band_min:e.min_basic_pay,pay_band_max:e.max_basic_pay,grade_pay:e.grade_pay},description:e.description}});(null==(s=d.data)?void 0:s.success)?l.success(null==(i=null==d?void 0:d.data)?void 0:i.message):l.error((null==(r=d.data)?void 0:r.message)||"Pay Level not updated successfully")}else{const a=await g.mutateAsync({api:null==(t=c)?void 0:t.createPayLevel,data:{pay_commission_id:e.pay_commission_id,level:q||e.level,level_name:`Level ${q}`||e.level_name,min_basic_pay:e.min_basic_pay,max_basic_pay:e.max_basic_pay,...!N&&{pay_band_name:e.pay_band_name,pay_band_min:e.min_basic_pay,pay_band_max:e.max_basic_pay,grade_pay:e.grade_pay},description:e.description}});(null==(o=a.data)?void 0:o.success)?l.success(null==(p=null==a?void 0:a.data)?void 0:p.message):l.error((null==(u=a.data)?void 0:u.message)||"Pay Level not created successfully"),$.reset(N?B:w)}d(!1),x(!1),null==v||v.refetch()}catch(y){l.error("An error occurred. Please try again.")}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[s.jsx("input",{type:"hidden",...$.register("pay_commission_id"),value:u||""}),s.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[s.jsx(C,{label:"Level",type:"number",name:"level",placeholder:"Enter Level"}),s.jsx(C,{name:"level_name",label:"Level Name",placeholder:"Enter Level Name",inputValidation:["removeSpecialCharacterExceptSpace"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[s.jsx(C,{type:"number",name:"min_basic_pay",label:"Minimum Basic Pay",placeholder:"Minimum Basic Pay"}),s.jsx(C,{type:"number",name:"max_basic_pay",label:"Maximum Basic Pay",placeholder:"Maximum Basic Pay"})]}),!N&&s.jsxs(s.Fragment,{children:[s.jsx("div",{children:s.jsx(C,{name:"pay_band_name",label:"Pay Band Name",placeholder:"Enter Pay Band Name (e.g., PB-2)"})}),s.jsx("div",{children:s.jsx(C,{type:"number",name:"grade_pay",label:"Grade Pay",placeholder:"Grade Pay"})})]}),s.jsx("div",{children:s.jsx(E,{name:"description",placeholder:"Enter description",label:"Description",rows:4,inputValidation:["removeSpecialCharacterExceptSpace"]})}),s.jsx(k,{}),s.jsx("div",{children:s.jsx(A,{isLoading:$.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function z(){var e,i,l,t,f,q,B,w,M,C,E,A,k,F;const[V]=r(),T=V.get("commission_id"),z=V.get("is_matrix_based"),Y=V.get("commission_name"),[O,H]=a.useState(""),[U,Q]=a.useState(!1),[Z,J]=a.useState(""),[K,W]=a.useState(!1),[X,ee]=a.useState("chart"),ae=L({api:`${null==(e=c)?void 0:e.getAllPayLevels}?pay_commission_id=${T}`,key:"getAllPayLevels",options:{enabled:!!T}});L({api:`${null==(i=c)?void 0:i.getPayLevelById}?id=${Z}`,key:"getPayLevelById",value:[Z],options:{enabled:!!Z}});const se=e=>{W(!0),Q(!0),J(e)},ie=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e);return s.jsxs("main",{className:"grid items-start",children:[s.jsx(G,{open:U,setOpen:Q,title:K?"Edit Pay Level":"Add Pay Level",id:Z,edit:K,setEdit:W,isMatrixBased:z,payCommissionId:m(T||""),payLevelListData:ae}),s.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[s.jsx(p,{className:"border-l-4 border-l-blue-500",children:s.jsx(u,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:Y}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"true"===z?"Matrix Based Commission":"Non-Matrix Based Commission"}),s.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Total Levels: ",(null==(t=null==(l=null==ae?void 0:ae.data)?void 0:l.data)?void 0:t.length)||0]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(x,{variant:"chart"===X?"default":"outline",size:"sm",onClick:()=>ee("chart"),className:"flex items-center gap-2",children:[s.jsx($,{className:"h-4 w-4"}),"Chart View"]}),s.jsxs(x,{variant:"list"===X?"default":"outline",size:"sm",onClick:()=>ee("list"),className:"flex items-center gap-2",children:[s.jsx(D,{className:"h-4 w-4"}),"List View"]})]})]})})}),s.jsxs("div",{className:"flex w-full justify-between gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(P,{search:O,setSearch:H,refetch:ae.refetch,isFetching:null==ae?void 0:ae.isLoading})}),s.jsx(x,{className:"flex items-center gap-2",onClick:()=>Q(!0),children:"Add New Pay Level"})]}),ae.isLoading?s.jsx(p,{children:s.jsx(v,{className:"flex h-64 items-center justify-center",children:s.jsx(S,{})})}):"chart"===X?s.jsxs(p,{children:[s.jsx(u,{className:"bg-gray-50",children:s.jsx("h2",{className:"text-center text-lg font-semibold",children:"PAY SCALE STRUCTURE"})}),s.jsx(v,{className:"p-0",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-y-2 border-gray-300 bg-gray-100",children:[s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Level"}),s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Level Name"}),"true"===z?s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Revised Pay Band (Rs.)"}):s.jsxs(s.Fragment,{children:[s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Pay Band"}),s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Grade Pay (Rs.)"})]}),s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left text-sm font-semibold",children:"Description"}),s.jsx("th",{className:"border border-gray-300 px-4 py-3 text-center text-sm font-semibold",children:"Actions"})]})}),s.jsxs("tbody",{children:[null==(q=null==(f=null==ae?void 0:ae.data)?void 0:f.data)?void 0:q.map(e=>s.jsxs("tr",{className:"transition-colors hover:bg-blue-50",children:[s.jsx("td",{className:"border border-gray-300 px-4 py-3",children:s.jsxs("span",{className:"font-bold text-blue-600",children:["Level ",null==e?void 0:e.level]})}),s.jsx("td",{className:"border border-gray-300 px-4 py-3",children:s.jsx("span",{className:"font-medium",children:null==e?void 0:e.level_name})}),"true"===z?s.jsx("td",{className:"border border-gray-300 px-4 py-3",children:s.jsxs("div",{className:"font-medium",children:[ie(null==e?void 0:e.min_basic_pay)," -"," ",ie(null==e?void 0:e.max_basic_pay)]})}):s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"border border-gray-300 px-4 py-3",children:(null==e?void 0:e.pay_band_name)?s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:null==e?void 0:e.pay_band_name}),s.jsxs("div",{className:"text-sm text-gray-600",children:[ie((null==e?void 0:e.pay_band_min)||0)," -"," ",ie((null==e?void 0:e.pay_band_max)||0)]})]}):s.jsx("span",{className:"text-gray-400",children:"-"})}),s.jsx("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(null==e?void 0:e.grade_pay)?s.jsx("span",{className:"font-semibold",children:ie(null==e?void 0:e.grade_pay)}):s.jsx("span",{className:"text-gray-400",children:"-"})})]}),s.jsx("td",{className:"border border-gray-300 px-4 py-3",children:s.jsx("span",{className:"text-sm text-gray-600",children:(null==e?void 0:e.description)||"-"})}),s.jsx("td",{className:"border border-gray-300 px-4 py-3",children:s.jsxs("div",{className:"flex justify-center gap-2",children:[s.jsxs(x,{size:"sm",variant:"outline",onClick:()=>se(String(null==e?void 0:e.id)),className:"flex items-center gap-1",children:[s.jsx(R,{className:"h-3 w-3"}),"Edit"]}),"true"===z&&s.jsxs(d,{className:"flex items-center gap-1 rounded-md bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",to:`pay-matrix?pay_level_id=${o(String(null==e?void 0:e.id))}`,children:[s.jsx(I,{className:"h-3 w-3"}),"Matrix"]})]})})]},null==e?void 0:e.id)),(!(null==(B=null==ae?void 0:ae.data)?void 0:B.data)||0===(null==(M=null==(w=null==ae?void 0:ae.data)?void 0:w.data)?void 0:M.length))&&s.jsx("tr",{children:s.jsxs("td",{colSpan:"true"===z?5:6,className:"border border-gray-300 py-12 text-center",children:[s.jsx("p",{className:"text-gray-500",children:"No pay levels found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-400",children:'Click "Add New Pay Level" to create one'})]})})]})]})})})]}):s.jsxs(p,{children:[s.jsx(u,{className:"px-7",children:s.jsx(y,{children:s.jsx("h2",{className:"text-lg font-semibold",children:"Pay Level Details"})})}),s.jsx(v,{children:s.jsxs(h,{children:[s.jsx(j,{children:s.jsxs(b,{children:[s.jsx(_,{children:"#"}),s.jsx(_,{children:"Level"}),s.jsx(_,{children:"Level Name"}),"true"===z&&s.jsx(_,{children:"Pay Range"}),"false"===z&&s.jsxs(s.Fragment,{children:[s.jsx(_,{children:"Pay Band"}),s.jsx(_,{children:"Grade Pay"})]}),s.jsx(_,{children:"Description"}),s.jsx(_,{children:"Created On"}),s.jsx(_,{children:"Actions"})]})}),s.jsxs(g,{children:[null==(E=null==(C=null==ae?void 0:ae.data)?void 0:C.data)?void 0:E.map((e,a)=>s.jsxs(b,{children:[s.jsx(N,{children:a+1}),s.jsx(N,{children:s.jsxs("span",{className:"font-semibold",children:["Level ",null==e?void 0:e.level]})}),s.jsx(N,{children:null==e?void 0:e.level_name}),"true"===z&&s.jsx(N,{children:s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{children:ie(null==e?void 0:e.min_basic_pay)}),s.jsx("div",{className:"text-muted-foreground",children:"to"}),s.jsx("div",{children:ie(null==e?void 0:e.max_basic_pay)})]})}),"false"===z&&s.jsx(N,{children:(null==e?void 0:e.pay_band_name)?s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:"font-medium",children:null==e?void 0:e.pay_band_name}),s.jsxs("div",{className:"text-muted-foreground",children:[ie((null==e?void 0:e.pay_band_min)||0)," -"," ",ie((null==e?void 0:e.pay_band_max)||0)]})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}),"false"===z&&s.jsx(N,{children:(null==e?void 0:e.grade_pay)?ie(null==e?void 0:e.grade_pay):s.jsx("span",{className:"text-muted-foreground",children:"-"})}),s.jsx(N,{children:(null==e?void 0:e.description)||s.jsx("span",{className:"text-muted-foreground",children:"-"})}),s.jsx(N,{children:n(null==e?void 0:e.created_at).format("DD MMM YYYY")}),s.jsx(N,{children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(x,{size:"sm",variant:"outline",onClick:()=>se(String(null==e?void 0:e.id)),children:"Edit"}),"true"===z&&s.jsx(d,{className:"rounded-lg bg-green-600 px-4 py-2 text-white",to:`pay-matrix?pay_level_id=${o(String(null==e?void 0:e.id))}`,children:"View Matrix"})]})})]},null==e?void 0:e.id)),(!(null==(A=null==ae?void 0:ae.data)?void 0:A.data)||0===(null==(F=null==(k=null==ae?void 0:ae.data)?void 0:k.data)?void 0:F.length))&&s.jsx(b,{children:s.jsx(N,{colSpan:9,className:"py-8 text-center text-muted-foreground",children:'No pay levels found. Click "Add New Pay Level" to create one.'})})]})]})})]})]})]})}function Y(){return s.jsx(t,{title:"Pay Level",subTitle:"Manage all the Pay Levels here",children:s.jsx("div",{className:"py-12",children:s.jsx(z,{})})})}export{Y as default};
