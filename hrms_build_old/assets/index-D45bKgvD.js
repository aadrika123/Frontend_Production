import{h as e,f as a,r as s,j as i,z as t,B as l,e as d}from"./index-UYY99J9q.js";import{P as r}from"./index-Dj741qwl.js";import{h as n}from"./moment-CBOc1lqT.js";import{C as o,a as c,b as m,c as u}from"./card-CtI_IPLF.js";import{T as p,a as j,b as h,c as x,d as f,e as v}from"./table-CS0u2e-w.js";import{u as g,b as y}from"./useCustomQuery-Dp3AX7R2.js";import{P as S}from"./index-914tDITV.js";import{S as D}from"./separator-BrVypJ4m.js";import{S as _}from"./index-UiGf0NcE.js";import{S as N}from"./Spinner-CjaIOVSb.js";import{a as b,o as E,c as w,b as C}from"./yup-jtZe4Tk8.js";import{F as O}from"./datetime-picker-CgwSorNf.js";import{R as L}from"./RHFTextField-BtYg5IGX.js";import{B as T}from"./ButtonLoading-C1bL9ixh.js";import"./select-CcbMZzqU.js";import"./input-qBPs6xkH.js";import"./switch-CnTLVnvq.js";import"./checkbox-D8MNaO54.js";import"./label-DVj88vWk.js";import{D as k}from"./index-D5PwM2eu.js";import{L as M}from"./loader-circle-CpY17M5D.js";import{t as $}from"./switch-m3ccuoD6.js";import"./calendar-ddNksXQs.js";import"./format-BkNqQ0tt.js";import"./chevron-right-BO4a-O50.js";import"./clock-CXHA5hGN.js";import"./check-B5JmqH3y.js";const A=w().shape({ddo_code:C().required().label("DDO Code"),ddo_name:C().required().label("DDO Name"),office_name:C().required().label("Office Name"),treasury_name:C().required().label("Treasury Name")});function B({open:l,setOpen:d,title:r,id:n,edit:o,setEdit:c,refetch:m}){var u;const p=g({}),{data:j,isFetching:h}=y({api:`${null==(u=e)?void 0:u.getDDoMstrById}/${a(String(n))}`,key:"getDDoMstrById",options:{enabled:o}}),x=b({defaultValues:{ddo_code:"",ddo_name:"",office_name:"",treasury_name:""},resolver:E(A)});return s.useEffect(()=>{var e,a,s,i;o&&j?x.reset({ddo_code:null==(e=null==j?void 0:j.data)?void 0:e.ddo_code,ddo_name:null==(a=null==j?void 0:j.data)?void 0:a.ddo_name,office_name:null==(s=null==j?void 0:j.data)?void 0:s.office_name,treasury_name:null==(i=null==j?void 0:j.data)?void 0:i.treasury_name}):x.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})},[o,j]),i.jsx(k,{open:l,setOpen:d,title:r,setEdit:c,edit:o,isLoading:h,children:i.jsx(O,{methods:x,onSubmit:x.handleSubmit(async s=>{var i,l,r,u,j,h,f,v;try{if(o&&s){const d=await p.mutateAsync({api:`${null==(i=e)?void 0:i.updateDDoMstrById}`,data:{id:a(String(n)),...s}});(null==(l=d.data)?void 0:l.success)?t.success(null==(r=null==d?void 0:d.data)?void 0:r.message):t.error((null==(u=d.data)?void 0:u.message)||"Employee Type not updated successfully")}else{const a=await p.mutateAsync({api:null==(j=e)?void 0:j.createDDoMstr,data:s});(null==(h=a.data)?void 0:h.success)?t.success(null==(f=null==a?void 0:a.data)?void 0:f.message):t.error((null==(v=a.data)?void 0:v.message)||"Employee Type not created successfully"),x.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})}d(!1),c(!1),m()}catch(g){}}),children:i.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[i.jsx("div",{children:i.jsx(L,{name:"ddo_code",placeholder:"Enter DDO Code",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{name:"ddo_name",placeholder:"Enter DDO Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{name:"office_name",placeholder:"Enter Office Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{name:"treasury_name",placeholder:"Enter Treasury Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx(D,{}),i.jsx("div",{children:i.jsx(T,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function F(){var r,b,E,w,C,O;const L=g({}),[T,k]=s.useState(1),[A,F]=s.useState(10),[P,V]=s.useState(""),[q,Y]=s.useState(!1),[I,R]=s.useState(""),[Q,z]=s.useState(!1),[H,U]=s.useState(null),W=y({api:`${e.getAllDDoMstr}?page=${T}&limit=${A}&q=${P}`,key:"getAllDDoList",value:[T,A],options:{enabled:!0}});return i.jsxs("main",{className:"grid items-start",children:[i.jsx(B,{open:q,setOpen:Y,title:Q?"Edit Employee Type":"Add Employee Type",id:I,edit:Q,setEdit:z,refetch:W.refetch}),i.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[i.jsxs("div",{className:"flex w-full justify-between gap-2",children:[i.jsx("div",{children:i.jsx(_,{search:P,setSearch:V,refetch:W.refetch,isFetching:null==W?void 0:W.isLoading})}),i.jsx("div",{children:i.jsx(l,{className:"flex items-center gap-2",onClick:()=>Y(!0),children:"Add New"})})]}),i.jsxs(o,{children:[i.jsx(c,{className:"px-7",children:i.jsxs(m,{children:["Employee Type List (",null==(b=null==(r=null==W?void 0:W.data)?void 0:r.pagination)?void 0:b.total,")"]})}),i.jsx(u,{children:W.isLoading?i.jsx("div",{className:"flex h-32 items-center justify-center",children:i.jsx(N,{})}):i.jsxs(i.Fragment,{children:[i.jsxs(p,{children:[i.jsx(j,{children:i.jsxs(h,{children:[i.jsx(x,{className:"",children:"#"}),i.jsx(x,{className:"",children:"DDO Code"}),i.jsx(x,{className:"",children:"DDO Name"}),i.jsx(x,{className:"",children:"Office Name"}),i.jsx(x,{className:"",children:"Created at"}),i.jsx(x,{className:"",children:"Status"}),i.jsx(x,{children:"Action"})]})}),i.jsx(f,{children:null==(w=null==(E=null==W?void 0:W.data)?void 0:E.data)?void 0:w.map((s,r)=>i.jsxs(h,{children:[i.jsx(v,{children:r+1}),i.jsx(v,{children:null==s?void 0:s.ddo_code}),i.jsx(v,{children:null==s?void 0:s.ddo_name}),i.jsx(v,{children:null==s?void 0:s.office_name}),i.jsx(v,{children:n(null==s?void 0:s.created_at).format("DD-MM-YYYY")}),i.jsx(v,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs($,{checked:1==(null==s?void 0:s.status),onChange:()=>(async s=>{var i,l,r,n;U(s);try{const d=await L.mutateAsync({api:`${null==(i=e)?void 0:i.toggleDDoMstr}`,data:{id:a(String(s))}});(null==(l=null==d?void 0:d.data)?void 0:l.success)?(W.refetch(),t.success(null==(r=null==d?void 0:d.data)?void 0:r.message)):t.error(null==(n=d.data)?void 0:n.message)}catch(o){t.error(d(o))}finally{U(null)}})(String(null==s?void 0:s.id)),disabled:H===String(null==s?void 0:s.id),className:((null==s?void 0:s.status)?"bg-primary":"bg-gray-200")+" relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50",children:[i.jsx("span",{className:"sr-only",children:"Enable notifications"}),i.jsx("span",{className:((null==s?void 0:s.status)?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white"})]}),H===String(null==s?void 0:s.id)&&i.jsx(M,{className:"h-4 w-4 animate-spin text-primary"})]})}),i.jsx(v,{children:i.jsx(l,{className:"bg-primary",onClick:()=>{return e=String(null==s?void 0:s.id),z(!0),Y(!0),void R(e);var e},children:"Edit"})})]},null==s?void 0:s.id))})]}),i.jsx(D,{className:"mb-2 mt-4"}),i.jsx("div",{className:"flex w-full justify-end",children:i.jsx(S,{page:T,limit:A,totalPages:null==(O=null==(C=null==W?void 0:W.data)?void 0:C.pagination)?void 0:O.totalPages,setPage:k,setLimit:F})})]})})]})]})]})}function P(){return i.jsx(r,{title:"DDO List",subTitle:"Manage all the DDo List",children:i.jsx("div",{className:"py-12",children:i.jsx(F,{})})})}export{P as default};
