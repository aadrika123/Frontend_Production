import{i as ae,h as M,e as J,r as h,j as e,z as j,B as I}from"./index-SDtq6APg.js";import{g as K,P as re}from"./index-CrjMXZHz.js";import{h as A,C as ie,a as le,c as ne}from"./card-BkXv33Jr.js";import{u as Q,b as X}from"./useCustomQuery-DuxI2f1A.js";import{g as de}from"./services-KQnp_8oA.js";import{P as oe}from"./index-H8LJk4gb.js";import{S as ce,a as me}from"./Spinner-thyyrLKV.js";import{S as he,a as xe,b as ue,c as pe,d as ge,e as fe,f as ye}from"./select-C_Ik7Cfg.js";import{a as be,o as je,c as ve,b as C,f as Ne}from"./yup-V-kjDK18.js";import{F as we,B as Se,a as He}from"./datetime-picker-iopySnZ3.js";import{R as O}from"./RHFTextField-D_VEXMjP.js";import{R as Ce}from"./RHFTextArea-CUQe0s4g.js";import{R as U}from"./RHFSelectField-DGuw7Cq7.js";import{D as Me}from"./index-CchGxI1X.js";import{C as De}from"./index-qZBYPp8w.js";import{C as ke}from"./calendar-C_1_1UGM.js";import{P as _e}from"./plus-DS1GEcj0.js";import{a as Pe}from"./clock-Cy8xExlC.js";import{L as $e}from"./loader-circle-CqvtqMqY.js";import{T as Ye}from"./trash-2-BJjgVrZW.js";import"./check-CsPaHRb5.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Fe=ve().shape({type:C().required().label("Type"),holiday_name:C().required().label("Holiday Name"),description:C().required().label("Description"),date:C().required().label("Date"),days:Ne().optional().positive().label("Days"),department_id:C().required().label("Department")});function Ie({open:E,setOpen:p,title:N,id:D,edit:o,setEdit:k,refetch:B}){var S,v,c;const w=K(),_=Q({}),{data:t,isFetching:R}=X({api:`${(S=M)==null?void 0:S.getHolidayById}?id=${J(String(D))}`,key:"getHolidayById",options:{enabled:o}}),u=be({defaultValues:{type:"",holiday_name:"",description:"",date:"",days:1,department_id:""},resolver:je(Fe)}),P=async n=>{var m,g,f,a,y,Y,T,F;try{if(o&&n){const r=await _.mutateAsync({api:`${(m=M)==null?void 0:m.updateHolidayById}`,data:{id:D,...n}});(g=r.data)!=null&&g.success?j.success((f=r==null?void 0:r.data)==null?void 0:f.message):j.error(((a=r.data)==null?void 0:a.message)||"Holiday not updated successfully")}else{const r=await _.mutateAsync({api:(y=M)==null?void 0:y.createHoliday,data:n});(Y=r.data)!=null&&Y.success?j.success((T=r==null?void 0:r.data)==null?void 0:T.message):j.error(((F=r.data)==null?void 0:F.message)||"Holiday not created successfully"),u.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})}p(!1),k(!1),B()}catch(r){console.log(r)}};h.useEffect(()=>{var n,m,g,f,a,y;o&&t?u.reset({type:String((n=t==null?void 0:t.data)==null?void 0:n.type),holiday_name:(m=t==null?void 0:t.data)==null?void 0:m.holiday_name,description:(g=t==null?void 0:t.data)==null?void 0:g.description,date:(f=t==null?void 0:t.data)==null?void 0:f.date,days:(a=t==null?void 0:t.data)==null?void 0:a.days,department_id:String((y=t==null?void 0:t.data)==null?void 0:y.department_id)}):u.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})},[o,t]);const $=[{value:"Restricted",label:"Restricted"},{value:"Gazetted",label:"Gazetted"},{value:"Optional",label:"Optional"}];return e.jsx(Me,{open:E,setOpen:p,title:N,setEdit:k,edit:o,isLoading:R,children:e.jsx(we,{methods:u,onSubmit:u.handleSubmit(P),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(U,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(c=(v=w==null?void 0:w.data)==null?void 0:v.data)!=null&&c.length?w.data.data.map(n=>({label:String(n.department_name),value:String(n.id)})):[]})}),e.jsx("div",{children:e.jsx(U,{name:"type",data:$})}),e.jsx("div",{children:e.jsx(O,{name:"holiday_name",placeholder:"Enter Holiday Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(Ce,{name:"description",placeholder:"Enter Description"})}),e.jsx("div",{children:e.jsx(O,{name:"date",type:"date",placeholder:"Select Date"})}),!o&&e.jsx("div",{children:e.jsx(O,{name:"days",type:"number",placeholder:"Enter Number of Days"})}),e.jsx(ce,{}),e.jsx("div",{children:e.jsx(Se,{isLoading:u.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ae(){var q,L,z,V,G,W;const E=Q({}),p=K(),[N,D]=h.useState(1),[o,k]=h.useState(10),[B,w]=h.useState(""),[_,t]=h.useState(!1),[R,u]=h.useState(""),[P,$]=h.useState(!1),[S,v]=h.useState(null),[c,n]=h.useState(A()),[m,g]=h.useState(""),f=m?`department_id=${J(m)}`:"",a=X({api:`${M.getAllHolidays}?page=${N}&limit=${o}&q=${B}&${f}`,key:"getAllHolidayList",value:[N,o,m],options:{enabled:!0}}),y=s=>{$(!0),t(!0),u(s)},Y=async s=>{v(s),De("Are you sure you want to delete this holiday?","Please confirm",async()=>{var x,d,b;try{const i=await E.mutateAsync({api:`${M.deleteHolidayById}`,data:{id:s}});(x=i==null?void 0:i.data)!=null&&x.success?(a.refetch(),j.success((d=i==null?void 0:i.data)==null?void 0:d.message)):j.error((b=i.data)==null?void 0:b.message)}catch(i){j.error(de(i))}finally{v(null)}}),v(null)},T=()=>{const s=c.clone().startOf("month"),x=c.clone().endOf("month"),d=s.clone().startOf("week"),b=x.clone().endOf("week"),i=[];let H=d.clone();for(;H.isSameOrBefore(b);)i.push(H.clone()),H.add(1,"day");return i},F=s=>{var x;return(x=a==null?void 0:a.data)!=null&&x.data?a.data.data.filter(d=>A(d.date).format("YYYY-MM-DD")===s.format("YYYY-MM-DD")):[]},r=()=>{n(c.clone().subtract(1,"month"))},Z=()=>{n(c.clone().add(1,"month"))},ee=()=>{n(A())},te=T(),se=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e.jsxs("main",{className:"grid items-start",children:[e.jsx(Ie,{open:_,setOpen:t,title:P?"Edit Holiday":"Add Holiday",id:R,edit:P,setEdit:$,refetch:a.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-6 md:gap-6 lg:col-span-2",children:[e.jsxs("div",{className:"flex flex-col gap-4 rounded-lg bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-600 p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-white/20 p-3 backdrop-blur-sm",children:e.jsx(ke,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Holiday Calendar"}),e.jsxs("p",{className:"text-sm text-blue-100",children:[((L=(q=a==null?void 0:a.data)==null?void 0:q.pagination)==null?void 0:L.total)||0," holidays scheduled"]})]})]}),e.jsxs(I,{onClick:()=>t(!0),className:"bg-white text-blue-600 hover:bg-blue-50",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Holiday"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs(he,{onValueChange:s=>g(s),value:m,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(ue,{placeholder:"Select Department"})}),e.jsx(pe,{children:e.jsxs(ge,{children:[e.jsx(fe,{children:"Select Department"}),(V=(z=p==null?void 0:p.data)==null?void 0:z.data)!=null&&V.length?p.data.data.map(s=>e.jsx(ye,{value:String(s.id),children:s.department_name},s.id)):null]})})]})}),e.jsx(I,{variant:"outline",onClick:ee,className:"border-white/30 bg-white/10 text-white hover:bg-white/20",children:"Today"})]})]}),e.jsxs(ie,{className:"overflow-hidden shadow-xl",children:[e.jsx(le,{className:"border-b bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{variant:"outline",size:"icon",onClick:r,className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:e.jsx(He,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:c.format("MMMM YYYY")}),e.jsx(I,{variant:"outline",size:"icon",onClick:Z,className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:e.jsx(Pe,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Week starts on Sunday"})]})}),e.jsx(ne,{className:"p-0",children:a.isLoading?e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(me,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white",children:[e.jsx("div",{className:"grid grid-cols-7 border-b bg-gray-50",children:se.map(s=>e.jsx("div",{className:"border-r p-4 text-center text-sm font-semibold uppercase tracking-wide text-gray-600 last:border-r-0",children:s.slice(0,3)},s))}),e.jsx("div",{className:"grid grid-cols-7",children:te.map((s,x)=>{const d=F(s),b=s.month()===c.month(),i=s.isSame(A(),"day"),H=s.day()===0||s.day()===6;return e.jsxs("div",{className:`group relative min-h-32 border-b border-r p-3 transition-all last:border-r-0 ${b?H?"bg-blue-50/30":"bg-white hover:bg-gray-50":"bg-gray-50/50"} ${d.length>0?"bg-gradient-to-br from-blue-50 to-indigo-50":""}`,children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-sm font-semibold transition-all ${i?"bg-blue-600 text-white shadow-lg":b?"text-gray-700":"text-gray-400"}`,children:s.format("D")}),d.length>0&&e.jsx("div",{className:"rounded-full bg-blue-600 px-2 py-0.5 text-xs font-semibold text-white shadow-sm",children:d.length})]}),e.jsx("div",{className:"space-y-1.5",children:d.map(l=>e.jsxs("div",{className:"group/item relative overflow-hidden rounded-lg border border-blue-200 bg-white p-2 shadow-sm transition-all hover:shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${l.status==1?"bg-green-500":"bg-gray-400"}`}),e.jsx("h4",{className:"line-clamp-1 text-xs font-semibold text-gray-900",children:l.name})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:l.type}),l.days>1&&e.jsxs("span",{className:"text-xs text-gray-600",children:[l.days,"d"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 opacity-0 transition-opacity group-hover/item:opacity-100",children:[e.jsx("button",{onClick:()=>y(String(l.id)),className:"flex h-7 w-7 items-center justify-center rounded-md bg-blue-600 text-white shadow-sm transition-all hover:bg-blue-700 hover:shadow-md",title:"Edit Holiday",children:e.jsx(Te,{className:"h-3.5 w-3.5"})}),e.jsx("button",{onClick:()=>Y(String(l.id)),disabled:S===String(l.id),className:"flex h-7 w-7 items-center justify-center rounded-md bg-red-600 text-white shadow-sm transition-all hover:bg-red-700 hover:shadow-md disabled:opacity-50",title:"Delete Holiday",children:S===String(l.id)?e.jsx($e,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(Ye,{className:"h-3.5 w-3.5"})})]})]}),l.name&&e.jsx("div",{className:"line-clamp-2 text-xs font-semibold text-gray-600",children:l.name}),l.description&&e.jsx("div",{className:"mt-1 line-clamp-2 text-xs text-gray-600",children:l.description})]},l.id))})]},x)})})]}),e.jsx("div",{className:"border-t bg-gray-50 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing holidays for ",c.format("MMMM YYYY")]}),e.jsx(oe,{page:N,limit:o,totalPages:(W=(G=a==null?void 0:a.data)==null?void 0:G.pagination)==null?void 0:W.totalPages,setPage:D,setLimit:k})]})})]})})]})]})]})}function it(){return e.jsx(re,{title:"Holiday List",subTitle:"Manage all the Holidays",children:e.jsx(Ae,{})})}export{it as default};
