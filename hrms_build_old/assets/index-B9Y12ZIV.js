import{r as e,an as s,aA as r,aD as t,j as a,ay as l,aB as d,al as n}from"./vendor-RyuIgj66.js";import{g as o,P as i}from"./index-DFF4_m_G.js";import{c,a as m,g as x,e as u}from"./yup-CH6wvET8.js";import{u as f}from"./useCustomQuery-DTB6aAiD.js";import{h as b}from"./index-ey2GEmQz.js";import{F as p,ah as h,O as y,T as g,X as j}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const N=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],v=c().shape({department_id:u().transform((e,s)=>""===s?void 0:e).required("Department is required").positive("Please select a valid department").integer("Please select a valid department"),weekly_offs:x().of(c().shape({day:m().required("Day is required").oneOf(N,"Invalid day selected"),weeks:x().of(u()).min(1,"Select at least one week").required("Weeks are required")})).min(1,"At least one weekly off is required").required(),description:m().optional(),department_name:m().optional()});function w(){var i;const[c,m]=e.useState(5),x=o(),u=f({}),w=s(),{register:k,control:_,handleSubmit:S,formState:{errors:W},setValue:C}=r({resolver:d(v),defaultValues:{department_id:void 0,department_name:void 0,weekly_offs:[{day:"Saturday",weeks:[]}],description:""}}),{fields:A,append:q,remove:D}=t({control:_,name:"weekly_offs"}),O=async e=>{var s;try{const r={department_id:String(e.department_id),weekly_offs:e.weekly_offs,description:e.description||"",department_name:e.department_name||""};(null==(s=(await u.mutateAsync({api:b.createWeekOff,data:r})).data)?void 0:s.success)&&(n.success("Weekly off created successfully!"),w(`/hrms/dashboard/weekly-off-list?department_id=${e.department_id}`))}catch(r){n.error("Failed to create weekly off. Please try again.")}};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsxs("div",{className:"mb-6 flex items-start gap-3 rounded border-l-4 border-blue-600 bg-blue-50 p-4",children:[a.jsx(p,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-blue-600"}),a.jsxs("div",{className:"text-sm text-blue-900",children:[a.jsx("p",{className:"font-semibold",children:"Instructions:"}),a.jsx("p",{className:"mt-1",children:"Configure weekly holidays for departments. Select the number of weeks, choose the department, and specify which weeks of the month should have holidays on selected days."})]})]}),a.jsxs("div",{className:"rounded-lg border border-gray-300 bg-white shadow-sm",children:[a.jsxs("div",{className:"border-b border-gray-200 bg-gray-100 px-6 py-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Weekly Off Configuration Form"}),a.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["All fields marked with ",a.jsx("span",{className:"text-red-600",children:"*"})," are mandatory"]})]}),a.jsxs("div",{className:"space-y-6 p-6",children:[a.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("label",{className:"mb-3 block text-sm font-semibold text-gray-700",children:["1. Number of Weeks in Month"," ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("div",{className:"flex gap-3",children:[4,5,6].map(e=>a.jsxs("button",{type:"button",onClick:()=>m(e),className:"rounded border-2 px-6 py-2.5 text-sm font-medium transition-colors "+(c===e?"border-blue-900 bg-blue-900 text-white":"border-gray-300 bg-white text-gray-700 hover:border-blue-900 hover:bg-blue-50"),children:[e," Weeks"]},e))}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Select the maximum number of weeks in a month for calculation"})]}),a.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["2. Select Department ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsxs("select",{...k("department_id"),onChange:e=>{const s=e.target.options[e.target.selectedIndex].text;C("department_name",s)},className:"w-full rounded border border-gray-400 bg-white px-3 py-2.5 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",children:[a.jsx("option",{value:"",children:"-- Select Department --"}),null==(i=null==x?void 0:x.data)?void 0:i.data.map(e=>a.jsx("option",{value:e.id,children:e.department_name},e.id))]}),W.department_id&&a.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[a.jsx(h,{className:"h-3 w-3"}),W.department_id.message]})]}),a.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["3. Weekly Offs Configuration"," ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsxs("button",{type:"button",onClick:()=>q({day:"Monday",weeks:[]}),className:"flex items-center gap-2 rounded border border-blue-900 bg-blue-900 px-4 py-1.5 text-sm font-medium text-white transition-colors hover:bg-blue-800",children:[a.jsx(y,{className:"h-4 w-4"}),"Add Day"]})]}),a.jsx("div",{className:"space-y-4",children:A.map((e,s)=>{var r,t,d,n,o,i,m,x;return a.jsx("div",{className:"rounded border border-gray-300 bg-white p-4",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsxs("div",{className:"flex-1 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-700",children:["Day ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("select",{...k(`weekly_offs.${s}.day`),className:"w-full rounded border border-gray-400 bg-white px-3 py-2 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",children:N.map(e=>a.jsx("option",{value:e,children:e},e))}),(null==(t=null==(r=W.weekly_offs)?void 0:r[s])?void 0:t.day)&&a.jsxs("p",{className:"mt-1 flex items-center gap-1 text-xs text-red-600",children:[a.jsx(h,{className:"h-3 w-3"}),null==(n=null==(d=W.weekly_offs[s])?void 0:d.day)?void 0:n.message]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-700",children:["Select Weeks ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx(l,{name:`weekly_offs.${s}.weeks`,control:_,render:({field:{value:e,onChange:s}})=>a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:c},(e,s)=>s+1).map(r=>{const t=null==e?void 0:e.includes(r);return a.jsxs("button",{type:"button",onClick:()=>s(((e,s,r)=>r.includes(s)?r.filter(e=>e!==s):[...r,s].sort((e,s)=>e-s))(0,r,e||[])),className:"rounded border-2 px-4 py-1.5 text-sm font-medium transition-colors "+(t?"border-green-700 bg-green-700 text-white":"border-gray-300 bg-white text-gray-700 hover:border-green-700 hover:bg-green-50"),children:["Week ",r]},r)})})}),(null==(i=null==(o=W.weekly_offs)?void 0:o[s])?void 0:i.weeks)&&a.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[a.jsx(h,{className:"h-3 w-3"}),null==(x=null==(m=W.weekly_offs[s])?void 0:m.weeks)?void 0:x.message]})]})]}),(null==A?void 0:A.length)>1&&a.jsx("button",{type:"button",onClick:()=>D(s),className:"rounded border border-red-600 p-2 text-red-600 transition-colors hover:bg-red-50",title:"Remove this day",children:a.jsx(g,{className:"h-4 w-4"})})]})},e.id)})}),W.weekly_offs&&!Array.isArray(W.weekly_offs)&&a.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[a.jsx(h,{className:"h-3 w-3"}),W.weekly_offs.message]})]}),a.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["4. Additional Description"," ",a.jsx("span",{className:"text-xs font-normal text-gray-500",children:"(Optional)"})]}),a.jsx("textarea",{...k("description"),rows:3,className:"w-full resize-none rounded border border-gray-400 px-3 py-2 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",placeholder:"Enter any additional information (e.g., 2nd & 4th Saturday off, All Sundays off)"}),W.description&&a.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[a.jsx(h,{className:"h-3 w-3"}),W.description.message]})]}),u.isSuccess&&a.jsxs("div",{className:"flex items-center gap-3 rounded border-l-4 border-green-600 bg-green-50 p-4 text-green-800",children:[a.jsx(j,{className:"h-5 w-5 flex-shrink-0"}),a.jsx("span",{className:"text-sm font-medium",children:"Weekly off configuration has been created successfully!"})]}),u.isError&&a.jsxs("div",{className:"flex items-center gap-3 rounded border-l-4 border-red-600 bg-red-50 p-4 text-red-800",children:[a.jsx(h,{className:"h-5 w-5 flex-shrink-0"}),a.jsx("span",{className:"text-sm font-medium",children:u.error.message})]})]}),a.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-xs text-gray-600",children:"Please review all information before submitting"}),a.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),S(O)(e)},disabled:u.isPending,className:"rounded bg-green-700 px-8 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-green-800 disabled:cursor-not-allowed disabled:bg-gray-400",children:u.isPending?"Submitting...":"Submit"})]})})]})]})}function k(){return a.jsx(i,{title:"Create Weekly Off",subTitle:"Manage all the Weekly Offs here",children:a.jsx(w,{})})}export{k as default};
