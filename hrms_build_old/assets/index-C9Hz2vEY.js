import{h as e,f as t,r as i,j as a,z as l,B as s,e as n}from"./index-BJ2Di0BB.js";import{P as r}from"./index-L2kacWh6.js";import{h as o}from"./moment-CBOc1lqT.js";import{C as d,a as c,b as u,c as m}from"./card-CrOEotWM.js";import{S as f,T as p,a as v,b,c as x,d as j,e as h}from"./index-BxKGIMG5.js";import{u as g,b as S}from"./useCustomQuery-DkqDqiry.js";import{P as _}from"./index-DZvdNKxy.js";import{S as y}from"./separator-BtSn9EpY.js";import{S as E}from"./Spinner-DjUjMlqR.js";import{a as C,o as I,c as N,f as w,b as A}from"./yup-BTlf5Wf5.js";import{F as R}from"./datetime-picker-cKnQNXMD.js";import{R as k}from"./RHFTextField-BK1QXo_s.js";import{B as F}from"./ButtonLoading-B5GmY3N3.js";import"./select-4D5dQM-6.js";import{R as q}from"./DateAndTimePicker-Bmu_5TYR.js";import{D}from"./index-ClKtlEeL.js";import"./calendar-B99NsLtP.js";import"./clock-PqgEqIzL.js";import"./check-DiqtQ1XW.js";const Y=N().shape({employee_contribution_rate:w().required("Employee Contribution Rate is required").min(0).max(100),employer_contribution_rate:w().required("Employer Contribution Rate is required").min(0).max(100),wage_ceiling:w().required("Wage Ceiling is required").min(0),effective_from:A().required("Effective From date is required"),effective_to:A().nullable().optional(),status:w().optional()});function P({open:s,setOpen:n,title:r,id:o,edit:d,setEdit:c,refetch:u}){var m;const f=g({}),{data:p,isFetching:v}=S({api:`${null==(m=e)?void 0:m.getESISlabById}?id=${t(String(o))}`,key:"getESISlabById",options:{enabled:d&&!!o}}),b=C({defaultValues:{employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1},resolver:I(Y)});return i.useEffect(()=>{var e,t,i,a,l,s;d&&p?b.reset({employee_contribution_rate:Number(null==(e=null==p?void 0:p.data)?void 0:e.employee_contribution_rate)||0,employer_contribution_rate:Number(null==(t=null==p?void 0:p.data)?void 0:t.employer_contribution_rate)||0,wage_ceiling:Number(null==(i=null==p?void 0:p.data)?void 0:i.wage_ceiling)||0,effective_from:(null==(a=null==p?void 0:p.data)?void 0:a.effective_from)||"",effective_to:(null==(l=null==p?void 0:p.data)?void 0:l.effective_to)||null,status:(null==(s=null==p?void 0:p.data)?void 0:s.status)||1}):b.reset({employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1})},[d,p,b]),a.jsx(D,{open:s,setOpen:n,title:r,setEdit:c,edit:d,isLoading:v,children:a.jsx(R,{methods:b,onSubmit:b.handleSubmit(async t=>{var i,a,s,r,m,p,v,x;try{if(d&&o){const n=await f.mutateAsync({api:null==(i=e)?void 0:i.updateESISlab,data:{id:Number(o),...t}});(null==(a=n.data)?void 0:a.success)?l.success((null==(s=null==n?void 0:n.data)?void 0:s.message)||"ESI Contribution Slab updated successfully"):l.error((null==(r=n.data)?void 0:r.message)||"ESI Contribution Slab not updated successfully")}else{const i=await f.mutateAsync({api:null==(m=e)?void 0:m.createESISlab,data:t});(null==(p=i.data)?void 0:p.success)?l.success((null==(v=null==i?void 0:i.data)?void 0:v.message)||"ESI Contribution Slab created successfully"):l.error((null==(x=i.data)?void 0:x.message)||"ESI Contribution Slab not created successfully")}b.reset({employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1}),n(!1),null==c||c(!1),null==u||u()}catch(j){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(k,{label:"Employee Contribution Rate",name:"employee_contribution_rate",placeholder:"Enter Employee Contribution Rate (%)",type:"number",step:"0.01"})}),a.jsx("div",{children:a.jsx(k,{label:"Employer Contribution Rate",name:"employer_contribution_rate",placeholder:"Enter Employer Contribution Rate (%)",type:"number",step:"0.01"})}),a.jsx("div",{children:a.jsx(k,{label:"Wage Ceiling",name:"wage_ceiling",placeholder:"Enter Wage Ceiling",type:"number"})}),a.jsx("div",{children:a.jsx(q,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),a.jsx("div",{children:a.jsx(q,{name:"effective_to",label:"Effective To (Optional)",placeholder:"Select effective to date"})}),a.jsx(y,{}),a.jsx("div",{children:a.jsx(F,{isLoading:b.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function B(){var t,r,C,I,N,w;const A=g({}),[R,k]=i.useState(1),[F]=i.useState(10),[q,D]=i.useState(""),[Y,B]=i.useState(!1),[L,M]=i.useState(""),[T,$]=i.useState(!1),z=S({api:`${e.getAllESISlabs}?page=${R}&limit=${F}&q=${q}`,key:"getAllESISlabs",value:[R,F,q],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(P,{open:Y,setOpen:B,title:T?"Edit ESI Contribution Slab":"Add ESI Contribution Slab",id:L,edit:T,setEdit:$,refetch:z.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(f,{search:q,setSearch:D,refetch:z.refetch,isFetching:null==z?void 0:z.isLoading})}),a.jsx("div",{children:a.jsx(s,{className:"flex items-center gap-2",onClick:()=>B(!0),children:"Add New"})})]}),a.jsx(y,{}),a.jsxs(d,{children:[a.jsx(c,{children:a.jsx(u,{children:"ESI Contribution Slabs"})}),a.jsx(m,{children:(null==z?void 0:z.isLoading)?a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(E,{})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(p,{children:[a.jsx(v,{children:a.jsxs(b,{children:[a.jsx(x,{children:"Employee Rate (%)"}),a.jsx(x,{children:"Employer Rate (%)"}),a.jsx(x,{children:"Wage Ceiling"}),a.jsx(x,{children:"Effective From"}),a.jsx(x,{children:"Effective To"}),a.jsx(x,{children:"Status"}),a.jsx(x,{children:"Actions"})]})}),a.jsx(j,{children:(null==(t=null==z?void 0:z.data)?void 0:t.data)&&(null==(r=null==z?void 0:z.data)?void 0:r.data.length)>0?null==(C=null==z?void 0:z.data)?void 0:C.data.map(t=>a.jsxs(b,{children:[a.jsxs(h,{children:[t.employee_contribution_rate,"%"]}),a.jsxs(h,{children:[t.employer_contribution_rate,"%"]}),a.jsxs(h,{children:["â‚¹",t.wage_ceiling]}),a.jsx(h,{children:o(t.effective_from).format("DD/MM/YYYY")}),a.jsx(h,{children:t.effective_to?o(t.effective_to).format("DD/MM/YYYY"):"-"}),a.jsx(h,{children:a.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold "+(1===t.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:1===t.status?"Active":"Inactive"})}),a.jsxs(h,{className:"flex gap-2",children:[a.jsx(s,{variant:"outline",size:"sm",onClick:()=>{return e=String(t.id),$(!0),B(!0),void M(e);var e},children:"Edit"}),a.jsx(s,{variant:"destructive",size:"sm",onClick:()=>(async t=>{var i,a,s,r;try{const n=await A.mutateAsync({api:null==(i=e)?void 0:i.deleteESISlab,data:{id:Number(t)}});(null==(a=null==n?void 0:n.data)?void 0:a.success)?(z.refetch(),l.success((null==(s=null==n?void 0:n.data)?void 0:s.message)||"ESI Contribution Slab deleted successfully")):l.error((null==(r=n.data)?void 0:r.message)||"Failed to delete ESI Contribution Slab")}catch(o){l.error(n(o))}})(String(t.id)),children:"Delete"})]})]},t.id)):a.jsx(b,{children:a.jsx(h,{colSpan:7,className:"text-center",children:"No ESI Contribution Slabs found"})})})]})})})]}),(null==(I=null==z?void 0:z.data)?void 0:I.pagination)&&a.jsx(_,{page:R,setPage:k,limit:F,totalPages:(null==(w=null==(N=null==z?void 0:z.data)?void 0:N.pagination)?void 0:w.totalPages)||1})]})]})}function L(){return a.jsx(r,{title:"ESI Contribution Slab",subTitle:"Manage ESI Contribution Slabs",children:a.jsx("div",{className:"py-12",children:a.jsx(B,{})})})}export{L as default};
