import{r as e,q as s,j as r,h as t,z as a}from"./index-pqP14EhS.js";import{g as l,P as d}from"./index-DZYVnpiZ.js";import{a as n,h as o,C as i,o as c,c as m,b as x,i as u,f}from"./yup-C8lOt6vX.js";import{u as b}from"./useCustomQuery-CzEWxvyG.js";import{C as p}from"./circle-alert-B7J-58O5.js";import{X as h}from"./x-CD4qz--Q.js";import{P as y}from"./plus-DLYguytq.js";import{T as g}from"./trash-2-DbSJu2aJ.js";import{C as j}from"./check-BQY2iuAn.js";const N=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],v=m().shape({department_id:f().transform((e,s)=>""===s?void 0:e).required("Department is required").positive("Please select a valid department").integer("Please select a valid department"),weekly_offs:u().of(m().shape({day:x().required("Day is required").oneOf(N,"Invalid day selected"),weeks:u().of(f()).min(1,"Select at least one week").required("Weeks are required")})).min(1,"At least one weekly off is required").required(),description:x().optional(),department_name:x().optional()});function w(){var d;const[m,x]=e.useState(5),u=l(),f=b({}),w=s(),{register:k,control:_,handleSubmit:S,formState:{errors:C},setValue:W}=n({resolver:c(v),defaultValues:{department_id:void 0,department_name:void 0,weekly_offs:[{day:"Saturday",weeks:[]}],description:""}}),{fields:q,append:A,remove:D}=o({control:_,name:"weekly_offs"}),O=async e=>{var s;try{const r={department_id:String(e.department_id),weekly_offs:e.weekly_offs,description:e.description||"",department_name:e.department_name||""};(null==(s=(await f.mutateAsync({api:t.createWeekOff,data:r})).data)?void 0:s.success)&&(a.success("Weekly off created successfully!"),w(`/hrms/dashboard/weekly-off-list?department_id=${e.department_id}`))}catch(r){a.error("Failed to create weekly off. Please try again.")}};return r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsxs("div",{className:"mb-6 flex items-start gap-3 rounded border-l-4 border-blue-600 bg-blue-50 p-4",children:[r.jsx(p,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-blue-600"}),r.jsxs("div",{className:"text-sm text-blue-900",children:[r.jsx("p",{className:"font-semibold",children:"Instructions:"}),r.jsx("p",{className:"mt-1",children:"Configure weekly holidays for departments. Select the number of weeks, choose the department, and specify which weeks of the month should have holidays on selected days."})]})]}),r.jsxs("div",{className:"rounded-lg border border-gray-300 bg-white shadow-sm",children:[r.jsxs("div",{className:"border-b border-gray-200 bg-gray-100 px-6 py-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Weekly Off Configuration Form"}),r.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["All fields marked with ",r.jsx("span",{className:"text-red-600",children:"*"})," are mandatory"]})]}),r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[r.jsxs("label",{className:"mb-3 block text-sm font-semibold text-gray-700",children:["1. Number of Weeks in Month"," ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsx("div",{className:"flex gap-3",children:[4,5,6].map(e=>r.jsxs("button",{type:"button",onClick:()=>x(e),className:"rounded border-2 px-6 py-2.5 text-sm font-medium transition-colors "+(m===e?"border-blue-900 bg-blue-900 text-white":"border-gray-300 bg-white text-gray-700 hover:border-blue-900 hover:bg-blue-50"),children:[e," Weeks"]},e))}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Select the maximum number of weeks in a month for calculation"})]}),r.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[r.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["2. Select Department ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsxs("select",{...k("department_id"),onChange:e=>{const s=e.target.options[e.target.selectedIndex].text;W("department_name",s)},className:"w-full rounded border border-gray-400 bg-white px-3 py-2.5 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",children:[r.jsx("option",{value:"",children:"-- Select Department --"}),null==(d=null==u?void 0:u.data)?void 0:d.data.map(e=>r.jsx("option",{value:e.id,children:e.department_name},e.id))]}),C.department_id&&r.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[r.jsx(h,{className:"h-3 w-3"}),C.department_id.message]})]}),r.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[r.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["3. Weekly Offs Configuration"," ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsxs("button",{type:"button",onClick:()=>A({day:"Monday",weeks:[]}),className:"flex items-center gap-2 rounded border border-blue-900 bg-blue-900 px-4 py-1.5 text-sm font-medium text-white transition-colors hover:bg-blue-800",children:[r.jsx(y,{className:"h-4 w-4"}),"Add Day"]})]}),r.jsx("div",{className:"space-y-4",children:q.map((e,s)=>{var t,a,l,d,n,o,c,x;return r.jsx("div",{className:"rounded border border-gray-300 bg-white p-4",children:r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-700",children:["Day ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsx("select",{...k(`weekly_offs.${s}.day`),className:"w-full rounded border border-gray-400 bg-white px-3 py-2 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",children:N.map(e=>r.jsx("option",{value:e,children:e},e))}),(null==(a=null==(t=C.weekly_offs)?void 0:t[s])?void 0:a.day)&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-xs text-red-600",children:[r.jsx(h,{className:"h-3 w-3"}),null==(d=null==(l=C.weekly_offs[s])?void 0:l.day)?void 0:d.message]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-700",children:["Select Weeks ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsx(i,{name:`weekly_offs.${s}.weeks`,control:_,render:({field:{value:e,onChange:s}})=>r.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:m},(e,s)=>s+1).map(t=>{const a=null==e?void 0:e.includes(t);return r.jsxs("button",{type:"button",onClick:()=>s(((e,s,r)=>r.includes(s)?r.filter(e=>e!==s):[...r,s].sort((e,s)=>e-s))(0,t,e||[])),className:"rounded border-2 px-4 py-1.5 text-sm font-medium transition-colors "+(a?"border-green-700 bg-green-700 text-white":"border-gray-300 bg-white text-gray-700 hover:border-green-700 hover:bg-green-50"),children:["Week ",t]},t)})})}),(null==(o=null==(n=C.weekly_offs)?void 0:n[s])?void 0:o.weeks)&&r.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[r.jsx(h,{className:"h-3 w-3"}),null==(x=null==(c=C.weekly_offs[s])?void 0:c.weeks)?void 0:x.message]})]})]}),(null==q?void 0:q.length)>1&&r.jsx("button",{type:"button",onClick:()=>D(s),className:"rounded border border-red-600 p-2 text-red-600 transition-colors hover:bg-red-50",title:"Remove this day",children:r.jsx(g,{className:"h-4 w-4"})})]})},e.id)})}),C.weekly_offs&&!Array.isArray(C.weekly_offs)&&r.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[r.jsx(h,{className:"h-3 w-3"}),C.weekly_offs.message]})]}),r.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-4",children:[r.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["4. Additional Description"," ",r.jsx("span",{className:"text-xs font-normal text-gray-500",children:"(Optional)"})]}),r.jsx("textarea",{...k("description"),rows:3,className:"w-full resize-none rounded border border-gray-400 px-3 py-2 text-sm focus:border-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-900 focus:ring-opacity-50",placeholder:"Enter any additional information (e.g., 2nd & 4th Saturday off, All Sundays off)"}),C.description&&r.jsxs("p",{className:"mt-2 flex items-center gap-1 text-xs text-red-600",children:[r.jsx(h,{className:"h-3 w-3"}),C.description.message]})]}),f.isSuccess&&r.jsxs("div",{className:"flex items-center gap-3 rounded border-l-4 border-green-600 bg-green-50 p-4 text-green-800",children:[r.jsx(j,{className:"h-5 w-5 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-medium",children:"Weekly off configuration has been created successfully!"})]}),f.isError&&r.jsxs("div",{className:"flex items-center gap-3 rounded border-l-4 border-red-600 bg-red-50 p-4 text-red-800",children:[r.jsx(h,{className:"h-5 w-5 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-medium",children:f.error.message})]})]}),r.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Please review all information before submitting"}),r.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),S(O)(e)},disabled:f.isPending,className:"rounded bg-green-700 px-8 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-green-800 disabled:cursor-not-allowed disabled:bg-gray-400",children:f.isPending?"Submitting...":"Submit"})]})})]})]})}function k(){return r.jsx(d,{title:"Create Weekly Off",subTitle:"Manage all the Weekly Offs here",children:r.jsx(w,{})})}export{k as default};
