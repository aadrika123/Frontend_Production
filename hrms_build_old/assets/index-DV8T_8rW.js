import{h as e,f as a,r as s,j as l,z as t,B as r,e as d}from"./index-C0dR7KKl.js";import{a as i,P as n}from"./index-DLwgcCrU.js";import{h as o}from"./moment-CBOc1lqT.js";import{C as c,c as m,a as x,d as u,b as h}from"./card-dfHK731x.js";import{T as p,a as v,b as j,c as f,d as y,e as _}from"./table-DGsqq0wP.js";import{S as g,a as w,b,c as N,e as S,f as L,d as T}from"./select-PSqof_An.js";import{u as C,b as D}from"./useCustomQuery-DfubPPhS.js";import{P as F}from"./index-CtQoh3RB.js";import{S as A}from"./separator-DK9wbIss.js";import{S as k}from"./index-DxKRME66.js";import{S as E}from"./Spinner-Bh5S-NfG.js";import{a as M,o as q,c as $,b as P,d as R}from"./yup-D-4eAt9F.js";import{F as B}from"./datetime-picker-Chw5tpGr.js";import{R as V}from"./RHFTextField-Bf4PLUtQ.js";import{R as Y}from"./RHFTextArea-CV_jXdwm.js";import{B as I}from"./ButtonLoading-CtnN6-Kp.js";import{R as O}from"./RHFSelectField-DetLCX2z.js";import"./input-5m-sj67D.js";import"./switch-DfyNgsks.js";import{C as z}from"./checkbox-5PN_yyUS.js";import{L as H}from"./label-BBEmak6c.js";import{D as Q}from"./index-Bak7Z6rK.js";import{B as U}from"./building-2-CdWSF90a.js";import{P as W}from"./plus-CFKm8SMJ.js";import{C as X}from"./calendar-D3nBqMDA.js";import{F as Z}from"./file-text-BD6EF3bc.js";import{P as G}from"./pen-BROgvl2c.js";import{L as J}from"./loader-circle-l2PdwOoK.js";import{T as K}from"./trash-2-BiiNp5Cs.js";import"./check-DJnOI1b1.js";import"./chevron-right-ZD98JKF5.js";import"./clock-zyZI13Cr.js";const ee=$().shape({leave_type_name:P().required("Leave type name is required"),max_days_per_year:P().required("Max days per year is required").min(1,"Max days must be at least 1"),carry_forward_allowed:R().required(),max_carry_forward_days:P().when("carry_forward_allowed",{is:!0,then:e=>e.min(0,"Cannot be negative"),otherwise:e=>e.notRequired()}),encashment_allowed:R().required(),description:P(),department_id:P().required("Department ID is required").min(1,"Department ID must be at least 1")});function ae({open:r,setOpen:d,title:n,id:o,edit:c,setEdit:m,refetch:x}){var u,h,p;const v=C({}),j=i(),{data:f,isFetching:y}=D({api:`${null==(u=e)?void 0:u.getLeaveTypeById}?id=${a(String(o))}`,key:"getLeaveTypeById",options:{enabled:c}}),_=M({defaultValues:{leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""},resolver:q(ee)});return s.useEffect(()=>{var e,a,s,l,t,r,d;c&&f?_.reset({leave_type_name:null==(e=null==f?void 0:f.data)?void 0:e.leave_type_name,max_days_per_year:String(null==(a=null==f?void 0:f.data)?void 0:a.max_days_per_year),carry_forward_allowed:null==(s=null==f?void 0:f.data)?void 0:s.carry_forward_allowed,max_carry_forward_days:String(null==(l=null==f?void 0:f.data)?void 0:l.max_carry_forward_days),encashment_allowed:null==(t=null==f?void 0:f.data)?void 0:t.encashment_allowed,description:null==(r=null==f?void 0:f.data)?void 0:r.description,department_id:String(null==(d=null==f?void 0:f.data)?void 0:d.department_id)}):_.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})},[c,f]),l.jsx(Q,{open:r,setOpen:d,title:n,setEdit:m,edit:c,isLoading:y,children:l.jsx(B,{methods:_,onSubmit:_.handleSubmit(async a=>{var s,l,r,i,n,u,h,p;try{if(c&&a){const d=await v.mutateAsync({api:`${null==(s=e)?void 0:s.updateLeaveTypeById}`,data:{id:o,...a}});(null==(l=d.data)?void 0:l.success)?t.success(null==(r=null==d?void 0:d.data)?void 0:r.message):t.error((null==(i=d.data)?void 0:i.message)||"Leave type not updated successfully")}else{const s=await v.mutateAsync({api:null==(n=e)?void 0:n.createLeaveType,data:a});(null==(u=s.data)?void 0:u.success)?t.success(null==(h=null==s?void 0:s.data)?void 0:h.message):t.error((null==(p=s.data)?void 0:p.message)||"Leave type not created successfully"),_.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})}d(!1),m(!1),x()}catch(j){}}),children:l.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[l.jsx("div",{children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[l.jsx(U,{className:"h-4 w-4 text-gray-400"}),"Department ID"]}),l.jsx(O,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(null==(p=null==(h=null==j?void 0:j.data)?void 0:h.data)?void 0:p.length)?j.data.data.map(e=>({label:String(e.department_name),value:String(e.id)})):[]})]})}),l.jsx("div",{children:l.jsx(V,{name:"leave_type_name",placeholder:"Enter Leave Type Name",label:"Leave Type Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),l.jsx("div",{children:l.jsx("div",{children:l.jsx(V,{name:"max_days_per_year",placeholder:"Enter Max Days",label:"Max Days Per Year",inputValidation:["number"]})})}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(z,{id:"carry_forward_allowed",checked:_.watch("carry_forward_allowed"),onCheckedChange:e=>_.setValue("carry_forward_allowed",e)}),l.jsx(H,{htmlFor:"carry_forward_allowed",className:"text-sm font-medium",children:"Carry Forward Allowed"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(z,{id:"encashment_allowed",checked:_.watch("encashment_allowed"),onCheckedChange:e=>_.setValue("encashment_allowed",e)}),l.jsx(H,{htmlFor:"encashment_allowed",className:"text-sm font-medium",children:"Encashment Allowed"})]})]}),_.watch("carry_forward_allowed")&&l.jsx("div",{children:l.jsx(V,{name:"max_carry_forward_days",placeholder:"Enter Max Carry Forward Days",label:"Max Carry Forward Days",inputValidation:["number"]})}),l.jsx("div",{children:l.jsx(Y,{name:"description",placeholder:"Enter Description",label:"Description"})}),l.jsx(A,{}),l.jsx("div",{children:l.jsx(I,{isLoading:_.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function se(){var n,M,q,$,P,R,B,V,Y,I,O,z;const H=C({}),Q=i(),[U,ee]=s.useState(1),[se,le]=s.useState(10),[te,re]=s.useState(""),[de,ie]=s.useState(!1),[ne,oe]=s.useState(""),[ce,me]=s.useState(!1),[xe,ue]=s.useState(null),[he,pe]=s.useState(""),ve=D({api:`${e.getAllLeaveTypes}?page=${U}&limit=${se}&q=${te}&department_id=${a(String(he))}`,key:"getAllLeaveTypes",value:[U,se,te,he],options:{enabled:!0}});return l.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[l.jsx(ae,{open:de,setOpen:ie,title:ce?"Edit Leave Type":"Add Leave Type",id:ne,edit:ce,setEdit:me,refetch:null==ve?void 0:ve.refetch}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[l.jsx("div",{}),l.jsxs(r,{onClick:()=>ie(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 shadow-lg shadow-blue-500/30 transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:shadow-blue-500/40",children:[l.jsx(W,{className:"mr-2 h-4 w-4"}),"Add Leave Type"]})]}),l.jsx(c,{className:"border-slate-200 shadow-sm",children:l.jsx(m,{className:"pt-6",children:l.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[l.jsx("div",{className:"max-w-md flex-1",children:l.jsx(k,{search:te,setSearch:re,refetch:null==ve?void 0:ve.refetch,isFetching:null==ve?void 0:ve.isLoading})}),l.jsxs(g,{onValueChange:e=>pe(e),value:he,children:[l.jsx(w,{className:"w-full bg-white sm:w-[220px]",children:l.jsx(b,{placeholder:"All Departments"})}),l.jsx(N,{children:l.jsxs(S,{children:[l.jsx(L,{children:"Filter by Department"}),(null==(M=null==(n=null==Q?void 0:Q.data)?void 0:n.data)?void 0:M.length)?Q.data.data.map(e=>l.jsx(T,{value:String(e.id),children:e.department_name},e.id)):null]})})]})]})})}),l.jsxs(c,{className:"overflow-hidden border-slate-200 shadow-lg",children:[l.jsx(x,{className:"border-b bg-gradient-to-r from-slate-50 to-blue-50",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(u,{className:"text-xl font-semibold text-slate-900",children:"Leave Types Registry"}),l.jsxs(h,{className:"mt-1",children:["Total ",(null==($=null==(q=null==ve?void 0:ve.data)?void 0:q.pagination)?void 0:$.total)||0," leave type(s) configured"]})]}),l.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:l.jsx(X,{className:"h-6 w-6 text-blue-600"})})]})}),l.jsx(m,{className:"p-0",children:(null==ve?void 0:ve.isLoading)?l.jsx("div",{className:"flex h-64 items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(E,{}),l.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Loading leave types..."})]})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(p,{children:[l.jsx(v,{children:l.jsxs(j,{className:"bg-slate-50 hover:bg-slate-50",children:[l.jsx(f,{className:"w-16 font-semibold text-slate-700",children:"#"}),l.jsx(f,{className:"font-semibold text-slate-700",children:"Leave Type"}),l.jsx(f,{className:"font-semibold text-slate-700",children:"Max Days/Year"}),l.jsx(f,{className:"font-semibold text-slate-700",children:"Carry Forward"}),l.jsx(f,{className:"font-semibold text-slate-700",children:"Encashment"}),l.jsx(f,{className:"font-semibold text-slate-700",children:"Created Date"}),l.jsx(f,{className:"text-right font-semibold text-slate-700",children:"Actions"})]})}),l.jsxs(y,{children:[null==(R=null==(P=null==ve?void 0:ve.data)?void 0:P.data)?void 0:R.map((a,s)=>l.jsxs(j,{className:"border-b border-slate-100 transition-colors hover:bg-slate-50/50",children:[l.jsx(_,{className:"font-medium text-slate-500",children:(U-1)*se+s+1}),l.jsx(_,{children:l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Z,{className:"h-4 w-4 text-slate-400"}),l.jsx("span",{className:"font-semibold text-slate-900",children:null==a?void 0:a.leave_type_name})]}),(null==a?void 0:a.description)&&l.jsx("div",{className:"ml-6 text-sm text-slate-500",children:null==a?void 0:a.description})]})}),l.jsx(_,{children:l.jsxs("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2.5 py-1 text-sm font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:[null==a?void 0:a.max_days_per_year," days"]})}),l.jsx(_,{children:(null==a?void 0:a.carry_forward_allowed)?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),l.jsxs("span",{className:"text-sm font-medium text-green-700",children:["Yes (",null==a?void 0:a.max_carry_forward_days," days)"]})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),l.jsx("span",{className:"text-sm text-slate-500",children:"No"})]})}),l.jsx(_,{children:(null==a?void 0:a.encashment_allowed)?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),l.jsx("span",{className:"text-sm font-medium text-green-700",children:"Allowed"})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),l.jsx("span",{className:"text-sm text-slate-500",children:"Not Allowed"})]})}),l.jsx(_,{children:l.jsx("span",{className:"text-sm text-slate-600",children:o(null==a?void 0:a.created_at).format("DD MMM YYYY")})}),l.jsx(_,{children:l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(r,{size:"sm",variant:"outline",onClick:()=>{return e=String(null==a?void 0:a.id),me(!0),ie(!0),void oe(e);var e},className:"h-8 border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700",children:l.jsx(G,{className:"h-3.5 w-3.5"})}),l.jsx(r,{size:"sm",variant:"outline",disabled:xe===String(null==a?void 0:a.id),onClick:()=>(async a=>{var s,l,r,i;ue(a);try{const d=await H.mutateAsync({api:`${null==(s=e)?void 0:s.deleteLeaveTypeById}`,data:{id:a}});(null==(l=null==d?void 0:d.data)?void 0:l.success)?(null==ve||ve.refetch(),t.success(null==(r=null==d?void 0:d.data)?void 0:r.message)):t.error(null==(i=d.data)?void 0:i.message)}catch(n){t.error(d(n))}finally{ue(null)}})(String(null==a?void 0:a.id)),className:"h-8 border-red-200 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 disabled:opacity-50",children:xe===String(null==a?void 0:a.id)?l.jsx(J,{className:"h-3.5 w-3.5 animate-spin"}):l.jsx(K,{className:"h-3.5 w-3.5"})})]})})]},null==a?void 0:a.id)),0===(null==(V=null==(B=null==ve?void 0:ve.data)?void 0:B.data)?void 0:V.length)&&l.jsx(j,{children:l.jsx(_,{colSpan:7,className:"h-64 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center text-slate-500",children:[l.jsx(X,{className:"mb-4 h-12 w-12 text-slate-300"}),l.jsx("p",{className:"text-lg font-medium",children:"No leave types found"}),l.jsx("p",{className:"mt-1 text-sm",children:"Create your first leave type to get started"})]})})})]})]})}),((null==(I=null==(Y=null==ve?void 0:ve.data)?void 0:Y.data)?void 0:I.length)??0)>0&&l.jsxs(l.Fragment,{children:[l.jsx(A,{className:"my-4"}),l.jsx("div",{className:"px-6 pb-4",children:l.jsx(F,{page:U,limit:se,totalPages:null==(z=null==(O=null==ve?void 0:ve.data)?void 0:O.pagination)?void 0:z.totalPages,setPage:ee,setLimit:le})})]})]})})]})]})]})}function le(){return l.jsx(n,{title:"Leave Type List",subTitle:"Manage all the Leave Types here",children:l.jsx("div",{children:l.jsx(se,{})})})}export{le as default};
