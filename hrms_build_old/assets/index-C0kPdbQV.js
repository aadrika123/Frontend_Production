import{aA as e,r as i,j as s,aB as a,al as t}from"./vendor-RyuIgj66.js";import{P as l}from"./index-DFF4_m_G.js";import{h as r}from"./moment-CBOc1lqT.js";import{h as c,e as n,B as d,g as o}from"./index-ey2GEmQz.js";import{C as m,a as u,b as f,c as j}from"./card-u7M7FP5y.js";import{T as p,a as v,b as h,c as x,d as y,e as g}from"./table-B_npepsp.js";import{u as C,b as _}from"./useCustomQuery-DTB6aAiD.js";import{P as A}from"./index-BHR1l08i.js";import{S as N}from"./separator-BQijJEjG.js";import{S as R}from"./index-CUStUwt1.js";import{S}from"./Spinner-BwGzvoRj.js";import{c as b,a as H,e as E}from"./yup-CH6wvET8.js";import{F as Y}from"./datetime-picker-dN6E5dqy.js";import{R as q}from"./RHFTextField-BSZ_cEI3.js";import{B as w}from"./ButtonLoading-DDalXO-W.js";import"./select-8PAfYjod.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{R as F}from"./DateAndTimePicker-CtTdRVKm.js";import{D}from"./index-B2ia16z0.js";import"./ui-B3c1eQmf.js";import"./icons-CxCh8mm_.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const k=b().shape({city_classification:H().required("City Classification is required"),city_name:H().required("City Name is required"),hra_percentage:E().required("HRA Percentage is required").min(0).max(100),effective_from:H().required("Effective From date is required")});function P({open:l,setOpen:r,title:d,id:o,edit:m,setEdit:u,refetch:f}){var j;const p=C({}),{data:v,isFetching:h}=_({api:`${null==(j=c)?void 0:j.getHRACityById}?id=${n(String(o))}`,key:"getHRACityById",options:{enabled:m&&!!o}}),x=e({defaultValues:{city_classification:"",city_name:"",hra_percentage:0,effective_from:""},resolver:a(k)});return i.useEffect(()=>{var e,i,s,a;m&&v?x.reset({city_classification:(null==(e=null==v?void 0:v.data)?void 0:e.city_classification)||"",city_name:(null==(i=null==v?void 0:v.data)?void 0:i.city_name)||"",hra_percentage:Number(null==(s=null==v?void 0:v.data)?void 0:s.hra_percentage)||0,effective_from:(null==(a=null==v?void 0:v.data)?void 0:a.effective_from)||""}):x.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})},[m,v]),s.jsx(D,{open:l,setOpen:r,title:d,setEdit:u,edit:m,isLoading:h,children:s.jsx(Y,{methods:x,onSubmit:x.handleSubmit(async e=>{var i,s,a,l,n,d,j,v;try{if(m&&o){const r=await p.mutateAsync({api:null==(i=c)?void 0:i.updateHRACity,data:{id:Number(o),...e}});(null==(s=r.data)?void 0:s.success)?t.success((null==(a=null==r?void 0:r.data)?void 0:a.message)||"HRA Classification updated successfully"):t.error((null==(l=r.data)?void 0:l.message)||"HRA Classification not updated successfully")}else{const i=await p.mutateAsync({api:null==(n=c)?void 0:n.createHRACity,data:e});(null==(d=i.data)?void 0:d.success)?t.success((null==(j=null==i?void 0:i.data)?void 0:j.message)||"HRA Classification created successfully"):t.error((null==(v=i.data)?void 0:v.message)||"HRA Classification not created successfully"),x.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})}r(!1),u(!1),f()}catch(h){}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[s.jsx("div",{children:s.jsx(q,{name:"city_classification",placeholder:"Enter City Classification (X, Y, Z)",inputValidation:["removeSpecialCharacterExceptSpace"]})}),s.jsx("div",{children:s.jsx(q,{name:"city_name",placeholder:"Enter City Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),s.jsx("div",{children:s.jsx(q,{name:"hra_percentage",placeholder:"Enter HRA Percentage",type:"number"})}),s.jsx("div",{children:s.jsx(F,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),s.jsx(N,{}),s.jsx("div",{children:s.jsx(w,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function L(){var e,a,l,n,b,H;const E=C({}),[Y,q]=i.useState(1),[w,F]=i.useState(10),[D,k]=i.useState(""),[L,M]=i.useState(!1),[$,B]=i.useState(""),[T,O]=i.useState(!1),V=_({api:`${c.getAllHRACities}?page=${Y}&limit=${w}&q=${D}`,key:"getAllHRACities",value:[Y,w,D],options:{enabled:!0}});return s.jsxs("main",{className:"grid items-start",children:[s.jsx(P,{open:L,setOpen:M,title:T?"Edit HRA Classification":"Add HRA Classification",id:$,edit:T,setEdit:O,refetch:V.refetch}),s.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[s.jsxs("div",{className:"flex w-full justify-between gap-2",children:[s.jsx("div",{children:s.jsx(R,{search:D,setSearch:k,refetch:V.refetch,isFetching:null==V?void 0:V.isLoading})}),s.jsx("div",{children:s.jsx(d,{className:"flex items-center gap-2",onClick:()=>M(!0),children:"Add New"})})]}),s.jsxs(m,{children:[s.jsx(u,{className:"px-7",children:s.jsxs(f,{children:["HRA Classification List (",(null==(a=null==(e=null==V?void 0:V.data)?void 0:e.pagination)?void 0:a.total)||0,")"]})}),s.jsx(j,{children:V.isLoading?s.jsx("div",{className:"flex h-32 items-center justify-center",children:s.jsx(S,{})}):s.jsxs(s.Fragment,{children:[s.jsxs(p,{children:[s.jsx(v,{children:s.jsxs(h,{children:[s.jsx(x,{className:"",children:"#"}),s.jsx(x,{className:"",children:"City Classification"}),s.jsx(x,{className:"",children:"City Name"}),s.jsx(x,{className:"",children:"HRA %"}),s.jsx(x,{className:"",children:"Effective From"}),s.jsx(x,{className:"",children:"Effective To"}),s.jsx(x,{className:"",children:"Created At"}),s.jsx(x,{children:"Action"})]})}),s.jsx(y,{children:null==(n=null==(l=null==V?void 0:V.data)?void 0:l.data)?void 0:n.map((e,i)=>s.jsxs(h,{children:[s.jsx(g,{children:(Y-1)*w+i+1}),s.jsx(g,{children:null==e?void 0:e.city_classification}),s.jsx(g,{children:null==e?void 0:e.city_name}),s.jsxs(g,{children:[null==e?void 0:e.hra_percentage,"%"]}),s.jsx(g,{children:r(null==e?void 0:e.effective_from).format("DD-MM-YYYY")}),s.jsx(g,{children:(null==e?void 0:e.effective_to)?r(null==e?void 0:e.effective_to).format("DD-MM-YYYY"):"N/A"}),s.jsx(g,{children:r(null==e?void 0:e.created_at).format("DD-MM-YYYY")}),s.jsx(g,{children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(d,{className:"bg-primary",onClick:()=>{return i=String(null==e?void 0:e.id),O(!0),M(!0),void B(i);var i},children:"Edit"}),s.jsx(d,{variant:"destructive",onClick:()=>(async e=>{var i,s,a,l;try{const r=await E.mutateAsync({api:null==(i=c)?void 0:i.deleteHRACity,data:{id:Number(e)}});(null==(s=null==r?void 0:r.data)?void 0:s.success)?(V.refetch(),t.success((null==(a=null==r?void 0:r.data)?void 0:a.message)||"HRA Classification deleted successfully")):t.error((null==(l=r.data)?void 0:l.message)||"Failed to delete HRA Classification")}catch(r){t.error(o(r))}})(String(null==e?void 0:e.id)),children:"Delete"})]})})]},null==e?void 0:e.id))})]}),s.jsx(N,{className:"mb-2 mt-4"}),s.jsx("div",{className:"flex w-full justify-end",children:s.jsx(A,{page:Y,limit:w,totalPages:(null==(H=null==(b=null==V?void 0:V.data)?void 0:b.pagination)?void 0:H.totalPages)||1,setPage:q,setLimit:F})})]})})]})]})]})}function M(){return s.jsx(l,{title:"HRA Classification",subTitle:"Manage HRA City Classifications",children:s.jsx("div",{className:"py-12",children:s.jsx(L,{})})})}export{M as default};
