import{h as e,f as a,r as s,j as i,z as l,B as t,e as d}from"./index-BJ2Di0BB.js";import{P as n}from"./index-L2kacWh6.js";import{h as r}from"./moment-CBOc1lqT.js";import{C as o,a as c,b as m,c as u}from"./card-CrOEotWM.js";import{S as p,T as j,a as x,b as h,c as v,d as f,e as g}from"./index-BxKGIMG5.js";import{u as y,b as D}from"./useCustomQuery-DkqDqiry.js";import{P as N}from"./index-DZvdNKxy.js";import{S}from"./separator-BtSn9EpY.js";import{S as _}from"./Spinner-DjUjMlqR.js";import{a as b,o as E,c as w,b as C}from"./yup-BTlf5Wf5.js";import{F as O}from"./datetime-picker-cKnQNXMD.js";import{R as L}from"./RHFTextField-BK1QXo_s.js";import{B as M}from"./ButtonLoading-B5GmY3N3.js";import"./select-4D5dQM-6.js";import{D as T}from"./index-ClKtlEeL.js";import{L as k}from"./loader-circle--1riX2Rm.js";import{t as A}from"./switch-CPa6oSpC.js";import"./calendar-B99NsLtP.js";import"./clock-PqgEqIzL.js";import"./check-DiqtQ1XW.js";const $=w().shape({ddo_code:C().required().label("DDO Code"),ddo_name:C().required().label("DDO Name"),office_name:C().required().label("Office Name"),treasury_name:C().required().label("Treasury Name")});function B({open:t,setOpen:d,title:n,id:r,edit:o,setEdit:c,refetch:m}){var u;const p=y({}),{data:j,isFetching:x}=D({api:`${null==(u=e)?void 0:u.getDDoMstrById}/${a(String(r))}`,key:"getDDoMstrById",options:{enabled:o}}),h=b({defaultValues:{ddo_code:"",ddo_name:"",office_name:"",treasury_name:""},resolver:E($)});return s.useEffect(()=>{var e,a,s,i;o&&j?h.reset({ddo_code:null==(e=null==j?void 0:j.data)?void 0:e.ddo_code,ddo_name:null==(a=null==j?void 0:j.data)?void 0:a.ddo_name,office_name:null==(s=null==j?void 0:j.data)?void 0:s.office_name,treasury_name:null==(i=null==j?void 0:j.data)?void 0:i.treasury_name}):h.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})},[o,j]),i.jsx(T,{open:t,setOpen:d,title:n,setEdit:c,edit:o,isLoading:x,children:i.jsx(O,{methods:h,onSubmit:h.handleSubmit(async s=>{var i,t,n,u,j,x,v,f;try{if(o&&s){const d=await p.mutateAsync({api:`${null==(i=e)?void 0:i.updateDDoMstrById}`,data:{id:a(String(r)),...s}});(null==(t=d.data)?void 0:t.success)?l.success(null==(n=null==d?void 0:d.data)?void 0:n.message):l.error((null==(u=d.data)?void 0:u.message)||"Employee Type not updated successfully")}else{const a=await p.mutateAsync({api:null==(j=e)?void 0:j.createDDoMstr,data:s});(null==(x=a.data)?void 0:x.success)?l.success(null==(v=null==a?void 0:a.data)?void 0:v.message):l.error((null==(f=a.data)?void 0:f.message)||"Employee Type not created successfully"),h.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})}d(!1),c(!1),m()}catch(g){}}),children:i.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[i.jsx("div",{children:i.jsx(L,{name:"ddo_code",placeholder:"Enter DDO Code",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{name:"ddo_name",placeholder:"Enter DDO Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{name:"office_name",placeholder:"Enter Office Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{name:"treasury_name",placeholder:"Enter Treasury Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx(S,{}),i.jsx("div",{children:i.jsx(M,{isLoading:h.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function F(){var n,b,E,w,C,O;const L=y({}),[M,T]=s.useState(1),[$,F]=s.useState(10),[P,q]=s.useState(""),[V,I]=s.useState(!1),[Y,R]=s.useState(""),[z,H]=s.useState(!1),[Q,G]=s.useState(null),J=D({api:`${e.getAllDDoMstr}?page=${M}&limit=${$}&q=${P}`,key:"getAllDDoList",value:[M,$],options:{enabled:!0}});return i.jsxs("main",{className:"grid items-start",children:[i.jsx(B,{open:V,setOpen:I,title:z?"Edit Employee Type":"Add Employee Type",id:Y,edit:z,setEdit:H,refetch:J.refetch}),i.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[i.jsxs("div",{className:"flex w-full justify-between gap-2",children:[i.jsx("div",{children:i.jsx(p,{search:P,setSearch:q,refetch:J.refetch,isFetching:null==J?void 0:J.isLoading})}),i.jsx("div",{children:i.jsx(t,{className:"flex items-center gap-2",onClick:()=>I(!0),children:"Add New"})})]}),i.jsxs(o,{children:[i.jsx(c,{className:"px-7",children:i.jsxs(m,{children:["Employee Type List (",null==(b=null==(n=null==J?void 0:J.data)?void 0:n.pagination)?void 0:b.total,")"]})}),i.jsx(u,{children:J.isLoading?i.jsx("div",{className:"flex h-32 items-center justify-center",children:i.jsx(_,{})}):i.jsxs(i.Fragment,{children:[i.jsxs(j,{children:[i.jsx(x,{children:i.jsxs(h,{children:[i.jsx(v,{className:"",children:"#"}),i.jsx(v,{className:"",children:"DDO Code"}),i.jsx(v,{className:"",children:"DDO Name"}),i.jsx(v,{className:"",children:"Office Name"}),i.jsx(v,{className:"",children:"Created at"}),i.jsx(v,{className:"",children:"Status"}),i.jsx(v,{children:"Action"})]})}),i.jsx(f,{children:null==(w=null==(E=null==J?void 0:J.data)?void 0:E.data)?void 0:w.map((s,n)=>i.jsxs(h,{children:[i.jsx(g,{children:n+1}),i.jsx(g,{children:null==s?void 0:s.ddo_code}),i.jsx(g,{children:null==s?void 0:s.ddo_name}),i.jsx(g,{children:null==s?void 0:s.office_name}),i.jsx(g,{children:r(null==s?void 0:s.created_at).format("DD-MM-YYYY")}),i.jsx(g,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(A,{checked:1==(null==s?void 0:s.status),onChange:()=>(async s=>{var i,t,n,r;G(s);try{const d=await L.mutateAsync({api:`${null==(i=e)?void 0:i.toggleDDoMstr}`,data:{id:a(String(s))}});(null==(t=null==d?void 0:d.data)?void 0:t.success)?(J.refetch(),l.success(null==(n=null==d?void 0:d.data)?void 0:n.message)):l.error(null==(r=d.data)?void 0:r.message)}catch(o){l.error(d(o))}finally{G(null)}})(String(null==s?void 0:s.id)),disabled:Q===String(null==s?void 0:s.id),className:((null==s?void 0:s.status)?"bg-primary":"bg-gray-200")+" relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50",children:[i.jsx("span",{className:"sr-only",children:"Enable notifications"}),i.jsx("span",{className:((null==s?void 0:s.status)?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white"})]}),Q===String(null==s?void 0:s.id)&&i.jsx(k,{className:"h-4 w-4 animate-spin text-primary"})]})}),i.jsx(g,{children:i.jsx(t,{className:"bg-primary",onClick:()=>{return e=String(null==s?void 0:s.id),H(!0),I(!0),void R(e);var e},children:"Edit"})})]},null==s?void 0:s.id))})]}),i.jsx(S,{className:"mb-2 mt-4"}),i.jsx("div",{className:"flex w-full justify-end",children:i.jsx(N,{page:M,limit:$,totalPages:null==(O=null==(C=null==J?void 0:J.data)?void 0:C.pagination)?void 0:O.totalPages,setPage:T,setLimit:F})})]})})]})]})]})}function P(){return i.jsx(n,{title:"DDO List",subTitle:"Manage all the DDo List",children:i.jsx("div",{className:"py-12",children:i.jsx(F,{})})})}export{P as default};
