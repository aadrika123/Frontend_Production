import{aA as e,r as s,j as i,aB as a,al as t,ak as o}from"./vendor-RyuIgj66.js";import{P as d}from"./index-DFF4_m_G.js";import{h as r}from"./moment-CBOc1lqT.js";import{h as n,e as l,B as m}from"./index-ey2GEmQz.js";import{C as c,a as u,b as v,c as x}from"./card-u7M7FP5y.js";import{T as p,a as h,b as j,c as f,d as _,e as g}from"./table-B_npepsp.js";import{u as y,b}from"./useCustomQuery-DTB6aAiD.js";import{S as N}from"./index-CUStUwt1.js";import{S as C}from"./Spinner-BwGzvoRj.js";import{c as S,b as w,a as E,d as P}from"./yup-CH6wvET8.js";import{F as q}from"./datetime-picker-dN6E5dqy.js";import{R as F}from"./RHFTextField-BSZ_cEI3.js";import{R as k}from"./RHFTextArea-DpBxMoiQ.js";import{B as $}from"./ButtonLoading-DDalXO-W.js";import{R as D}from"./RHFSelectField-oISAIiMK.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import{R as L}from"./RHFCheckbox-BZ4qq51l.js";import{S as O}from"./separator-BQijJEjG.js";import{D as Y}from"./index-B2ia16z0.js";import{L as A,r as B}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";import"./select-8PAfYjod.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";const T=[{label:"7th CPC",value:"7th_cpc"},{label:"6th CPC",value:"6th_cpc"},{label:"5th CPC",value:"5th_cpc"},{label:"Custom",value:"custom"}],M=S().shape({commission_name:E().required("Commission Name is required"),commission_type:E().required("Commission Type is required"),effective_from:P().required("Effective From date is required"),effective_to:P().nullable(),government_order_no:E().required("Government Order No is required"),government_order_date:P().required("Government Order Date is required"),description:E().required("Description is required"),is_matrix_based:w().default(!1)});function R({open:o,setOpen:d,title:r,id:m,edit:c,setEdit:u,refetch:v}){var x;const p=y({}),{data:h,isFetching:j}=b({api:`${null==(x=n)?void 0:x.getPayCommissionById}?id=${l(String(m))}`,key:"getPayCommissionById",options:{enabled:!!c}}),f=e({defaultValues:{commission_name:"",commission_type:"",effective_from:void 0,effective_to:void 0,government_order_no:"",government_order_date:void 0,description:"",is_matrix_based:!1},resolver:a(M)});return s.useEffect(()=>{var e,s,i,a,t,o,d,r;c&&(null==h?void 0:h.data)?f.reset({commission_name:(null==(e=null==h?void 0:h.data)?void 0:e.commission_name)||"",commission_type:(null==(s=null==h?void 0:h.data)?void 0:s.commission_type)||"",effective_from:(null==(i=null==h?void 0:h.data)?void 0:i.effective_from)||void 0,effective_to:(null==(a=null==h?void 0:h.data)?void 0:a.effective_to)||void 0,government_order_no:(null==(t=null==h?void 0:h.data)?void 0:t.government_order_no)||"",government_order_date:(null==(o=null==h?void 0:h.data)?void 0:o.government_order_date)||void 0,description:(null==(d=null==h?void 0:h.data)?void 0:d.description)||"",is_matrix_based:(null==(r=null==h?void 0:h.data)?void 0:r.is_matrix_based)||!1}):f.reset({commission_name:"",commission_type:"",effective_from:void 0,effective_to:void 0,government_order_no:"",government_order_date:void 0,description:"",is_matrix_based:!1})},[c,h,f]),s.useEffect(()=>{"7th_cpc"==f.watch("commission_type")&&f.setValue("is_matrix_based",!0),"6th_cpc"==f.watch("commission_type")&&f.setValue("is_matrix_based",!1)},[f.watch("commission_type")]),i.jsx(Y,{open:o,setOpen:d,title:r,setEdit:u,edit:c,isLoading:j,children:i.jsx(q,{methods:f,onSubmit:f.handleSubmit(async e=>{var s,i,a,o,r,l,x,h;try{if(c&&e){const d=await p.mutateAsync({api:`${null==(s=n)?void 0:s.updatePayCommissionById}`,data:{id:m,...e}});(null==(i=d.data)?void 0:i.success)?t.success(null==(a=null==d?void 0:d.data)?void 0:a.message):t.error((null==(o=d.data)?void 0:o.message)||"Pay Commission not updated successfully")}else{const s=await p.mutateAsync({api:null==(r=n)?void 0:r.createPayCommission,data:e});(null==(l=s.data)?void 0:l.success)?t.success(null==(x=null==s?void 0:s.data)?void 0:x.message):t.error((null==(h=s.data)?void 0:h.message)||"Pay Commission not created successfully"),f.reset({commission_name:"",commission_type:"",effective_from:void 0,effective_to:void 0,government_order_no:"",government_order_date:void 0,description:"",is_matrix_based:!1})}d(!1),u(!1),v()}catch(j){}}),children:i.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[i.jsx("div",{children:i.jsx(F,{label:"Commission Name",name:"commission_name",placeholder:"Enter Commission Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(D,{label:"Commission Type",name:"commission_type",data:T})}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[i.jsx(F,{type:"date",name:"effective_from",placeholder:"Effective From"}),i.jsx(F,{type:"date",label:"Effective To",name:"effective_to",placeholder:"Effective To (Optional)"})]}),i.jsx("div",{children:i.jsx(F,{name:"government_order_no",label:"Government Order No",placeholder:"Enter Government Order No"})}),i.jsx("div",{children:i.jsx(F,{type:"date",name:"government_order_date",label:"Government Order Date",placeholder:"Government Order Date"})}),i.jsx("div",{children:i.jsx(k,{name:"description",placeholder:"Enter description",label:"Description",rows:4,inputValidation:["removeSpecialCharacterExceptSpace"]})}),i.jsx("div",{children:i.jsx(L,{disabled:"custom"!==f.watch("commission_type"),name:"is_matrix_based",label:"Is Matrix Based Pay Structure"})}),i.jsx(O,{}),i.jsx("div",{children:i.jsx($,{isLoading:f.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function V(){var e,a,t,d,y,S;const[w,E]=s.useState(""),[P,q]=s.useState(!1),[F,k]=s.useState(""),[$,D]=s.useState(!1),[L,O]=s.useState("list"),Y=b({api:`${n.getAllPayCommissions}`,key:"getAllPayCommissions",options:{enabled:!0}}),T=e=>{D(!0),q(!0),k(e)};return i.jsxs("main",{className:"grid items-start",children:[i.jsx(R,{open:P,setOpen:q,title:$?"Edit Pay Commission":"Add Pay Commission",id:F,edit:$,setEdit:D,refetch:Y.refetch}),i.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[i.jsxs("div",{className:"flex w-full justify-between gap-2",children:[i.jsx("div",{children:i.jsx(N,{search:w,setSearch:E,refetch:Y.refetch,isFetching:null==Y?void 0:Y.isLoading})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"flex rounded-lg border",children:[i.jsxs(m,{variant:"list"===L?"default":"ghost",size:"sm",onClick:()=>O("list"),className:"rounded-r-none",children:[i.jsx(A,{className:"mr-2 h-4 w-4"}),"List"]}),i.jsxs(m,{variant:"chart"===L?"default":"ghost",size:"sm",onClick:()=>O("chart"),className:"rounded-l-none",children:[i.jsx(B,{className:"mr-2 h-4 w-4"}),"Chart"]})]}),i.jsx(m,{className:"flex items-center gap-2",onClick:()=>q(!0),children:"Add New"})]})]}),i.jsxs(c,{children:[i.jsx(u,{className:"px-7",children:i.jsxs(v,{children:["Employee Type List (",null==(a=null==(e=null==Y?void 0:Y.data)?void 0:e.pagination)?void 0:a.total,")"]})}),i.jsx(x,{children:Y.isLoading?i.jsx("div",{className:"flex h-32 items-center justify-center",children:i.jsx(C,{})}):i.jsx(i.Fragment,{children:"list"===L?i.jsxs(p,{children:[i.jsx(h,{children:i.jsxs(j,{children:[i.jsx(f,{className:"",children:"#"}),i.jsx(f,{className:"",children:"Pay Commission"}),i.jsx(f,{className:"",children:"Is Matrix"}),i.jsx(f,{className:"",children:"Created at"}),i.jsx(f,{children:"Action"})]})}),i.jsx(_,{children:null==(d=null==(t=null==Y?void 0:Y.data)?void 0:t.data)?void 0:d.map((e,s)=>i.jsxs(j,{children:[i.jsx(g,{children:s+1}),i.jsx(g,{children:null==e?void 0:e.commission_name}),i.jsx(g,{children:(null==e?void 0:e.is_matrix_based)?"Yes":"No"}),i.jsx(g,{children:r(null==e?void 0:e.created_at).format("DD-MM-YYYY")}),i.jsx(g,{children:i.jsx(m,{className:"bg-primary",onClick:()=>T(String(null==e?void 0:e.id)),children:"Edit"})}),i.jsx(g,{children:i.jsx(o,{className:"rounded-lg bg-green-600 px-4 py-2 text-white",to:`pay-level?commission_id=${l(String(null==e?void 0:e.id))}&is_matrix_based=${null==e?void 0:e.is_matrix_based}&commission_name=${null==e?void 0:e.commission_name}`,children:"View Levels"})})]},null==e?void 0:e.id))})]}):i.jsx("div",{className:"space-y-6",children:null==(S=null==(y=null==Y?void 0:Y.data)?void 0:y.data)?void 0:S.map((e,s)=>i.jsxs(c,{className:"border-2",children:[i.jsx(u,{className:"pb-3",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{children:i.jsx("h3",{className:"text-lg font-semibold",children:null==e?void 0:e.commission_name})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(m,{size:"sm",className:"bg-primary",onClick:()=>T(String(null==e?void 0:e.id)),children:"Edit"}),i.jsx(o,{className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm text-white",to:`pay-level?commission_id=${l(String(null==e?void 0:e.id))}&is_matrix_based=${null==e?void 0:e.is_matrix_based}&commission_name=${null==e?void 0:e.commission_name}`,children:"View Levels"})]})]})}),i.jsx(x,{children:i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-muted-foreground",children:"Index:"}),i.jsx("span",{className:"ml-2 font-medium",children:s+1})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-muted-foreground",children:"Matrix Based:"}),i.jsx("span",{className:"ml-2 font-medium",children:(null==e?void 0:e.is_matrix_based)?"Yes":"No"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-muted-foreground",children:"Created:"}),i.jsx("span",{className:"ml-2 font-medium",children:r(null==e?void 0:e.created_at).format("DD-MM-YYYY")})]})]})})]},null==e?void 0:e.id))})})})]})]})]})}function G(){return i.jsx(d,{title:"Pay Commission",subTitle:"Manage all the Pay Commissions here",children:i.jsx("div",{className:"py-12",children:i.jsx(V,{})})})}export{G as default};
