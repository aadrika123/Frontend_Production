import{r as e,a6 as s,j as l}from"./vendor-RyuIgj66.js";import{P as a,D as n,c as t,e as i,f as r}from"./index-DFF4_m_G.js";import{C as d,a as c,d as o,c as x}from"./card-u7M7FP5y.js";import{c as m,e as h,h as j,B as u}from"./index-ey2GEmQz.js";import{B as p}from"./badge-DbWnzWn2.js";import{T as f,a as N,b as y,c as v,d as g,e as b}from"./table-B_npepsp.js";import{S as w,a as _,b as S,c as A,d as D}from"./select-8PAfYjod.js";import{S as P}from"./separator-BQijJEjG.js";import{b as C}from"./useCustomQuery-DTB6aAiD.js";import{al as $,v as T,aN as E,a9 as k,N as I,s as L,E as R,aK as Y}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const B=()=>{var B,F,z;const{user:G}=m(),M=(null==G?void 0:G._id)?h(String(G._id)):null,H=(new Date).getFullYear(),[V,q]=e.useState(H.toString()),[O,K]=e.useState(null),[Q,J]=e.useState(null),[U,W]=e.useState(!1),X=e.useRef(null),{data:Z,refetch:ee,isLoading:se}=C({api:`${j.getPaySlipList}?emp_id=${M}&year=${V}`,key:`salarySlips-${V}`,options:{enabled:!!(null==G?void 0:G._id)}}),le=(null==(B=null==Z?void 0:Z.data)?void 0:B.salary_slips)||[],ae=null==(F=null==Z?void 0:Z.data)?void 0:F.employee,ne=(null==(z=null==Z?void 0:Z.data)?void 0:z.summary)||{total_gross:0,total_deductions:0,total_net:0,total_records:0},{data:te,refetch:ie}=C({api:O?`${j.getPaySlipById}?id=${O.id}`:"",key:`salarySlipDetail-${(null==O?void 0:O.id)||"none"}`,options:{enabled:!!(null==O?void 0:O.id)}});s.useEffect(()=>{(null==te?void 0:te.data)&&J(te.data)},[te]);const re=e=>null==e?"â‚¹0":new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e),de=Array.from({length:5},(e,s)=>H-s),ce=e=>{switch(null==e?void 0:e.toLowerCase()){case"paid":return l.jsx(p,{className:"bg-green-100 text-green-700 hover:bg-green-100",children:"Paid"});case"processed":return l.jsx(p,{className:"bg-blue-100 text-blue-700 hover:bg-blue-100",children:"Processed"});case"pending":return l.jsx(p,{className:"bg-yellow-100 text-yellow-700 hover:bg-yellow-100",children:"Pending"});default:return l.jsx(p,{variant:"outline",children:e||"N/A"})}};return l.jsx(a,{title:"Salary Slips",children:l.jsxs("div",{className:"container mx-auto space-y-6 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Salary Slips"}),l.jsx("p",{className:"text-muted-foreground",children:"View and download your monthly salary slips"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(w,{value:V,onValueChange:q,children:[l.jsx(_,{className:"w-[120px]",children:l.jsx(S,{placeholder:"Year"})}),l.jsx(A,{children:de.map(e=>l.jsx(D,{value:e.toString(),children:e},e))})]}),l.jsxs(u,{variant:"outline",size:"sm",onClick:()=>ee(),children:[l.jsx($,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[l.jsxs(d,{children:[l.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(o,{className:"text-sm font-medium",children:"Total Gross"}),l.jsx(T,{className:"h-4 w-4 text-green-600"})]}),l.jsxs(x,{children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:re(ne.total_gross)}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Year to date"})]})]}),l.jsxs(d,{children:[l.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(o,{className:"text-sm font-medium",children:"Total Deductions"}),l.jsx(E,{className:"h-4 w-4 text-red-600"})]}),l.jsxs(x,{children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:re(ne.total_deductions)}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Year to date"})]})]}),l.jsxs(d,{children:[l.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(o,{className:"text-sm font-medium",children:"Net Received"}),l.jsx(k,{className:"h-4 w-4 text-blue-600"})]}),l.jsxs(x,{children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:re(ne.total_net)}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Year to date"})]})]}),l.jsxs(d,{children:[l.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(o,{className:"text-sm font-medium",children:"Slips Generated"}),l.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(x,{children:[l.jsx("div",{className:"text-2xl font-bold",children:ne.total_records}),l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Months in ",V]})]})]})]}),l.jsxs(d,{children:[l.jsx(c,{children:l.jsxs(o,{className:"flex items-center gap-2",children:[l.jsx(L,{className:"h-5 w-5"}),"Monthly Salary Slips - ",V]})}),l.jsx(x,{children:se?l.jsx("div",{className:"py-8 text-center",children:"Loading..."}):0===le.length?l.jsxs("div",{className:"py-8 text-center text-muted-foreground",children:[l.jsx(I,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),l.jsxs("p",{children:["No salary slips found for ",V]})]}):l.jsxs(f,{children:[l.jsx(N,{children:l.jsxs(y,{children:[l.jsx(v,{children:"Month"}),l.jsx(v,{className:"text-right",children:"Gross Salary"}),l.jsx(v,{className:"text-right",children:"Deductions"}),l.jsx(v,{className:"text-right",children:"Net Salary"}),l.jsx(v,{children:"Status"}),l.jsx(v,{className:"text-right",children:"Actions"})]})}),l.jsx(g,{children:le.map(e=>l.jsxs(y,{children:[l.jsxs(b,{className:"font-medium",children:[e.month_name," ",e.year]}),l.jsx(b,{className:"text-right",children:re(e.gross_salary)}),l.jsx(b,{className:"text-right text-red-600",children:re(e.total_deductions)}),l.jsx(b,{className:"text-right font-semibold text-green-600",children:re(e.net_salary)}),l.jsx(b,{children:ce(e.payment_status)}),l.jsx(b,{className:"text-right",children:l.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>(e=>{K(e),W(!0),ie()})(e),children:[l.jsx(R,{className:"mr-1 h-4 w-4"}),"View"]})})]},e.id))})]})})]}),l.jsx(n,{open:U,onOpenChange:W,children:l.jsxs(t,{className:"max-h-[90vh] max-w-3xl overflow-y-auto",children:[l.jsx(i,{children:l.jsxs(r,{className:"flex items-center justify-between",children:[l.jsxs("span",{children:["Salary Slip - ",null==Q?void 0:Q.month_name," ",null==Q?void 0:Q.year]}),l.jsxs(u,{variant:"outline",size:"sm",onClick:()=>(()=>{if(X.current){const e=X.current.innerHTML,s=window.open("","","width=800,height=600");s&&(s.document.write(`\n          <html>\n            <head>\n              <title>Salary Slip - ${null==Q?void 0:Q.month_name} ${null==Q?void 0:Q.year}</title>\n              <style>\n                body { font-family: Arial, sans-serif; padding: 20px; }\n                .text-muted-foreground { color: #6b7280; }\n                .font-semibold { font-weight: 600; }\n                .font-bold { font-weight: 700; }\n              </style>\n            </head>\n            <body>${e}</body>\n          </html>\n        `),s.document.close(),s.print())}})(),children:[l.jsx(Y,{className:"mr-2 h-4 w-4"}),"Print"]})]})}),l.jsxs("div",{ref:X,className:"p-4",children:[l.jsxs("div",{className:"mb-6 border-b pb-4 text-center",children:[l.jsx("h2",{className:"text-xl font-bold",children:"SALARY SLIP"}),l.jsxs("p",{className:"text-sm text-muted-foreground",children:["For the month of ",null==Q?void 0:Q.month_name," ",null==Q?void 0:Q.year]})]}),l.jsxs("div",{className:"mb-6 grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-1 text-sm",children:[l.jsxs("p",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Employee Name:"})," ",l.jsx("strong",{children:(null==Q?void 0:Q.emp_name)||(null==ae?void 0:ae.emp_name)})]}),l.jsxs("p",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Employee Code:"})," ",l.jsx("strong",{children:(null==Q?void 0:Q.emp_code)||(null==ae?void 0:ae.emp_code)})]}),l.jsxs("p",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Department:"})," ",(null==Q?void 0:Q.department_name)||(null==ae?void 0:ae.department_name)]})]}),l.jsxs("div",{className:"space-y-1 text-sm",children:[l.jsxs("p",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Designation:"})," ",(null==Q?void 0:Q.designation)||"-"]}),l.jsxs("p",{children:[l.jsx("span",{className:"text-muted-foreground",children:"PAN:"})," ",(null==Q?void 0:Q.pan_no)||"-"]}),l.jsxs("p",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Bank A/C:"})," ",(null==Q?void 0:Q.bank_account_no)||"-"]})]})]}),l.jsx(P,{className:"my-4"}),l.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"mb-3 font-semibold text-green-700",children:"Earnings"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Basic Pay"}),l.jsx("span",{children:re(null==O?void 0:O.basic_pay)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Dearness Allowance (DA)"}),l.jsx("span",{children:re(null==O?void 0:O.da_amount)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"House Rent Allowance (HRA)"}),l.jsx("span",{children:re(null==O?void 0:O.hra_amount)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Other Allowances"}),l.jsx("span",{children:re(null==O?void 0:O.other_allowances)})]}),l.jsx(P,{className:"my-2"}),l.jsxs("div",{className:"flex justify-between font-semibold",children:[l.jsx("span",{children:"Gross Salary"}),l.jsx("span",{className:"text-green-600",children:re(null==O?void 0:O.gross_salary)})]})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"mb-3 font-semibold text-red-700",children:"Deductions"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Provident Fund (Employee)"}),l.jsx("span",{children:re(null==O?void 0:O.pf_employee)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Professional Tax"}),l.jsx("span",{children:re(null==O?void 0:O.professional_tax)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Income Tax (TDS)"}),l.jsx("span",{children:re(null==O?void 0:O.income_tax)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"ESI (Employee)"}),l.jsx("span",{children:re(null==O?void 0:O.esi_employee)})]}),l.jsx(P,{className:"my-2"}),l.jsxs("div",{className:"flex justify-between font-semibold",children:[l.jsx("span",{children:"Total Deductions"}),l.jsx("span",{className:"text-red-600",children:re(null==O?void 0:O.total_deductions)})]})]})]})]}),l.jsx(P,{className:"my-6"}),l.jsx("div",{className:"rounded-lg bg-blue-50 p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-lg font-semibold",children:"Net Salary"}),l.jsx("span",{className:"text-2xl font-bold text-blue-600",children:re(null==O?void 0:O.net_salary)})]})}),l.jsx("p",{className:"mt-6 text-center text-xs text-muted-foreground",children:"This is a computer generated salary slip and does not require a signature."})]})]})})]})})};export{B as default};
