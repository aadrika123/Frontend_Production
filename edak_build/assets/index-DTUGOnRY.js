import{u as O,y as D,p as J,e as Q,o as W,r as l,j as a,D as X,F as Z,R as aa,A as K,B as ea,f as sa,h as ta,i as S,_ as n,E as V,q as ra,s as ca,t as na,v as oa,w as la,G as da}from"./index-BRnLakpB.js";import{P as ia}from"./index-Bj9W1lOi.js";import{T as ua,a as ha,b as z,c as u,d as xa,e as h}from"./table-DX_ipx9P.js";import{g as pa}from"./services-KQnp_8oA.js";import{P as ga}from"./index-Dq_TpNNj.js";import{S as ja}from"./index-DWmEqRZi.js";import{q as fa}from"./switch-DBWYH6I_.js";import"./badge-DsXNu46Z.js";import"./index-YSq32AOx.js";import"./circle-check-big-Ck6Q2ipy.js";import"./pagination-Di-b090E.js";const ma=sa().shape({source:ta().required("Complaint source name is required")});function Sa({open:x,setOpen:p,title:P,id:d,edit:o,setEdit:g,refetch:v}){const w=O({}),j=D({}),{data:i,isFetching:$}=J({api:`${S.getComplaintSourceById}/${d}`,key:"getComplaintSourceById",options:{enabled:o}}),c=Q({defaultValues:{source:""},resolver:W(ma)}),C=async s=>{var y,b,f,m;try{if(o&&s){const t=await j.mutateAsync({api:`${S.updateComplaintSource}/${d}`,data:s});(y=t.data)!=null&&y.success?n.success((b=t==null?void 0:t.data)==null?void 0:b.message):n.error("Complaint Source not updated successfully")}else{const t=await w.mutateAsync({api:S.createComplaintSource,data:s});(f=t.data)!=null&&f.success?n.success((m=t==null?void 0:t.data)==null?void 0:m.message):n.error("Complaint Source not created successfully"),c.reset({source:""})}p(!1),g(!1),v()}catch(t){console.log(t)}};return l.useEffect(()=>{o&&i?c.reset({source:i.data.source}):c.reset({source:""})},[o,i]),a.jsx(X,{open:x,setOpen:p,title:P,setEdit:g,edit:o,isLoading:$,children:a.jsx(Z,{methods:c,onSubmit:c.handleSubmit(C),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(aa,{name:"source",placeholder:"Enter Complaint Source "})}),a.jsx(K,{}),a.jsx("div",{children:a.jsx(ea,{isLoading:c.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ca(){var f,m,t,A,E,F,T,B,M,k,q;const[x,p]=l.useState(1),P=D({}),[d,o]=l.useState(5),[g,v]=l.useState(""),[w,j]=l.useState(!1),[i,$]=l.useState(""),[c,C]=l.useState(!1),s=J({api:`${S.getAllComplaintSource}?page=${x}&limit=${d}&q=${g}`,key:"getAllComplaintSource",value:[x,d],options:{enabled:!0}}),y=e=>{C(!0),j(!0),$(e)},b=async e=>{var N,L,_,H,I,R,Y,G,U;try{const r=await P.mutateAsync({api:`${(N=S)==null?void 0:N.updateComplaintSourceStatus}/${e}`,data:{id:i}});(L=r==null?void 0:r.data)!=null&&L.success?(s.refetch(),((H=(_=r==null?void 0:r.data)==null?void 0:_.data)==null?void 0:H.status)==1&&n.success((I=r.data)==null?void 0:I.message),((Y=(R=r==null?void 0:r.data)==null?void 0:R.data)==null?void 0:Y.status)==0&&n.error((G=r.data)==null?void 0:G.message)):n.error((U=r.data)==null?void 0:U.message)}catch(r){n.error(pa(r))}};return a.jsxs("main",{className:"grid items-start",children:[a.jsx(Sa,{open:w,setOpen:j,title:c?"Edit Complaint Source":"Add Complaint Source",id:i,edit:c,setEdit:C,refetch:s.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(ja,{search:g,setSearch:v,refetch:s.refetch,isFetching:s.isLoading,setPage:p})}),a.jsx("div",{children:a.jsx(V,{className:"flex items-center gap-2",onClick:()=>j(!0),children:"Add New"})})]}),a.jsxs(ra,{children:[a.jsx(ca,{className:"px-7",children:a.jsxs(na,{children:["Complaint Source List (",(m=(f=s.data)==null?void 0:f.data)==null?void 0:m.totalDocs,")"]})}),a.jsx(oa,{children:s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(la,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(ua,{children:[a.jsx(ha,{children:a.jsxs(z,{children:[a.jsx(u,{className:"",children:"#"}),a.jsx(u,{className:"",children:" Complaint Source Name"}),a.jsx(u,{className:"",children:"Id"}),a.jsx(u,{className:"",children:"Created at"}),a.jsx(u,{className:"",children:"Status"}),a.jsx(u,{children:"Action"})]})}),a.jsx(xa,{children:(E=(A=(t=s==null?void 0:s.data)==null?void 0:t.data)==null?void 0:A.docs)==null?void 0:E.map((e,N)=>a.jsxs(z,{children:[a.jsx(h,{children:N+1}),a.jsx(h,{children:e==null?void 0:e.source}),a.jsx(h,{children:e==null?void 0:e._id}),a.jsx(h,{children:da(e==null?void 0:e.createdAt).format("DD-MM-YYYY")}),a.jsx(h,{children:a.jsxs(fa,{checked:(e==null?void 0:e.status)==1,onChange:()=>b(e==null?void 0:e._id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),a.jsx(h,{children:a.jsx(V,{onClick:()=>y(e==null?void 0:e._id),children:"Edit"})})]},e==null?void 0:e._id))})]}),a.jsx(K,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(ga,{page:x,perPage:d,totalPage:(T=(F=s==null?void 0:s.data)==null?void 0:F.data)==null?void 0:T.totalDocs,hasNextPage:(M=(B=s==null?void 0:s.data)==null?void 0:B.data)==null?void 0:M.hasNextPage,hasPrevPage:(q=(k=s==null?void 0:s.data)==null?void 0:k.data)==null?void 0:q.hasPrevPage,setPage:p,setPerPage:o})})]})})]})]})]})}function Ba(){return a.jsx(ia,{title:"Complaint Source",subTitle:"Manage all the Complaint Source here",children:a.jsx("div",{className:"py-12",children:a.jsx(Ca,{})})})}export{Ba as default};
