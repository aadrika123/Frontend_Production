import{u as W,J as V,w as D,d as X,o as Z,r as u,j as e,D as ee,F as ae,R as E,P as se,M as Q,B as le,e as re,f as w,a4 as te,i as g,_ as h,N as O,x as ne,y as de,z as ce,A as oe,G as ie,O as he}from"./index-sBt8KVQv.js";import{P as xe}from"./index-bghbaOW_.js";import{T as ue,a as me,b as U,c as d,d as je,e as c}from"./table-DhJaKXns.js";import{g as pe}from"./services-KQnp_8oA.js";import{P as fe}from"./index-CWE-6F3H.js";import{S as ge}from"./index-m0Xp7Z0A.js";import{q as be}from"./switch-C4sUQQw-.js";import"./badge-k_k0X2i3.js";import"./index-0SY1KMsh.js";import"./circle-check-big-gd_18BkE.js";import"./pagination-C0kqlCDZ.js";const ye=re().shape({formType:w().required("form Type is required"),elementKey:w().required("Element Key is required"),elementLabel:w().required("Element Label is required"),isEnable:te().required("Is Enable is required")});function Te({open:v,setOpen:x,title:P,id:o,edit:i,setEdit:m,refetch:S}){const F=W({}),j=V({}),{data:n,isFetching:L}=D({api:`${g.getTableFormById}/${o}`,key:"getTableFormById",options:{enabled:i}}),t=X({defaultValues:{formType:"",elementKey:"",elementLabel:"",isEnable:!1},resolver:Z(ye)}),b=async s=>{var y,T,p,f;try{if(i&&s){const l=await j.mutateAsync({api:`${g.updateTableForm}/${o}`,data:s});(y=l.data)!=null&&y.success?h.success((T=l==null?void 0:l.data)==null?void 0:T.message):h.error("Table Form is not updated successfully")}else{const l=await F.mutateAsync({api:g.createTableForm,data:s});(p=l.data)!=null&&p.success?h.success((f=l==null?void 0:l.data)==null?void 0:f.message):h.error("Table Form is not created successfully"),t.reset({formType:"",elementKey:"",elementLabel:"",isEnable:!1})}x(!1),m(!1),S()}catch(l){console.log(l)}};return u.useEffect(()=>{i&&n?t.reset({formType:n.data.formType,elementKey:n.data.elementKey,elementLabel:n.data.elementLabel,isEnable:n.data.isEnable}):t.reset({formType:""})},[i,n]),e.jsx(ee,{open:v,setOpen:x,title:P,setEdit:m,edit:i,isLoading:L,children:e.jsx(ae,{methods:t,onSubmit:t.handleSubmit(b),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(E,{name:"formType",placeholder:"Enter form Type"})}),e.jsx("div",{children:i?e.jsx(E,{value:t.watch("elementKey"),placeholder:"Enter Element Key"}):e.jsx(E,{name:"elementKey",placeholder:"Enter Element Key"})}),e.jsx("div",{children:e.jsx(E,{name:"elementLabel",placeholder:"Enter Element Label"})}),e.jsx("div",{children:e.jsx(se,{name:"isEnable",data:[{value:"true",label:"Yes"},{value:"false",label:"No"}]})}),e.jsx(Q,{}),e.jsx("div",{children:e.jsx(le,{isLoading:t.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ne(){var p,f,l,$,A,K,q,C,M,B,k;const v=V({}),[x,P]=u.useState(1),[o,i]=u.useState(10),[m,S]=u.useState(""),[F,j]=u.useState(!1),[n,L]=u.useState(""),[t,b]=u.useState(!1),s=D({api:`${g.getAllTableForm}?page=${x}&limit=${o}&q=${m}`,key:"getAllTableForm",value:[x,o],options:{enabled:!0}}),y=a=>{b(!0),j(!0),L(a)},T=async a=>{var N,I,H,Y,_,R,z,G,J;try{const r=await v.mutateAsync({api:`${(N=g)==null?void 0:N.updateTableFormStatus}/${a}`,data:{id:n}});(I=r==null?void 0:r.data)!=null&&I.success?(s.refetch(),((Y=(H=r==null?void 0:r.data)==null?void 0:H.data)==null?void 0:Y.status)==1&&h.success((_=r.data)==null?void 0:_.message),((z=(R=r==null?void 0:r.data)==null?void 0:R.data)==null?void 0:z.status)==0&&h.error((G=r.data)==null?void 0:G.message)):h.error((J=r.data)==null?void 0:J.message)}catch(r){h.error(pe(r))}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(Te,{open:F,setOpen:j,title:t?"Edit Table Form":"Add Table Form",id:n,edit:t,setEdit:b,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(ge,{search:m,setSearch:S,refetch:s.refetch,isFetching:s.isLoading})}),e.jsx("div",{children:e.jsx(O,{className:"flex items-center gap-2",onClick:()=>j(!0),children:"Add New"})})]}),e.jsxs(ne,{children:[e.jsx(de,{className:"px-7",children:e.jsxs(ce,{children:["Table Form List (",(f=(p=s.data)==null?void 0:p.data)==null?void 0:f.totalDocs,")"]})}),e.jsx(oe,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ie,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(U,{children:[e.jsx(d,{className:"",children:"#"}),e.jsx(d,{className:"",children:"Form Type "}),e.jsx(d,{className:"",children:"Element Key "}),e.jsx(d,{className:"",children:"Element Label "}),e.jsx(d,{className:"",children:"Is Enable"}),e.jsx(d,{className:"",children:"Id"}),e.jsx(d,{className:"",children:"Created at"}),e.jsx(d,{className:"",children:"Status"}),e.jsx(d,{children:"Action"})]})}),e.jsx(je,{children:(A=($=(l=s==null?void 0:s.data)==null?void 0:l.data)==null?void 0:$.docs)==null?void 0:A.map((a,N)=>e.jsxs(U,{children:[e.jsx(c,{children:x*o-o+N+1}),e.jsx(c,{children:a==null?void 0:a.formType}),e.jsx(c,{children:a==null?void 0:a.elementKey}),e.jsx(c,{children:a==null?void 0:a.elementLabel}),e.jsx(c,{children:a!=null&&a.isEnable?e.jsx("div",{className:"text-green-700 font-bold",children:" Yes"}):e.jsx("div",{className:"text-red-500 font-bold",children:"No"})}),e.jsx(c,{children:a==null?void 0:a._id}),e.jsx(c,{children:he(a==null?void 0:a.createdAt).format("DD-MM-YYYY")}),e.jsx(c,{children:e.jsxs(be,{checked:(a==null?void 0:a.status)==1,onChange:()=>T(a==null?void 0:a._id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),e.jsx(c,{children:e.jsx(O,{className:"bg-primary",onClick:()=>y(a._id),children:"Edit"})})]},a==null?void 0:a._id))})]}),e.jsx(Q,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(fe,{page:x,perPage:o,totalPage:(q=(K=s==null?void 0:s.data)==null?void 0:K.data)==null?void 0:q.totalDocs,hasNextPage:(M=(C=s==null?void 0:s.data)==null?void 0:C.data)==null?void 0:M.hasNextPage,hasPrevPage:(k=(B=s==null?void 0:s.data)==null?void 0:B.data)==null?void 0:k.hasPrevPage,setPage:P,setPerPage:i})})]})})]})]})]})}function Ce(){return e.jsx(xe,{title:"Table Form List",subTitle:"Manage all the Table Form here",children:e.jsx("div",{className:"py-12",children:e.jsx(Ne,{})})})}export{Ce as default};
