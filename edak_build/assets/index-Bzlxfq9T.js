import{u as W,J as V,w as K,d as X,o as Z,r as i,j as a,D,F as aa,R as ea,M as Q,B as sa,e as ta,f as ra,i as m,_ as l,N as J,x as na,y as ca,z as la,A as da,G as oa,O as ia}from"./index-X8Jed7md.js";import{P as ha}from"./index-Cy_U-8FL.js";import{T as xa,a as ua,b as O,c as x,d as ga,e as u}from"./table-ef4MjCgB.js";import{g as ja}from"./services-KQnp_8oA.js";import{P as pa}from"./index-CzxWg9XN.js";import{S as fa}from"./index-B5iYydcl.js";import{q as ma}from"./switch-BV3074KS.js";import"./badge-RJ0OQ2B2.js";import"./index-D0fJI6gO.js";import"./circle-check-big-DRfU2PMj.js";import"./pagination-1_mcwOxu.js";const ba=ta().shape({ulbName:ra().required("Ulb name is required")});function Na({open:U,setOpen:d,title:b,id:c,edit:o,setEdit:g,refetch:v}){const w=W({}),j=V({}),{data:h,isFetching:$}=K({api:`${m.getUlbById}/${c}`,key:"getUlbById",options:{enabled:o}}),n=X({defaultValues:{ulbName:""},resolver:Z(ba)}),N=async s=>{var y,P,p,f;try{if(o&&s){const r=await j.mutateAsync({api:`${m.updateUlb}/${c}`,data:s});(y=r.data)!=null&&y.success?l.success((P=r==null?void 0:r.data)==null?void 0:P.message):l.error("Ulb not updated successfully")}else{const r=await w.mutateAsync({api:m.createUlb,data:s});(p=r.data)!=null&&p.success?l.success((f=r==null?void 0:r.data)==null?void 0:f.message):l.error("Ulb not created successfully"),n.reset({ulbName:""})}d(!1),g(!1),v()}catch(r){console.log(r)}};return i.useEffect(()=>{o&&h?n.reset({ulbName:h.data.ulbName}):n.reset({ulbName:""})},[o,h]),a.jsx(D,{open:U,setOpen:d,title:b,setEdit:g,edit:o,isLoading:$,children:a.jsx(aa,{methods:n,onSubmit:n.handleSubmit(N),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(ea,{name:"ulbName",placeholder:"Enter Ulb name"})}),a.jsx(Q,{}),a.jsx("div",{children:a.jsx(sa,{isLoading:n.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function ya(){var p,f,r,A,C,E,F,M,T,B,k,L;const U=V({}),[d,b]=i.useState(1),[c,o]=i.useState(10),[g,v]=i.useState(""),[w,j]=i.useState(!1),[h,$]=i.useState(""),[n,N]=i.useState(!1),s=K({api:`${(p=m)==null?void 0:p.getAllUlb}?page=${d}&limit=${c}&q=${g}`,key:"getAllUlb",value:[d,c],options:{enabled:!0}}),y=e=>{N(!0),j(!0),$(e)},P=async e=>{var S,_,q,H,I,R,Y,z,G;try{const t=await U.mutateAsync({api:`${(S=m)==null?void 0:S.updateUlbStatus}/${e}`,data:{id:h}});(_=t==null?void 0:t.data)!=null&&_.success?(s.refetch(),((H=(q=t==null?void 0:t.data)==null?void 0:q.data)==null?void 0:H.status)==1&&l.success((I=t==null?void 0:t.data)==null?void 0:I.message),((Y=(R=t==null?void 0:t.data)==null?void 0:R.data)==null?void 0:Y.status)==0&&l.error((z=t==null?void 0:t.data)==null?void 0:z.message)):l.error((G=t==null?void 0:t.data)==null?void 0:G.message)}catch(t){l.error(ja(t))}};return a.jsxs("main",{className:"grid items-start",children:[a.jsx(Na,{open:w,setOpen:j,title:n?"Edit Ulb":"Add Ulb",id:h,edit:n,setEdit:N,refetch:s==null?void 0:s.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(fa,{search:g,setPage:b,setSearch:v,refetch:s.refetch,isFetching:s.isLoading})}),a.jsx("div",{children:a.jsx(J,{className:"flex items-center gap-2",onClick:()=>j(!0),children:"Add New"})})]}),a.jsxs(na,{children:[a.jsx(ca,{className:"px-7",children:a.jsxs(la,{children:["Ulb List (",(r=(f=s==null?void 0:s.data)==null?void 0:f.data)==null?void 0:r.totalDocs,")"]})}),a.jsx(da,{children:s!=null&&s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(oa,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(xa,{children:[a.jsx(ua,{children:a.jsxs(O,{children:[a.jsx(x,{className:"",children:"#"}),a.jsx(x,{className:"",children:"Ulb Name"}),a.jsx(x,{className:"",children:"Id"}),a.jsx(x,{className:"",children:"Created at"}),a.jsx(x,{className:"",children:"Status"}),a.jsx(x,{children:"Action"})]})}),a.jsx(ga,{children:(E=(C=(A=s==null?void 0:s.data)==null?void 0:A.data)==null?void 0:C.docs)==null?void 0:E.map((e,S)=>a.jsxs(O,{children:[a.jsx(u,{children:d*c-c+S+1}),a.jsx(u,{children:e==null?void 0:e.ulbName}),a.jsx(u,{children:e==null?void 0:e._id}),a.jsx(u,{children:ia(e==null?void 0:e.createdAt).format("DD-MM-YYYY")}),a.jsx(u,{children:a.jsxs(ma,{checked:(e==null?void 0:e.status)==1,onChange:()=>P(e==null?void 0:e._id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),a.jsx(u,{children:a.jsx(J,{className:"bg-primary",onClick:()=>y(e==null?void 0:e._id),children:"Edit"})})]},e==null?void 0:e._id))})]}),a.jsx(Q,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(pa,{page:d,perPage:c,totalPage:(M=(F=s==null?void 0:s.data)==null?void 0:F.data)==null?void 0:M.totalDocs,hasNextPage:(B=(T=s==null?void 0:s.data)==null?void 0:T.data)==null?void 0:B.hasNextPage,hasPrevPage:(L=(k=s==null?void 0:s.data)==null?void 0:k.data)==null?void 0:L.hasPrevPage,setPage:b,setPerPage:o})})]})})]})]})]})}function Ta(){return a.jsx(ha,{title:"Ulb List",subTitle:"Manage all the ulb here",children:a.jsx("div",{children:a.jsx(ya,{})})})}export{Ta as default};
