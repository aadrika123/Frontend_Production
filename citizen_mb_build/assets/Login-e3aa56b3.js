import{u as j,r as l,c as D,j as a,F,a as n}from"./index-cfc403bf.js";import{c as R,a as _,b as J,u as O}from"./index.esm-f8bc8447.js";/* empty css                */import{P}from"./ProjectApiList-f293eba9.js";import{a as q,A as T}from"./axios-28c6f114.js";import{R as $}from"./Blocks-1a8bea28.js";const z="/assets/logo1-3109eaef.png",Y=()=>{const u=j(),{notify:d,setisLoggedIn:S}=l.useContext(D),[r,v]=l.useState(null),[s,y]=l.useState(),{api_login:k}=P(),[I,g]=l.useState(!1),L=R({email:_().required("Enter email"),password:J().required("Enter password")}),t=O({initialValues:{email:"",password:""},onSubmit:o=>{C()},validationSchema:L}),f=["Tax Collector","ULB Tax Collector"],E=l.useMemo(()=>Array.isArray(r)&&r.some(o=>f.includes(o)),[r]);l.useEffect(()=>{var o,e,i;r!=null&&(E?(d("Login Successfull !!! ","success"),window.localStorage.setItem("menuList",JSON.stringify((o=s==null?void 0:s.userDetails)==null?void 0:o.menuPermission)),window.localStorage.setItem("userName",JSON.stringify((e=s==null?void 0:s.userDetails)==null?void 0:e.userName)),window.localStorage.setItem("roles",JSON.stringify((i=s==null?void 0:s.userDetails)==null?void 0:i.role)),u("/dashboard")):d("You don't have permission of Tax Collector !!!","warn"))},[r]);const m=JSON.parse(window.localStorage.getItem("roles")),c=window.localStorage.getItem("token"),A=l.useMemo(()=>Array.isArray(m)&&m.some(o=>f.includes(o)),[m,c]);l.useEffect(()=>{c!=""&&c!=null&&c!=null&&A&&u("/dashboard")},[]);const C=()=>{let o={email:t.values.email,password:t.values.password};console.log("--1--before login send...",o),q.post(k,o,T()).then(function(e){var i,x,w,h,p,b,N;console.log("login response => ",e),e.data.status==!0?(console.log("--2--login response...",e),window.localStorage.setItem("token",(x=(i=e==null?void 0:e.data)==null?void 0:i.data)==null?void 0:x.token),window.localStorage.setItem("isLoggedIn",!0),y((w=e==null?void 0:e.data)==null?void 0:w.data),v((b=(p=(h=e==null?void 0:e.data)==null?void 0:h.data)==null?void 0:p.userDetails)==null?void 0:b.role),S(!0)):(g(!1),d((N=e==null?void 0:e.data)==null?void 0:N.message,"error"))}).catch(function(e){g(!1),console.log("--2--login error...",e),d("Something went wrong !!! ","error")})};return a(F,{children:a("div",{className:" h-screen bg-zinc-100 flex flex-row flex-wrap justify-center items-center",children:n("form",{onChange:t.handleChange,onSubmit:t.handleSubmit,className:"flex flex-col gap-2 w-max h-max shadow-lg rounded-md px-10 py-4 bg-white text-zinc-700 animate__animated animate__fadeInDown",children:[n("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[a("img",{src:z,alt:"",className:"w-16"}),n("div",{className:"text-xl uppercase tracking-wide font-semibold",children:["Urban Development & ",a("br",{})," Housing Department"]})]}),a("hr",{}),n("div",{className:"mt-6 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"email",className:"text-sm",children:"Email :"}),a("input",{type:"email",name:"email",id:"email",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter email"}),t.errors.email&&t.touched.email&&a("span",{className:"text-red-600 text-xs",children:t.errors.email})]}),n("div",{className:"mt-4 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"password",className:"text-sm",children:"Password :"}),a("input",{type:"password",name:"password",id:"password",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter password"}),t.errors.password&&t.touched.password&&a("span",{className:"text-red-600 text-xs",children:t.errors.password})]}),a("div",{className:"text-center mb-6 mt-4",children:I?a("div",{className:"flex justify-center",children:a($,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):a("button",{type:"submit",className:"px-4 py-1.5 bg-green-200 hover:bg-green-300 rounded-md shadow-md text-sm",children:" Login "})})]})})})};export{Y as default};
