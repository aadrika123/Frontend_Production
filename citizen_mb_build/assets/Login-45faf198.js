import{a as j,r as l,c as D,b as a,F,j as n}from"./index-ac8fdf8c.js";import{c as R,a as _,b as J,u as O}from"./index.esm-c683b93b.js";import{l as P}from"./logo1-44af78fe.js";/* empty css                */import{P as T}from"./ProjectApiList-f293eba9.js";import{a as q,A as $}from"./axios-28c6f114.js";import{R as z}from"./Blocks-bdd35ea6.js";const G=()=>{const N=j(),{notify:d,setisLoggedIn:y}=l.useContext(D),[r,S]=l.useState(null),[s,v]=l.useState(),{api_login:k}=T(),[I,u]=l.useState(!1),L=R({email:_().required("Enter email"),password:J().required("Enter password")}),t=O({initialValues:{email:"",password:""},onSubmit:o=>{C()},validationSchema:L}),g=["Tax Collector","ULB Tax Collector","Team Leader"],E=l.useMemo(()=>Array.isArray(r)&&r.some(o=>g.includes(o)),[r]);l.useEffect(()=>{var o,e,i;r!=null&&(E?(d("Login Successfull !!! ","success"),window.localStorage.setItem("menuList",JSON.stringify((o=s==null?void 0:s.userDetails)==null?void 0:o.menuPermission)),window.localStorage.setItem("userName",JSON.stringify((e=s==null?void 0:s.userDetails)==null?void 0:e.userName)),window.localStorage.setItem("roles",JSON.stringify((i=s==null?void 0:s.userDetails)==null?void 0:i.role)),window.location.replace("/property/mobile-property-options")):d("You don't have permission of Tax Collector !!!","warn"))},[r]);const c=JSON.parse(window.localStorage.getItem("roles")),m=window.localStorage.getItem("token"),A=l.useMemo(()=>Array.isArray(c)&&c.some(o=>g.includes(o)),[c,m]);l.useEffect(()=>{m!=""&&m!=null&&m!=null&&A&&N("/dashboard")},[]);const C=()=>{let o={email:t.values.email,password:t.values.password,type:"mobile"};console.log("--1--before login send...",o),q.post(k,o,$()).then(function(e){var i,f,w,p,x,h,b;console.log("login response => ",e),e.data.status==!0?(console.log("--2--login response...",e),window.localStorage.setItem("token",(f=(i=e==null?void 0:e.data)==null?void 0:i.data)==null?void 0:f.token),window.localStorage.setItem("isLoggedIn",!0),v((w=e==null?void 0:e.data)==null?void 0:w.data),S((h=(x=(p=e==null?void 0:e.data)==null?void 0:p.data)==null?void 0:x.userDetails)==null?void 0:h.role),y(!0)):(u(!1),d((b=e==null?void 0:e.data)==null?void 0:b.message,"error"))}).catch(function(e){u(!1),console.log("--2--login error...",e),d("Something went wrong !!! ","error")})};return a(F,{children:a("div",{className:" h-screen bg-zinc-100 flex flex-row flex-wrap justify-center items-center",children:n("form",{onChange:t.handleChange,onSubmit:t.handleSubmit,className:"flex flex-col gap-2 w-max h-max shadow-lg rounded-md px-10 py-4 bg-white text-zinc-700 animate__animated animate__fadeInDown",children:[n("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[a("img",{src:P,alt:"",className:"w-16"}),n("div",{className:"text-xl uppercase tracking-wide font-semibold",children:["Urban Development & ",a("br",{})," Housing Department"]})]}),a("hr",{}),n("div",{className:"mt-6 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"email",className:"text-sm",children:"Email :"}),a("input",{type:"email",name:"email",id:"email",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter email"}),t.errors.email&&t.touched.email&&a("span",{className:"text-red-600 text-xs",children:t.errors.email})]}),n("div",{className:"mt-4 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"password",className:"text-sm",children:"Password :"}),a("input",{type:"password",name:"password",id:"password",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter password"}),t.errors.password&&t.touched.password&&a("span",{className:"text-red-600 text-xs",children:t.errors.password})]}),a("div",{className:"text-center mb-6 mt-4",children:I?a("div",{className:"flex justify-center",children:a(z,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):a("button",{type:"submit",className:"px-4 py-1.5 bg-green-200 hover:bg-green-300 rounded-md shadow-md text-sm",children:" Login "})})]})})})};export{G as default};
