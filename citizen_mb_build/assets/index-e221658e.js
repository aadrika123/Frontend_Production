import{R as W,u as G,c as Q,Q as m,b as t,F as H,j as e}from"./index-c15426ae.js";import{u as J}from"./formik.esm-a712a7d1.js";import{c as K,a as o,b as X}from"./index.esm-79c8b416.js";import{F as Y,a as Z,T as u}from"./LoadingButton-9cecaa10.js";import{u as k}from"./useCustomGeoLocation-0e568816.js";import{r as D}from"./resizeImage-f1558408.js";import{w as U}from"./waterAndSepticTanker-d762a753.js";import{b as ee,a as ae}from"./useCustomQuery-71fa52f4.js";import{O as te}from"./OverLayLoader-ce1047ee.js";import"./Hourglass-0df07d17.js";import{C as le}from"./CreateConfirmation-82c851a0.js";import"./ThemeStyle-994f51bc.js";import"./index.esm-27ec6a04.js";import"./ApiHeader2-b363f7b8.js";function ve(){var h,g,f,v,N,y,w,b,F,C,V,L,T,R,S,q,A,_,j,z,E;const[x,$]=W.useState(null),M=G(),p=ee({}),{coords:i}=k(),{id:n}=Q(),a=ae({api:U.bookingDetails,config:{applicationId:n},options:{enabled:!!n}}),l=J({enableReinitialize:!0,initialValues:{applicationId:n,status:1,comments:"",latitude:"",longitude:"",document:null},validationSchema:K({comments:o().required("Required").min(10,"Minimum 10 characters").max(100,"Maximum 100 characters"),latitude:o().required("Required"),longitude:o().required("Required"),document:X().required("Required").test("fileSize","File Size is too large",d=>d&&d.size<=2e6)}),onSubmit:async(d,{resetForm:c})=>{await le(l.values.status===1?"Are you sure you want to cancel trip?":"Are you sure you want to successful trip?")?await O(d,c):console.log("cancelled")}}),O=async(d,c)=>{var r,P,I;console.log(d);try{const s=await p.mutateAsync({api:U.submitDriverAction,data:d});(r=s==null?void 0:s.data)!=null&&r.status?(m.success((P=s==null?void 0:s.data)==null?void 0:P.message),M("/water-tanker",{replace:!0}),c()):m.error((I=s==null?void 0:s.data)==null?void 0:I.message)}catch{m.error("Something went wrong")}},B=async d=>{let c=d.target.files[0];const r=await D(c);r?($(URL.createObjectURL(r)),l.setFieldValue("document",r),l.setFieldValue("latitude",i==null?void 0:i.latitude),l.setFieldValue("longitude",i==null?void 0:i.longitude)):(l.setFieldValue("document",null),l.setFieldValue("latitude",""),l.setFieldValue("longitude",""))};return console.log((h=a==null?void 0:a.data)==null?void 0:h.data),t(H,{children:[p.isLoading&&e(te,{}),t("div",{className:"p-4",children:[t("div",{className:" bg-white w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Cancel Trip For Water Tanker"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:t("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(f=(g=a==null?void 0:a.data)==null?void 0:g.data)==null?void 0:f.booking_no})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Applicant Name"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(N=(v=a==null?void 0:a.data)==null?void 0:v.data)==null?void 0:N.applicant_name})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Delivery Address"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(w=(y=a==null?void 0:a.data)==null?void 0:y.data)==null?void 0:w.address})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Contact Number"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(F=(b=a==null?void 0:a.data)==null?void 0:b.data)==null?void 0:F.mobile})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600 no-underline",children:"Water Tanker Capacity"}),t("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:[(V=(C=a==null?void 0:a.data)==null?void 0:C.data)==null?void 0:V.capacity," Ltr"]})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(T=(L=a==null?void 0:a.data)==null?void 0:L.data)==null?void 0:T.booking_date})]}),e("hr",{className:"w-full border-b-1 border-gray-200"}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Assigned Date"}),e("div",{className:"col-span-6 font-semibold  text-gray-700 2xl:text-base text-xs",children:(S=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:S.assign_date})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Vehicle No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(A=(q=a==null?void 0:a.data)==null?void 0:q.data)==null?void 0:A.vehicle_no})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Delivery Date"}),t("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:[(j=(_=a==null?void 0:a.data)==null?void 0:_.data)==null?void 0:j.delivery_date," ",(E=(z=a==null?void 0:a.data)==null?void 0:z.data)==null?void 0:E.delivery_time]})]})]})})]}),e("p",{className:"border-b"}),e("div",{className:"bg-white py-8  rounded-lg shadow-xl p-4 mt-3",children:e(Y,{formik:l,children:t("div",{className:"space-y-5 ",children:[e("div",{className:"flex-1",children:e(Z,{label:"comments",name:"comments",placeholder:"Enter comments",formik:l})}),t("div",{className:"flex w-full gap-4",children:[e(u,{disabled:!0,label:"Latitude",name:"latitude",placeholder:"Enter Latitude",formik:l}),e(u,{disabled:!0,label:"Longitude",name:"longitude",placeholder:"Enter Longitude",formik:l})]}),e("div",{className:"flex-1"}),t("div",{className:"flex-1",children:[e(u,{label:"Upload document",name:"document",onChange:B,type:"file",placeholder:"Upload document"}),e("span",{className:"text-red-600 absolute text-xs",children:l.touched.document&&l.errors.document?l.errors.document:null})]}),x&&e("div",{className:"flex justify-center",children:e("img",{src:x,alt:"image",className:""})}),t("div",{className:"flex py-2 justify-between mt-8",children:[e("button",{type:"button",onClick:()=>{l.setFieldValue("status",1),l.handleSubmit()},className:"bg-red-500 text-white rounded-lg px-4 py-1.5 text-sm",children:"Cancel Trip"}),e("button",{type:"button",onClick:()=>{l.setFieldValue("status",2),l.handleSubmit()},className:"bg-[#838FCE] text-white rounded-lg px-4 py-1.5 text-sm",children:"Successful Trip"})]})]})})})]})]})}export{ve as default};
