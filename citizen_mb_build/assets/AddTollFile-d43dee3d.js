import{u as W,r as L,R as G,j as r,F as k,b as o,Q as m}from"./index-d234e753.js";import{u as Q}from"./formik.esm-8135a30a.js";import{T as H}from"./ThemeStyle-994f51bc.js";import{c as J,a as K}from"./index.esm-ef23645b.js";import{R as X}from"./RentalApiList-91990935.js";import{u as Y}from"./useCustomGeoLocation-5613db6b.js";import{r as S}from"./resizeImage-f1558408.js";import{b as Z,a as h}from"./useCustomQuery-6fc50d1c.js";import{F as D,S as b,a as ee,T}from"./LoadingButton-141ccc16.js";import{O as le}from"./OverLayLoader-dbcd3546.js";import{R as re}from"./RotatingLoader-93a6f5da.js";import{u as se}from"./useErrorFocusField-458425b6.js";import"./hoist-non-react-statics.cjs-736e71bf.js";import"./ApiHeader2-b363f7b8.js";import"./index.esm-7ee2a9f6.js";import"./Hourglass-8738f9c5.js";const g=[{isRequired:!0,isVisible:!0,label:"Circle",name:"circle",type:"select"},{isRequired:!0,isVisible:!0,label:"Market",name:"market",type:"select"},{isRequired:!0,isVisible:!0,label:"Vendor Name",name:"vendorName",type:"text",inputValidation:["string","removeDoubleSpace"]},{isRequired:!0,isVisible:!0,label:"Mobile",name:"mobile",type:"text",inputValidation:["mobile","number"]},{isRequired:!0,isVisible:!0,label:"Address",name:"address",type:"text",inputValidation:["string","removeDoubleSpace"]},{isRequired:!0,isVisible:!0,label:"Rate",name:"rate",type:"select"},{isRequired:!0,isVisible:!0,label:o("span",{children:["Longitude ",r("br",{}),r("small",{className:"text-blue-700",children:"(When you choose the photo1, it will be auto filled)"})]}),placeholder:"Longitude",name:"longitude",type:"text"},{isRequired:!0,isVisible:!0,label:o("span",{children:["Latitude ",r("br",{}),r("small",{className:"text-blue-700",children:"(When you choose the photo1, it will be auto filled)"})]}),placeholder:"Latitude",name:"latitude",type:"text"},{isRequired:!0,isVisible:!0,label:"Photo1 Path",name:"photo1Path",type:"file"},{isRequired:!0,isVisible:!0,label:"Photo2 Path",name:"photo2Path",type:"file"},{isRequired:!0,isVisible:!0,label:"Remarks",name:"remarks",type:"textarea",inputValidation:["string","removeDoubleSpace"]}];function xe(){const{AutoFocusErrorField:A}=se(),v=Z({}),{titleColor:C}=H(),{coords:t}=Y(),{api_UlbCircleList:_,api_locationByCircleList:j,api_addToll:O,api_getTollRateList:I}=X(),U=W(),[f,E]=L.useState(""),[y,$]=L.useState(""),x=(e,l)=>{m.dismiss(),l=="success"&&m.success(e),l=="error"&&m.error(e)},i=Q({initialValues:g.reduce((e,l)=>(e[l.name]="",e),{}),enableReinitialize:!0,onSubmit:async e=>{await z(e)},validationSchema:J().shape(g.reduce((e,l)=>(l.isRequired&&(e[l.name]=K().required("This field is required")),e),{}))}),M=async(e,l)=>{if(e=="photo1Path"){const n=await S(l),c=new File([n],l==null?void 0:l.name,{type:l==null?void 0:l.type});i.setFieldValue("latitude",t==null?void 0:t.latitude),i.setFieldValue("longitude",t==null?void 0:t.longitude),i.setFieldValue("photo1Path",c),E(URL.createObjectURL(l))}else{const n=await S(l),c=new File([n],l==null?void 0:l.name,{type:l==null?void 0:l.type});i.setFieldValue("photo2Path",c),$(URL.createObjectURL(l))}},z=async e=>{let l={circleId:e==null?void 0:e.circle,marketId:e==null?void 0:e.market,vendorName:e==null?void 0:e.vendorName,address:e==null?void 0:e.address,rate:e==null?void 0:e.rate,mobile:e==null?void 0:e.mobile,photograph1:e==null?void 0:e.photo1Path,photograph2:e==null?void 0:e.photo2Path,longitude:e==null?void 0:e.longitude,latitude:e==null?void 0:e.latitude,remarks:e==null?void 0:e.remarks};const n=await v.mutateAsync({api:O,data:l});console.log("res",n.data.status),n.data.status?(x(n.data.message,"success"),U("/municipal-rental")):x(n.data.message,"error")},a=h({api:_,options:{enabled:!0}}),d=h({api:j,config:{circleId:i.values.circle},value:[i.values.circle],options:{enabled:!!i.values.circle}}),p=h({api:I,options:{enabled:!0}}),{submitCount:N,errors:R,isSubmitting:F,isValid:B}=i;return G.useEffect(()=>{A({submitCount:N,isSubmitting:F,errors:R,isValid:B})},[R,N,F]),a!=null&&a.isLoading?r(k,{children:r(re,{})}):o(k,{children:[v.isLoading&&r(le,{}),r("div",{className:" bg-[#eff2f0]",children:o("div",{className:"container mx-auto p-4",children:[o("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 p-4 border-b",children:[o("div",{className:"col-span-6 flex space-x-3",children:[r("img",{src:"https://cdn-icons-png.flaticon.com/128/2981/2981313.png",className:"h-10 -mt-2"}),r("h1",{className:`font-semibold ${C} text-xl px-4 py-2 text-gray-600 -mt-2`,children:"Add Toll"})]}),r("div",{className:"col-span-6 flex space-x-3 justify-end"})]}),r("div",{className:"bg-[#fdfdfd]  rounded-2xl shadow-md p-2",children:o(D,{formik:i,children:[r("div",{className:"p-2",children:r("div",{className:"valid-form flex flex-wrap flex-row -mx-4",children:r("div",{className:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4 gap-5",children:g.map((e,l)=>{var n,c,V,w,P,q;if(e.name==="circle")return r("div",{className:"mt-4",children:o(b,{name:e.name,label:e.label,formik:i,children:[r("option",{selected:!0,children:"select"}),(c=(n=a==null?void 0:a.data)==null?void 0:n.data)==null?void 0:c.map((s,u)=>r("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.circle_name},u))]},l)});if(e.name==="market")return r("div",{className:"mt-4",children:o(b,{name:e.name,label:e.label,formik:i,children:[r("option",{selected:!0,children:"select"}),(w=(V=d==null?void 0:d.data)==null?void 0:V.data)==null?void 0:w.map((s,u)=>r("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.market_name},u))]},l)});if(e.name==="rate")return r("div",{className:"mt-4",children:o(b,{name:e.name,label:e.label,formik:i,children:[r("option",{selected:!0,children:"select"}),(q=(P=p==null?void 0:p.data)==null?void 0:P.data)==null?void 0:q.map((s,u)=>o("option",{value:s==null?void 0:s.id,children:[s==null?void 0:s.toll_type," (Rs.",s==null?void 0:s.rate,")"]},u))]},l)});if(e.type==="textarea")return r("div",{className:"mt-4",children:r(ee,{name:e.name,label:e.label,formik:i,inputValidation:e.inputValidation},l)});if(e.type=="text")return r("div",{className:"mt-4",children:r(T,{name:e.name,label:e.label,formik:i,inputValidation:e.inputValidation,placeholder:e.placeholder,disabled:e.name==="latitude"||e.name==="longitude"},l)});if(e.type=="file")return o("div",{className:"mt-4",children:[r(T,{name:e.name,label:e.label,type:"file",onChange:s=>M(e.name,s.target.files[0])},l),r("p",{className:"text-red-500 text-xs",children:i.touched[e.name]&&i.errors[e.name]?i.errors[e.name]:null}),e.name==="photo1Path"&&f&&r("img",{src:f,className:"h-14"}),e.name==="photo2Path"&&y&&r("img",{src:y,className:"h-14"})]})})})})}),r("div",{className:"pb-8",children:r("button",{type:"submit",className:"bg-green-500 px-7 py-2 text-white font-semibold rounded leading-5 shadow-lg w-full",children:"Save"})})]})})]})})]})}export{xe as default};
