var ht=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var s=(i,t,e)=>(ht(i,t,"read from private field"),e?e.call(i):t.get(i)),u=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},l=(i,t,e,r)=>(ht(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e);var d=(i,t,e)=>(ht(i,t,"access private method"),e);import{a8 as Ut,a9 as E,aa as tt,ab as Z,ac as kt,ad as St,ae as Et,af as Bt,ag as Wt,ah as jt,ai as wt,aj as st,ak as Ft,al as Vt,r as m,am as Dt,an as it}from"./index-BnYbweqe.js";var y,n,W,b,M,T,S,j,L,A,U,D,F,K,P,B,V,ut,z,ct,H,lt,N,dt,G,ft,$,pt,J,bt,et,Pt,It,zt=(It=class extends Ut{constructor(t,e){super();u(this,P);u(this,V);u(this,z);u(this,H);u(this,N);u(this,G);u(this,$);u(this,J);u(this,et);u(this,y,void 0);u(this,n,void 0);u(this,W,void 0);u(this,b,void 0);u(this,M,void 0);u(this,T,void 0);u(this,S,void 0);u(this,j,void 0);u(this,L,void 0);u(this,A,void 0);u(this,U,void 0);u(this,D,void 0);u(this,F,void 0);u(this,K,new Set);this.options=e,l(this,y,t),l(this,S,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,n).addObserver(this),Qt(s(this,n),this.options)?d(this,P,B).call(this):this.updateResult(),d(this,N,dt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return yt(s(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return yt(s(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,G,ft).call(this),d(this,$,pt).call(this),s(this,n).removeObserver(this)}setOptions(t,e){const r=this.options,o=s(this,n);if(this.options=s(this,y).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof E(this.options.enabled,s(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,J,bt).call(this),s(this,n).setOptions(this.options),r._defaulted&&!tt(this.options,r)&&s(this,y).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,n),observer:this});const c=this.hasListeners();c&&xt(s(this,n),o,this.options,r)&&d(this,P,B).call(this),this.updateResult(e),c&&(s(this,n)!==o||E(this.options.enabled,s(this,n))!==E(r.enabled,s(this,n))||Z(this.options.staleTime,s(this,n))!==Z(r.staleTime,s(this,n)))&&d(this,V,ut).call(this);const a=d(this,z,ct).call(this);c&&(s(this,n)!==o||E(this.options.enabled,s(this,n))!==E(r.enabled,s(this,n))||a!==s(this,F))&&d(this,H,lt).call(this,a)}getOptimisticResult(t){const e=s(this,y).getQueryCache().build(s(this,y),t),r=this.createResult(e,t);return Nt(this,r)&&(l(this,b,r),l(this,T,this.options),l(this,M,s(this,n).state)),r}getCurrentResult(){return s(this,b)}trackResult(t,e){const r={};return Object.keys(t).forEach(o=>{Object.defineProperty(r,o,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(o),e==null||e(o),t[o])})}),r}trackProp(t){s(this,K).add(t)}getCurrentQuery(){return s(this,n)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,y).defaultQueryOptions(t),r=s(this,y).getQueryCache().build(s(this,y),e);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,P,B).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,b)))}createResult(t,e){var Ct;const r=s(this,n),o=this.options,c=s(this,b),a=s(this,M),f=s(this,T),O=t!==r?t.state:s(this,W),{state:p}=t;let h={...p},k=!1,g;if(e._optimisticResults){const C=this.hasListeners(),ot=!C&&Qt(t,e),_t=C&&xt(t,r,e,o);(ot||_t)&&(h={...h,...jt(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:Y,errorUpdatedAt:Rt,status:I}=h;if(e.select&&h.data!==void 0)if(c&&h.data===(a==null?void 0:a.data)&&e.select===s(this,j))g=s(this,L);else try{l(this,j,e.select),g=e.select(h.data),g=wt(c==null?void 0:c.data,g,e),l(this,L,g),l(this,S,null)}catch(C){l(this,S,C)}else g=h.data;if(e.placeholderData!==void 0&&g===void 0&&I==="pending"){let C;if(c!=null&&c.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))C=c.data;else if(C=typeof e.placeholderData=="function"?e.placeholderData((Ct=s(this,A))==null?void 0:Ct.state.data,s(this,A)):e.placeholderData,e.select&&C!==void 0)try{C=e.select(C),l(this,S,null)}catch(ot){l(this,S,ot)}C!==void 0&&(I="success",g=wt(c==null?void 0:c.data,C,e),k=!0)}s(this,S)&&(Y=s(this,S),g=s(this,L),Rt=Date.now(),I="error");const rt=h.fetchStatus==="fetching",nt=I==="pending",at=I==="error",gt=nt&&rt,Ot=g!==void 0;return{status:I,fetchStatus:h.fetchStatus,isPending:nt,isSuccess:I==="success",isError:at,isInitialLoading:gt,isLoading:gt,data:g,dataUpdatedAt:h.dataUpdatedAt,error:Y,errorUpdatedAt:Rt,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>O.dataUpdateCount||h.errorUpdateCount>O.errorUpdateCount,isFetching:rt,isRefetching:rt&&!nt,isLoadingError:at&&!Ot,isPaused:h.fetchStatus==="paused",isPlaceholderData:k,isRefetchError:at&&Ot,isStale:mt(t,e),refetch:this.refetch}}updateResult(t){const e=s(this,b),r=this.createResult(s(this,n),this.options);if(l(this,M,s(this,n).state),l(this,T,this.options),s(this,M).data!==void 0&&l(this,A,s(this,n)),tt(r,e))return;l(this,b,r);const o={},c=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options,f=typeof a=="function"?a():a;if(f==="all"||!f&&!s(this,K).size)return!0;const R=new Set(f??s(this,K));return this.options.throwOnError&&R.add("error"),Object.keys(s(this,b)).some(O=>{const p=O;return s(this,b)[p]!==e[p]&&R.has(p)})};(t==null?void 0:t.listeners)!==!1&&c()&&(o.listeners=!0),d(this,et,Pt).call(this,{...o,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,N,dt).call(this)}},y=new WeakMap,n=new WeakMap,W=new WeakMap,b=new WeakMap,M=new WeakMap,T=new WeakMap,S=new WeakMap,j=new WeakMap,L=new WeakMap,A=new WeakMap,U=new WeakMap,D=new WeakMap,F=new WeakMap,K=new WeakMap,P=new WeakSet,B=function(t){d(this,J,bt).call(this);let e=s(this,n).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(kt)),e},V=new WeakSet,ut=function(){d(this,G,ft).call(this);const t=Z(this.options.staleTime,s(this,n));if(St||s(this,b).isStale||!Et(t))return;const r=Bt(s(this,b).dataUpdatedAt,t)+1;l(this,U,setTimeout(()=>{s(this,b).isStale||this.updateResult()},r))},z=new WeakSet,ct=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,n)):this.options.refetchInterval)??!1},H=new WeakSet,lt=function(t){d(this,$,pt).call(this),l(this,F,t),!(St||E(this.options.enabled,s(this,n))===!1||!Et(s(this,F))||s(this,F)===0)&&l(this,D,setInterval(()=>{(this.options.refetchIntervalInBackground||Wt.isFocused())&&d(this,P,B).call(this)},s(this,F)))},N=new WeakSet,dt=function(){d(this,V,ut).call(this),d(this,H,lt).call(this,d(this,z,ct).call(this))},G=new WeakSet,ft=function(){s(this,U)&&(clearTimeout(s(this,U)),l(this,U,void 0))},$=new WeakSet,pt=function(){s(this,D)&&(clearInterval(s(this,D)),l(this,D,void 0))},J=new WeakSet,bt=function(){const t=s(this,y).getQueryCache().build(s(this,y),this.options);if(t===s(this,n))return;const e=s(this,n);l(this,n,t),l(this,W,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},et=new WeakSet,Pt=function(t){st.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,b))}),s(this,y).getQueryCache().notify({query:s(this,n),type:"observerResultsUpdated"})})},It);function Ht(i,t){return E(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function Qt(i,t){return Ht(i,t)||i.state.data!==void 0&&yt(i,t,t.refetchOnMount)}function yt(i,t,e){if(E(t.enabled,i)!==!1){const r=typeof e=="function"?e(i):e;return r==="always"||r!==!1&&mt(i,t)}return!1}function xt(i,t,e,r){return(i!==t||E(r.enabled,i)===!1)&&(!e.suspense||i.state.status!=="error")&&mt(i,e)}function mt(i,t){return E(t.enabled,i)!==!1&&i.isStaleByTime(Z(t.staleTime,i))}function Nt(i,t){return!tt(i.getCurrentResult(),t)}var Q,x,v,w,_,q,X,vt,Mt,Gt=(Mt=class extends Ut{constructor(t,e){super();u(this,_);u(this,X);u(this,Q,void 0);u(this,x,void 0);u(this,v,void 0);u(this,w,void 0);l(this,Q,t),this.setOptions(e),this.bindMethods(),d(this,_,q).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const e=this.options;this.options=s(this,Q).defaultMutationOptions(t),tt(this.options,e)||s(this,Q).getMutationCache().notify({type:"observerOptionsUpdated",mutation:s(this,v),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&Ft(e.mutationKey)!==Ft(this.options.mutationKey)?this.reset():((r=s(this,v))==null?void 0:r.state.status)==="pending"&&s(this,v).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=s(this,v))==null||t.removeObserver(this)}onMutationUpdate(t){d(this,_,q).call(this),d(this,X,vt).call(this,t)}getCurrentResult(){return s(this,x)}reset(){var t;(t=s(this,v))==null||t.removeObserver(this),l(this,v,void 0),d(this,_,q).call(this),d(this,X,vt).call(this)}mutate(t,e){var r;return l(this,w,e),(r=s(this,v))==null||r.removeObserver(this),l(this,v,s(this,Q).getMutationCache().build(s(this,Q),this.options)),s(this,v).addObserver(this),s(this,v).execute(t)}},Q=new WeakMap,x=new WeakMap,v=new WeakMap,w=new WeakMap,_=new WeakSet,q=function(){var e;const t=((e=s(this,v))==null?void 0:e.state)??Vt();l(this,x,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},X=new WeakSet,vt=function(t){st.batch(()=>{var e,r,o,c,a,f,R,O;if(s(this,w)&&this.hasListeners()){const p=s(this,x).variables,h=s(this,x).context;(t==null?void 0:t.type)==="success"?((r=(e=s(this,w)).onSuccess)==null||r.call(e,t.data,p,h),(c=(o=s(this,w)).onSettled)==null||c.call(o,t.data,null,p,h)):(t==null?void 0:t.type)==="error"&&((f=(a=s(this,w)).onError)==null||f.call(a,t.error,p,h),(O=(R=s(this,w)).onSettled)==null||O.call(R,void 0,t.error,p,h))}this.listeners.forEach(p=>{p(s(this,x))})})},Mt),Tt=m.createContext(!1),$t=()=>m.useContext(Tt);Tt.Provider;function Jt(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}}var Xt=m.createContext(Jt()),Yt=()=>m.useContext(Xt);function Lt(i,t){return typeof i=="function"?i(...t):!!i}function Zt(){}var qt=(i,t)=>{(i.suspense||i.throwOnError)&&(t.isReset()||(i.retryOnMount=!1))},te=i=>{m.useEffect(()=>{i.clearReset()},[i])},ee=({result:i,errorResetBoundary:t,throwOnError:e,query:r})=>i.isError&&!t.isReset()&&!i.isFetching&&r&&Lt(e,[i.error,r]),se=i=>{i.suspense&&typeof i.staleTime!="number"&&(i.staleTime=1e3)},ie=(i,t)=>(i==null?void 0:i.suspense)&&t.isPending,re=(i,t,e)=>t.fetchOptimistic(i).catch(()=>{e.clearReset()});function ne(i,t,e){var O,p,h,k;const r=Dt(e),o=$t(),c=Yt(),a=r.defaultQueryOptions(i);(p=(O=r.getDefaultOptions().queries)==null?void 0:O._experimental_beforeQuery)==null||p.call(O,a),a._optimisticResults=o?"isRestoring":"optimistic",se(a),qt(a,c),te(c);const[f]=m.useState(()=>new t(r,a)),R=f.getOptimisticResult(a);if(m.useSyncExternalStore(m.useCallback(g=>{const Y=o?()=>{}:f.subscribe(st.batchCalls(g));return f.updateResult(),Y},[f,o]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),m.useEffect(()=>{f.setOptions(a,{listeners:!1})},[a,f]),ie(a,R))throw re(a,f,c);if(ee({result:R,errorResetBoundary:c,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash)}))throw R.error;return(k=(h=r.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||k.call(h,a,R),a.notifyOnChangeProps?R:f.trackResult(R)}function At(i,t){return ne(i,zt,t)}function Kt(i,t){const e=Dt(t),[r]=m.useState(()=>new Gt(e,i));m.useEffect(()=>{r.setOptions(i)},[r,i]);const o=m.useSyncExternalStore(m.useCallback(a=>r.subscribe(st.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),c=m.useCallback((a,f)=>{r.mutate(a,f).catch(Zt)},[r]);if(o.error&&Lt(r.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:c,mutateAsync:o.mutate}}const ae=async(i,t)=>(await it.get(i,{...t})).data;function le({key:i,api:t,options:e,value:r,config:o}){return At({queryKey:[i??t,...r??[]],queryFn:async()=>ae(t,o),refetchOnReconnect:"always",refetchOnWindowFocus:!1,...e})}function de({key:i,api:t,options:e,value:r,config:o}){return At({queryKey:[i??t,...r??[]],queryFn:async()=>(await it.post(t,{...o})).data,refetchOnReconnect:"always",refetchOnWindowFocus:!1,...e})}const oe=(i,t)=>it.post(i,t),fe=({options:i})=>Kt({mutationFn:({api:t,data:e})=>oe(t,e),...i}),pe=({options:i})=>Kt({mutationFn:({api:t,data:e})=>it.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}),...i});export{le as a,pe as b,de as c,fe as u};
