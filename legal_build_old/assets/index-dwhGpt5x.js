import{r as d,j as e,l as N,_ as l,B as L}from"./index-DFXsu1cG.js";import{a as K}from"./index-BOCEW2O0.js";import{h as O}from"./moment-C5S46NFB.js";import{S as z,C as Q,a as W,d as X,c as Z}from"./separator-EWFhvtH1.js";import{T as D,a as ee,b as U,c as x,d as ae,e as g}from"./table-BMmGgJMf.js";import{u as G,a as J}from"./useCustomQuery-L-0XltA9.js";import{g as se}from"./services-KQnp_8oA.js";import{P as re}from"./index-B97T6Cl7.js";import{D as te,S as ne,q as ce}from"./switch-BeWbLBR4.js";import{S as de}from"./Spinner-D31LjvDN.js";import{a as le,o as ie,F as oe,f as ue,R as pe,B as he,c as xe,b as V}from"./switch-BI5EbOij.js";import"./select-Bl6BGl8Z.js";import{a as ge}from"./useMasters-DrPDxH7_.js";import{L as je}from"./loader-circle-OSXIsPm0.js";const fe=xe().shape({caseSubType:V().required("Case Sub Type is required"),caseTypeId:V().required("Case  Type Id is required")});function ye({open:$,setOpen:u,title:F,id:p,edit:i,setEdit:j,refetch:I}){var y,S;const f=ge(),h=G({}),{data:n,isFetching:_}=J({api:`${N.getCaseSubTypeById}/${p}`,key:"getCaseSubTypeById",options:{enabled:i}}),c=le({defaultValues:{caseSubType:"",caseTypeId:""},resolver:ie(fe)}),v=async s=>{var o,w,b,m,C,T;try{if(i&&s){const t=await h.mutateAsync({api:`${N.updateCaseSubType}`,data:{id:p,...s}});(o=t.data)!=null&&o.success?l.success((w=t==null?void 0:t.data)==null?void 0:w.message):l.error(((b=t.data)==null?void 0:b.message)||"Case Sub Type not updated successfully")}else{const t=await h.mutateAsync({api:N.createCaseSubType,data:s});(m=t.data)!=null&&m.success?l.success((C=t==null?void 0:t.data)==null?void 0:C.message):l.error(((T=t.data)==null?void 0:T.message)||"Case Sub Type not created successfully"),c.reset({caseSubType:"",caseTypeId:""})}u(!1),j(!1),I()}catch(t){console.log(t)}};return d.useEffect(()=>{var s,o;i&&n?c.reset({caseSubType:((s=n==null?void 0:n.data)==null?void 0:s.case_sub_type)||"",caseTypeId:String((o=n==null?void 0:n.data)==null?void 0:o.case_type_id)||""}):c.reset({caseSubType:"",caseTypeId:""})},[i,n]),e.jsx(te,{open:$,setOpen:u,title:F,setEdit:j,edit:i,isLoading:_,children:e.jsx(oe,{methods:c,onSubmit:c.handleSubmit(v),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(ue,{name:"caseTypeId",data:((S=(y=f==null?void 0:f.data)==null?void 0:y.data)==null?void 0:S.map(s=>({label:String(s.case_type),value:String(s.id)})))||[]})}),e.jsx("div",{children:e.jsx(pe,{name:"caseSubType",placeholder:"Enter your case Sub type"})}),e.jsx(z,{}),e.jsx("div",{children:e.jsx(he,{isLoading:c.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Se(){var b,m,C,T,t,A;const $=G({}),[u,F]=d.useState(1),[p,i]=d.useState(10),[j,I]=d.useState(""),[f,h]=d.useState(!1),[n,_]=d.useState(""),[c,v]=d.useState(!1),[y,S]=d.useState(null),s=J({api:`${N.getAllCaseSubType}?page=${u}&limit=${p}&q=${j}`,key:"getAllCaseSubType",value:[u,p],options:{enabled:!0}}),o=a=>{v(!0),h(!0),_(a)},w=async a=>{var P,B,E,k,q,M,H,R,Y;S(a);try{const r=await $.mutateAsync({api:`${(P=N)==null?void 0:P.updateCaseSubTypeStatus}`,data:{id:a}});(B=r==null?void 0:r.data)!=null&&B.success?(s.refetch(),((k=(E=r==null?void 0:r.data)==null?void 0:E.data)==null?void 0:k.status)==1&&l.success((q=r==null?void 0:r.data)==null?void 0:q.message),((H=(M=r==null?void 0:r.data)==null?void 0:M.data)==null?void 0:H.status)==0&&l.error((R=r==null?void 0:r.data)==null?void 0:R.message)):l.error((Y=r.data)==null?void 0:Y.message)}catch(r){l.error(se(r))}finally{S(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(ye,{open:f,setOpen:h,title:c?"Edit Case Sub Type":"Add Case Sub Type",id:n,edit:c,setEdit:v,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(ne,{search:j,setSearch:I,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(L,{className:"flex items-center gap-2",onClick:()=>h(!0),children:"Add New"})})]}),e.jsxs(Q,{children:[e.jsx(W,{className:"px-7",children:e.jsxs(X,{children:["Case Sub Type List (",(m=(b=s==null?void 0:s.data)==null?void 0:b.pagination)==null?void 0:m.total,")"]})}),e.jsx(Z,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(de,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:[e.jsx(ee,{children:e.jsxs(U,{children:[e.jsx(x,{className:"",children:"#"}),e.jsx(x,{className:"",children:"Case type "}),e.jsx(x,{className:"",children:"Case sub type name"}),e.jsx(x,{className:"",children:"Created at"}),e.jsx(x,{className:"",children:"Status"}),e.jsx(x,{children:"Action"})]})}),e.jsx(ae,{children:(T=(C=s==null?void 0:s.data)==null?void 0:C.data)==null?void 0:T.map((a,P)=>e.jsxs(U,{children:[e.jsx(g,{children:P+1}),e.jsx(g,{children:a==null?void 0:a.case_type}),e.jsx(g,{children:a==null?void 0:a.case_sub_type}),e.jsx(g,{children:O(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(g,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ce,{checked:(a==null?void 0:a.status)==1,onChange:()=>w(String(a==null?void 0:a.id)),disabled:y===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),y===String(a==null?void 0:a.id)&&e.jsx(je,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(g,{children:e.jsx(L,{className:"bg-primary",onClick:()=>o(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(z,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(re,{page:u,limit:p,totalPages:(A=(t=s==null?void 0:s.data)==null?void 0:t.pagination)==null?void 0:A.totalPages,setPage:F,setLimit:i})})]})})]})]})]})}function Ee(){return e.jsx(K,{title:"Case Sub Type List",subTitle:"Manage all the case Sub types here",children:e.jsx("div",{className:"py-12",children:e.jsx(Se,{})})})}export{Ee as default};
