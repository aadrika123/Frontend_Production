import{e as $,j as e,r as c,l as T,u as G,n as J,_ as D,B as O,o as C,y as Z}from"./index-Csk3n5hK.js";import{S as ve,h as De}from"./Spinner-BRFUKIaT.js";import{S as be,C as B,c as U,a as Ae,b as _e,d as we}from"./separator-DxHuHOzs.js";import{u as Ce,C as Se,c as Pe,b as q,g as Re,a as Me,o as Te,F as Fe,f as ke,B as Ee}from"./switch-CHfnM_JJ.js";import{I as $e}from"./select-nyEHKbTP.js";import{R as Ie}from"./RHFTextArea-d-YzkRQK.js";import{D as Oe}from"./index--iU86GmE.js";import{u as K,c as Be,a as Q}from"./useCustomQuery-BYn9UIPW.js";import{c as Ue}from"./index-BwyZGPoe.js";import{F as L}from"./file-text-d7yFUUqy.js";import{C as qe}from"./calendar-DOwtnN6y.js";import{T as Le,d as X,c as ze,O as Ve,W as Ye,C as He,b as We,D as Ge,a as ee,P as Je,R as Ze}from"./index-DjS3pGek.js";import{U as Ke}from"./user-BAsrBwKX.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=$("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=$("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=$("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=$("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function Xe({name:t,label:a,isDynamic:s,isRequired:n,...o}){const{control:i,setValue:u}=Ce();return e.jsx(Se,{name:t,control:i,render:({field:{ref:m},fieldState:{error:x}})=>e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-200",htmlFor:a,children:[a," ",n&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx($e,{type:"file",onChange:f=>{u(t,f.target.files?f.target.files[0]:null)},ref:m,className:`mt-1 ${x?"border-red-400":null}`,...o}),x&&e.jsx("span",{className:"text-red-400 text-xs",children:x.message})]})})}const z=[{value:"orderSheet",label:"Order Sheet"},{value:"judgementCopy",label:"Judgement Copy"},{value:"Other",label:"Other"}],et=Pe().shape({documentName:q().required("Document Name is required"),docType:q(),docPath:Re().required("Document is required"),description:q().required("Description is required")});function tt({open:t,setOpen:a,title:s,id:n,edit:o,setEdit:i,refetch:u}){var r,P,k;const m=K({}),x=Be({}),[f,d]=c.useState(""),{data:l,isFetching:j}=Q({api:`${T.getCaseTypeById}/${n}`,key:"getCaseTypeById",options:{enabled:o}}),{user:g}=G(),y=Me({defaultValues:{documentName:((r=l==null?void 0:l.data)==null?void 0:r.document_name)||"",docType:((P=l==null?void 0:l.data)==null?void 0:P.doc_type)||"",docPath:void 0,description:((k=l==null?void 0:l.data)==null?void 0:k.description)||""},resolver:Te(et)}),{id:b}=J(),R=async h=>{var _,w;const p=new FormData;p.append("img",h);try{const N=await x.mutateAsync({api:T.uploadDocumentDms,data:p});if((_=N.data)!=null&&_.status)return N.data.data;throw new Error(((w=N.data)==null?void 0:w.message)||"DMS upload failed")}catch(N){throw console.error("DMS Upload Error:",N),N}},S=async h=>{var p,_,w,N,V,Y;try{let M=f;if((!o||h.docPath instanceof File)&&(D.loading("Uploading document..."),M=await R(h.docPath),d(M),D.dismiss()),o&&h){const I={id:n,documentName:h.documentName,description:h.description,docPath:M,docType:h.docType},v=await m.mutateAsync({api:T.updateCaseType,data:I});(p=v.data)!=null&&p.success?D.success((_=v==null?void 0:v.data)==null?void 0:_.message):D.error(((w=v.data)==null?void 0:w.message)||"Document updated successfully")}else{const I={caseId:b||"",documentName:h.documentName,description:h.description,docPath:M,actionByUserId:g==null?void 0:g._id,actionByRoleId:g==null?void 0:g.roleId,actionByRoleName:g==null?void 0:g.roleName,actionByUserName:g==null?void 0:g.fullName},v=await m.mutateAsync({api:T.attachDocument,data:I});(N=v.data)!=null&&N.success?D.success((V=v==null?void 0:v.data)==null?void 0:V.message):D.error(((Y=v.data)==null?void 0:Y.message)||"Document not attached successfully"),y.reset({documentName:"",description:"",docPath:""})}a(!1),i(!1),u(),d("")}catch(M){console.log("Submit Error:",M),D.error("An error occurred while processing your request")}};c.useEffect(()=>{var h,p,_,w,N;o&&l?(y.reset({documentName:((h=l.data)==null?void 0:h.document_name)||"",description:((p=l.data)==null?void 0:p.description)||"",docPath:(_=l.data)==null?void 0:_.document_path,docType:(w=l.data)==null?void 0:w.doc_type}),d(((N=l.data)==null?void 0:N.document_path)||"")):(y.reset({documentName:"",description:"",docPath:"",docType:""}),d(""))},[o,l]);const E=y.formState.isSubmitting||x.isPending;return e.jsx(Oe,{open:t,setOpen:a,title:s,setEdit:i,edit:o,isLoading:j,children:e.jsx(Fe,{methods:y,onSubmit:y.handleSubmit(S),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(ke,{name:"documentName",data:(z==null?void 0:z.map(h=>({label:String(h.label),value:String(h.label)})))||[]})}),e.jsx("div",{children:e.jsx(Xe,{name:"docPath",placeholder:"Upload your document"})}),e.jsx("div",{children:e.jsx(Ie,{name:"description",placeholder:"Enter your description"})}),e.jsx(be,{}),e.jsx("div",{children:e.jsx(Ee,{isLoading:E,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const at=(t,a,s)=>{Ue({customUI:({onClose:n})=>e.jsxs("div",{className:"rounded-md bg-white p-4 shadow-lg",children:[e.jsx("h1",{className:"text-lg font-bold",children:t}),e.jsx("p",{className:"text-sm",children:a}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{className:"rounded-md bg-red-500 px-4 py-1 text-white",onClick:()=>{s(),n()},children:"Yes"}),e.jsx("button",{className:"ml-2 rounded-md bg-gray-500 px-4 py-1 text-white",onClick:n,children:"No"})]})]})})};function Vt(){var g,y,b,R,S,E;const{user:t}=G(),[a,s]=c.useState(""),[n,o]=c.useState(!1),[i,u]=c.useState(""),[m,x]=c.useState(!1),{id:f}=J(),d=Q({api:`${T.getAllDocuments}/${f}`,key:"getAllDocumentsList",value:[],options:{enabled:!0}}),l=K({}),j=async r=>{at("Are you sure?","Please confirm",async()=>{var P,k,h;try{const p=await l.mutateAsync({api:`${T.deleteAttachedDocument}`,data:{id:r}});(P=p==null?void 0:p.data)!=null&&P.success?(D.success(((k=p==null?void 0:p.data)==null?void 0:k.message)||"Deleted successfully"),d.refetch()):D.error(((h=p==null?void 0:p.data)==null?void 0:h.message)||"Failed to delete")}catch(p){D.error("Error deleting item"),console.error("Delete Error:",p)}})};return e.jsxs("main",{className:"min-h-screen bg-gray-50/50 p-6",children:[e.jsx(tt,{open:n,setOpen:o,title:m?"Edit Document":"Attach Document",id:i,edit:m,setEdit:x,refetch:d.refetch}),e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Document Management"}),e.jsxs("p",{className:"mt-1 text-gray-600",children:["Manage case documents (",((y=(g=d==null?void 0:d.data)==null?void 0:g.pagination)==null?void 0:y.total)||0," total)"]})]}),e.jsxs(O,{className:"w-full bg-blue-600 hover:bg-blue-700 sm:w-auto",onClick:()=>o(!0),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Add New Document"]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:d.isLoading?e.jsx(B,{children:e.jsx(U,{className:"flex h-32 items-center justify-center",children:e.jsx(ve,{})})}):e.jsxs(e.Fragment,{children:[(R=(b=d==null?void 0:d.data)==null?void 0:b.data)==null?void 0:R.map((r,P)=>e.jsxs(B,{className:"border border-gray-200 transition-all duration-200 hover:shadow-lg",children:[e.jsx(Ae,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"h-6 w-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx(_e,{className:"text-lg font-semibold text-gray-900",children:(r==null?void 0:r.document_name)||"Document"}),e.jsxs(we,{className:"mt-1 text-sm text-gray-600",children:["Case ID: #",r==null?void 0:r.case_id," â€¢ Document #",P+1]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Created:"," ",De(r==null?void 0:r.created_at).format("DD-MM-YYYY")]}),(t==null?void 0:t.roleId)==77&&e.jsx("div",{className:"ml-auto flex justify-end",children:e.jsx(O,{size:"sm",variant:"ghost",className:"flex h-7 w-7 items-center p-0 text-red-500 hover:bg-red-50 hover:text-red-700",onClick:()=>j(r==null?void 0:r.id),children:e.jsx(Le,{className:"h-3.5 w-3.5"})})})]})})]})}),e.jsxs(U,{className:"pt-0",children:[(r==null?void 0:r.description)&&e.jsx("p",{className:"mb-4 text-sm leading-relaxed text-gray-700",children:r.description}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4 text-sm sm:grid-cols-2 lg:grid-cols-3",children:[(r==null?void 0:r.doc_type)&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:["Type: ",r.doc_type]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsxs("span",{children:["Action By:","",e.jsx("span",{className:"font-medium",children:r==null?void 0:r.action_by_role_name}),r!=null&&r.action_by_user_name?` (${r==null?void 0:r.action_by_user_name})`:""]})]})]}),(r==null?void 0:r.document_path)&&e.jsxs("div",{className:"rounded-lg border bg-gray-50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Document Path:"})]}),e.jsx("a",{href:r.document_path,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:"View Document"})]}),e.jsx("p",{className:"mt-1 break-all text-xs text-gray-500",children:r.document_path})]})]})]},r==null?void 0:r.id)),((E=(S=d==null?void 0:d.data)==null?void 0:S.data)==null?void 0:E.length)===0&&e.jsx(B,{className:"py-12 text-center",children:e.jsxs(U,{children:[e.jsx(L,{className:"mx-auto mb-4 h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-900",children:"No documents found"}),e.jsx("p",{className:"mb-4 text-gray-600",children:a?"Try adjusting your search criteria":"Upload your first document to get started"}),e.jsxs(O,{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Add New Document"]})]})})]})})]})]})}function st(t,a=[]){let s=[];function n(i,u){const m=c.createContext(u),x=s.length;s=[...s,u];const f=l=>{var S;const{scope:j,children:g,...y}=l,b=((S=j==null?void 0:j[t])==null?void 0:S[x])||m,R=c.useMemo(()=>y,Object.values(y));return e.jsx(b.Provider,{value:R,children:g})};f.displayName=i+"Provider";function d(l,j){var b;const g=((b=j==null?void 0:j[t])==null?void 0:b[x])||m,y=c.useContext(g);if(y)return y;if(u!==void 0)return u;throw new Error(`\`${l}\` must be used within \`${i}\``)}return[f,d]}const o=()=>{const i=s.map(u=>c.createContext(u));return function(m){const x=(m==null?void 0:m[t])||i;return c.useMemo(()=>({[`__scope${t}`]:{...m,[t]:x}}),[m,x])}};return o.scopeName=t,[n,ot(o,...a)]}function ot(...t){const a=t[0];if(t.length===1)return a;const s=()=>{const n=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const u=n.reduce((m,{useScope:x,scopeName:f})=>{const l=x(i)[`__scope${f}`];return{...m,...l}},{});return c.useMemo(()=>({[`__scope${a.scopeName}`]:u}),[u])}};return s.scopeName=a.scopeName,s}function W(t,a){if(typeof t=="function")return t(a);t!=null&&(t.current=a)}function rt(...t){return a=>{let s=!1;const n=t.map(o=>{const i=W(o,a);return!s&&typeof i=="function"&&(s=!0),i});if(s)return()=>{for(let o=0;o<n.length;o++){const i=n[o];typeof i=="function"?i():W(t[o],null)}}}}function te(...t){return c.useCallback(rt(...t),t)}function nt(t,a,{checkForDefaultPrevented:s=!0}={}){return function(o){if(t==null||t(o),s===!1||!o.defaultPrevented)return a==null?void 0:a(o)}}var ct=Symbol("radix.slottable");function lt(t){const a=({children:s})=>e.jsx(e.Fragment,{children:s});return a.displayName=`${t}.Slottable`,a.__radixId=ct,a}var ae="AlertDialog",[it,Yt]=st(ae,[X]),A=X(),se=t=>{const{__scopeAlertDialog:a,...s}=t,n=A(a);return e.jsx(Ze,{...n,...s,modal:!0})};se.displayName=ae;var dt="AlertDialogTrigger",ut=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...n}=t,o=A(s);return e.jsx(ze,{...o,...n,ref:a})});ut.displayName=dt;var mt="AlertDialogPortal",oe=t=>{const{__scopeAlertDialog:a,...s}=t,n=A(a);return e.jsx(Je,{...n,...s})};oe.displayName=mt;var pt="AlertDialogOverlay",re=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...n}=t,o=A(s);return e.jsx(Ve,{...o,...n,ref:a})});re.displayName=pt;var F="AlertDialogContent",[xt,gt]=it(F),ht=lt("AlertDialogContent"),ne=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,children:n,...o}=t,i=A(s),u=c.useRef(null),m=te(a,u),x=c.useRef(null);return e.jsx(Ye,{contentName:F,titleName:ce,docsSlug:"alert-dialog",children:e.jsx(xt,{scope:s,cancelRef:x,children:e.jsxs(He,{role:"alertdialog",...i,...o,ref:m,onOpenAutoFocus:nt(o.onOpenAutoFocus,f=>{var d;f.preventDefault(),(d=x.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:f=>f.preventDefault(),onInteractOutside:f=>f.preventDefault(),children:[e.jsx(ht,{children:n}),e.jsx(yt,{contentRef:u})]})})})});ne.displayName=F;var ce="AlertDialogTitle",le=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...n}=t,o=A(s);return e.jsx(We,{...o,...n,ref:a})});le.displayName=ce;var ie="AlertDialogDescription",de=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...n}=t,o=A(s);return e.jsx(Ge,{...o,...n,ref:a})});de.displayName=ie;var ft="AlertDialogAction",ue=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...n}=t,o=A(s);return e.jsx(ee,{...o,...n,ref:a})});ue.displayName=ft;var me="AlertDialogCancel",pe=c.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...n}=t,{cancelRef:o}=gt(me,s),i=A(s),u=te(a,o);return e.jsx(ee,{...i,...n,ref:u})});pe.displayName=me;var yt=({contentRef:t})=>{const a=`\`${F}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${F}\` by passing a \`${ie}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${F}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return c.useEffect(()=>{var n;document.getElementById((n=t.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},Nt=se,jt=oe,xe=re,ge=ne,he=ue,fe=pe,ye=le,Ne=de;const Ht=Nt,vt=jt,je=c.forwardRef(({className:t,...a},s)=>e.jsx(xe,{className:C("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));je.displayName=xe.displayName;const Dt=c.forwardRef(({className:t,...a},s)=>e.jsxs(vt,{children:[e.jsx(je,{}),e.jsx(ge,{ref:s,className:C("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]}));Dt.displayName=ge.displayName;const bt=({className:t,...a})=>e.jsx("div",{className:C("flex flex-col space-y-2 text-center sm:text-left",t),...a});bt.displayName="AlertDialogHeader";const At=({className:t,...a})=>e.jsx("div",{className:C("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});At.displayName="AlertDialogFooter";const _t=c.forwardRef(({className:t,...a},s)=>e.jsx(ye,{ref:s,className:C("text-lg font-semibold",t),...a}));_t.displayName=ye.displayName;const wt=c.forwardRef(({className:t,...a},s)=>e.jsx(Ne,{ref:s,className:C("text-sm text-muted-foreground",t),...a}));wt.displayName=Ne.displayName;const Ct=c.forwardRef(({className:t,...a},s)=>e.jsx(he,{ref:s,className:C(Z(),t),...a}));Ct.displayName=he.displayName;const St=c.forwardRef(({className:t,...a},s)=>e.jsx(fe,{ref:s,className:C(Z({variant:"outline"}),"mt-2 sm:mt-0",t),...a}));St.displayName=fe.displayName;export{Ht as A,Lt as B,zt as F,Vt as H,H as P,Dt as a,bt as b,_t as c,wt as d,At as e,St as f,Ct as g};
