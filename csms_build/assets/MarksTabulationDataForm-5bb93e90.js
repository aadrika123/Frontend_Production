import{r as o,u as ee,a as te,j as t}from"./index-2d137de0.js";import{u as le}from"./formik.esm-d65f4248.js";import{c as se,a as g}from"./index.esm-aa041152.js";import{a as w}from"./PowerupFunctions-42ae8b7a.js";import{A as n,a as d,b as ae}from"./AxiosInterceptors-ca7a5259.js";import{B as re}from"./BarLoader-702b4bef.js";import{B as oe}from"./BottomErrorCard-bf717467.js";import{T as ie}from"./Tabs-2733856a.js";import{N as ce}from"./nodata-040bca7f.js";import"./hoist-non-react-statics.cjs-b8781c68.js";function ke(){const[M,S]=o.useState(!1),[I,E]=o.useState(null),[F,r]=o.useState(!1),[u,_]=o.useState([]),[x,P]=o.useState([]),[f,T]=o.useState([]),[b,A]=o.useState([]);o.useState([]);const[j,C]=o.useState(),[ne,D]=o.useState(),[h,L]=o.useState(),{api_getActiveExamTermData:V,api_getactiveClassData:B,api_finance_year:O,api_getactiveSectionData:$,api_postMarksEntryData:q,api_getMarksEntryData:de,api_getMarksTabulationData:R}=ae(),p=ee(),{id:y}=te(),G=se({classId:g().required("Select Class"),sectionId:g().required("Select Section"),termId:g().required("Select Term")}),l=le({initialValues:{classId:"",sectionId:"",termId:"",isMainSubject:!0,isOptionalSubject:!1,fullMarks:"",passMarks:"",totalMarks:0,totalObtainedMarks:0,percentage:0,marks:[]},onSubmit:(e,s)=>{console.log("at submit ",e),J(e)},validationSchema:G}),J=e=>{r(!0);let s,a,m={classId:e.classId,sectionId:e==null?void 0:e.sectionId,subjectId:e==null?void 0:e.subjectId,termId:e==null?void 0:e.termId,obtMarks1:parseFloat(e==null?void 0:e.obtMarks)};s=q,a=m,n.post(s,a,d()).then(function(c){var k,N,v;console.log("view discount group master..",(k=c==null?void 0:c.data)==null?void 0:k.data),(N=c==null?void 0:c.data)!=null&&N.status?p("/marks-tabulation"):i(!0,`${(v=c==null?void 0:c.data)==null?void 0:v.message}`),r(!1)}).catch(function(c){console.log("==2 error list...",c),i(!0,"Error occured in submitting form."),r(!1)})},K=()=>{r(!0),n.post(O,{},d()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),_(e==null?void 0:e.data)):i(!0,"Error occured while fetching data."),r(!1)}).catch(function(e){console.log("==2 error list...",e),i(!0,"Error occured while fetching data."),r(!1)})},U=()=>{r(!0),n.post(B,{},d()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),P(e==null?void 0:e.data.data)):i(!0,"Error occured while fetching data."),r(!1)}).catch(function(e){console.log("==2 error list...",e),i(!0,"Error occured while fetching data."),r(!1)})},Y=()=>{r(!0),n.post($,{},d()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),T(e==null?void 0:e.data.data)):i(!0,"Error occured while fetching data."),r(!1)}).catch(function(e){console.log("==2 error list...",e),i(!0,"Error occured while fetching data."),r(!1)})},H=()=>{r(!0),n.post(V,{},d()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),A(e==null?void 0:e.data.data)):i(!0,"Error occured while fetching data."),r(!1)}).catch(function(e){console.log("==2 error list...",e),i(!0,"Error occured while fetching data."),r(!1)})},z=()=>{n.post(R,{},d()).then(function(e){var s,a,m;(s=e==null?void 0:e.data)!=null&&s.status?l.setFieldValue("marks",(a=e==null?void 0:e.data)==null?void 0:a.data.map(c=>({...c,obtMarks:0}))):i(!0,`${(m=e==null?void 0:e.data)==null?void 0:m.message}`),r(!1)}).catch(function(e){console.log("==2 error list...",e),i(!0,"Error occured while fetching data.")})},Q=()=>{let e=l.values.marks.reduce((s,a)=>s+(a==null?void 0:a.full_marks),0);C(e)},W=()=>{let e=l.values.marks.reduce((s,a)=>parseInt(s)+parseInt(a==null?void 0:a.obtMarks),0);console.log(e),L(e)},X=(e,s)=>{l.setFieldValue(`marks.${s}.obtMarks`,e),console.log(s,e,`marks.${s}.obtMarks`),D(s)};console.log(l.values.marks),o.useEffect(()=>{W()},[l.values.marks]),o.useEffect(()=>{Q()},[l.values.marks]),o.useEffect(()=>{l.setFieldValue("totalMarks",j)},[j]),o.useEffect(()=>{K(),U(),Y(),H(),z()},[]),o.useEffect(()=>{let e=(h/l.values.totalMarks*100).toFixed(2);l.setFieldValue("percentage",e)},[h,l.values.totalMarks]);const Z=e=>{let s=e.target.name,a=e.target.value;s=="fullMarks"&&l.setFieldValue("fullMarks",w(a.trim(),l.values.fullMarks,3)),s=="passMarks"&&l.setFieldValue("passMarks",w(a.trim(),l.values.passMarks,3))},i=(e,s)=>{E(s),S(e)};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"main-div",children:t.jsxs("div",{className:"main-inner-div",children:[F&&t.jsx(re,{}),M&&t.jsx(oe,{activateBottomErrorCard:i,errorTitle:I}),t.jsxs("div",{className:"main-sub-div",children:[t.jsx("div",{className:"main-sub-inner-div",children:t.jsxs("div",{className:"text-div",children:[t.jsx("div",{className:"big-text",children:"Marks Tabulation Master Form"}),t.jsx("div",{className:"small-text",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]})}),y===void 0?t.jsx("div",{className:"tab-div",children:t.jsx("div",{className:"add-button-master-div",children:t.jsxs("button",{onClick:()=>p("/marks-tabulation-form"),type:"submit",className:" add-button-master",children:["Add"," "]})})}):null]}),t.jsx(ie,{listRoute:"/marks-tabulation",formRoute:"/marks-tabulation-form"}),t.jsx("div",{className:"details-div",children:t.jsx("span",{className:"detailes",children:"Marks Tabulation Form"})}),t.jsx("div",{className:"form-div",children:t.jsx("form",{onSubmit:l.handleSubmit,onChange:Z,children:t.jsxs("div",{className:"form",children:[t.jsxs("div",{className:"col-span-4 grid grid-cols-12",children:[t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4 relative",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Financial Year",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsx("select",{...l.getFieldProps("fy"),disabled:!0,type:"number",className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 h-10 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select class",children:u==null?void 0:u.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.fy,children:e==null?void 0:e.fy}))}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.fy&&l.errors.fy?l.errors.fy:null})]}),t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Term",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsxs("select",{...l.getFieldProps("subjectId"),type:"text",className:"form-control h-10 block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select Discount Group",children:[t.jsx("option",{value:"",children:"Select"}),b==null?void 0:b.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.term_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:l.touched.subjectId&&l.errors.subjectId?l.errors.subjectId:null})]}),t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Class",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsxs("select",{...l.getFieldProps("classId"),type:"number",className:"form-control h-10 block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select Class",children:[t.jsx("option",{value:"",children:"Select"}),x==null?void 0:x.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.class_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:l.touched.classId&&l.errors.classId?l.errors.classId:null})]}),t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Section",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsxs("select",{...l.getFieldProps("sectionId"),type:"text",className:"form-control h-10 block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select Discount Group",children:[t.jsx("option",{value:"",children:"Select"}),f==null?void 0:f.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.section_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:l.touched.sectionId&&l.errors.sectionId?l.errors.sectionId:null})]}),t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Admission no",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsx("input",{...l.getFieldProps("fullMarks"),type:"text",className:"form-control h-10 block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter admission no",onKeyDown:e=>["e","E","+","-"].includes(e.key)&&e.preventDefault()}),t.jsx("span",{className:"text-red-600 text-xs",children:l.touched.pickupPointName&&l.errors.pickupPointName?l.errors.pickupPointName:null})]})]}),l.values.classId!==""&&l.values.sectionId!==""?t.jsxs("div",{className:"col-span-12 mt-4 ",children:[t.jsxs("div",{className:"overflow-x-auto shadow-lg border",children:[l.values.marks.length===0&&t.jsxs("div",{className:"w-full flex items-center justify-center",children:[" ",t.jsx("img",{src:ce,alt:"noData",className:"w-[20vh] h-[20vh]"})]}),l.values.marks&&l.values.marks.map((e,s)=>t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 max-[820px]:w-[820px]",children:[t.jsx("thead",{className:"bg-[#E7EFFC] ",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Subject"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Full Marks"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Passing Marks"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Obtained Marks"})]})}),t.jsx("tbody",{className:" divide-y divide-gray-200 ",children:t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e==null?void 0:e.subject_name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e==null?void 0:e.full_marks}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e==null?void 0:e.pass_marks}),t.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:t.jsx("input",{...l.getFieldProps(`marks.${s}.obtMarks`),onChange:a=>X(a.target.value,s),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),className:"  text-center form-control h-10  w-1/2 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",type:"number"})})]})})]}))]}),l.values.marks&&l.values.marks.map((e,s)=>t.jsxs("div",{className:"mt-9",children:[" ",t.jsx("div",{className:"flex justify-start",children:t.jsxs("div",{className:"w-full grid-cols-12 col-span-12 grid mt-1 max-[464px]:grid-cols-6",children:[t.jsx("div",{className:"form-group mb-6 col-span-5 md:pr-4 flex justify-start max-[464px]:col-span-6",children:t.jsxs("label",{className:"form-check-label text-gray-800 ml-2 w-full",children:[" ",t.jsxs("span",{className:"inline text-gray-700",children:["Total Marks",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]})})," ",t.jsxs("div",{className:"form-group mb-6 col-span-2 md:pr-4 flex max-[464px]:col-span-6",children:[t.jsx("input",{...l.getFieldProps("totalMarks"),type:"number",disabled:!0,className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md ",placeholder:"0"}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.totalMarks&&l.errors.totalMarks?l.errors.totalMarks:null})]})]})}),t.jsx("div",{className:"flex justify-start",children:t.jsxs("div",{className:"w-full grid-cols-12 col-span-12 grid mt-1 max-[464px]:grid-cols-6",children:[t.jsx("div",{className:"form-group mb-6 col-span-5 md:pr-4 flex justify-start max-[464px]:col-span-6",children:t.jsxs("label",{className:"form-check-label text-gray-800 ml-2 w-full",children:[" ",t.jsxs("span",{className:"inline text-gray-700",children:["Obtained marks",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]})})," ",t.jsxs("div",{className:"form-group mb-6 col-span-2 md:pr-4 flex max-[464px]:col-span-6",children:[t.jsx("input",{...l.getFieldProps("totalObtainedMarks"),type:"number",disabled:!0,value:h,className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md ",placeholder:"0"}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.feeAmount&&l.errors.feeAmount?l.errors.feeAmount:null})]})]})}),t.jsx("div",{className:"flex justify-start",children:t.jsxs("div",{className:"w-full grid-cols-12 col-span-12 grid mt-1 max-[464px]:grid-cols-6",children:[t.jsx("div",{className:"form-group mb-6 col-span-5 md:pr-4 flex justify-start max-[464px]:col-span-6",children:t.jsxs("label",{className:"form-check-label text-gray-800 ml-2 w-full",children:[" ",t.jsxs("span",{className:"inline text-gray-700",children:["Percentage",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]})})," ",t.jsxs("div",{className:"form-group mb-6 col-span-2 md:pr-4 flex max-[464px]:col-span-6",children:[t.jsx("input",{...l.getFieldProps("percentage"),type:"number",disabled:!0,className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md ",placeholder:"0"}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.feeAmount&&l.errors.feeAmount?l.errors.feeAmount:null})]})]})})]}))]}):null,t.jsxs("div",{className:"cancel-button-div",children:[t.jsx("div",{className:"    ",children:t.jsx("button",{onClick:()=>p("/marks-tabulation"),type:"button",className:"cancel-button",children:"Back to List"})}),t.jsx("div",{className:"submit-button-div",children:t.jsx("button",{type:"submit",className:" cypress_next2_button submit-button",children:y!==void 0?"Update":"Save"})})]})]})})})]})})})}export{ke as default};
