import{r,u as At,A as j,a as b,Q as v,j as t,R as Bt,P as Lt,T as Pt,b as Tt}from"./index-db227e36.js";import{B as kt}from"./BarLoader-92cd05ea.js";import{n as z,c as Mt}from"./PowerupFunctions-c7a4e16f.js";import{u as Ht}from"./useSetTitle-a0238787.js";import{D as $t,L as Vt}from"./DeleteView-1203d5ab.js";import{B as qt}from"./BottomErrorCard-f7652267.js";import{u as Gt,a as Rt,b as Ot,F as Ut}from"./formik.esm-243b4d91.js";import"./Link-6fc20fc6.js";import{E as Jt}from"./jspdf.plugin.autotable-3961c679.js";import{P as zt}from"./Pagination-4f356562.js";import{T as Kt}from"./TabulationHeader-dacf758e.js";import{T as Qt}from"./TextField-9598b68c.js";import"./index-50cdb325.js";import"./index-fd275632.js";import"./hoist-non-react-statics.cjs-6b598447.js";import"./typeof-7fd5df1e.js";import"./InputAdornment-ef3b3dee.js";import"./Select-1112e714.js";const be=()=>{const[m,y]=r.useState([]),[D,Yt]=r.useState(!0),[K,o]=r.useState(!1),[_,Zt]=r.useState(!1),[Q,Y]=r.useState([]),[Z,Wt]=r.useState(null),[h,C]=r.useState(null),[W,g]=r.useState(!1),[E,X]=r.useState(),[N,tt]=r.useState([]),[et,at]=r.useState([]),[S,F]=r.useState(1),[w,lt]=r.useState(10),[st,I]=r.useState(),[ct,p]=r.useState(),[it,rt]=r.useState(!1),[ot,dt]=r.useState(),{api_postSubjectGroupData:mt,api_deleteSubjectGroupData:nt,api_searchSubjectGroupData:ut,api_getactiveClassData:ht,api_editSubjectGroupData:ft,api_section_group_map:xt,api_getSubjectGroupData:jt}=Tt();At(),Ht("Class Master");const n=[{id:1,fee_head:10,fee_head_type:10,desc:"hello"},{id:2,fee_head:10,fee_head_type:10,desc:"hello"},{id:3,fee_head:10,fee_head_type:10,desc:"hello"},{id:4,fee_head:10,fee_head_type:10,desc:"hello"},{id:5,fee_head:10,fee_head_type:10,desc:"hello"}],c=Gt({initialValues:{classId:"",sectionData:[],subject:[{subjectName:""}]},onSubmit:(e,l)=>{console.log("at submit ",e,et);let s=[];e.sectionData.map(i=>e.subject.map(d=>s.push({...d,...i,classId:c.values.classId})));const a=s.map(i=>({subjectName:i.subjectName,section:i.section_name,sectionId:i.id,classId:parseInt(i.classId)}));console.log(a,s),St(a),c.resetForm()}});console.log(c.values.classId,c.values.sectionData);const bt=m;console.log(m);const vt=e=>{lt(parseInt(e))},gt=e=>{F(e-1)},Nt=e=>{F(e+1)};r.useEffect(()=>{u()},[S]),r.useEffect(()=>{u()},[w]);const St=e=>{console.log(e),o(!0);let l,s,a={subjectGroupMap:e};h!==null?(l=ft,s=a,s.id=h):(e==null?void 0:e.bankName)!==""&&h==null&&(l=mt,s=a),j.post(l,s,b()).then(function(i){var d,f,x;console.log("bank master..",(d=i==null?void 0:i.data)==null?void 0:d.data),((f=i==null?void 0:i.data)==null?void 0:f.status)===!0?(v.success(h!==null?"Data Updated Successfully!":"Data Added Successfully"),u(),C(null)):v.error(`${(x=i==null?void 0:i.data)==null?void 0:x.message}`),o(!1)}).catch(function(i){console.log("==2 error list...",i),v.warning("Error occured in submitting form."),o(!1)})},wt=e=>{let l=[];for(let s=0;s<e.length;s++)l.push({section_name:e[s].section_name,sectionName:e[s].sectionName});at(l)};r.useState(()=>{wt([c.values.sectionData])},[c.values.sectionData]);const yt=[{Header:"Sl No.",Cell:({cell:e})=>t.jsx("span",{children:z(e.row.index+1)})},{Header:"Class",accessor:"class_name"},{Header:"Section",accessor:"section_name"},{Header:"Subject",accessor:"subject_name"},{Header:"Status",Cell:({cell:e})=>{var l,s;return t.jsx("span",{className:((l=e.row.original)==null?void 0:l.status)==="Active"?"text-[green]":"text-[red]",children:z((s=e.row.original)==null?void 0:s.status)})}},{Header:"Created Date",accessor:"date"},{Header:"Created Time",accessor:"time"},{Header:"Action",Cell:({cell:e})=>{var l,s;return t.jsx("div",{className:"flex",children:t.jsx("button",{onClick:()=>{var a,i;C((a=e.row.original)==null?void 0:a.id),X(((i=e.row.original)==null?void 0:i.status)==="Active"?"deactive":"active"),g(!0)},className:`${((l=e.row.original)==null?void 0:l.status)=="Active"?"deactivate-button-master":"deactivate-second-button-master"}`,children:((s=e.row.original)==null?void 0:s.status)==="Active"?"Deactivate":"Activate"})})}}],Dt=()=>{o(!0),g(!1);let e={id:h,status:E};j.post(nt,e,b()).then(function(l){var s,a;((s=l==null?void 0:l.data)==null?void 0:s.status)===!0?u():activateBottomErrorCard(!0,`${(a=l==null?void 0:l.data)==null?void 0:a.message}`),o(!1)}).catch(function(l){activateBottomErrorCard(!0,"Error occured in deletion.1"),o(!1)})},u=(e=null)=>{console.log(e);let l,s;e===null?(s={perPage:w,page:S},l=jt):(s={search:e},l=ut),o(!0),j.post(l,s,b()).then(function(a){var i,d,f,x,A,B,L,P,T,k,M,H,$,V,q,G,R,O,U,J;((i=a==null?void 0:a.data)==null?void 0:i.status)===!0?((f=(d=a==null?void 0:a.data)==null?void 0:d.data)==null?void 0:f.total)===0||((A=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:A.data.length)===0?(v.error("Data not Found"),y((L=(B=a==null?void 0:a.data)==null?void 0:B.data)==null?void 0:L.data),I((T=(P=a==null?void 0:a.data)==null?void 0:P.data)==null?void 0:T.last_page),p((M=(k=a==null?void 0:a.data)==null?void 0:k.data)==null?void 0:M.total)):(console.log("class section map data",($=(H=a==null?void 0:a.data)==null?void 0:H.data)==null?void 0:$.data),y((q=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:q.data),I((R=(G=a==null?void 0:a.data)==null?void 0:G.data)==null?void 0:R.last_page),p((U=(O=a==null?void 0:a.data)==null?void 0:O.data)==null?void 0:U.total)):v.error(`${(J=a==null?void 0:a.data)==null?void 0:J.message}`),o(!1)}).catch(function(a){activateBottomErrorCard(!0,"Error occured while fetching data.2"),o(!1)})},_t=()=>{o(!0),j.post(ht,{},b()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),tt(e==null?void 0:e.data.data)):activateBottomErrorCard(!0,"Error occured while fetching data.3"),o(!1)}).catch(function(e){console.log("==2 error list...",e),activateBottomErrorCard(!0,"Error occured while fetching data.4"),o(!1)})},Ct=e=>{o(!0),j.post(xt,{classId:e},b()).then(function(l){var s,a,i;((s=l==null?void 0:l.data)==null?void 0:s.status)===!0?(console.log(l==null?void 0:l.data),c.setFieldValue("sectionData",(i=(a=l==null?void 0:l.data)==null?void 0:a.data)==null?void 0:i.map(d=>({...d,sectionName:!0})))):activateBottomErrorCard(!0,"Error occured while fetching data.5"),o(!1)}).catch(function(l){console.log("==2 error list...",l),activateBottomErrorCard(!0,"Error occured while fetching data.6"),o(!1)})};r.useEffect(()=>{c.values.classId!=""&&Ct(parseInt(c.values.classId))},[c.values.classId]),r.useEffect(()=>{u(),_t()},[]);const Et=e=>{e.target.name},Ft=(e,l)=>{let s=e.target.name,a=e.target.value;s==`subject.${l}.subjectName`&&c.setFieldValue(`subject.${l}.subjectName`,Mt(a,c.values.subject[l].subjectName,50))};r.useEffect(()=>{const e=m.map(l=>{const{id:s,...a}=l;return a});console.log(e),Y(e)},[m]);const It=[{title:"Class",feild:"class_name"},{title:"Section",feild:"section_name"},{title:"Subject",feild:"subject_name"},{title:"Created Date  ",feild:"date"},{title:"Created Time ",feild:"time"},{title:"Status",feild:"status"}],pt=()=>{const e=new Jt;e.text("Subject Map Details",10,10),e.autoTable({theme:"grid",columns:It.map(l=>({...l,dataKey:l.feild})),body:m}),e.save("SubjectMap.pdf")};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full h-[76vh] lg:h-auto overflow-auto ",children:[t.jsxs("div",{className:"flex items-start justify-start flex-col mt-5 ml-5 ",children:[t.jsx("h1",{className:"text-4xl font-semibold text-gray-700",children:"Subject Master Form"}),t.jsx("h1",{className:"common-header-smalltext",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]}),t.jsx("div",{className:" mt-3 ml-3 mr-3 ",children:t.jsx("div",{className:"flex h-auto  items-start justify-start w-full",children:t.jsxs("div",{className:"grid grid-cols-12 w-full  ml-3 mr-3",children:[t.jsx("div",{className:"col-span-12 lg:col-span-5 w-full flex justify-center",children:t.jsxs("div",{className:"mt-5 border border-teal-300 w-full  rounded-md relative",children:[t.jsxs("div",{className:"bg-white px-3 ",children:[" ",t.jsx("h1",{className:" absolute text-2xl bg-white flex font-semibold  -mt-4 text-[#0F766E] ml-9",children:"Add"})]}),t.jsxs("div",{className:"w-full mb-6 mt-[4vh] pb-10  ",children:[t.jsx(Rt,{value:c,children:t.jsxs(Ot,{onSubmit:c.handleSubmit,onChange:Et,children:[t.jsxs("div",{className:"grid grid-cols-12",children:[t.jsx("div",{className:" col-span-12 lg:col-span-3",children:t.jsxs("label",{className:"  text-teal-900 text-sm w-[10vw]   font-semibold",htmlFor:"",children:["Class Name",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})}),t.jsxs("div",{className:"col-span-12 lg:col-span-9",children:[t.jsxs("select",{...c.getFieldProps("classId"),className:"common-input-css",type:"text",placeholder:"Enter class",children:[t.jsx("option",{value:"",children:"Select"}),N==null?void 0:N.map((e,l)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.class_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:c.touched.classId&&c.errors.classId?c.errors.classId:null})]})]}),c.values.sectionData.length>0&&t.jsx("div",{className:"col-span-12 mt-4",children:t.jsx("div",{className:"overflow-x-auto pt-4 ",children:t.jsx("div",{className:"w-[95%] ml-5 flex items-center  justify-center border border-teal-300 ",children:t.jsxs("div",{className:"w-full   relative",children:[t.jsxs("div",{className:"absolute",children:[" ",t.jsxs("h1",{className:" bg-white text-teal-900 text-sm font-semibold items-start justify-start px-2 mt-[-10px] ml-7 ",children:[" ","Section"," ",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]}),t.jsx("div",{className:"w-full h-[10vh] flex items-center justify-start",children:c.values.sectionData&&c.values.sectionData.map((e,l)=>t.jsxs("div",{className:"mx-10",children:[t.jsx("input",{name:"sectionName",value:e==null?void 0:e.section_name,checked:c.values.sectionData[l].sectionName===!0,onChange:()=>c.setFieldValue(`sectionData.${l}.sectionName`,!(e!=null&&e.sectionName)),type:"checkbox",className:"text-slat-500  ml-[10px]  text-teal-900 w-5 h-5 font-bold mt-2   "})," ",t.jsx("span",{className:"ml-2 -mt-6",children:e.section_name})]}))})]})})})}),c.values.sectionData.length>0?t.jsx(t.Fragment,{children:t.jsx("div",{className:"w-[95%] ml-5 flex items-center mt-8 justify-center border border-teal-300  h-[34vh] overflow-auto",children:t.jsx("div",{className:"w-full  relative",children:t.jsxs("div",{className:"h-[32vh] overflow-auto",children:[" ",t.jsx("div",{className:"w-full ",children:t.jsx(Ut,{name:"subject",children:e=>t.jsx(t.Fragment,{children:(c==null?void 0:c.values.subject.length)>0&&(c==null?void 0:c.values.subject.map((l,s)=>t.jsx(Bt.Fragment,{children:t.jsx("div",{className:"w-full h-auto overflow-auto flex items-center justify-center",children:t.jsxs("div",{className:"flex mt-[4vh] max-[700px]:block",children:[t.jsx(Qt,{formik:c,label:"Subject Name",name:`subject.${s}.subjectName`,isDynamic:!0,placeholder:"Enter subject name",onChange:a=>Ft(a,s)}),t.jsxs("div",{className:" px-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add & Remove Subject"}),s>0&&t.jsx("button",{className:"mt-1",type:"button",onClick:()=>e.remove(s),children:t.jsx(Lt,{className:"inline-block w-9 h-9 text-red-600"})}),"|",t.jsx("button",{type:"button",className:"mt-1",onClick:()=>{if(l.subjectName==="")return activateBottomErrorCard(!0,"fill the subject name");e.push({subjectName:""})},children:t.jsx(Pt,{className:"inline-block w-9 h-9 text-blue-600"})})]})]})})},s)))})})})]})})})}):null,t.jsx("div",{className:"mt-3",children:t.jsx("button",{type:"submit",className:"save-button",children:"Save"})})]})}),t.jsx("div",{className:"mandatorytext",children:t.jsxs("h1",{children:["Note : (*) is a mandatory field, Section Name must be character (A-Z,a-z)"," "]})})]})]})}),t.jsx("div",{className:" col-span-12 lg:col-span-7 w-full lg:ml-2 ",children:t.jsxs("div",{className:"mt-5 border border-teal-300   rounded-md relative",children:[t.jsxs("div",{className:"bg-white px-3 ",children:[" ",t.jsx("h1",{className:" absolute text-2xl bg-white flex font-semibold  -mt-4 text-gray-500 ml-9",children:"View List"})]}),t.jsx("div",{className:"mt-5  ",children:t.jsx(Kt,{generatePdf:pt,enable:it,setenable:rt,csvdata:Q,readymadeListData:m,fetchMasterList:u,setSearchTableData:dt,searchTableData:ot})}),t.jsx("div",{className:"-mt-5 main-div",children:t.jsxs("div",{className:" rounded-md h-[80vh] 2xl:p-6 p-4 overflow-y-auto",children:[K&&t.jsx(kt,{}),_&&t.jsx(qt,{activateBottomErrorCard,errorTitle:Z}),_&&t.jsxs("div",{className:"alert-msg",role:"alert",children:[t.jsx("strong",{className:"sorry-msg",children:"Sorry! "}),t.jsx("span",{className:"some-error-msg",children:"Some error occured while fetching list. Please try again later"}),t.jsx("span",{className:"absolute-span"})]}),W&&t.jsx($t,{setdeleteStatus:g,deleteItem:Dt,deactivate:E}),t.jsx("div",{className:"h-[55vh] overflow-auto",children:D&&(n==null?void 0:n.length)!=0&&t.jsxs(t.Fragment,{children:[t.jsx(Vt,{filter:!1,exportStatus:!1,assessmentType:!1,columns:yt,dataList:bt,pageNumber:ct}),t.jsx(zt,{ChangePage:vt,number:S,lastPage:st,nextPage:Nt,prevPage:gt,postperpage:w})]})}),D&&(n==null?void 0:n.length)==0&&t.jsx("div",{className:"data-not-found",children:"Data Not Found"})]})})]})})]})})})]})})};export{be as default};
