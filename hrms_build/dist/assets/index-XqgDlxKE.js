import{h as e,f as a,r as s,j as t,z as i,B as l,e as d}from"./index-pyCvve81.js";import{a as r,P as n}from"./index-BN0jNiUj.js";import{h as o}from"./moment-CBOc1lqT.js";import{C as c,a as m,c as u}from"./card-bx3Oa7DD.js";import{u as h,b as x}from"./useCustomQuery-B1PLu8pZ.js";import{P as p}from"./index-By2ZT1Is.js";import{S as j}from"./Spinner-BDgO_yrk.js";import{S as y,a as v,b as g,c as f,e as b,f as N,d as w}from"./select-BIraycn9.js";import{a as S,o as H,c as _,b as k,f as Y}from"./yup-C9jKbjb2.js";import{F as D,C}from"./datetime-picker-CYDyb3rk.js";import{R as M}from"./RHFTextField-oGT6ZvhB.js";import{R as $}from"./RHFTextArea-DiyrAPVA.js";import{B as E}from"./ButtonLoading-C9GHL4iQ.js";import{R as O}from"./RHFSelectField-C9SERau7.js";import"./input-DWARB5Y9.js";import"./switch-Br0yiZF5.js";import"./checkbox-BD1KnAu3.js";import"./label-D5MVRa8l.js";import{S as T}from"./separator-DS4WD8aU.js";import{D as A}from"./index-CDBXPzA7.js";import{C as F}from"./index-CYJ8F6FM.js";import{C as R}from"./calendar-DxovkaVF.js";import{P as B}from"./plus-DDy7-FbJ.js";import{C as L}from"./chevron-right-CT2wJ-fK.js";import{S as P}from"./square-pen-CY_TiJqr.js";import{L as q}from"./loader-circle-DXaVvWTg.js";import{T as z}from"./trash-2-BXm2aACA.js";import"./check-BHEPqzdD.js";import"./format-BkNqQ0tt.js";import"./clock-DqQh3QaC.js";const I=_().shape({type:k().required().label("Type"),holiday_name:k().required().label("Holiday Name"),description:k().required().label("Description"),date:k().required().label("Date"),days:Y().optional().positive().label("Days"),department_id:k().required().label("Department")});function V({open:l,setOpen:d,title:n,id:o,edit:c,setEdit:m,refetch:u}){var p,j,y;const v=r(),g=h({}),{data:f,isFetching:b}=x({api:`${null==(p=e)?void 0:p.getHolidayById}?id=${a(String(o))}`,key:"getHolidayById",options:{enabled:c}}),N=S({defaultValues:{type:"",holiday_name:"",description:"",date:"",days:1,department_id:""},resolver:H(I)});s.useEffect(()=>{var e,a,s,t,i,l;c&&f?N.reset({type:String(null==(e=null==f?void 0:f.data)?void 0:e.type),holiday_name:null==(a=null==f?void 0:f.data)?void 0:a.holiday_name,description:null==(s=null==f?void 0:f.data)?void 0:s.description,date:null==(t=null==f?void 0:f.data)?void 0:t.date,days:null==(i=null==f?void 0:f.data)?void 0:i.days,department_id:String(null==(l=null==f?void 0:f.data)?void 0:l.department_id)}):N.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})},[c,f]);return t.jsx(A,{open:l,setOpen:d,title:n,setEdit:m,edit:c,isLoading:b,children:t.jsx(D,{methods:N,onSubmit:N.handleSubmit(async a=>{var s,t,l,r,n,h,x,p;try{if(c&&a){const d=await g.mutateAsync({api:`${null==(s=e)?void 0:s.updateHolidayById}`,data:{id:o,...a}});(null==(t=d.data)?void 0:t.success)?i.success(null==(l=null==d?void 0:d.data)?void 0:l.message):i.error((null==(r=d.data)?void 0:r.message)||"Holiday not updated successfully")}else{const s=await g.mutateAsync({api:null==(n=e)?void 0:n.createHoliday,data:a});(null==(h=s.data)?void 0:h.success)?i.success(null==(x=null==s?void 0:s.data)?void 0:x.message):i.error((null==(p=s.data)?void 0:p.message)||"Holiday not created successfully"),N.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})}d(!1),m(!1),u()}catch(j){}}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[t.jsx("div",{children:t.jsx(O,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(null==(y=null==(j=null==v?void 0:v.data)?void 0:j.data)?void 0:y.length)?v.data.data.map(e=>({label:String(e.department_name),value:String(e.id)})):[]})}),t.jsx("div",{children:t.jsx(O,{name:"type",data:[{value:"Restricted",label:"Restricted"},{value:"Gazetted",label:"Gazetted"},{value:"Optional",label:"Optional"}]})}),t.jsx("div",{children:t.jsx(M,{name:"holiday_name",placeholder:"Enter Holiday Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),t.jsx("div",{children:t.jsx($,{name:"description",placeholder:"Enter Description"})}),t.jsx("div",{children:t.jsx(M,{name:"date",type:"date",placeholder:"Select Date"})}),!c&&t.jsx("div",{children:t.jsx(M,{name:"days",type:"number",placeholder:"Enter Number of Days"})}),t.jsx(T,{}),t.jsx("div",{children:t.jsx(E,{isLoading:N.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function W(){var n,S,H,_,k,Y;const D=h({}),M=r(),[$,E]=s.useState(1),[O,T]=s.useState(10),[A,I]=s.useState(""),[W,G]=s.useState(!1),[Q,U]=s.useState(""),[X,Z]=s.useState(!1),[J,K]=s.useState(null),[ee,ae]=s.useState(o()),[se,te]=s.useState(""),ie=se?`department_id=${a(se)}`:"",le=x({api:`${e.getAllHolidays}?page=${$}&limit=${O}&q=${A}&${ie}`,key:"getAllHolidayList",value:[$,O,se],options:{enabled:!0}}),de=(()=>{const e=ee.clone().startOf("month"),a=ee.clone().endOf("month"),s=e.clone().startOf("week"),t=a.clone().endOf("week"),i=[];let l=s.clone();for(;l.isSameOrBefore(t);)i.push(l.clone()),l.add(1,"day");return i})();return t.jsxs("main",{className:"grid items-start",children:[t.jsx(V,{open:W,setOpen:G,title:X?"Edit Holiday":"Add Holiday",id:Q,edit:X,setEdit:Z,refetch:le.refetch}),t.jsxs("div",{className:"grid auto-rows-max items-start gap-6 md:gap-6 lg:col-span-2",children:[t.jsxs("div",{className:"flex flex-col gap-4 rounded-lg bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-600 p-6 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"rounded-full bg-white/20 p-3 backdrop-blur-sm",children:t.jsx(R,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Holiday Calendar"}),t.jsxs("p",{className:"text-sm text-blue-100",children:[(null==(S=null==(n=null==le?void 0:le.data)?void 0:n.pagination)?void 0:S.total)||0," holidays scheduled"]})]})]}),t.jsxs(l,{onClick:()=>G(!0),className:"bg-white text-blue-600 hover:bg-blue-50",children:[t.jsx(B,{className:"mr-2 h-4 w-4"}),"Add Holiday"]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{children:t.jsxs(y,{onValueChange:e=>te(e),value:se,children:[t.jsx(v,{className:"w-[180px]",children:t.jsx(g,{placeholder:"Select Department"})}),t.jsx(f,{children:t.jsxs(b,{children:[t.jsx(N,{children:"Select Department"}),(null==(_=null==(H=null==M?void 0:M.data)?void 0:H.data)?void 0:_.length)?M.data.data.map(e=>t.jsx(w,{value:String(e.id),children:e.department_name},e.id)):null]})})]})}),t.jsx(l,{variant:"outline",onClick:()=>{ae(o())},className:"border-white/30 bg-white/10 text-white hover:bg-white/20",children:"Today"})]})]}),t.jsxs(c,{className:"overflow-hidden shadow-xl",children:[t.jsx(m,{className:"border-b bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(l,{variant:"outline",size:"icon",onClick:()=>{ae(ee.clone().subtract(1,"month"))},className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:t.jsx(C,{className:"h-5 w-5"})}),t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:ee.format("MMMM YYYY")}),t.jsx(l,{variant:"outline",size:"icon",onClick:()=>{ae(ee.clone().add(1,"month"))},className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:t.jsx(L,{className:"h-5 w-5"})})]}),t.jsx("div",{className:"text-sm text-gray-600",children:"Week starts on Sunday"})]})}),t.jsx(u,{className:"p-0",children:le.isLoading?t.jsx("div",{className:"flex h-96 items-center justify-center",children:t.jsx(j,{})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-white",children:[t.jsx("div",{className:"grid grid-cols-7 border-b bg-gray-50",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>t.jsx("div",{className:"border-r p-4 text-center text-sm font-semibold uppercase tracking-wide text-gray-600 last:border-r-0",children:e.slice(0,3)},e))}),t.jsx("div",{className:"grid grid-cols-7",children:de.map((a,s)=>{const l=(r=a,(null==(n=null==le?void 0:le.data)?void 0:n.data)?le.data.data.filter(e=>o(e.date).format("YYYY-MM-DD")===r.format("YYYY-MM-DD")):[]);var r,n;const c=a.month()===ee.month(),m=a.isSame(o(),"day"),u=0===a.day()||6===a.day();return t.jsxs("div",{className:`group relative min-h-32 border-b border-r p-3 transition-all last:border-r-0 ${c?u?"bg-blue-50/30":"bg-white hover:bg-gray-50":"bg-gray-50/50"} ${l.length>0?"bg-gradient-to-br from-blue-50 to-indigo-50":""}`,children:[t.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[t.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full text-sm font-semibold transition-all "+(m?"bg-blue-600 text-white shadow-lg":c?"text-gray-700":"text-gray-400"),children:a.format("D")}),l.length>0&&t.jsx("div",{className:"rounded-full bg-blue-600 px-2 py-0.5 text-xs font-semibold text-white shadow-sm",children:l.length})]}),t.jsx("div",{className:"space-y-1.5",children:l.map(a=>t.jsxs("div",{className:"group/item relative overflow-hidden rounded-lg border border-blue-200 bg-white p-2 shadow-sm transition-all hover:shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"h-2 w-2 rounded-full "+(1==a.status?"bg-green-500":"bg-gray-400")}),t.jsx("h4",{className:"line-clamp-1 text-xs font-semibold text-gray-900",children:a.name})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[t.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:a.type}),a.days>1&&t.jsxs("span",{className:"text-xs text-gray-600",children:[a.days,"d"]})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-1 opacity-0 transition-opacity group-hover/item:opacity-100",children:[t.jsx("button",{onClick:()=>{return e=String(a.id),Z(!0),G(!0),void U(e);var e},className:"flex h-7 w-7 items-center justify-center rounded-md bg-blue-600 text-white shadow-sm transition-all hover:bg-blue-700 hover:shadow-md",title:"Edit Holiday",children:t.jsx(P,{className:"h-3.5 w-3.5"})}),t.jsx("button",{onClick:()=>(async a=>{K(a),F("Are you sure you want to delete this holiday?","Please confirm",async()=>{var s,t,l;try{const d=await D.mutateAsync({api:`${e.deleteHolidayById}`,data:{id:a}});(null==(s=null==d?void 0:d.data)?void 0:s.success)?(le.refetch(),i.success(null==(t=null==d?void 0:d.data)?void 0:t.message)):i.error(null==(l=d.data)?void 0:l.message)}catch(r){i.error(d(r))}finally{K(null)}}),K(null)})(String(a.id)),disabled:J===String(a.id),className:"flex h-7 w-7 items-center justify-center rounded-md bg-red-600 text-white shadow-sm transition-all hover:bg-red-700 hover:shadow-md disabled:opacity-50",title:"Delete Holiday",children:J===String(a.id)?t.jsx(q,{className:"h-3.5 w-3.5 animate-spin"}):t.jsx(z,{className:"h-3.5 w-3.5"})})]})]}),a.name&&t.jsx("div",{className:"line-clamp-2 text-xs font-semibold text-gray-600",children:a.name}),a.description&&t.jsx("div",{className:"mt-1 line-clamp-2 text-xs text-gray-600",children:a.description})]},a.id))})]},s)})})]}),t.jsx("div",{className:"border-t bg-gray-50 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Showing holidays for ",ee.format("MMMM YYYY")]}),t.jsx(p,{page:$,limit:O,totalPages:null==(Y=null==(k=null==le?void 0:le.data)?void 0:k.pagination)?void 0:Y.totalPages,setPage:E,setLimit:T})]})})]})})]})]})]})}function G(){return t.jsx(n,{title:"Holiday List",subTitle:"Manage all the Holidays",children:t.jsx(W,{})})}export{G as default};
