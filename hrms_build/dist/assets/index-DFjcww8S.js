import{h as e,f as i,r as s,j as a,z as t,B as l,e as r}from"./index-pyCvve81.js";import{P as c}from"./index-BN0jNiUj.js";import{h as n}from"./moment-CBOc1lqT.js";import{C as d,a as o,b as m,c as u}from"./card-bx3Oa7DD.js";import{T as f,a as j,b as v,c as p,d as h,e as x}from"./table-vFocFjjc.js";import{u as g,b as y}from"./useCustomQuery-B1PLu8pZ.js";import{P as C}from"./index-By2ZT1Is.js";import{S as _}from"./separator-DS4WD8aU.js";import{S as A}from"./index-cYG0LkNy.js";import{S as N}from"./Spinner-BDgO_yrk.js";import{a as R,o as S,c as b,b as H,f as E}from"./yup-C9jKbjb2.js";import{F as Y}from"./datetime-picker-CYDyb3rk.js";import{R as k}from"./RHFTextField-oGT6ZvhB.js";import{B as w}from"./ButtonLoading-C9GHL4iQ.js";import"./select-BIraycn9.js";import"./input-DWARB5Y9.js";import"./switch-Br0yiZF5.js";import"./checkbox-BD1KnAu3.js";import"./label-D5MVRa8l.js";import{R as F}from"./DateAndTimePicker-CD_49ExZ.js";import{D as q}from"./index-CDBXPzA7.js";import"./calendar-DxovkaVF.js";import"./format-BkNqQ0tt.js";import"./chevron-right-CT2wJ-fK.js";import"./clock-DqQh3QaC.js";import"./check-BHEPqzdD.js";const D=b().shape({city_classification:H().required("City Classification is required"),city_name:H().required("City Name is required"),hra_percentage:E().required("HRA Percentage is required").min(0).max(100),effective_from:H().required("Effective From date is required")});function P({open:l,setOpen:r,title:c,id:n,edit:d,setEdit:o,refetch:m}){var u;const f=g({}),{data:j,isFetching:v}=y({api:`${null==(u=e)?void 0:u.getHRACityById}?id=${i(String(n))}`,key:"getHRACityById",options:{enabled:d&&!!n}}),p=R({defaultValues:{city_classification:"",city_name:"",hra_percentage:0,effective_from:""},resolver:S(D)});return s.useEffect(()=>{var e,i,s,a;d&&j?p.reset({city_classification:(null==(e=null==j?void 0:j.data)?void 0:e.city_classification)||"",city_name:(null==(i=null==j?void 0:j.data)?void 0:i.city_name)||"",hra_percentage:Number(null==(s=null==j?void 0:j.data)?void 0:s.hra_percentage)||0,effective_from:(null==(a=null==j?void 0:j.data)?void 0:a.effective_from)||""}):p.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})},[d,j]),a.jsx(q,{open:l,setOpen:r,title:c,setEdit:o,edit:d,isLoading:v,children:a.jsx(Y,{methods:p,onSubmit:p.handleSubmit(async i=>{var s,a,l,c,u,j,v,h;try{if(d&&n){const r=await f.mutateAsync({api:null==(s=e)?void 0:s.updateHRACity,data:{id:Number(n),...i}});(null==(a=r.data)?void 0:a.success)?t.success((null==(l=null==r?void 0:r.data)?void 0:l.message)||"HRA Classification updated successfully"):t.error((null==(c=r.data)?void 0:c.message)||"HRA Classification not updated successfully")}else{const s=await f.mutateAsync({api:null==(u=e)?void 0:u.createHRACity,data:i});(null==(j=s.data)?void 0:j.success)?t.success((null==(v=null==s?void 0:s.data)?void 0:v.message)||"HRA Classification created successfully"):t.error((null==(h=s.data)?void 0:h.message)||"HRA Classification not created successfully"),p.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})}r(!1),o(!1),m()}catch(x){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(k,{name:"city_classification",placeholder:"Enter City Classification (X, Y, Z)",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(k,{name:"city_name",placeholder:"Enter City Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(k,{name:"hra_percentage",placeholder:"Enter HRA Percentage",type:"number"})}),a.jsx("div",{children:a.jsx(F,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),a.jsx(_,{}),a.jsx("div",{children:a.jsx(w,{isLoading:p.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function M(){var i,c,R,S,b,H;const E=g({}),[Y,k]=s.useState(1),[w,F]=s.useState(10),[q,D]=s.useState(""),[M,L]=s.useState(!1),[$,T]=s.useState(""),[B,V]=s.useState(!1),O=y({api:`${e.getAllHRACities}?page=${Y}&limit=${w}&q=${q}`,key:"getAllHRACities",value:[Y,w,q],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(P,{open:M,setOpen:L,title:B?"Edit HRA Classification":"Add HRA Classification",id:$,edit:B,setEdit:V,refetch:O.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(A,{search:q,setSearch:D,refetch:O.refetch,isFetching:null==O?void 0:O.isLoading})}),a.jsx("div",{children:a.jsx(l,{className:"flex items-center gap-2",onClick:()=>L(!0),children:"Add New"})})]}),a.jsxs(d,{children:[a.jsx(o,{className:"px-7",children:a.jsxs(m,{children:["HRA Classification List (",(null==(c=null==(i=null==O?void 0:O.data)?void 0:i.pagination)?void 0:c.total)||0,")"]})}),a.jsx(u,{children:O.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(N,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(f,{children:[a.jsx(j,{children:a.jsxs(v,{children:[a.jsx(p,{className:"",children:"#"}),a.jsx(p,{className:"",children:"City Classification"}),a.jsx(p,{className:"",children:"City Name"}),a.jsx(p,{className:"",children:"HRA %"}),a.jsx(p,{className:"",children:"Effective From"}),a.jsx(p,{className:"",children:"Effective To"}),a.jsx(p,{className:"",children:"Created At"}),a.jsx(p,{children:"Action"})]})}),a.jsx(h,{children:null==(S=null==(R=null==O?void 0:O.data)?void 0:R.data)?void 0:S.map((i,s)=>a.jsxs(v,{children:[a.jsx(x,{children:(Y-1)*w+s+1}),a.jsx(x,{children:null==i?void 0:i.city_classification}),a.jsx(x,{children:null==i?void 0:i.city_name}),a.jsxs(x,{children:[null==i?void 0:i.hra_percentage,"%"]}),a.jsx(x,{children:n(null==i?void 0:i.effective_from).format("DD-MM-YYYY")}),a.jsx(x,{children:(null==i?void 0:i.effective_to)?n(null==i?void 0:i.effective_to).format("DD-MM-YYYY"):"N/A"}),a.jsx(x,{children:n(null==i?void 0:i.created_at).format("DD-MM-YYYY")}),a.jsx(x,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(l,{className:"bg-primary",onClick:()=>{return e=String(null==i?void 0:i.id),V(!0),L(!0),void T(e);var e},children:"Edit"}),a.jsx(l,{variant:"destructive",onClick:()=>(async i=>{var s,a,l,c;try{const r=await E.mutateAsync({api:null==(s=e)?void 0:s.deleteHRACity,data:{id:Number(i)}});(null==(a=null==r?void 0:r.data)?void 0:a.success)?(O.refetch(),t.success((null==(l=null==r?void 0:r.data)?void 0:l.message)||"HRA Classification deleted successfully")):t.error((null==(c=r.data)?void 0:c.message)||"Failed to delete HRA Classification")}catch(n){t.error(r(n))}})(String(null==i?void 0:i.id)),children:"Delete"})]})})]},null==i?void 0:i.id))})]}),a.jsx(_,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(C,{page:Y,limit:w,totalPages:(null==(H=null==(b=null==O?void 0:O.data)?void 0:b.pagination)?void 0:H.totalPages)||1,setPage:k,setLimit:F})})]})})]})]})]})}function L(){return a.jsx(c,{title:"HRA Classification",subTitle:"Manage HRA City Classifications",children:a.jsx("div",{className:"py-12",children:a.jsx(M,{})})})}export{L as default};
