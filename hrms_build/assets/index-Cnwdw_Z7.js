import{i as F,r as T,j as e,h as E,_ as N}from"./index-DKX_p4W9.js";import{b as I,P as X}from"./index-CssRLD9V.js";import{a as z,o as L,h as R,C as V,c as v,d as _,i as W,b as C}from"./yup-Bq90E6cX.js";import{u as Y}from"./useCustomQuery-umJkPyD_.js";import{C as B}from"./calendar-DKCNnPFB.js";import{P as G}from"./plus-CqeltYtK.js";import{T as H}from"./trash-2-BH1rokkW.js";import{C as J}from"./check-Cq090eBu.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=F("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),S=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Q=v().shape({department_id:_().transform((n,x)=>x===""?void 0:n).required("Department is required").positive("Please select a valid department").integer("Please select a valid department"),weekly_offs:W().of(v().shape({day:C().required("Day is required").oneOf(S,"Invalid day selected"),weeks:W().of(_()).min(1,"Select at least one week").required("Weeks are required")})).min(1,"At least one weekly off is required").required(),description:C().optional()});function U(){var y;const[n,x]=T.useState(5),f=I(),o=Y({}),{register:h,control:p,handleSubmit:A,formState:{errors:r}}=z({resolver:L(Q),defaultValues:{department_id:void 0,weekly_offs:[{day:"Saturday",weeks:[]}],description:""}}),{fields:b,append:O,remove:P}=R({control:p,name:"weekly_offs"}),D=async s=>{var t;try{const a={department_id:s.department_id,weekly_offs:s.weekly_offs,description:s.description||""};(t=(await o.mutateAsync({api:E.createWeekOff,data:a})).data)!=null&&t.success&&N.success("Weekly off created successfully!")}catch{N.error("Failed to create weekly off. Please try again.")}},q=(s,t,a)=>a.includes(t)?a.filter(d=>d!==t):[...a,t].sort((d,m)=>d-m),M=s=>{s.preventDefault(),A(D)(s)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:e.jsxs("div",{className:"overflow-hidden rounded-2xl bg-white shadow-xl",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-8 text-white",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx(B,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Weekly Off Manager"})]}),e.jsx("p",{className:"text-blue-100",children:"Configure department weekly holidays"})]}),e.jsxs("div",{className:"space-y-8 p-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Number of Weeks in Month ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex gap-2",children:[4,5,6].map(s=>e.jsxs("button",{type:"button",onClick:()=>x(s),className:`rounded-lg px-6 py-3 font-medium transition-all ${n===s?"scale-105 bg-blue-600 text-white shadow-md":"border-2 border-gray-200 bg-white text-gray-700 hover:border-blue-400"}`,children:[s," Weeks"]},s))}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Select the maximum number of weeks in a month"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...h("department_id"),className:"w-full rounded-xl border-2 border-gray-200 bg-white px-4 py-3 outline-none transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-100",children:[e.jsx("option",{value:"",children:"Select Department"}),(y=f==null?void 0:f.data)==null?void 0:y.data.map(s=>e.jsx("option",{value:s.id,children:s.department_name},s.id))]}),r.department_id&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.department_id.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["Weekly Offs Configuration"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("button",{type:"button",onClick:()=>O({day:"Monday",weeks:[]}),className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white shadow-md transition-colors hover:bg-blue-700 hover:shadow-lg",children:[e.jsx(G,{className:"h-4 w-4"}),"Add Day"]})]}),e.jsx("div",{className:"space-y-4",children:b.map((s,t)=>{var a,c,d,m,g,j,k,w;return e.jsx("div",{className:"rounded-xl border-2 border-gray-200 bg-gray-50 p-6 transition-all hover:border-blue-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-600",children:["Day ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{...h(`weekly_offs.${t}.day`),className:"w-full rounded-lg border-2 border-gray-200 bg-white px-4 py-2 outline-none transition-all focus:border-blue-500 focus:ring-2 focus:ring-blue-100",children:S.map(l=>e.jsx("option",{value:l,children:l},l))}),((c=(a=r.weekly_offs)==null?void 0:a[t])==null?void 0:c.day)&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:(m=(d=r.weekly_offs[t])==null?void 0:d.day)==null?void 0:m.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-xs font-medium text-gray-600",children:["Select Weeks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(V,{name:`weekly_offs.${t}.weeks`,control:p,render:({field:{value:l,onChange:$}})=>e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:n},(i,u)=>u+1).map(i=>{const u=l==null?void 0:l.includes(i);return e.jsxs("button",{type:"button",onClick:()=>$(q(t,i,l||[])),className:`rounded-lg px-4 py-2 font-medium transition-all ${u?"scale-105 bg-blue-600 text-white shadow-md":"border-2 border-gray-200 bg-white text-gray-700 hover:border-blue-400"}`,children:["Week ",i]},i)})})}),((j=(g=r.weekly_offs)==null?void 0:g[t])==null?void 0:j.weeks)&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:(w=(k=r.weekly_offs[t])==null?void 0:k.weeks)==null?void 0:w.message})]})]}),b.length>1&&e.jsx("button",{type:"button",onClick:()=>P(t),className:"rounded-lg p-2 text-red-600 transition-colors hover:bg-red-50",children:e.jsx(H,{className:"h-5 w-5"})})]})},s.id)})}),r.weekly_offs&&!Array.isArray(r.weekly_offs)&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.weekly_offs.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Description"," ",e.jsx("span",{className:"text-xs text-gray-400",children:"(Optional)"})]}),e.jsx("textarea",{...h("description"),rows:3,className:"w-full resize-none rounded-xl border-2 border-gray-200 px-4 py-3 outline-none transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-100",placeholder:"E.g., 2nd & 4th Saturday off, All Sundays off"}),r.description&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.description.message})]}),o.isSuccess&&e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border-2 border-green-200 bg-green-50 p-4 text-green-800",children:[e.jsx(J,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:"Weekly off created successfully!"})]}),o.isError&&e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border-2 border-red-200 bg-red-50 p-4 text-red-800",children:[e.jsx(K,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:o.error.message})]}),e.jsx("button",{type:"button",onClick:M,disabled:o.isPending,className:"w-full rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 py-4 font-semibold text-white shadow-lg transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-50",children:o.isPending?"Creating...":"Create Weekly Off"})]})]})})}function de(){return e.jsx(X,{title:"Create Weekly Off",subTitle:"Manage all the Weekly Offs here",children:e.jsx(U,{})})}export{de as default};
