import{h as e,f as s,r as i,j as a,z as t,B as l,e as r}from"./index-BJ2Di0BB.js";import{P as n}from"./index-L2kacWh6.js";import{h as d}from"./moment-CBOc1lqT.js";import{C as o,a as c,b as p,c as m}from"./card-CrOEotWM.js";import{S as u,T as j,a as x,b as h,c as v,d as y,e as f}from"./index-BxKGIMG5.js";import{u as g,b as S}from"./useCustomQuery-DkqDqiry.js";import{P as E}from"./index-DZvdNKxy.js";import{S as N}from"./separator-BtSn9EpY.js";import{S as b}from"./Spinner-DjUjMlqR.js";import{a as T,o as w,c as A,b as L}from"./yup-BTlf5Wf5.js";import{F as k}from"./datetime-picker-cKnQNXMD.js";import{R as C}from"./RHFTextField-BK1QXo_s.js";import{R as _}from"./RHFTextArea-CtK9XJcE.js";import{B as F}from"./ButtonLoading-B5GmY3N3.js";import"./select-4D5dQM-6.js";import{D as $}from"./index-ClKtlEeL.js";import{t as B}from"./switch-CPa6oSpC.js";import{L as D}from"./loader-circle--1riX2Rm.js";import"./calendar-B99NsLtP.js";import"./clock-PqgEqIzL.js";import"./check-DiqtQ1XW.js";const P=A().shape({emp_type:L().required("Employee Type is required"),description:L().required("Description is required")});function q({open:l,setOpen:r,title:n,id:d,edit:o,setEdit:c,refetch:p}){var m;const u=g({}),{data:j,isFetching:x}=S({api:`${null==(m=e)?void 0:m.getEmpTypeById}/${s(String(d))}`,key:"getEmpTypeById",options:{enabled:o}}),h=T({defaultValues:{emp_type:"",description:""},resolver:w(P)});return i.useEffect(()=>{var e,s;o&&j?h.reset({emp_type:(null==(e=null==j?void 0:j.data)?void 0:e.emp_type)||"",description:(null==(s=null==j?void 0:j.data)?void 0:s.description)||""}):h.reset({emp_type:"",description:""})},[o,j]),a.jsx($,{open:l,setOpen:r,title:n,setEdit:c,edit:o,isLoading:x,children:a.jsx(k,{methods:h,onSubmit:h.handleSubmit(async i=>{var a,l,n,m,j,x,v,y;try{if(o&&i){const r=await u.mutateAsync({api:`${null==(a=e)?void 0:a.updateEmpType}`,data:{id:s(String(d)),...i}});(null==(l=r.data)?void 0:l.success)?t.success(null==(n=null==r?void 0:r.data)?void 0:n.message):t.error((null==(m=r.data)?void 0:m.message)||"Employee Type not updated successfully")}else{const s=await u.mutateAsync({api:null==(j=e)?void 0:j.createEmpType,data:i});(null==(x=s.data)?void 0:x.success)?t.success(null==(v=null==s?void 0:s.data)?void 0:v.message):t.error((null==(y=s.data)?void 0:y.message)||"Employee Type not created successfully"),h.reset({emp_type:"",description:""})}r(!1),c(!1),p()}catch(f){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(C,{name:"emp_type",placeholder:"Enter Employee Type",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(_,{name:"description",placeholder:"Enter your description",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx(N,{}),a.jsx("div",{children:a.jsx(F,{isLoading:h.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function R(){var n,T,w,A,L,k;const C=g({}),[_,F]=i.useState(1),[$,P]=i.useState(10),[R,M]=i.useState(""),[O,Y]=i.useState(!1),[H,I]=i.useState(""),[V,z]=i.useState(!1),[Q,G]=i.useState(null),J=S({api:`${e.getAllEmpTypes}?page=${_}&limit=${$}&q=${R}`,key:"getAllEmpTypes",value:[_,$],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(q,{open:O,setOpen:Y,title:V?"Edit Employee Type":"Add Employee Type",id:H,edit:V,setEdit:z,refetch:J.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(u,{search:R,setSearch:M,refetch:J.refetch,isFetching:null==J?void 0:J.isLoading})}),a.jsx("div",{children:a.jsx(l,{className:"flex items-center gap-2",onClick:()=>Y(!0),children:"Add New"})})]}),a.jsxs(o,{children:[a.jsx(c,{className:"px-7",children:a.jsxs(p,{children:["Employee Type List (",null==(T=null==(n=null==J?void 0:J.data)?void 0:n.pagination)?void 0:T.total,")"]})}),a.jsx(m,{children:J.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(b,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(j,{children:[a.jsx(x,{children:a.jsxs(h,{children:[a.jsx(v,{className:"",children:"#"}),a.jsx(v,{className:"",children:"Employee Type"}),a.jsx(v,{className:"",children:"Description"}),a.jsx(v,{className:"",children:"Created at"}),a.jsx(v,{className:"",children:"Status"}),a.jsx(v,{children:"Action"})]})}),a.jsx(y,{children:null==(A=null==(w=null==J?void 0:J.data)?void 0:w.data)?void 0:A.map((i,n)=>a.jsxs(h,{children:[a.jsx(f,{children:n+1}),a.jsx(f,{children:null==i?void 0:i.emp_type}),a.jsx(f,{children:null==i?void 0:i.description}),a.jsx(f,{children:d(null==i?void 0:i.created_at).format("DD-MM-YYYY")}),a.jsx(f,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(B,{checked:1==(null==i?void 0:i.status),onChange:()=>(async i=>{var a,l,n,d;G(i);try{const r=await C.mutateAsync({api:`${null==(a=e)?void 0:a.updateEmpTypeStatus}`,data:{id:s(String(i))}});(null==(l=null==r?void 0:r.data)?void 0:l.success)?(J.refetch(),t.success(null==(n=null==r?void 0:r.data)?void 0:n.message)):t.error(null==(d=r.data)?void 0:d.message)}catch(o){t.error(r(o))}finally{G(null)}})(String(null==i?void 0:i.id)),disabled:Q===String(null==i?void 0:i.id),className:((null==i?void 0:i.status)?"bg-primary":"bg-gray-200")+" relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50",children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:((null==i?void 0:i.status)?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white"})]}),Q===String(null==i?void 0:i.id)&&a.jsx(D,{className:"h-4 w-4 animate-spin text-primary"})]})}),a.jsx(f,{children:a.jsx(l,{className:"bg-primary",onClick:()=>{return e=String(null==i?void 0:i.id),z(!0),Y(!0),void I(e);var e},children:"Edit"})})]},null==i?void 0:i.id))})]}),a.jsx(N,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(E,{page:_,limit:$,totalPages:null==(k=null==(L=null==J?void 0:J.data)?void 0:L.pagination)?void 0:k.totalPages,setPage:F,setLimit:P})})]})})]})]})]})}function M(){return a.jsx(n,{title:"Employee Type List",subTitle:"Manage all the Employee types here",children:a.jsx("div",{className:"py-12",children:a.jsx(R,{})})})}export{M as default};
