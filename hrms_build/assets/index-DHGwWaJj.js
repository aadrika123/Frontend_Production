import{h as _,e as V,r as m,j as e,z as p,B as F}from"./index-Df4ChAN-.js";import{P as z}from"./index-DjNjGvXo.js";import{C as L,a as X,b as Z,c as G,h as Y}from"./card-CW8LZ2r1.js";import{S as J,T as K,a as O,b as $,c as l,d as Q,e as o}from"./index-Tosm5l2v.js";import{u as k,b as D}from"./useCustomQuery-BBKf_waA.js";import{g as U}from"./services-KQnp_8oA.js";import{P as W}from"./index-CRGyM8Pm.js";import{S as I,a as ee}from"./Spinner-CyN74T25.js";import{a as ae,o as se,c as ie,b as T,f as ce}from"./yup-pPl0eVQc.js";import{F as te,B as re}from"./datetime-picker-EqBIIAIP.js";import{R as w}from"./RHFTextField-C5PfVKXx.js";import"./select-DZKz6XPY.js";import{R as ne}from"./DateAndTimePicker-YyDdH3It.js";import{D as le}from"./index-D4JNSpYb.js";import"./calendar-CMNTAmai.js";import"./clock-BxgzxCOp.js";import"./check-BzewUJFq.js";const oe=ie().shape({city_classification:T().required("City Classification is required"),city_name:T().required("City Name is required"),hra_percentage:ce().required("HRA Percentage is required").min(0).max(100),effective_from:T().required("Effective From date is required")});function de({open:b,setOpen:d,title:S,id:c,edit:f,setEdit:x,refetch:E}){var j;const R=k({}),{data:i,isFetching:P}=D({api:`${(j=_)==null?void 0:j.getHRACityById}?id=${V(String(c))}`,key:"getHRACityById",options:{enabled:f&&!!c}}),r=ae({defaultValues:{city_classification:"",city_name:"",hra_percentage:0,effective_from:""},resolver:se(oe)}),H=async s=>{var u,h,n,g,y,C,v,A;try{if(f&&c){const a=await R.mutateAsync({api:(u=_)==null?void 0:u.updateHRACity,data:{id:Number(c),...s}});(h=a.data)!=null&&h.success?p.success(((n=a==null?void 0:a.data)==null?void 0:n.message)||"HRA Classification updated successfully"):p.error(((g=a.data)==null?void 0:g.message)||"HRA Classification not updated successfully")}else{const a=await R.mutateAsync({api:(y=_)==null?void 0:y.createHRACity,data:s});(C=a.data)!=null&&C.success?p.success(((v=a==null?void 0:a.data)==null?void 0:v.message)||"HRA Classification created successfully"):p.error(((A=a.data)==null?void 0:A.message)||"HRA Classification not created successfully"),r.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})}d(!1),x(!1),E()}catch(a){console.log(a)}};return m.useEffect(()=>{var s,u,h,n;f&&i?r.reset({city_classification:((s=i==null?void 0:i.data)==null?void 0:s.city_classification)||"",city_name:((u=i==null?void 0:i.data)==null?void 0:u.city_name)||"",hra_percentage:Number((h=i==null?void 0:i.data)==null?void 0:h.hra_percentage)||0,effective_from:((n=i==null?void 0:i.data)==null?void 0:n.effective_from)||""}):r.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})},[f,i]),e.jsx(le,{open:b,setOpen:d,title:S,setEdit:x,edit:f,isLoading:P,children:e.jsx(te,{methods:r,onSubmit:r.handleSubmit(H),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(w,{name:"city_classification",placeholder:"Enter City Classification (X, Y, Z)",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(w,{name:"city_name",placeholder:"Enter City Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(w,{name:"hra_percentage",placeholder:"Enter HRA Percentage",type:"number"})}),e.jsx("div",{children:e.jsx(ne,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),e.jsx(I,{}),e.jsx("div",{children:e.jsx(re,{isLoading:r.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function fe(){var n,g,y,C,v,A;const b=k({}),[d,S]=m.useState(1),[c,f]=m.useState(10),[x,E]=m.useState(""),[R,i]=m.useState(!1),[P,r]=m.useState(""),[H,j]=m.useState(!1),s=D({api:`${_.getAllHRACities}?page=${d}&limit=${c}&q=${x}`,key:"getAllHRACities",value:[d,c,x],options:{enabled:!0}}),u=a=>{j(!0),i(!0),r(a)},h=async a=>{var N,M,q,B;try{const t=await b.mutateAsync({api:(N=_)==null?void 0:N.deleteHRACity,data:{id:Number(a)}});(M=t==null?void 0:t.data)!=null&&M.success?(s.refetch(),p.success(((q=t==null?void 0:t.data)==null?void 0:q.message)||"HRA Classification deleted successfully")):p.error(((B=t.data)==null?void 0:B.message)||"Failed to delete HRA Classification")}catch(t){p.error(U(t))}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(de,{open:R,setOpen:i,title:H?"Edit HRA Classification":"Add HRA Classification",id:P,edit:H,setEdit:j,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(J,{search:x,setSearch:E,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(F,{className:"flex items-center gap-2",onClick:()=>i(!0),children:"Add New"})})]}),e.jsxs(L,{children:[e.jsx(X,{className:"px-7",children:e.jsxs(Z,{children:["HRA Classification List (",((g=(n=s==null?void 0:s.data)==null?void 0:n.pagination)==null?void 0:g.total)||0,")"]})}),e.jsx(G,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ee,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(O,{children:e.jsxs($,{children:[e.jsx(l,{className:"",children:"#"}),e.jsx(l,{className:"",children:"City Classification"}),e.jsx(l,{className:"",children:"City Name"}),e.jsx(l,{className:"",children:"HRA %"}),e.jsx(l,{className:"",children:"Effective From"}),e.jsx(l,{className:"",children:"Effective To"}),e.jsx(l,{className:"",children:"Created At"}),e.jsx(l,{children:"Action"})]})}),e.jsx(Q,{children:(C=(y=s==null?void 0:s.data)==null?void 0:y.data)==null?void 0:C.map((a,N)=>e.jsxs($,{children:[e.jsx(o,{children:(d-1)*c+N+1}),e.jsx(o,{children:a==null?void 0:a.city_classification}),e.jsx(o,{children:a==null?void 0:a.city_name}),e.jsxs(o,{children:[a==null?void 0:a.hra_percentage,"%"]}),e.jsx(o,{children:Y(a==null?void 0:a.effective_from).format("DD-MM-YYYY")}),e.jsx(o,{children:a!=null&&a.effective_to?Y(a==null?void 0:a.effective_to).format("DD-MM-YYYY"):"N/A"}),e.jsx(o,{children:Y(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(o,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{className:"bg-primary",onClick:()=>u(String(a==null?void 0:a.id)),children:"Edit"}),e.jsx(F,{variant:"destructive",onClick:()=>h(String(a==null?void 0:a.id)),children:"Delete"})]})})]},a==null?void 0:a.id))})]}),e.jsx(I,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(W,{page:d,limit:c,totalPages:((A=(v=s==null?void 0:s.data)==null?void 0:v.pagination)==null?void 0:A.totalPages)||1,setPage:S,setLimit:f})})]})})]})]})]})}function Ee(){return e.jsx(z,{title:"HRA Classification",subTitle:"Manage HRA City Classifications",children:e.jsx("div",{className:"py-12",children:e.jsx(fe,{})})})}export{Ee as default};
