import{h as L,e as ae,r as i,j as e,_,B as $}from"./index-BBv-jxBe.js";import{b as se,P as de}from"./index-BSKmHp5D.js";import{S as re,C as O,c as Q,a as ne,e as ce,b as ie,d as oe,h as me}from"./Spinner-C_5aFvoA.js";import{S as xe,T as he,a as pe,b as k,c as g,d as ue,e as x}from"./index-C2C79wUE.js";import{F as fe,a as je,R as q,C as W,L as X,B as ge,S as _e,b as ye,c as be,d as we,f as Ne,g as ve,e as Se}from"./label-NZF332sR.js";import{u as le,b as te}from"./useCustomQuery-DnwWmgzu.js";import{g as Ce}from"./services-KQnp_8oA.js";import{P as Fe}from"./index-BJ8zQrhn.js";import{a as Te,o as Le,c as Pe,b as T,g as Z}from"./yup-BufIYiSe.js";import{R as Ae}from"./RHFTextArea-YunceHYR.js";import"./input-SE5cd0iG.js";import{D as Me,L as Be}from"./index-CuIam2nO.js";import{B as Ee}from"./building-2-BZVV_cz6.js";import{P as Ie}from"./plus-DBHol04b.js";import{C as ee}from"./calendar-CNgLaRc4.js";import{F as $e}from"./file-text-BLCu_wK7.js";import{P as ke}from"./pen-BEfpKUoQ.js";import{T as qe}from"./trash-2-BfTOG4Nm.js";const Re=Pe().shape({leave_type_name:T().required("Leave type name is required"),max_days_per_year:T().required("Max days per year is required").min(1,"Max days must be at least 1"),carry_forward_allowed:Z().required(),max_carry_forward_days:T().when("carry_forward_allowed",{is:!0,then:h=>h.min(0,"Cannot be negative"),otherwise:h=>h.notRequired()}),encashment_allowed:Z().required(),description:T(),department_id:T().required("Department ID is required").min(1,"Department ID must be at least 1")});function Ve({open:h,setOpen:p,title:y,id:P,edit:n,setEdit:A,refetch:w}){var N,v,S;const M=le({}),b=se(),{data:r,isFetching:B}=te({api:`${(N=L)==null?void 0:N.getLeaveTypeById}?id=${ae(String(P))}`,key:"getLeaveTypeById",options:{enabled:n}}),d=Te({defaultValues:{leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""},resolver:Le(Re)}),E=async l=>{var u,s,f,j,o,m,C,F;try{if(n&&l){const t=await M.mutateAsync({api:`${(u=L)==null?void 0:u.updateLeaveTypeById}`,data:{id:P,...l}});(s=t.data)!=null&&s.success?_.success((f=t==null?void 0:t.data)==null?void 0:f.message):_.error(((j=t.data)==null?void 0:j.message)||"Leave type not updated successfully")}else{const t=await M.mutateAsync({api:(o=L)==null?void 0:o.createLeaveType,data:l});(m=t.data)!=null&&m.success?_.success((C=t==null?void 0:t.data)==null?void 0:C.message):_.error(((F=t.data)==null?void 0:F.message)||"Leave type not created successfully"),d.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})}p(!1),A(!1),w()}catch(t){console.log(t)}};return i.useEffect(()=>{var l,u,s,f,j,o,m;n&&r?d.reset({leave_type_name:(l=r==null?void 0:r.data)==null?void 0:l.leave_type_name,max_days_per_year:String((u=r==null?void 0:r.data)==null?void 0:u.max_days_per_year),carry_forward_allowed:(s=r==null?void 0:r.data)==null?void 0:s.carry_forward_allowed,max_carry_forward_days:String((f=r==null?void 0:r.data)==null?void 0:f.max_carry_forward_days),encashment_allowed:(j=r==null?void 0:r.data)==null?void 0:j.encashment_allowed,description:(o=r==null?void 0:r.data)==null?void 0:o.description,department_id:String((m=r==null?void 0:r.data)==null?void 0:m.department_id)}):d.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})},[n,r]),e.jsx(Me,{open:h,setOpen:p,title:y,setEdit:A,edit:n,isLoading:B,children:e.jsx(fe,{methods:d,onSubmit:d.handleSubmit(E),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(Ee,{className:"h-4 w-4 text-gray-400"}),"Department ID"]}),e.jsx(je,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(S=(v=b==null?void 0:b.data)==null?void 0:v.data)!=null&&S.length?b.data.data.map(l=>({label:String(l.department_name),value:String(l.id)})):[]})]})}),e.jsx("div",{children:e.jsx(q,{name:"leave_type_name",placeholder:"Enter Leave Type Name",label:"Leave Type Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx("div",{children:e.jsx(q,{name:"max_days_per_year",placeholder:"Enter Max Days",label:"Max Days Per Year",inputValidation:["number"]})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{id:"carry_forward_allowed",checked:d.watch("carry_forward_allowed"),onCheckedChange:l=>d.setValue("carry_forward_allowed",l)}),e.jsx(X,{htmlFor:"carry_forward_allowed",className:"text-sm font-medium",children:"Carry Forward Allowed"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{id:"encashment_allowed",checked:d.watch("encashment_allowed"),onCheckedChange:l=>d.setValue("encashment_allowed",l)}),e.jsx(X,{htmlFor:"encashment_allowed",className:"text-sm font-medium",children:"Encashment Allowed"})]})]}),d.watch("carry_forward_allowed")&&e.jsx("div",{children:e.jsx(q,{name:"max_carry_forward_days",placeholder:"Enter Max Carry Forward Days",label:"Max Carry Forward Days",inputValidation:["number"]})}),e.jsx("div",{children:e.jsx(Ae,{name:"description",placeholder:"Enter Description",label:"Description"})}),e.jsx(re,{}),e.jsx("div",{children:e.jsx(ge,{isLoading:d.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ye(){var o,m,C,F,t,R,V,Y,H,D,z,G;const h=le({}),p=se(),[y,P]=i.useState(1),[n,A]=i.useState(10),[w,M]=i.useState(""),[b,r]=i.useState(!1),[B,d]=i.useState(""),[E,N]=i.useState(!1),[v,S]=i.useState(null),[l,u]=i.useState(""),s=te({api:`${L.getAllLeaveTypes}?page=${y}&limit=${n}&q=${w}&department_id=${ae(String(l))}`,key:"getAllLeaveTypes",value:[y,n,w,l],options:{enabled:!0}}),f=a=>{N(!0),r(!0),d(a)},j=async a=>{var I,U,J,K;S(a);try{const c=await h.mutateAsync({api:`${(I=L)==null?void 0:I.deleteLeaveTypeById}`,data:{id:B}});(U=c==null?void 0:c.data)!=null&&U.success?(s==null||s.refetch(),_.success((J=c==null?void 0:c.data)==null?void 0:J.message)):_.error((K=c.data)==null?void 0:K.message)}catch(c){_.error(Ce(c))}finally{S(null)}};return e.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[e.jsx(Ve,{open:b,setOpen:r,title:E?"Edit Leave Type":"Add Leave Type",id:B,edit:E,setEdit:N,refetch:s==null?void 0:s.refetch}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{}),e.jsxs($,{onClick:()=>r(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 shadow-lg shadow-blue-500/30 transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:shadow-blue-500/40",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Add Leave Type"]})]}),e.jsx(O,{className:"border-slate-200 shadow-sm",children:e.jsx(Q,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"max-w-md flex-1",children:e.jsx(xe,{search:w,setSearch:M,refetch:s==null?void 0:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsxs(_e,{onValueChange:a=>u(a),value:l,children:[e.jsx(ye,{className:"w-full bg-white sm:w-[220px]",children:e.jsx(be,{placeholder:"All Departments"})}),e.jsx(we,{children:e.jsxs(Ne,{children:[e.jsx(ve,{children:"Filter by Department"}),(m=(o=p==null?void 0:p.data)==null?void 0:o.data)!=null&&m.length?p.data.data.map(a=>e.jsx(Se,{value:String(a.id),children:a.department_name},a.id)):null]})})]})]})})}),e.jsxs(O,{className:"overflow-hidden border-slate-200 shadow-lg",children:[e.jsx(ne,{className:"border-b bg-gradient-to-r from-slate-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ce,{className:"text-xl font-semibold text-slate-900",children:"Leave Types Registry"}),e.jsxs(ie,{className:"mt-1",children:["Total ",((F=(C=s==null?void 0:s.data)==null?void 0:C.pagination)==null?void 0:F.total)||0," leave type(s) configured"]})]}),e.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:e.jsx(ee,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx(Q,{className:"p-0",children:s!=null&&s.isLoading?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(oe,{}),e.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Loading leave types..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(pe,{children:e.jsxs(k,{className:"bg-slate-50 hover:bg-slate-50",children:[e.jsx(g,{className:"w-16 font-semibold text-slate-700",children:"#"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Leave Type"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Max Days/Year"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Carry Forward"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Encashment"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Created Date"}),e.jsx(g,{className:"text-right font-semibold text-slate-700",children:"Actions"})]})}),e.jsxs(ue,{children:[(R=(t=s==null?void 0:s.data)==null?void 0:t.data)==null?void 0:R.map((a,I)=>e.jsxs(k,{className:"border-b border-slate-100 transition-colors hover:bg-slate-50/50",children:[e.jsx(x,{className:"font-medium text-slate-500",children:(y-1)*n+I+1}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"font-semibold text-slate-900",children:a==null?void 0:a.leave_type_name})]}),(a==null?void 0:a.description)&&e.jsx("div",{className:"ml-6 text-sm text-slate-500",children:a==null?void 0:a.description})]})}),e.jsx(x,{children:e.jsxs("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2.5 py-1 text-sm font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:[a==null?void 0:a.max_days_per_year," days"]})}),e.jsx(x,{children:a!=null&&a.carry_forward_allowed?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["Yes (",a==null?void 0:a.max_carry_forward_days," days)"]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("span",{className:"text-sm text-slate-500",children:"No"})]})}),e.jsx(x,{children:a!=null&&a.encashment_allowed?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Allowed"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("span",{className:"text-sm text-slate-500",children:"Not Allowed"})]})}),e.jsx(x,{children:e.jsx("span",{className:"text-sm text-slate-600",children:me(a==null?void 0:a.created_at).format("DD MMM YYYY")})}),e.jsx(x,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx($,{size:"sm",variant:"outline",onClick:()=>f(String(a==null?void 0:a.id)),className:"h-8 border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700",children:e.jsx(ke,{className:"h-3.5 w-3.5"})}),e.jsx($,{size:"sm",variant:"outline",disabled:v===String(a==null?void 0:a.id),onClick:()=>j(String(a==null?void 0:a.id)),className:"h-8 border-red-200 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 disabled:opacity-50",children:v===String(a==null?void 0:a.id)?e.jsx(Be,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(qe,{className:"h-3.5 w-3.5"})})]})})]},a==null?void 0:a.id)),((Y=(V=s==null?void 0:s.data)==null?void 0:V.data)==null?void 0:Y.length)===0&&e.jsx(k,{children:e.jsx(x,{colSpan:7,className:"h-64 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-slate-500",children:[e.jsx(ee,{className:"mb-4 h-12 w-12 text-slate-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No leave types found"}),e.jsx("p",{className:"mt-1 text-sm",children:"Create your first leave type to get started"})]})})})]})]})}),((D=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:D.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"my-4"}),e.jsx("div",{className:"px-6 pb-4",children:e.jsx(Fe,{page:y,limit:n,totalPages:(G=(z=s==null?void 0:s.data)==null?void 0:z.pagination)==null?void 0:G.totalPages,setPage:P,setLimit:A})})]})]})})]})]})]})}function da(){return e.jsx(de,{title:"Leave Type List",subTitle:"Manage all the Leave Types here",children:e.jsx("div",{children:e.jsx(Ye,{})})})}export{da as default};
