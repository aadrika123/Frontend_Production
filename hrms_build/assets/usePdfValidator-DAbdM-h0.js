import{k as e,r as a}from"./index-C0dR7KKl.js";import{c as i,g as t,b as r}from"./yup-D-4eAt9F.js";
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=e("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),n=e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),l=e("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),d=e("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),o=e("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),h=e("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),c=e("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */i({name:r().required("Name is required").min(2,"Name must be at least 2 characters"),email:r().required("Email is required").email("Invalid email address"),description:r(),pdfFile:t().required("PDF file is required")});const m=[{name:"JavaScript",pattern:/\/JavaScript|\/JS\s*\(|app\.alert|eval\(|document\.|window\./gi,severity:"high"},{name:"OpenAction",pattern:/\/OpenAction/gi,severity:"high"},{name:"AA (Additional Actions)",pattern:/\/AA\s*<</gi,severity:"high"},{name:"Launch Action",pattern:/\/Launch/gi,severity:"high"},{name:"ImportData",pattern:/\/ImportData/gi,severity:"high"},{name:"RichMedia",pattern:/\/RichMedia/gi,severity:"high"},{name:"GoToE",pattern:/\/GoToE/gi,severity:"high"}],y=e=>({high:3,medium:2,low:1}[e]||0),p=(e={})=>{const i={maxFileSizeMB:10,strictMode:!0,autoValidate:!0,...e},[t,r]=a.useState(null),[s,n]=a.useState(null),[l,d]=a.useState(!1),o=a.useCallback(async e=>{if(d(!0),r(e),!e){const e={isValid:!1,message:"No file provided",threats:[],severity:"high"};return n(e),d(!1),e}if("application/pdf"!==e.type){const a={isValid:!1,message:`Invalid file type. Expected PDF, got ${e.type||"unknown"}`,threats:[{name:"Invalid File Type",severity:"high",description:"Only PDF files are allowed"}],severity:"high"};return n(a),d(!1),a}const a=1024*i.maxFileSizeMB*1024;if(e.size>a){const a={isValid:!1,message:`File size (${(e.size/1024/1024).toFixed(2)}MB) exceeds the maximum limit of ${i.maxFileSizeMB}MB`,threats:[{name:"File Too Large",severity:"medium",description:`File size exceeds ${i.maxFileSizeMB}MB limit`}],severity:"medium"};return n(a),d(!1),a}try{const a=await(e=>new Promise((a,i)=>{const t=new FileReader;t.onload=e=>{var i;return a(null==(i=e.target)?void 0:i.result)},t.onerror=()=>i(new Error("Failed to read file")),t.readAsText(e)}))(e);if(!a.startsWith("%PDF-")){const e={isValid:!1,message:"Invalid PDF file. File does not have a valid PDF header",threats:[{name:"Invalid PDF Format",severity:"high",description:"File does not contain a valid PDF header"}],severity:"high"};return n(e),d(!1),e}const t=[];let r,s=null;if(m.forEach(({name:e,pattern:i,severity:r})=>{const n=a.match(i);n&&n.length>0&&(t.push({name:e,severity:r,description:`Found ${n.length} occurrence(s) of ${e}`,matchCount:n.length}),(!s||y(r)>y(s))&&(s=r))}),0===t.length)r={isValid:!0,message:"PDF is safe and contains no security threats",threats:[],severity:null};else{if(i.strictMode?t.length>0:t.some(e=>"high"===e.severity)){t.map(e=>e.name).join(", ");r={isValid:!1,message:"⚠️The file appears to be corrupted or contains malicious code. Please upload a valid file.",threats:t,severity:s}}else r={isValid:!0,message:"PDF contains low-risk elements but is approved for upload",threats:t,severity:s}}return n(r),d(!1),r}catch(t){const e={isValid:!1,message:`Error reading PDF file: ${t.message}`,threats:[{name:"Read Error",severity:"high",description:t.message}],severity:"high"};return n(e),d(!1),e}},[i.maxFileSizeMB,i.strictMode]),h=a.useCallback(()=>{r(null),n(null),d(!1)},[]),c=a.useCallback(async e=>{var a;const t=null==(a=e.target.files)?void 0:a[0];t&&i.autoValidate?await o(t):t&&r(t)},[o,i.autoValidate]);return{validateFile:o,validation:s,isValidating:l,reset:h,file:t,handleFileChange:c}};export{n as C,l as F,d as H,o as M,h as U,c as W,s as a,p as u};
