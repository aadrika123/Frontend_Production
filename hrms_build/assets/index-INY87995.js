import{n as e,h as a,f as s,r as l,j as i,z as t,m as d,B as n}from"./index-BJ2Di0BB.js";import{P as r}from"./index-L2kacWh6.js";import{h as c}from"./moment-CBOc1lqT.js";import{C as o,a as u,b as m,c as p}from"./card-CrOEotWM.js";import{S as x,T as v,a as y,b as j,c as h,d as g,e as f}from"./index-BxKGIMG5.js";import{u as _,b}from"./useCustomQuery-DkqDqiry.js";import{S as N}from"./separator-BtSn9EpY.js";import{S as P}from"./Spinner-DjUjMlqR.js";import{a as S,o as L,c as B,f as C}from"./yup-BTlf5Wf5.js";import{F as E}from"./datetime-picker-cKnQNXMD.js";import{R as M}from"./RHFTextField-BK1QXo_s.js";import{B as I}from"./ButtonLoading-B5GmY3N3.js";import"./select-4D5dQM-6.js";import{D as A}from"./index-ClKtlEeL.js";import"./calendar-B99NsLtP.js";import"./clock-PqgEqIzL.js";import"./check-DiqtQ1XW.js";const k=B().shape({cell_index:C().required("Cell Index is required").positive("Cell Index must be positive"),basic_pay:C().required("Basic Pay is required").positive("Basic Pay must be positive")});function T({open:d,setOpen:n,title:r,id:c,edit:o,setEdit:u,empTypeListData:m,payLevelId:p}){var x,v,y,j,h,g;const f=_({}),P=e(String(p)),{data:B,isFetching:C}=b({api:`${null==(x=a)?void 0:x.getPayMatrixById}?id=${s(String(c))}`,key:"getPayMatrixById",options:{enabled:!!o}}),T=(null==m?void 0:m.data)&&(null==(y=null==(v=null==m?void 0:m.data)?void 0:v.data)?void 0:y.length)>0?Math.max(...null==(h=null==(j=null==m?void 0:m.data)?void 0:j.data)?void 0:h.map(e=>null==e?void 0:e.cell_index))+1:1;b({api:`${null==(g=a)?void 0:g.getPayLevelById}?id=${p}`,key:"getPayLevelById",value:[p],options:{enabled:!!p}});const $={pay_level_id:Number(P)||0,cell_index:0,basic_pay:0},w=S({defaultValues:$,resolver:L(k)});return l.useEffect(()=>{o&&(null==B?void 0:B.data)?w.reset(B.data):w.reset($)},[o,B,w]),l.useEffect(()=>{(null==m?void 0:m.data)&&!o&&w.setValue("cell_index",T)},[m,o,T,w]),i.jsx(A,{open:d,setOpen:n,title:r,setEdit:u,edit:o,isLoading:C,children:i.jsx(E,{methods:w,onSubmit:w.handleSubmit(async e=>{var s,l,i,d,r,p,x,v;try{if(o&&e){const n=await f.mutateAsync({api:`${null==(s=a)?void 0:s.updatePayMatrix}`,data:{id:c,pay_level_id:e.pay_level_id,cell_index:e.cell_index,basic_pay:e.basic_pay}});(null==(l=n.data)?void 0:l.success)?t.success(null==(i=null==n?void 0:n.data)?void 0:i.message):t.error((null==(d=n.data)?void 0:d.message)||"Pay Level Cell not updated successfully")}else{const s=await f.mutateAsync({api:null==(r=a)?void 0:r.createPayMatrix,data:{pay_level_id:e.pay_level_id,cell_index:e.cell_index,basic_pay:e.basic_pay}});(null==(p=s.data)?void 0:p.success)?t.success(null==(x=null==s?void 0:s.data)?void 0:x.message):t.error((null==(v=s.data)?void 0:v.message)||"Pay Level Cell not created successfully"),w.reset($)}n(!1),u(!1),null==m||m.refetch()}catch(y){t.error("An error occurred. Please try again.")}}),children:i.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[i.jsx("input",{type:"hidden",...w.register("pay_level_id"),value:p||""}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[i.jsx(M,{type:"number",label:"Cell Index",name:"cell_index",placeholder:"Enter Cell Index"}),i.jsx(M,{type:"number",name:"basic_pay",label:"Basic Pay",placeholder:"Enter Basic Pay"})]}),i.jsx(N,{}),i.jsx("div",{children:i.jsx(I,{isLoading:w.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function $(){var e,s,t,r;const[S]=d(),L=S.get("pay_level_id");_({});const[B,C]=l.useState(1),[E,M]=l.useState(10),[I,A]=l.useState(""),[k,$]=l.useState(!1),[w,F]=l.useState(""),[D,q]=l.useState(!1),[Y,O]=l.useState(null),z=b({api:`${a.getAllPayMatrix}?pay_level_id=${L}`,key:"getAllPayMatrix",value:[B,E],options:{enabled:!!L}});return i.jsxs("main",{className:"grid items-start",children:[i.jsx(T,{open:k,setOpen:$,title:D?"Edit Employee Type":"Add Employee Type",id:w,edit:D,setEdit:q,empTypeListData:z,payLevelId:L||void 0}),i.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[i.jsxs("div",{className:"flex w-full justify-between gap-2",children:[i.jsx("div",{children:i.jsx(x,{search:I,setSearch:A,refetch:z.refetch,isFetching:null==z?void 0:z.isLoading})}),i.jsx("div",{children:i.jsx(n,{className:"flex items-center gap-2",onClick:()=>$(!0),children:"Add New"})})]}),i.jsxs(o,{children:[i.jsx(u,{className:"px-7",children:i.jsxs(m,{children:["Employee Type List (",(null==(s=null==(e=null==z?void 0:z.data)?void 0:e.data)?void 0:s.length)||0,")"]})}),i.jsx(p,{children:z.isLoading?i.jsx("div",{className:"flex h-32 items-center justify-center",children:i.jsx(P,{})}):i.jsxs(i.Fragment,{children:[i.jsxs(v,{children:[i.jsx(y,{children:i.jsxs(j,{children:[i.jsx(h,{className:"",children:"#"}),i.jsx(h,{className:"",children:"Level"}),i.jsx(h,{className:"",children:"Cell Index"}),i.jsx(h,{className:"",children:"Basic Pay"}),i.jsx(h,{className:"",children:"Created at"}),i.jsx(h,{children:"Action"})]})}),i.jsx(g,{children:null==(r=null==(t=null==z?void 0:z.data)?void 0:t.data)?void 0:r.map((e,a)=>i.jsxs(j,{children:[i.jsx(f,{children:a+1}),i.jsx(f,{children:`Level ${null==e?void 0:e.pay_level_id}`}),i.jsx(f,{children:null==e?void 0:e.cell_index}),i.jsx(f,{children:null==e?void 0:e.basic_pay}),i.jsx(f,{children:c(null==e?void 0:e.created_at).format("DD-MM-YYYY")}),i.jsx(f,{children:i.jsx(n,{className:"bg-primary",onClick:()=>{return a=String(null==e?void 0:e.id),q(!0),$(!0),void F(a);var a},children:"Edit"})})]},null==e?void 0:e.id))})]}),i.jsx(N,{className:"mb-2 mt-4"})]})})]})]})]})}function w(){return i.jsx(r,{title:"Pay Matrix",subTitle:"Manage all the Pay Matrices here",children:i.jsx("div",{className:"py-12",children:i.jsx($,{})})})}export{w as default};
