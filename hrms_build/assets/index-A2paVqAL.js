import{aC as e,r,an as t,j as s,al as a}from"./vendor-RyuIgj66.js";import{g as d,C as l,P as i}from"./index-DFF4_m_G.js";import{h as o,e as n}from"./index-ey2GEmQz.js";import{u as c,b as x}from"./useCustomQuery-DTB6aAiD.js";import{P as m,T as b}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const g=()=>{var i,g,y,h,u,p,j,f,v,N,w,k,D,S;const[_]=e(),A=c({}),C=_.get("department_id"),[W,O]=r.useState(null),L=d(),[T,F]=r.useState(C),I=t(),M=x({api:`${null==(i=o)?void 0:i.getAllWeekOffsByDepartment}?department_id=${n(String(T))}`,value:[T],options:{enabled:!!T}}),P={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"},$=r.useMemo(()=>{var e;return(null==(e=null==M?void 0:M.data)?void 0:e.data)?M.data.data.reduce((e,r)=>(e[r.day_off]||(e[r.day_off]=[]),e[r.day_off].push(r),e),{}):{}},[null==(g=null==M?void 0:M.data)?void 0:g.data]),z=r.useMemo(()=>$?Object.keys($).map(Number).sort((e,r)=>e-r):[],[$]),R=W?$[W]:null==(y=null==M?void 0:M.data)?void 0:y.data;return s.jsx("div",{className:"min-h-screen bg-gray-100",children:s.jsxs("div",{children:[s.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[s.jsx("div",{className:"border-b border-gray-300 bg-purple-50 px-4 py-3",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Select Department"})}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{className:"p-4",children:[s.jsxs("select",{value:T||"",onChange:e=>F(e.target.value),className:"w-full max-w-xs border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select Department"}),null==(h=null==L?void 0:L.data)?void 0:h.data.map(e=>s.jsx("option",{value:String(e.id),children:e.department_name},e.id))]}),T&&s.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected:"," ",s.jsx("span",{className:"font-semibold",children:(null==(p=null==(u=null==L?void 0:L.data)?void 0:u.data.find(e=>String(e.id)===T))?void 0:p.department_name)||"N/A"})]})]}),s.jsx("div",{className:"p-4",children:s.jsx("button",{onClick:()=>I("/hrms/dashboard/create-weekly-off"),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:"Add Weekly Off"})})]})]}),(null==M?void 0:M.isLoading)&&s.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:s.jsx("div",{className:"text-gray-600",children:"Loading day off records..."})}),!T&&!(null==M?void 0:M.isLoading)&&s.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:s.jsx("div",{className:"text-gray-600",children:"Please select a department to view day off schedules"})}),T&&!(null==M?void 0:M.isLoading)&&0===(null==(f=null==(j=null==M?void 0:M.data)?void 0:j.data)?void 0:f.length)&&s.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:s.jsx("div",{className:"text-gray-600",children:"No day off records found for this department"})}),T&&!(null==M?void 0:M.isLoading)&&(null==(N=null==(v=null==M?void 0:M.data)?void 0:v.data)?void 0:N.length)>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[s.jsx("div",{className:"border-b border-gray-300 bg-blue-50 px-4 py-3",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Filter by Day"})}),s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>O(null),className:"border px-4 py-2 font-medium "+(null===W?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:["All Days (",null==(k=null==(w=null==M?void 0:M.data)?void 0:w.data)?void 0:k.length,")"]}),z.map(e=>{var r;return s.jsxs("button",{onClick:()=>O(e),className:"border px-4 py-2 font-medium "+(W===e?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[P[e]," (",null==(r=$[e])?void 0:r.length,")"]},e)})]})})]}),s.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[s.jsx("div",{className:"border-b border-gray-300 bg-green-50 px-4 py-3",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Summary"})}),s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[s.jsxs("div",{className:"border border-gray-300 bg-blue-50 p-3",children:[s.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Total Records"}),s.jsx("div",{className:"text-2xl font-bold text-gray-800",children:null==R?void 0:R.length})]}),s.jsxs("div",{className:"border border-gray-300 bg-green-50 p-3",children:[s.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Days Scheduled"}),s.jsx("div",{className:"text-2xl font-bold text-gray-800",children:null==z?void 0:z.length})]}),s.jsxs("div",{className:"border border-gray-300 bg-yellow-50 p-3",children:[s.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Department ID"}),s.jsx("div",{className:"text-2xl font-bold text-gray-800",children:(null==(S=null==(D=null==M?void 0:M.data)?void 0:D.data[0])?void 0:S.department_name)||"N/A"})]})]})})]}),s.jsxs("div",{className:"border border-gray-300 bg-white",children:[s.jsx("div",{className:"border-b border-gray-300 bg-blue-900 px-4 py-3 text-white",children:s.jsx("h2",{className:"text-lg font-semibold",children:W?`${P[W]} Schedule`:"All Day Off Records"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b-2 border-gray-400 bg-gray-200",children:[s.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"S.No"}),s.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Day Off"}),s.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Week Number"}),s.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Department Name"}),s.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),s.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Created Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Action"})]})}),s.jsx("tbody",{children:null==R?void 0:R.map((e,r)=>s.jsxs("tr",{className:`border-b border-gray-300 ${r%2==0?"bg-white":"bg-gray-50"} hover:bg-blue-50`,children:[s.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:r+1}),s.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:[s.jsx("span",{className:"font-medium",children:P[e.day_off]}),s.jsxs("span",{className:"ml-1 text-gray-500",children:["(",e.day_off,")"]})]}),s.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:["Week ",e.week_number]}),s.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:null==e?void 0:e.department_name}),s.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm",children:s.jsx("span",{className:"inline-block border border-green-300 bg-green-100 px-2 py-1 text-xs font-semibold text-green-800",children:1===e.status?"Active":"Inactive"})}),s.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:new Date(e.created_at).toLocaleDateString("en-IN")}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",onClick:()=>{a.error("Edit functionality is not implemented yet.")},className:"rounded p-1.5 text-blue-600 hover:bg-blue-100",title:"Edit",children:s.jsx(m,{size:18})}),s.jsx("button",{onClick:()=>{return r=e.id,void l("Are you sure you want to delete this weekly off?","Please confirm",async()=>{var e,t,s;try{const d=await A.mutateAsync({api:o.deleteWeekOffById,data:{id:r}});(null==(e=d.data)?void 0:e.success)?(a.success((null==(t=null==d?void 0:d.data)?void 0:t.message)||"Weekly off deleted successfully"),M.refetch()):a.error((null==(s=d.data)?void 0:s.message)||"Failed to delete weekly off")}catch(d){a.error("An error occurred while deleting weekly off")}});var r},className:"rounded p-1.5 text-red-600 hover:bg-red-100",title:"Delete",children:s.jsx(b,{size:18})})]})})]},e.id))})]})}),s.jsx("div",{className:"border-t border-gray-300 bg-gray-100 px-4 py-3",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Total Records:"," ",s.jsx("span",{className:"font-semibold",children:null==R?void 0:R.length})]})})]}),!W&&s.jsxs("div",{className:"mt-6 border border-gray-300 bg-white",children:[s.jsx("div",{className:"border-b border-gray-300 bg-orange-50 px-4 py-3",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Day-wise Distribution"})}),s.jsx("div",{className:"p-4",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-300 bg-gray-200",children:[s.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Day"}),s.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Total Schedules"}),s.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Weeks Covered"})]})}),s.jsx("tbody",{children:z.map((e,r)=>{const t=$[e],a=t.map(e=>e.week_number).sort((e,r)=>e-r);return s.jsxs("tr",{className:"border-b border-gray-300 "+(r%2==0?"bg-white":"bg-gray-50"),children:[s.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm font-medium text-gray-800",children:P[e]}),s.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:null==t?void 0:t.length}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:a.join(", ")})]},e)})})]})})]})]})]})})};function y(){return s.jsx(i,{title:"Weekly Off List",subTitle:"Manage all the Weekly Off schedules here",children:s.jsx("div",{className:"py-2",children:s.jsx(g,{})})})}export{y as default};
