import{h as N,e as A,r as d,j as e,z as m,B as q}from"./index-Df4ChAN-.js";import{P as Y}from"./index-DjNjGvXo.js";import{C as z,a as U,b as G,c as J,h as K}from"./card-CW8LZ2r1.js";import{S as Q,T as W,a as X,b as I,c as u,d as Z,e as h}from"./index-Tosm5l2v.js";import{u as V,b as H}from"./useCustomQuery-BBKf_waA.js";import{g as ee}from"./services-KQnp_8oA.js";import{P as ae}from"./index-CRGyM8Pm.js";import{S as R,a as se}from"./Spinner-CyN74T25.js";import{a as re,o as ne,c as te,b as T}from"./yup-pPl0eVQc.js";import{F as ce,B as oe}from"./datetime-picker-EqBIIAIP.js";import{R as w}from"./RHFTextField-C5PfVKXx.js";import"./select-DZKz6XPY.js";import{D as le}from"./index-D4JNSpYb.js";import{L as de}from"./loader-circle-DH4IlwT9.js";import{t as ie}from"./switch-CSM65BwS.js";import"./calendar-CMNTAmai.js";import"./clock-BxgzxCOp.js";import"./check-BzewUJFq.js";const pe=te().shape({ddo_code:T().required().label("DDO Code"),ddo_name:T().required().label("DDO Name"),office_name:T().required().label("Office Name"),treasury_name:T().required().label("Treasury Name")});function ue({open:O,setOpen:x,title:M,id:f,edit:i,setEdit:g,refetch:P}){var j;const _=V({}),{data:r,isFetching:$}=H({api:`${(j=N)==null?void 0:j.getDDoMstrById}/${A(String(f))}`,key:"getDDoMstrById",options:{enabled:i}}),o=re({defaultValues:{ddo_code:"",ddo_name:"",office_name:"",treasury_name:""},resolver:ne(pe)}),v=async t=>{var l,s,p,E,y,S,D,b;try{if(i&&t){const n=await _.mutateAsync({api:`${(l=N)==null?void 0:l.updateDDoMstrById}`,data:{id:A(String(f)),...t}});(s=n.data)!=null&&s.success?m.success((p=n==null?void 0:n.data)==null?void 0:p.message):m.error(((E=n.data)==null?void 0:E.message)||"Employee Type not updated successfully")}else{const n=await _.mutateAsync({api:(y=N)==null?void 0:y.createDDoMstr,data:t});(S=n.data)!=null&&S.success?m.success((D=n==null?void 0:n.data)==null?void 0:D.message):m.error(((b=n.data)==null?void 0:b.message)||"Employee Type not created successfully"),o.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})}x(!1),g(!1),P()}catch(n){console.log(n)}};return d.useEffect(()=>{var t,l,s,p;i&&r?o.reset({ddo_code:(t=r==null?void 0:r.data)==null?void 0:t.ddo_code,ddo_name:(l=r==null?void 0:r.data)==null?void 0:l.ddo_name,office_name:(s=r==null?void 0:r.data)==null?void 0:s.office_name,treasury_name:(p=r==null?void 0:r.data)==null?void 0:p.treasury_name}):o.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})},[i,r]),e.jsx(le,{open:O,setOpen:x,title:M,setEdit:g,edit:i,isLoading:$,children:e.jsx(ce,{methods:o,onSubmit:o.handleSubmit(v),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(w,{name:"ddo_code",placeholder:"Enter DDO Code",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(w,{name:"ddo_name",placeholder:"Enter DDO Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(w,{name:"office_name",placeholder:"Enter Office Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(w,{name:"treasury_name",placeholder:"Enter Treasury Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(R,{}),e.jsx("div",{children:e.jsx(oe,{isLoading:o.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function he(){var y,S,D,b,n,B;const O=V({}),[x,M]=d.useState(1),[f,i]=d.useState(10),[g,P]=d.useState(""),[_,r]=d.useState(!1),[$,o]=d.useState(""),[v,j]=d.useState(!1),[t,l]=d.useState(null),s=H({api:`${N.getAllDDoMstr}?page=${x}&limit=${f}&q=${g}`,key:"getAllDDoList",value:[x,f],options:{enabled:!0}}),p=a=>{j(!0),r(!0),o(a)},E=async a=>{var C,F,k,L;l(a);try{const c=await O.mutateAsync({api:`${(C=N)==null?void 0:C.toggleDDoMstr}`,data:{id:A(String(a))}});(F=c==null?void 0:c.data)!=null&&F.success?(s.refetch(),m.success((k=c==null?void 0:c.data)==null?void 0:k.message)):m.error((L=c.data)==null?void 0:L.message)}catch(c){m.error(ee(c))}finally{l(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(ue,{open:_,setOpen:r,title:v?"Edit Employee Type":"Add Employee Type",id:$,edit:v,setEdit:j,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(Q,{search:g,setSearch:P,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(q,{className:"flex items-center gap-2",onClick:()=>r(!0),children:"Add New"})})]}),e.jsxs(z,{children:[e.jsx(U,{className:"px-7",children:e.jsxs(G,{children:["Employee Type List (",(S=(y=s==null?void 0:s.data)==null?void 0:y.pagination)==null?void 0:S.total,")"]})}),e.jsx(J,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(se,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(I,{children:[e.jsx(u,{className:"",children:"#"}),e.jsx(u,{className:"",children:"DDO Code"}),e.jsx(u,{className:"",children:"DDO Name"}),e.jsx(u,{className:"",children:"Office Name"}),e.jsx(u,{className:"",children:"Created at"}),e.jsx(u,{className:"",children:"Status"}),e.jsx(u,{children:"Action"})]})}),e.jsx(Z,{children:(b=(D=s==null?void 0:s.data)==null?void 0:D.data)==null?void 0:b.map((a,C)=>e.jsxs(I,{children:[e.jsx(h,{children:C+1}),e.jsx(h,{children:a==null?void 0:a.ddo_code}),e.jsx(h,{children:a==null?void 0:a.ddo_name}),e.jsx(h,{children:a==null?void 0:a.office_name}),e.jsx(h,{children:K(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ie,{checked:(a==null?void 0:a.status)==1,onChange:()=>E(String(a==null?void 0:a.id)),disabled:t===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),t===String(a==null?void 0:a.id)&&e.jsx(de,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(h,{children:e.jsx(q,{className:"bg-primary",onClick:()=>p(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(R,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ae,{page:x,limit:f,totalPages:(B=(n=s==null?void 0:s.data)==null?void 0:n.pagination)==null?void 0:B.totalPages,setPage:M,setLimit:i})})]})})]})]})]})}function Pe(){return e.jsx(Y,{title:"DDO List",subTitle:"Manage all the DDo List",children:e.jsx("div",{className:"py-12",children:e.jsx(he,{})})})}export{Pe as default};
