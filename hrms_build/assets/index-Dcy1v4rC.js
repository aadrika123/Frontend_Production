import{Q as R,r as g,l as B,h as O,e as F,j as e,z as h}from"./index-SDtq6APg.js";import{g as Q,C as q,P as G}from"./index-CrjMXZHz.js";import{u as H,b as J}from"./useCustomQuery-DuxI2f1A.js";import{P as K}from"./pen-D8DxK0bF.js";import{T as U}from"./trash-2-BJjgVrZW.js";const V=()=>{var f,p,j,u,N,v,w,k,S,D,_,A,W,C;const[P]=R(),T=H({}),L=P.get("department_id"),[o,y]=g.useState(null),n=Q(),[d,I]=g.useState(L),$=B(),r=J({api:`${(f=O)==null?void 0:f.getAllWeekOffsByDepartment}?department_id=${F(String(d))}`,value:[d],options:{enabled:!!d}}),b={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"},c=g.useMemo(()=>{var s;return(s=r==null?void 0:r.data)!=null&&s.data?r.data.data.reduce((t,a)=>(t[a.day_off]||(t[a.day_off]=[]),t[a.day_off].push(a),t),{}):{}},[(p=r==null?void 0:r.data)==null?void 0:p.data]),x=g.useMemo(()=>c?Object.keys(c).map(Number).sort((s,t)=>s-t):[],[c]),i=o?c[o]:(j=r==null?void 0:r.data)==null?void 0:j.data,M=s=>{h.error("Edit functionality is not implemented yet.")},E=s=>{q("Are you sure you want to delete this weekly off?","Please confirm",async()=>{var t,a,m;try{const l=await T.mutateAsync({api:O.deleteWeekOffById,data:{id:s}});(t=l.data)!=null&&t.success?(h.success(((a=l==null?void 0:l.data)==null?void 0:a.message)||"Weekly off deleted successfully"),r.refetch()):h.error(((m=l.data)==null?void 0:m.message)||"Failed to delete weekly off")}catch{h.error("An error occurred while deleting weekly off")}})};return e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-purple-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Select Department"})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("select",{value:d||"",onChange:s=>I(s.target.value),className:"w-full max-w-xs border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Department"}),(u=n==null?void 0:n.data)==null?void 0:u.data.map(s=>e.jsx("option",{value:String(s.id),children:s.department_name},s.id))]}),d&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected:"," ",e.jsx("span",{className:"font-semibold",children:((v=(N=n==null?void 0:n.data)==null?void 0:N.data.find(s=>String(s.id)===d))==null?void 0:v.department_name)||"N/A"})]})]}),e.jsx("div",{className:"p-4",children:e.jsx("button",{onClick:()=>$("/hrms/dashboard/create-weekly-off"),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:"Add Weekly Off"})})]})]}),(r==null?void 0:r.isLoading)&&e.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:e.jsx("div",{className:"text-gray-600",children:"Loading day off records..."})}),!d&&!(r!=null&&r.isLoading)&&e.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:e.jsx("div",{className:"text-gray-600",children:"Please select a department to view day off schedules"})}),d&&!(r!=null&&r.isLoading)&&((k=(w=r==null?void 0:r.data)==null?void 0:w.data)==null?void 0:k.length)===0&&e.jsx("div",{className:"mb-6 border border-gray-300 bg-white p-8 text-center",children:e.jsx("div",{className:"text-gray-600",children:"No day off records found for this department"})}),d&&!(r!=null&&r.isLoading)&&((D=(S=r==null?void 0:r.data)==null?void 0:S.data)==null?void 0:D.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-blue-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Filter by Day"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>y(null),className:`border px-4 py-2 font-medium ${o===null?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:["All Days (",(A=(_=r==null?void 0:r.data)==null?void 0:_.data)==null?void 0:A.length,")"]}),x.map(s=>{var t;return e.jsxs("button",{onClick:()=>y(s),className:`border px-4 py-2 font-medium ${o===s?"border-blue-600 bg-blue-600 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:[b[s]," (",(t=c[s])==null?void 0:t.length,")"]},s)})]})})]}),e.jsxs("div",{className:"mb-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-green-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Summary"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"border border-gray-300 bg-blue-50 p-3",children:[e.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Total Records"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:i==null?void 0:i.length})]}),e.jsxs("div",{className:"border border-gray-300 bg-green-50 p-3",children:[e.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Days Scheduled"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:x==null?void 0:x.length})]}),e.jsxs("div",{className:"border border-gray-300 bg-yellow-50 p-3",children:[e.jsx("div",{className:"mb-1 text-sm text-gray-600",children:"Department ID"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:((C=(W=r==null?void 0:r.data)==null?void 0:W.data[0])==null?void 0:C.department_name)||"N/A"})]})]})})]}),e.jsxs("div",{className:"border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-blue-900 px-4 py-3 text-white",children:e.jsx("h2",{className:"text-lg font-semibold",children:o?`${b[o]} Schedule`:"All Day Off Records"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-400 bg-gray-200",children:[e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"S.No"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Day Off"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Week Number"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Department Name"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Created Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Action"})]})}),e.jsx("tbody",{children:i==null?void 0:i.map((s,t)=>e.jsxs("tr",{className:`border-b border-gray-300 ${t%2===0?"bg-white":"bg-gray-50"} hover:bg-blue-50`,children:[e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:t+1}),e.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:b[s.day_off]}),e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",s.day_off,")"]})]}),e.jsxs("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:["Week ",s.week_number]}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:s==null?void 0:s.department_name}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm",children:e.jsx("span",{className:"inline-block border border-green-300 bg-green-100 px-2 py-1 text-xs font-semibold text-green-800",children:s.status===1?"Active":"Inactive"})}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:new Date(s.created_at).toLocaleDateString("en-IN")}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>M(),className:"rounded p-1.5 text-blue-600 hover:bg-blue-100",title:"Edit",children:e.jsx(K,{size:18})}),e.jsx("button",{onClick:()=>E(s.id),className:"rounded p-1.5 text-red-600 hover:bg-red-100",title:"Delete",children:e.jsx(U,{size:18})})]})})]},s.id))})]})}),e.jsx("div",{className:"border-t border-gray-300 bg-gray-100 px-4 py-3",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Total Records:"," ",e.jsx("span",{className:"font-semibold",children:i==null?void 0:i.length})]})})]}),!o&&e.jsxs("div",{className:"mt-6 border border-gray-300 bg-white",children:[e.jsx("div",{className:"border-b border-gray-300 bg-orange-50 px-4 py-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Day-wise Distribution"})}),e.jsx("div",{className:"p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-300 bg-gray-200",children:[e.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Day"}),e.jsx("th",{className:"border-r border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Total Schedules"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Weeks Covered"})]})}),e.jsx("tbody",{children:x.map((s,t)=>{const a=c[s],m=a.map(l=>l.week_number).sort((l,z)=>l-z);return e.jsxs("tr",{className:`border-b border-gray-300 ${t%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm font-medium text-gray-800",children:b[s]}),e.jsx("td",{className:"border-r border-gray-300 px-4 py-3 text-sm text-gray-700",children:a==null?void 0:a.length}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:m.join(", ")})]},s)})})]})})]})]})]})})};function re(){return e.jsx(G,{title:"Weekly Off List",subTitle:"Manage all the Weekly Off schedules here",children:e.jsx("div",{className:"py-2",children:e.jsx(V,{})})})}export{re as default};
