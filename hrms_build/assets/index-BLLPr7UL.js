import{h as b,e as A,r as o,j as e,_ as x,B as L}from"./index-BUAqwvjp.js";import{P as Y}from"./index-84defR4d.js";import{S as V,C as U,a as z,b as G,c as J,d as K,h as Q}from"./Spinner-BUPeaMAF.js";import{S as W,T as X,a as Z,b as I,c as p,d as ee,e as h,P as ae}from"./index-gxUzAQTn.js";import{u as H,b as R}from"./useCustomQuery-B3XmTANn.js";import{g as se}from"./services-KQnp_8oA.js";import{a as re,o as ne,F as ce,R as T,B as te,c as le,b as w}from"./label-SrgL-fwq.js";import{D as de,q as oe,L as ie}from"./index-BGFNnE_G.js";const ue=le().shape({ddo_code:w().required().label("DDO Code"),ddo_name:w().required().label("DDO Name"),office_name:w().required().label("Office Name"),treasury_name:w().required().label("Treasury Name")});function pe({open:O,setOpen:f,title:M,id:m,edit:i,setEdit:g,refetch:P}){var j;const N=H({}),{data:r,isFetching:$}=R({api:`${(j=b)==null?void 0:j.getDDoMstrById}/${A(String(m))}`,key:"getDDoMstrById",options:{enabled:i}}),l=re({defaultValues:{ddo_code:"",ddo_name:"",office_name:"",treasury_name:""},resolver:ne(ue)}),v=async c=>{var d,s,u,E,y,S,D,_;try{if(i&&c){const n=await N.mutateAsync({api:`${(d=b)==null?void 0:d.updateDDoMstrById}`,data:{id:A(String(m)),...c}});(s=n.data)!=null&&s.success?x.success((u=n==null?void 0:n.data)==null?void 0:u.message):x.error(((E=n.data)==null?void 0:E.message)||"Employee Type not updated successfully")}else{const n=await N.mutateAsync({api:(y=b)==null?void 0:y.createDDoMstr,data:c});(S=n.data)!=null&&S.success?x.success((D=n==null?void 0:n.data)==null?void 0:D.message):x.error(((_=n.data)==null?void 0:_.message)||"Employee Type not created successfully"),l.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})}f(!1),g(!1),P()}catch(n){console.log(n)}};return o.useEffect(()=>{var c,d,s,u;i&&r?l.reset({ddo_code:(c=r==null?void 0:r.data)==null?void 0:c.ddo_code,ddo_name:(d=r==null?void 0:r.data)==null?void 0:d.ddo_name,office_name:(s=r==null?void 0:r.data)==null?void 0:s.office_name,treasury_name:(u=r==null?void 0:r.data)==null?void 0:u.treasury_name}):l.reset({ddo_code:"",ddo_name:"",office_name:"",treasury_name:""})},[i,r]),e.jsx(de,{open:O,setOpen:f,title:M,setEdit:g,edit:i,isLoading:$,children:e.jsx(ce,{methods:l,onSubmit:l.handleSubmit(v),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(T,{name:"ddo_code",placeholder:"Enter DDO Code",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(T,{name:"ddo_name",placeholder:"Enter DDO Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(T,{name:"office_name",placeholder:"Enter Office Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(T,{name:"treasury_name",placeholder:"Enter Treasury Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(V,{}),e.jsx("div",{children:e.jsx(te,{isLoading:l.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function he(){var y,S,D,_,n,B;const O=H({}),[f,M]=o.useState(1),[m,i]=o.useState(10),[g,P]=o.useState(""),[N,r]=o.useState(!1),[$,l]=o.useState(""),[v,j]=o.useState(!1),[c,d]=o.useState(null),s=R({api:`${b.getAllDDoMstr}?page=${f}&limit=${m}&q=${g}`,key:"getAllDDoList",value:[f,m],options:{enabled:!0}}),u=a=>{j(!0),r(!0),l(a)},E=async a=>{var C,F,k,q;d(a);try{const t=await O.mutateAsync({api:`${(C=b)==null?void 0:C.toggleDDoMstr}`,data:{id:A(String(a))}});(F=t==null?void 0:t.data)!=null&&F.success?(s.refetch(),x.success((k=t==null?void 0:t.data)==null?void 0:k.message)):x.error((q=t.data)==null?void 0:q.message)}catch(t){x.error(se(t))}finally{d(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(pe,{open:N,setOpen:r,title:v?"Edit Employee Type":"Add Employee Type",id:$,edit:v,setEdit:j,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(W,{search:g,setSearch:P,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(L,{className:"flex items-center gap-2",onClick:()=>r(!0),children:"Add New"})})]}),e.jsxs(U,{children:[e.jsx(z,{className:"px-7",children:e.jsxs(G,{children:["Employee Type List (",(S=(y=s==null?void 0:s.data)==null?void 0:y.pagination)==null?void 0:S.total,")"]})}),e.jsx(J,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(K,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(I,{children:[e.jsx(p,{className:"",children:"#"}),e.jsx(p,{className:"",children:"DDO Code"}),e.jsx(p,{className:"",children:"DDO Name"}),e.jsx(p,{className:"",children:"Office Name"}),e.jsx(p,{className:"",children:"Created at"}),e.jsx(p,{className:"",children:"Status"}),e.jsx(p,{children:"Action"})]})}),e.jsx(ee,{children:(_=(D=s==null?void 0:s.data)==null?void 0:D.data)==null?void 0:_.map((a,C)=>e.jsxs(I,{children:[e.jsx(h,{children:C+1}),e.jsx(h,{children:a==null?void 0:a.ddo_code}),e.jsx(h,{children:a==null?void 0:a.ddo_name}),e.jsx(h,{children:a==null?void 0:a.office_name}),e.jsx(h,{children:Q(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(oe,{checked:(a==null?void 0:a.status)==1,onChange:()=>E(String(a==null?void 0:a.id)),disabled:c===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),c===String(a==null?void 0:a.id)&&e.jsx(ie,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(h,{children:e.jsx(L,{className:"bg-primary",onClick:()=>u(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(V,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ae,{page:f,limit:m,totalPages:(B=(n=s==null?void 0:s.data)==null?void 0:n.pagination)==null?void 0:B.totalPages,setPage:M,setLimit:i})})]})})]})]})]})}function _e(){return e.jsx(Y,{title:"DDO List",subTitle:"Manage all the DDo List",children:e.jsx("div",{className:"py-12",children:e.jsx(he,{})})})}export{_e as default};
