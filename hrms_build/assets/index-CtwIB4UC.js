import{h as e,f as a,r as s,j as t,z as l,B as i,e as d}from"./index-BJ2Di0BB.js";import{g as r,P as n}from"./index-L2kacWh6.js";import{h as o}from"./moment-CBOc1lqT.js";import{C as c,a as m,c as u}from"./card-CrOEotWM.js";import{u as h,b as x}from"./useCustomQuery-DkqDqiry.js";import{P as p}from"./index-DZvdNKxy.js";import{S as y}from"./Spinner-DjUjMlqR.js";import{S as j,a as v,b as g,c as f,d as b,e as N,f as w}from"./select-4D5dQM-6.js";import{a as S,o as H,c as _,b as D,f as Y}from"./yup-BTlf5Wf5.js";import{F as k,a as M}from"./datetime-picker-cKnQNXMD.js";import{R as C}from"./RHFTextField-BK1QXo_s.js";import{R as $}from"./RHFTextArea-CtK9XJcE.js";import{B as E}from"./ButtonLoading-B5GmY3N3.js";import{R as O}from"./RHFSelectField-CxYg0t7R.js";import{S as A}from"./separator-BtSn9EpY.js";import{D as F}from"./index-ClKtlEeL.js";import{C as B}from"./index-DEtLcoiv.js";import{C as L}from"./calendar-B99NsLtP.js";import{P as R}from"./plus-UbJrlwP1.js";import{a as T}from"./clock-PqgEqIzL.js";import{S as P}from"./square-pen-HR786vv8.js";import{L as q}from"./loader-circle--1riX2Rm.js";import{T as z}from"./trash-2-DvAODSCO.js";import"./check-DiqtQ1XW.js";const I=_().shape({type:D().required().label("Type"),holiday_name:D().required().label("Holiday Name"),description:D().required().label("Description"),date:D().required().label("Date"),days:Y().optional().positive().label("Days"),department_id:D().required().label("Department")});function G({open:i,setOpen:d,title:n,id:o,edit:c,setEdit:m,refetch:u}){var p,y,j;const v=r(),g=h({}),{data:f,isFetching:b}=x({api:`${null==(p=e)?void 0:p.getHolidayById}?id=${a(String(o))}`,key:"getHolidayById",options:{enabled:c}}),N=S({defaultValues:{type:"",holiday_name:"",description:"",date:"",days:1,department_id:""},resolver:H(I)});s.useEffect(()=>{var e,a,s,t,l,i;c&&f?N.reset({type:String(null==(e=null==f?void 0:f.data)?void 0:e.type),holiday_name:null==(a=null==f?void 0:f.data)?void 0:a.holiday_name,description:null==(s=null==f?void 0:f.data)?void 0:s.description,date:null==(t=null==f?void 0:f.data)?void 0:t.date,days:null==(l=null==f?void 0:f.data)?void 0:l.days,department_id:String(null==(i=null==f?void 0:f.data)?void 0:i.department_id)}):N.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})},[c,f]);return t.jsx(F,{open:i,setOpen:d,title:n,setEdit:m,edit:c,isLoading:b,children:t.jsx(k,{methods:N,onSubmit:N.handleSubmit(async a=>{var s,t,i,r,n,h,x,p;try{if(c&&a){const d=await g.mutateAsync({api:`${null==(s=e)?void 0:s.updateHolidayById}`,data:{id:o,...a}});(null==(t=d.data)?void 0:t.success)?l.success(null==(i=null==d?void 0:d.data)?void 0:i.message):l.error((null==(r=d.data)?void 0:r.message)||"Holiday not updated successfully")}else{const s=await g.mutateAsync({api:null==(n=e)?void 0:n.createHoliday,data:a});(null==(h=s.data)?void 0:h.success)?l.success(null==(x=null==s?void 0:s.data)?void 0:x.message):l.error((null==(p=s.data)?void 0:p.message)||"Holiday not created successfully"),N.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})}d(!1),m(!1),u()}catch(y){}}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[t.jsx("div",{children:t.jsx(O,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(null==(j=null==(y=null==v?void 0:v.data)?void 0:y.data)?void 0:j.length)?v.data.data.map(e=>({label:String(e.department_name),value:String(e.id)})):[]})}),t.jsx("div",{children:t.jsx(O,{name:"type",data:[{value:"Restricted",label:"Restricted"},{value:"Gazetted",label:"Gazetted"},{value:"Optional",label:"Optional"}]})}),t.jsx("div",{children:t.jsx(C,{name:"holiday_name",placeholder:"Enter Holiday Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),t.jsx("div",{children:t.jsx($,{name:"description",placeholder:"Enter Description"})}),t.jsx("div",{children:t.jsx(C,{name:"date",type:"date",placeholder:"Select Date"})}),!c&&t.jsx("div",{children:t.jsx(C,{name:"days",type:"number",placeholder:"Enter Number of Days"})}),t.jsx(A,{}),t.jsx("div",{children:t.jsx(E,{isLoading:N.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function V(){var n,S,H,_,D,Y;const k=h({}),C=r(),[$,E]=s.useState(1),[O,A]=s.useState(10),[F,I]=s.useState(""),[V,W]=s.useState(!1),[J,Q]=s.useState(""),[K,U]=s.useState(!1),[X,Z]=s.useState(null),[ee,ae]=s.useState(o()),[se,te]=s.useState(""),le=se?`department_id=${a(se)}`:"",ie=x({api:`${e.getAllHolidays}?page=${$}&limit=${O}&q=${F}&${le}`,key:"getAllHolidayList",value:[$,O,se],options:{enabled:!0}}),de=(()=>{const e=ee.clone().startOf("month"),a=ee.clone().endOf("month"),s=e.clone().startOf("week"),t=a.clone().endOf("week"),l=[];let i=s.clone();for(;i.isSameOrBefore(t);)l.push(i.clone()),i.add(1,"day");return l})();return t.jsxs("main",{className:"grid items-start",children:[t.jsx(G,{open:V,setOpen:W,title:K?"Edit Holiday":"Add Holiday",id:J,edit:K,setEdit:U,refetch:ie.refetch}),t.jsxs("div",{className:"grid auto-rows-max items-start gap-6 md:gap-6 lg:col-span-2",children:[t.jsxs("div",{className:"flex flex-col gap-4 rounded-lg bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-600 p-6 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"rounded-full bg-white/20 p-3 backdrop-blur-sm",children:t.jsx(L,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Holiday Calendar"}),t.jsxs("p",{className:"text-sm text-blue-100",children:[(null==(S=null==(n=null==ie?void 0:ie.data)?void 0:n.pagination)?void 0:S.total)||0," holidays scheduled"]})]})]}),t.jsxs(i,{onClick:()=>W(!0),className:"bg-white text-blue-600 hover:bg-blue-50",children:[t.jsx(R,{className:"mr-2 h-4 w-4"}),"Add Holiday"]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{children:t.jsxs(j,{onValueChange:e=>te(e),value:se,children:[t.jsx(v,{className:"w-[180px]",children:t.jsx(g,{placeholder:"Select Department"})}),t.jsx(f,{children:t.jsxs(b,{children:[t.jsx(N,{children:"Select Department"}),(null==(_=null==(H=null==C?void 0:C.data)?void 0:H.data)?void 0:_.length)?C.data.data.map(e=>t.jsx(w,{value:String(e.id),children:e.department_name},e.id)):null]})})]})}),t.jsx(i,{variant:"outline",onClick:()=>{ae(o())},className:"border-white/30 bg-white/10 text-white hover:bg-white/20",children:"Today"})]})]}),t.jsxs(c,{className:"overflow-hidden shadow-xl",children:[t.jsx(m,{className:"border-b bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(i,{variant:"outline",size:"icon",onClick:()=>{ae(ee.clone().subtract(1,"month"))},className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:t.jsx(M,{className:"h-5 w-5"})}),t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:ee.format("MMMM YYYY")}),t.jsx(i,{variant:"outline",size:"icon",onClick:()=>{ae(ee.clone().add(1,"month"))},className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:t.jsx(T,{className:"h-5 w-5"})})]}),t.jsx("div",{className:"text-sm text-gray-600",children:"Week starts on Sunday"})]})}),t.jsx(u,{className:"p-0",children:ie.isLoading?t.jsx("div",{className:"flex h-96 items-center justify-center",children:t.jsx(y,{})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-white",children:[t.jsx("div",{className:"grid grid-cols-7 border-b bg-gray-50",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>t.jsx("div",{className:"border-r p-4 text-center text-sm font-semibold uppercase tracking-wide text-gray-600 last:border-r-0",children:e.slice(0,3)},e))}),t.jsx("div",{className:"grid grid-cols-7",children:de.map((a,s)=>{const i=(r=a,(null==(n=null==ie?void 0:ie.data)?void 0:n.data)?ie.data.data.filter(e=>o(e.date).format("YYYY-MM-DD")===r.format("YYYY-MM-DD")):[]);var r,n;const c=a.month()===ee.month(),m=a.isSame(o(),"day"),u=0===a.day()||6===a.day();return t.jsxs("div",{className:`group relative min-h-32 border-b border-r p-3 transition-all last:border-r-0 ${c?u?"bg-blue-50/30":"bg-white hover:bg-gray-50":"bg-gray-50/50"} ${i.length>0?"bg-gradient-to-br from-blue-50 to-indigo-50":""}`,children:[t.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[t.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full text-sm font-semibold transition-all "+(m?"bg-blue-600 text-white shadow-lg":c?"text-gray-700":"text-gray-400"),children:a.format("D")}),i.length>0&&t.jsx("div",{className:"rounded-full bg-blue-600 px-2 py-0.5 text-xs font-semibold text-white shadow-sm",children:i.length})]}),t.jsx("div",{className:"space-y-1.5",children:i.map(a=>t.jsxs("div",{className:"group/item relative overflow-hidden rounded-lg border border-blue-200 bg-white p-2 shadow-sm transition-all hover:shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"h-2 w-2 rounded-full "+(1==a.status?"bg-green-500":"bg-gray-400")}),t.jsx("h4",{className:"line-clamp-1 text-xs font-semibold text-gray-900",children:a.name})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[t.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:a.type}),a.days>1&&t.jsxs("span",{className:"text-xs text-gray-600",children:[a.days,"d"]})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-1 opacity-0 transition-opacity group-hover/item:opacity-100",children:[t.jsx("button",{onClick:()=>{return e=String(a.id),U(!0),W(!0),void Q(e);var e},className:"flex h-7 w-7 items-center justify-center rounded-md bg-blue-600 text-white shadow-sm transition-all hover:bg-blue-700 hover:shadow-md",title:"Edit Holiday",children:t.jsx(P,{className:"h-3.5 w-3.5"})}),t.jsx("button",{onClick:()=>(async a=>{Z(a),B("Are you sure you want to delete this holiday?","Please confirm",async()=>{var s,t,i;try{const d=await k.mutateAsync({api:`${e.deleteHolidayById}`,data:{id:a}});(null==(s=null==d?void 0:d.data)?void 0:s.success)?(ie.refetch(),l.success(null==(t=null==d?void 0:d.data)?void 0:t.message)):l.error(null==(i=d.data)?void 0:i.message)}catch(r){l.error(d(r))}finally{Z(null)}}),Z(null)})(String(a.id)),disabled:X===String(a.id),className:"flex h-7 w-7 items-center justify-center rounded-md bg-red-600 text-white shadow-sm transition-all hover:bg-red-700 hover:shadow-md disabled:opacity-50",title:"Delete Holiday",children:X===String(a.id)?t.jsx(q,{className:"h-3.5 w-3.5 animate-spin"}):t.jsx(z,{className:"h-3.5 w-3.5"})})]})]}),a.name&&t.jsx("div",{className:"line-clamp-2 text-xs font-semibold text-gray-600",children:a.name}),a.description&&t.jsx("div",{className:"mt-1 line-clamp-2 text-xs text-gray-600",children:a.description})]},a.id))})]},s)})})]}),t.jsx("div",{className:"border-t bg-gray-50 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Showing holidays for ",ee.format("MMMM YYYY")]}),t.jsx(p,{page:$,limit:O,totalPages:null==(Y=null==(D=null==ie?void 0:ie.data)?void 0:D.pagination)?void 0:Y.totalPages,setPage:E,setLimit:A})]})})]})})]})]})]})}function W(){return t.jsx(n,{title:"Holiday List",subTitle:"Manage all the Holidays",children:t.jsx(V,{})})}export{W as default};
