import{h as L,e as ae,r as o,j as e,z as _,B as $}from"./index-Df4ChAN-.js";import{g as se,P as de}from"./index-DjNjGvXo.js";import{C as O,c as Q,a as ne,d as ce,b as oe,h as ie}from"./card-CW8LZ2r1.js";import{S as me,T as xe,a as he,b as k,c as g,d as pe,e as x}from"./index-Tosm5l2v.js";import{S as fe,a as ue,b as je,c as ge,d as _e,e as ye,f as be}from"./select-DZKz6XPY.js";import{u as re,b as te}from"./useCustomQuery-BBKf_waA.js";import{g as we}from"./services-KQnp_8oA.js";import{P as Ne}from"./index-CRGyM8Pm.js";import{S as le,a as ve}from"./Spinner-CyN74T25.js";import{a as Se,o as Ce,c as Fe,b as T,d as W}from"./yup-pPl0eVQc.js";import{F as Te,a as X,L as Z,B as Le}from"./datetime-picker-EqBIIAIP.js";import{R as q}from"./RHFTextField-C5PfVKXx.js";import{R as Pe}from"./RHFTextArea-bqK8EsA9.js";import{R as Ae}from"./RHFSelectField-Cy0QtYHL.js";import{D as Me}from"./index-D4JNSpYb.js";import{B as Be}from"./building-2-C13TmP2w.js";import{P as Ee}from"./plus-BVJr4s_q.js";import{C as ee}from"./calendar-CMNTAmai.js";import{F as Ie}from"./file-text-DUxWW8Vx.js";import{P as $e}from"./pen-Bes7sZ4Y.js";import{L as ke}from"./loader-circle-DH4IlwT9.js";import{T as qe}from"./trash-2-DOuI6ik9.js";import"./check-BzewUJFq.js";import"./clock-BxgzxCOp.js";const Re=Fe().shape({leave_type_name:T().required("Leave type name is required"),max_days_per_year:T().required("Max days per year is required").min(1,"Max days must be at least 1"),carry_forward_allowed:W().required(),max_carry_forward_days:T().when("carry_forward_allowed",{is:!0,then:h=>h.min(0,"Cannot be negative"),otherwise:h=>h.notRequired()}),encashment_allowed:W().required(),description:T(),department_id:T().required("Department ID is required").min(1,"Department ID must be at least 1")});function Ve({open:h,setOpen:p,title:y,id:P,edit:n,setEdit:A,refetch:w}){var N,v,S;const M=re({}),b=se(),{data:r,isFetching:B}=te({api:`${(N=L)==null?void 0:N.getLeaveTypeById}?id=${ae(String(P))}`,key:"getLeaveTypeById",options:{enabled:n}}),d=Se({defaultValues:{leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""},resolver:Ce(Re)}),E=async t=>{var f,s,u,j,i,m,C,F;try{if(n&&t){const l=await M.mutateAsync({api:`${(f=L)==null?void 0:f.updateLeaveTypeById}`,data:{id:P,...t}});(s=l.data)!=null&&s.success?_.success((u=l==null?void 0:l.data)==null?void 0:u.message):_.error(((j=l.data)==null?void 0:j.message)||"Leave type not updated successfully")}else{const l=await M.mutateAsync({api:(i=L)==null?void 0:i.createLeaveType,data:t});(m=l.data)!=null&&m.success?_.success((C=l==null?void 0:l.data)==null?void 0:C.message):_.error(((F=l.data)==null?void 0:F.message)||"Leave type not created successfully"),d.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})}p(!1),A(!1),w()}catch(l){console.log(l)}};return o.useEffect(()=>{var t,f,s,u,j,i,m;n&&r?d.reset({leave_type_name:(t=r==null?void 0:r.data)==null?void 0:t.leave_type_name,max_days_per_year:String((f=r==null?void 0:r.data)==null?void 0:f.max_days_per_year),carry_forward_allowed:(s=r==null?void 0:r.data)==null?void 0:s.carry_forward_allowed,max_carry_forward_days:String((u=r==null?void 0:r.data)==null?void 0:u.max_carry_forward_days),encashment_allowed:(j=r==null?void 0:r.data)==null?void 0:j.encashment_allowed,description:(i=r==null?void 0:r.data)==null?void 0:i.description,department_id:String((m=r==null?void 0:r.data)==null?void 0:m.department_id)}):d.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})},[n,r]),e.jsx(Me,{open:h,setOpen:p,title:y,setEdit:A,edit:n,isLoading:B,children:e.jsx(Te,{methods:d,onSubmit:d.handleSubmit(E),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-400"}),"Department ID"]}),e.jsx(Ae,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(S=(v=b==null?void 0:b.data)==null?void 0:v.data)!=null&&S.length?b.data.data.map(t=>({label:String(t.department_name),value:String(t.id)})):[]})]})}),e.jsx("div",{children:e.jsx(q,{name:"leave_type_name",placeholder:"Enter Leave Type Name",label:"Leave Type Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx("div",{children:e.jsx(q,{name:"max_days_per_year",placeholder:"Enter Max Days",label:"Max Days Per Year",inputValidation:["number"]})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:"carry_forward_allowed",checked:d.watch("carry_forward_allowed"),onCheckedChange:t=>d.setValue("carry_forward_allowed",t)}),e.jsx(Z,{htmlFor:"carry_forward_allowed",className:"text-sm font-medium",children:"Carry Forward Allowed"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:"encashment_allowed",checked:d.watch("encashment_allowed"),onCheckedChange:t=>d.setValue("encashment_allowed",t)}),e.jsx(Z,{htmlFor:"encashment_allowed",className:"text-sm font-medium",children:"Encashment Allowed"})]})]}),d.watch("carry_forward_allowed")&&e.jsx("div",{children:e.jsx(q,{name:"max_carry_forward_days",placeholder:"Enter Max Carry Forward Days",label:"Max Carry Forward Days",inputValidation:["number"]})}),e.jsx("div",{children:e.jsx(Pe,{name:"description",placeholder:"Enter Description",label:"Description"})}),e.jsx(le,{}),e.jsx("div",{children:e.jsx(Le,{isLoading:d.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ye(){var i,m,C,F,l,R,V,Y,H,z,D,G;const h=re({}),p=se(),[y,P]=o.useState(1),[n,A]=o.useState(10),[w,M]=o.useState(""),[b,r]=o.useState(!1),[B,d]=o.useState(""),[E,N]=o.useState(!1),[v,S]=o.useState(null),[t,f]=o.useState(""),s=te({api:`${L.getAllLeaveTypes}?page=${y}&limit=${n}&q=${w}&department_id=${ae(String(t))}`,key:"getAllLeaveTypes",value:[y,n,w,t],options:{enabled:!0}}),u=a=>{N(!0),r(!0),d(a)},j=async a=>{var I,U,J,K;S(a);try{const c=await h.mutateAsync({api:`${(I=L)==null?void 0:I.deleteLeaveTypeById}`,data:{id:B}});(U=c==null?void 0:c.data)!=null&&U.success?(s==null||s.refetch(),_.success((J=c==null?void 0:c.data)==null?void 0:J.message)):_.error((K=c.data)==null?void 0:K.message)}catch(c){_.error(we(c))}finally{S(null)}};return e.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[e.jsx(Ve,{open:b,setOpen:r,title:E?"Edit Leave Type":"Add Leave Type",id:B,edit:E,setEdit:N,refetch:s==null?void 0:s.refetch}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{}),e.jsxs($,{onClick:()=>r(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 shadow-lg shadow-blue-500/30 transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:shadow-blue-500/40",children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Add Leave Type"]})]}),e.jsx(O,{className:"border-slate-200 shadow-sm",children:e.jsx(Q,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"max-w-md flex-1",children:e.jsx(me,{search:w,setSearch:M,refetch:s==null?void 0:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsxs(fe,{onValueChange:a=>f(a),value:t,children:[e.jsx(ue,{className:"w-full bg-white sm:w-[220px]",children:e.jsx(je,{placeholder:"All Departments"})}),e.jsx(ge,{children:e.jsxs(_e,{children:[e.jsx(ye,{children:"Filter by Department"}),(m=(i=p==null?void 0:p.data)==null?void 0:i.data)!=null&&m.length?p.data.data.map(a=>e.jsx(be,{value:String(a.id),children:a.department_name},a.id)):null]})})]})]})})}),e.jsxs(O,{className:"overflow-hidden border-slate-200 shadow-lg",children:[e.jsx(ne,{className:"border-b bg-gradient-to-r from-slate-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ce,{className:"text-xl font-semibold text-slate-900",children:"Leave Types Registry"}),e.jsxs(oe,{className:"mt-1",children:["Total ",((F=(C=s==null?void 0:s.data)==null?void 0:C.pagination)==null?void 0:F.total)||0," leave type(s) configured"]})]}),e.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:e.jsx(ee,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx(Q,{className:"p-0",children:s!=null&&s.isLoading?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ve,{}),e.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Loading leave types..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(xe,{children:[e.jsx(he,{children:e.jsxs(k,{className:"bg-slate-50 hover:bg-slate-50",children:[e.jsx(g,{className:"w-16 font-semibold text-slate-700",children:"#"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Leave Type"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Max Days/Year"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Carry Forward"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Encashment"}),e.jsx(g,{className:"font-semibold text-slate-700",children:"Created Date"}),e.jsx(g,{className:"text-right font-semibold text-slate-700",children:"Actions"})]})}),e.jsxs(pe,{children:[(R=(l=s==null?void 0:s.data)==null?void 0:l.data)==null?void 0:R.map((a,I)=>e.jsxs(k,{className:"border-b border-slate-100 transition-colors hover:bg-slate-50/50",children:[e.jsx(x,{className:"font-medium text-slate-500",children:(y-1)*n+I+1}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"font-semibold text-slate-900",children:a==null?void 0:a.leave_type_name})]}),(a==null?void 0:a.description)&&e.jsx("div",{className:"ml-6 text-sm text-slate-500",children:a==null?void 0:a.description})]})}),e.jsx(x,{children:e.jsxs("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2.5 py-1 text-sm font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:[a==null?void 0:a.max_days_per_year," days"]})}),e.jsx(x,{children:a!=null&&a.carry_forward_allowed?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["Yes (",a==null?void 0:a.max_carry_forward_days," days)"]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("span",{className:"text-sm text-slate-500",children:"No"})]})}),e.jsx(x,{children:a!=null&&a.encashment_allowed?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Allowed"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("span",{className:"text-sm text-slate-500",children:"Not Allowed"})]})}),e.jsx(x,{children:e.jsx("span",{className:"text-sm text-slate-600",children:ie(a==null?void 0:a.created_at).format("DD MMM YYYY")})}),e.jsx(x,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx($,{size:"sm",variant:"outline",onClick:()=>u(String(a==null?void 0:a.id)),className:"h-8 border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700",children:e.jsx($e,{className:"h-3.5 w-3.5"})}),e.jsx($,{size:"sm",variant:"outline",disabled:v===String(a==null?void 0:a.id),onClick:()=>j(String(a==null?void 0:a.id)),className:"h-8 border-red-200 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 disabled:opacity-50",children:v===String(a==null?void 0:a.id)?e.jsx(ke,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(qe,{className:"h-3.5 w-3.5"})})]})})]},a==null?void 0:a.id)),((Y=(V=s==null?void 0:s.data)==null?void 0:V.data)==null?void 0:Y.length)===0&&e.jsx(k,{children:e.jsx(x,{colSpan:7,className:"h-64 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-slate-500",children:[e.jsx(ee,{className:"mb-4 h-12 w-12 text-slate-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No leave types found"}),e.jsx("p",{className:"mt-1 text-sm",children:"Create your first leave type to get started"})]})})})]})]})}),((z=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:z.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"my-4"}),e.jsx("div",{className:"px-6 pb-4",children:e.jsx(Ne,{page:y,limit:n,totalPages:(G=(D=s==null?void 0:s.data)==null?void 0:D.pagination)==null?void 0:G.totalPages,setPage:P,setLimit:A})})]})]})})]})]})]})}function xa(){return e.jsx(de,{title:"Leave Type List",subTitle:"Manage all the Leave Types here",children:e.jsx("div",{children:e.jsx(Ye,{})})})}export{xa as default};
