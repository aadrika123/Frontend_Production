import{h as e,f as t,r as i,j as a,z as l,B as s,e as n}from"./index-CaGgFSeq.js";import{P as r}from"./index-_Ebnz7ZO.js";import{h as o}from"./moment-CBOc1lqT.js";import{C as d,a as c,b as u,c as m}from"./card-DpoqoWLt.js";import{T as f,a as p,b as v,c as j,d as b,e as x}from"./table-Cx7GlPK-.js";import{u as h,b as g}from"./useCustomQuery-kAcgaiYY.js";import{P as S}from"./index-DPZPUd0B.js";import{S as _}from"./separator-BjkNEWW3.js";import{S as y}from"./index-BTP_FOeW.js";import{S as E}from"./Spinner-qexXCl2s.js";import{a as C,o as I,c as N,f as w,b as R}from"./yup-CKEuqCyz.js";import{F as k}from"./datetime-picker-BtprqcV1.js";import{R as A}from"./RHFTextField-DnsEykRH.js";import{B as q}from"./ButtonLoading-B22z2lRV.js";import"./select-CIf9vlQt.js";import"./input-D-UmUPn3.js";import"./switch-Dzwmyki0.js";import"./checkbox-BzF0hRJq.js";import"./label-CInbbuF8.js";import{R as F}from"./DateAndTimePicker-BSsRf7i2.js";import{D as Y}from"./index-atwvxgXU.js";import"./calendar-B5etLz2h.js";import"./format-BkNqQ0tt.js";import"./chevron-right-CSfpr0N3.js";import"./clock-B2whL4Nd.js";import"./check-DrWmecxK.js";const D=N().shape({employee_contribution_rate:w().required("Employee Contribution Rate is required").min(0).max(100),employer_contribution_rate:w().required("Employer Contribution Rate is required").min(0).max(100),wage_ceiling:w().required("Wage Ceiling is required").min(0),effective_from:R().required("Effective From date is required"),effective_to:R().nullable().optional(),status:w().optional()});function P({open:s,setOpen:n,title:r,id:o,edit:d,setEdit:c,refetch:u}){var m;const f=h({}),{data:p,isFetching:v}=g({api:`${null==(m=e)?void 0:m.getESISlabById}?id=${t(String(o))}`,key:"getESISlabById",options:{enabled:d&&!!o}}),j=C({defaultValues:{employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1},resolver:I(D)});return i.useEffect(()=>{var e,t,i,a,l,s;d&&p?j.reset({employee_contribution_rate:Number(null==(e=null==p?void 0:p.data)?void 0:e.employee_contribution_rate)||0,employer_contribution_rate:Number(null==(t=null==p?void 0:p.data)?void 0:t.employer_contribution_rate)||0,wage_ceiling:Number(null==(i=null==p?void 0:p.data)?void 0:i.wage_ceiling)||0,effective_from:(null==(a=null==p?void 0:p.data)?void 0:a.effective_from)||"",effective_to:(null==(l=null==p?void 0:p.data)?void 0:l.effective_to)||null,status:(null==(s=null==p?void 0:p.data)?void 0:s.status)||1}):j.reset({employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1})},[d,p,j]),a.jsx(Y,{open:s,setOpen:n,title:r,setEdit:c,edit:d,isLoading:v,children:a.jsx(k,{methods:j,onSubmit:j.handleSubmit(async t=>{var i,a,s,r,m,p,v,b;try{if(d&&o){const n=await f.mutateAsync({api:null==(i=e)?void 0:i.updateESISlab,data:{id:Number(o),...t}});(null==(a=n.data)?void 0:a.success)?l.success((null==(s=null==n?void 0:n.data)?void 0:s.message)||"ESI Contribution Slab updated successfully"):l.error((null==(r=n.data)?void 0:r.message)||"ESI Contribution Slab not updated successfully")}else{const i=await f.mutateAsync({api:null==(m=e)?void 0:m.createESISlab,data:t});(null==(p=i.data)?void 0:p.success)?l.success((null==(v=null==i?void 0:i.data)?void 0:v.message)||"ESI Contribution Slab created successfully"):l.error((null==(b=i.data)?void 0:b.message)||"ESI Contribution Slab not created successfully")}j.reset({employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1}),n(!1),null==c||c(!1),null==u||u()}catch(x){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(A,{label:"Employee Contribution Rate",name:"employee_contribution_rate",placeholder:"Enter Employee Contribution Rate (%)",type:"number",step:"0.01"})}),a.jsx("div",{children:a.jsx(A,{label:"Employer Contribution Rate",name:"employer_contribution_rate",placeholder:"Enter Employer Contribution Rate (%)",type:"number",step:"0.01"})}),a.jsx("div",{children:a.jsx(A,{label:"Wage Ceiling",name:"wage_ceiling",placeholder:"Enter Wage Ceiling",type:"number"})}),a.jsx("div",{children:a.jsx(F,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),a.jsx("div",{children:a.jsx(F,{name:"effective_to",label:"Effective To (Optional)",placeholder:"Select effective to date"})}),a.jsx(_,{}),a.jsx("div",{children:a.jsx(q,{isLoading:j.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function T(){var t,r,C,I,N,w;const R=h({}),[k,A]=i.useState(1),[q]=i.useState(10),[F,Y]=i.useState(""),[D,T]=i.useState(!1),[$,B]=i.useState(""),[L,M]=i.useState(!1),W=g({api:`${e.getAllESISlabs}?page=${k}&limit=${q}&q=${F}`,key:"getAllESISlabs",value:[k,q,F],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(P,{open:D,setOpen:T,title:L?"Edit ESI Contribution Slab":"Add ESI Contribution Slab",id:$,edit:L,setEdit:M,refetch:W.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(y,{search:F,setSearch:Y,refetch:W.refetch,isFetching:null==W?void 0:W.isLoading})}),a.jsx("div",{children:a.jsx(s,{className:"flex items-center gap-2",onClick:()=>T(!0),children:"Add New"})})]}),a.jsx(_,{}),a.jsxs(d,{children:[a.jsx(c,{children:a.jsx(u,{children:"ESI Contribution Slabs"})}),a.jsx(m,{children:(null==W?void 0:W.isLoading)?a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(E,{})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(f,{children:[a.jsx(p,{children:a.jsxs(v,{children:[a.jsx(j,{children:"Employee Rate (%)"}),a.jsx(j,{children:"Employer Rate (%)"}),a.jsx(j,{children:"Wage Ceiling"}),a.jsx(j,{children:"Effective From"}),a.jsx(j,{children:"Effective To"}),a.jsx(j,{children:"Status"}),a.jsx(j,{children:"Actions"})]})}),a.jsx(b,{children:(null==(t=null==W?void 0:W.data)?void 0:t.data)&&(null==(r=null==W?void 0:W.data)?void 0:r.data.length)>0?null==(C=null==W?void 0:W.data)?void 0:C.data.map(t=>a.jsxs(v,{children:[a.jsxs(x,{children:[t.employee_contribution_rate,"%"]}),a.jsxs(x,{children:[t.employer_contribution_rate,"%"]}),a.jsxs(x,{children:["â‚¹",t.wage_ceiling]}),a.jsx(x,{children:o(t.effective_from).format("DD/MM/YYYY")}),a.jsx(x,{children:t.effective_to?o(t.effective_to).format("DD/MM/YYYY"):"-"}),a.jsx(x,{children:a.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold "+(1===t.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:1===t.status?"Active":"Inactive"})}),a.jsxs(x,{className:"flex gap-2",children:[a.jsx(s,{variant:"outline",size:"sm",onClick:()=>{return e=String(t.id),M(!0),T(!0),void B(e);var e},children:"Edit"}),a.jsx(s,{variant:"destructive",size:"sm",onClick:()=>(async t=>{var i,a,s,r;try{const n=await R.mutateAsync({api:null==(i=e)?void 0:i.deleteESISlab,data:{id:Number(t)}});(null==(a=null==n?void 0:n.data)?void 0:a.success)?(W.refetch(),l.success((null==(s=null==n?void 0:n.data)?void 0:s.message)||"ESI Contribution Slab deleted successfully")):l.error((null==(r=n.data)?void 0:r.message)||"Failed to delete ESI Contribution Slab")}catch(o){l.error(n(o))}})(String(t.id)),children:"Delete"})]})]},t.id)):a.jsx(v,{children:a.jsx(x,{colSpan:7,className:"text-center",children:"No ESI Contribution Slabs found"})})})]})})})]}),(null==(I=null==W?void 0:W.data)?void 0:I.pagination)&&a.jsx(S,{page:k,setPage:A,limit:q,totalPages:(null==(w=null==(N=null==W?void 0:W.data)?void 0:N.pagination)?void 0:w.totalPages)||1})]})]})}function $(){return a.jsx(r,{title:"ESI Contribution Slab",subTitle:"Manage ESI Contribution Slabs",children:a.jsx("div",{className:"py-12",children:a.jsx(T,{})})})}export{$ as default};
