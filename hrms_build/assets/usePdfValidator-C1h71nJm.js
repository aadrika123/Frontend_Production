import{r as e}from"./vendor-RyuIgj66.js";import{c as i,f as a,a as t}from"./yup-CH6wvET8.js";i({name:t().required("Name is required").min(2,"Name must be at least 2 characters"),email:t().required("Email is required").email("Invalid email address"),description:t(),pdfFile:a().required("PDF file is required")});const s=[{name:"JavaScript",pattern:/\/JavaScript|\/JS\s*\(|app\.alert|eval\(|document\.|window\./gi,severity:"high"},{name:"OpenAction",pattern:/\/OpenAction/gi,severity:"high"},{name:"AA (Additional Actions)",pattern:/\/AA\s*<</gi,severity:"high"},{name:"Launch Action",pattern:/\/Launch/gi,severity:"high"},{name:"ImportData",pattern:/\/ImportData/gi,severity:"high"},{name:"RichMedia",pattern:/\/RichMedia/gi,severity:"high"},{name:"GoToE",pattern:/\/GoToE/gi,severity:"high"}],r=e=>({high:3,medium:2,low:1}[e]||0),n=(i={})=>{const a={maxFileSizeMB:10,strictMode:!0,autoValidate:!0,...i},[t,n]=e.useState(null),[l,o]=e.useState(null),[d,h]=e.useState(!1),m=e.useCallback(async e=>{if(h(!0),n(e),!e){const e={isValid:!1,message:"No file provided",threats:[],severity:"high"};return o(e),h(!1),e}if("application/pdf"!==e.type){const i={isValid:!1,message:`Invalid file type. Expected PDF, got ${e.type||"unknown"}`,threats:[{name:"Invalid File Type",severity:"high",description:"Only PDF files are allowed"}],severity:"high"};return o(i),h(!1),i}const i=1024*a.maxFileSizeMB*1024;if(e.size>i){const i={isValid:!1,message:`File size (${(e.size/1024/1024).toFixed(2)}MB) exceeds the maximum limit of ${a.maxFileSizeMB}MB`,threats:[{name:"File Too Large",severity:"medium",description:`File size exceeds ${a.maxFileSizeMB}MB limit`}],severity:"medium"};return o(i),h(!1),i}try{const i=await(e=>new Promise((i,a)=>{const t=new FileReader;t.onload=e=>{var a;return i(null==(a=e.target)?void 0:a.result)},t.onerror=()=>a(new Error("Failed to read file")),t.readAsText(e)}))(e);if(!i.startsWith("%PDF-")){const e={isValid:!1,message:"Invalid PDF file. File does not have a valid PDF header",threats:[{name:"Invalid PDF Format",severity:"high",description:"File does not contain a valid PDF header"}],severity:"high"};return o(e),h(!1),e}const t=[];let n,l=null;if(s.forEach(({name:e,pattern:a,severity:s})=>{const n=i.match(a);n&&n.length>0&&(t.push({name:e,severity:s,description:`Found ${n.length} occurrence(s) of ${e}`,matchCount:n.length}),(!l||r(s)>r(l))&&(l=s))}),0===t.length)n={isValid:!0,message:"PDF is safe and contains no security threats",threats:[],severity:null};else{if(a.strictMode?t.length>0:t.some(e=>"high"===e.severity)){t.map(e=>e.name).join(", ");n={isValid:!1,message:"⚠️The file appears to be corrupted or contains malicious code. Please upload a valid file.",threats:t,severity:l}}else n={isValid:!0,message:"PDF contains low-risk elements but is approved for upload",threats:t,severity:l}}return o(n),h(!1),n}catch(t){const e={isValid:!1,message:`Error reading PDF file: ${t.message}`,threats:[{name:"Read Error",severity:"high",description:t.message}],severity:"high"};return o(e),h(!1),e}},[a.maxFileSizeMB,a.strictMode]),c=e.useCallback(()=>{n(null),o(null),h(!1)},[]),u=e.useCallback(async e=>{var i;const t=null==(i=e.target.files)?void 0:i[0];t&&a.autoValidate?await m(t):t&&n(t)},[m,a.autoValidate]);return{validateFile:m,validation:l,isValidating:d,reset:c,file:t,handleFileChange:u}};export{n as u};
