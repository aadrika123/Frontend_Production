import{h as e,f as i,r as s,j as a,z as t,B as l,e as c}from"./index-BJ2Di0BB.js";import{P as r}from"./index-L2kacWh6.js";import{h as n}from"./moment-CBOc1lqT.js";import{C as d,a as o,b as m,c as u}from"./card-CrOEotWM.js";import{S as f,T as v,a as h,b as j,c as p,d as x,e as y}from"./index-BxKGIMG5.js";import{u as g,b as C}from"./useCustomQuery-DkqDqiry.js";import{P as _}from"./index-DZvdNKxy.js";import{S as A}from"./separator-BtSn9EpY.js";import{S as N}from"./Spinner-DjUjMlqR.js";import{a as R,o as S,c as H,b,f as E}from"./yup-BTlf5Wf5.js";import{F as Y}from"./datetime-picker-cKnQNXMD.js";import{R as F}from"./RHFTextField-BK1QXo_s.js";import{B as k}from"./ButtonLoading-B5GmY3N3.js";import"./select-4D5dQM-6.js";import{R as D}from"./DateAndTimePicker-Bmu_5TYR.js";import{D as q}from"./index-ClKtlEeL.js";import"./calendar-B99NsLtP.js";import"./clock-PqgEqIzL.js";import"./check-DiqtQ1XW.js";const w=H().shape({city_classification:b().required("City Classification is required"),city_name:b().required("City Name is required"),hra_percentage:E().required("HRA Percentage is required").min(0).max(100),effective_from:b().required("Effective From date is required")});function P({open:l,setOpen:c,title:r,id:n,edit:d,setEdit:o,refetch:m}){var u;const f=g({}),{data:v,isFetching:h}=C({api:`${null==(u=e)?void 0:u.getHRACityById}?id=${i(String(n))}`,key:"getHRACityById",options:{enabled:d&&!!n}}),j=R({defaultValues:{city_classification:"",city_name:"",hra_percentage:0,effective_from:""},resolver:S(w)});return s.useEffect(()=>{var e,i,s,a;d&&v?j.reset({city_classification:(null==(e=null==v?void 0:v.data)?void 0:e.city_classification)||"",city_name:(null==(i=null==v?void 0:v.data)?void 0:i.city_name)||"",hra_percentage:Number(null==(s=null==v?void 0:v.data)?void 0:s.hra_percentage)||0,effective_from:(null==(a=null==v?void 0:v.data)?void 0:a.effective_from)||""}):j.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})},[d,v]),a.jsx(q,{open:l,setOpen:c,title:r,setEdit:o,edit:d,isLoading:h,children:a.jsx(Y,{methods:j,onSubmit:j.handleSubmit(async i=>{var s,a,l,r,u,v,h,p;try{if(d&&n){const c=await f.mutateAsync({api:null==(s=e)?void 0:s.updateHRACity,data:{id:Number(n),...i}});(null==(a=c.data)?void 0:a.success)?t.success((null==(l=null==c?void 0:c.data)?void 0:l.message)||"HRA Classification updated successfully"):t.error((null==(r=c.data)?void 0:r.message)||"HRA Classification not updated successfully")}else{const s=await f.mutateAsync({api:null==(u=e)?void 0:u.createHRACity,data:i});(null==(v=s.data)?void 0:v.success)?t.success((null==(h=null==s?void 0:s.data)?void 0:h.message)||"HRA Classification created successfully"):t.error((null==(p=s.data)?void 0:p.message)||"HRA Classification not created successfully"),j.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})}c(!1),o(!1),m()}catch(x){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(F,{name:"city_classification",placeholder:"Enter City Classification (X, Y, Z)",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(F,{name:"city_name",placeholder:"Enter City Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(F,{name:"hra_percentage",placeholder:"Enter HRA Percentage",type:"number"})}),a.jsx("div",{children:a.jsx(D,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),a.jsx(A,{}),a.jsx("div",{children:a.jsx(k,{isLoading:j.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function L(){var i,r,R,S,H,b;const E=g({}),[Y,F]=s.useState(1),[k,D]=s.useState(10),[q,w]=s.useState(""),[L,M]=s.useState(!1),[B,$]=s.useState(""),[T,I]=s.useState(!1),O=C({api:`${e.getAllHRACities}?page=${Y}&limit=${k}&q=${q}`,key:"getAllHRACities",value:[Y,k,q],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(P,{open:L,setOpen:M,title:T?"Edit HRA Classification":"Add HRA Classification",id:B,edit:T,setEdit:I,refetch:O.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(f,{search:q,setSearch:w,refetch:O.refetch,isFetching:null==O?void 0:O.isLoading})}),a.jsx("div",{children:a.jsx(l,{className:"flex items-center gap-2",onClick:()=>M(!0),children:"Add New"})})]}),a.jsxs(d,{children:[a.jsx(o,{className:"px-7",children:a.jsxs(m,{children:["HRA Classification List (",(null==(r=null==(i=null==O?void 0:O.data)?void 0:i.pagination)?void 0:r.total)||0,")"]})}),a.jsx(u,{children:O.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(N,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(v,{children:[a.jsx(h,{children:a.jsxs(j,{children:[a.jsx(p,{className:"",children:"#"}),a.jsx(p,{className:"",children:"City Classification"}),a.jsx(p,{className:"",children:"City Name"}),a.jsx(p,{className:"",children:"HRA %"}),a.jsx(p,{className:"",children:"Effective From"}),a.jsx(p,{className:"",children:"Effective To"}),a.jsx(p,{className:"",children:"Created At"}),a.jsx(p,{children:"Action"})]})}),a.jsx(x,{children:null==(S=null==(R=null==O?void 0:O.data)?void 0:R.data)?void 0:S.map((i,s)=>a.jsxs(j,{children:[a.jsx(y,{children:(Y-1)*k+s+1}),a.jsx(y,{children:null==i?void 0:i.city_classification}),a.jsx(y,{children:null==i?void 0:i.city_name}),a.jsxs(y,{children:[null==i?void 0:i.hra_percentage,"%"]}),a.jsx(y,{children:n(null==i?void 0:i.effective_from).format("DD-MM-YYYY")}),a.jsx(y,{children:(null==i?void 0:i.effective_to)?n(null==i?void 0:i.effective_to).format("DD-MM-YYYY"):"N/A"}),a.jsx(y,{children:n(null==i?void 0:i.created_at).format("DD-MM-YYYY")}),a.jsx(y,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(l,{className:"bg-primary",onClick:()=>{return e=String(null==i?void 0:i.id),I(!0),M(!0),void $(e);var e},children:"Edit"}),a.jsx(l,{variant:"destructive",onClick:()=>(async i=>{var s,a,l,r;try{const c=await E.mutateAsync({api:null==(s=e)?void 0:s.deleteHRACity,data:{id:Number(i)}});(null==(a=null==c?void 0:c.data)?void 0:a.success)?(O.refetch(),t.success((null==(l=null==c?void 0:c.data)?void 0:l.message)||"HRA Classification deleted successfully")):t.error((null==(r=c.data)?void 0:r.message)||"Failed to delete HRA Classification")}catch(n){t.error(c(n))}})(String(null==i?void 0:i.id)),children:"Delete"})]})})]},null==i?void 0:i.id))})]}),a.jsx(A,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(_,{page:Y,limit:k,totalPages:(null==(b=null==(H=null==O?void 0:O.data)?void 0:H.pagination)?void 0:b.totalPages)||1,setPage:F,setLimit:D})})]})})]})]})]})}function M(){return a.jsx(r,{title:"HRA Classification",subTitle:"Manage HRA City Classifications",children:a.jsx("div",{className:"py-12",children:a.jsx(L,{})})})}export{M as default};
