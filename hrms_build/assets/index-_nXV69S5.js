import{aA as e,r as a,j as s,aB as i,al as l,aC as t}from"./vendor-RyuIgj66.js";import{P as d}from"./index-DFF4_m_G.js";import{h as r}from"./moment-CBOc1lqT.js";import{d as n,h as c,e as o,B as u}from"./index-ey2GEmQz.js";import{C as m,a as p,b as x,c as v}from"./card-u7M7FP5y.js";import{T as j,a as y,b as h,c as g,d as f,e as _}from"./table-B_npepsp.js";import{u as b,b as S}from"./useCustomQuery-DTB6aAiD.js";import{S as N}from"./separator-BQijJEjG.js";import{S as P}from"./index-CUStUwt1.js";import{S as L}from"./Spinner-BwGzvoRj.js";import{c as B,e as C}from"./yup-CH6wvET8.js";import{F as E}from"./datetime-picker-dN6E5dqy.js";import{R as M}from"./RHFTextField-BSZ_cEI3.js";import{B as I}from"./ButtonLoading-DDalXO-W.js";import"./select-8PAfYjod.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{D as A}from"./index-B2ia16z0.js";import"./ui-B3c1eQmf.js";import"./icons-CxCh8mm_.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const $=B().shape({cell_index:C().required("Cell Index is required").positive("Cell Index must be positive"),basic_pay:C().required("Basic Pay is required").positive("Basic Pay must be positive")});function w({open:t,setOpen:d,title:r,id:u,edit:m,setEdit:p,empTypeListData:x,payLevelId:v}){var j,y,h,g,f,_;const P=b({}),L=n(String(v)),{data:B,isFetching:C}=S({api:`${null==(j=c)?void 0:j.getPayMatrixById}?id=${o(String(u))}`,key:"getPayMatrixById",options:{enabled:!!m}}),w=(null==x?void 0:x.data)&&(null==(h=null==(y=null==x?void 0:x.data)?void 0:y.data)?void 0:h.length)>0?Math.max(...null==(f=null==(g=null==x?void 0:x.data)?void 0:g.data)?void 0:f.map(e=>null==e?void 0:e.cell_index))+1:1;S({api:`${null==(_=c)?void 0:_.getPayLevelById}?id=${v}`,key:"getPayLevelById",value:[v],options:{enabled:!!v}});const T={pay_level_id:Number(L)||0,cell_index:0,basic_pay:0},k=e({defaultValues:T,resolver:i($)});return a.useEffect(()=>{m&&(null==B?void 0:B.data)?k.reset(B.data):k.reset(T)},[m,B,k]),a.useEffect(()=>{(null==x?void 0:x.data)&&!m&&k.setValue("cell_index",w)},[x,m,w,k]),s.jsx(A,{open:t,setOpen:d,title:r,setEdit:p,edit:m,isLoading:C,children:s.jsx(E,{methods:k,onSubmit:k.handleSubmit(async e=>{var a,s,i,t,r,n,o,v;try{if(m&&e){const d=await P.mutateAsync({api:`${null==(a=c)?void 0:a.updatePayMatrix}`,data:{id:u,pay_level_id:e.pay_level_id,cell_index:e.cell_index,basic_pay:e.basic_pay}});(null==(s=d.data)?void 0:s.success)?l.success(null==(i=null==d?void 0:d.data)?void 0:i.message):l.error((null==(t=d.data)?void 0:t.message)||"Pay Level Cell not updated successfully")}else{const a=await P.mutateAsync({api:null==(r=c)?void 0:r.createPayMatrix,data:{pay_level_id:e.pay_level_id,cell_index:e.cell_index,basic_pay:e.basic_pay}});(null==(n=a.data)?void 0:n.success)?l.success(null==(o=null==a?void 0:a.data)?void 0:o.message):l.error((null==(v=a.data)?void 0:v.message)||"Pay Level Cell not created successfully"),k.reset(T)}d(!1),p(!1),null==x||x.refetch()}catch(j){l.error("An error occurred. Please try again.")}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[s.jsx("input",{type:"hidden",...k.register("pay_level_id"),value:v||""}),s.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[s.jsx(M,{type:"number",label:"Cell Index",name:"cell_index",placeholder:"Enter Cell Index"}),s.jsx(M,{type:"number",name:"basic_pay",label:"Basic Pay",placeholder:"Enter Basic Pay"})]}),s.jsx(N,{}),s.jsx("div",{children:s.jsx(I,{isLoading:k.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function T(){var e,i,l,d;const[n]=t(),o=n.get("pay_level_id");b({});const[B,C]=a.useState(1),[E,M]=a.useState(10),[I,A]=a.useState(""),[$,T]=a.useState(!1),[k,F]=a.useState(""),[q,D]=a.useState(!1),[Y,O]=a.useState(null),R=S({api:`${c.getAllPayMatrix}?pay_level_id=${o}`,key:"getAllPayMatrix",value:[B,E],options:{enabled:!!o}});return s.jsxs("main",{className:"grid items-start",children:[s.jsx(w,{open:$,setOpen:T,title:q?"Edit Employee Type":"Add Employee Type",id:k,edit:q,setEdit:D,empTypeListData:R,payLevelId:o||void 0}),s.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[s.jsxs("div",{className:"flex w-full justify-between gap-2",children:[s.jsx("div",{children:s.jsx(P,{search:I,setSearch:A,refetch:R.refetch,isFetching:null==R?void 0:R.isLoading})}),s.jsx("div",{children:s.jsx(u,{className:"flex items-center gap-2",onClick:()=>T(!0),children:"Add New"})})]}),s.jsxs(m,{children:[s.jsx(p,{className:"px-7",children:s.jsxs(x,{children:["Employee Type List (",(null==(i=null==(e=null==R?void 0:R.data)?void 0:e.data)?void 0:i.length)||0,")"]})}),s.jsx(v,{children:R.isLoading?s.jsx("div",{className:"flex h-32 items-center justify-center",children:s.jsx(L,{})}):s.jsxs(s.Fragment,{children:[s.jsxs(j,{children:[s.jsx(y,{children:s.jsxs(h,{children:[s.jsx(g,{className:"",children:"#"}),s.jsx(g,{className:"",children:"Level"}),s.jsx(g,{className:"",children:"Cell Index"}),s.jsx(g,{className:"",children:"Basic Pay"}),s.jsx(g,{className:"",children:"Created at"}),s.jsx(g,{children:"Action"})]})}),s.jsx(f,{children:null==(d=null==(l=null==R?void 0:R.data)?void 0:l.data)?void 0:d.map((e,a)=>s.jsxs(h,{children:[s.jsx(_,{children:a+1}),s.jsx(_,{children:`Level ${null==e?void 0:e.pay_level_id}`}),s.jsx(_,{children:null==e?void 0:e.cell_index}),s.jsx(_,{children:null==e?void 0:e.basic_pay}),s.jsx(_,{children:r(null==e?void 0:e.created_at).format("DD-MM-YYYY")}),s.jsx(_,{children:s.jsx(u,{className:"bg-primary",onClick:()=>{return a=String(null==e?void 0:e.id),D(!0),T(!0),void F(a);var a},children:"Edit"})})]},null==e?void 0:e.id))})]}),s.jsx(N,{className:"mb-2 mt-4"})]})})]})]})]})}function k(){return s.jsx(d,{title:"Pay Matrix",subTitle:"Manage all the Pay Matrices here",children:s.jsx("div",{className:"py-12",children:s.jsx(T,{})})})}export{k as default};
