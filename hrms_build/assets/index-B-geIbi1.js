import{r as e,aA as a,j as s,aB as t,al as i}from"./vendor-RyuIgj66.js";import{P as r}from"./index-DFF4_m_G.js";import{h as n,e as l,i as o,B as c,g as d}from"./index-ey2GEmQz.js";import{C as m,a as u,b as x,c as j}from"./card-u7M7FP5y.js";import{T as h,a as p,b as g,c as v,d as f,e as b}from"./table-B_npepsp.js";import{u as _,b as S}from"./useCustomQuery-DTB6aAiD.js";import{P as y}from"./index-BHR1l08i.js";import{S as I}from"./separator-BQijJEjG.js";import{S as T}from"./index-CUStUwt1.js";import{S as R}from"./Spinner-BwGzvoRj.js";import{c as F,e as N,a as w}from"./yup-CH6wvET8.js";import{F as A}from"./datetime-picker-dN6E5dqy.js";import{R as E}from"./RHFTextField-BSZ_cEI3.js";import{B as q}from"./ButtonLoading-DDalXO-W.js";import{R as C}from"./RHFSelectField-oISAIiMK.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import{R as $}from"./SelectField-CQPezaQs.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{D as k}from"./index-B2ia16z0.js";import{B}from"./badge-DbWnzWn2.js";import"./ui-B3c1eQmf.js";import"./icons-CxCh8mm_.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";import"./select-8PAfYjod.js";const L=F().shape({financial_year:w().required("Financial Year is required"),regime:w().required("Regime is required").oneOf(["new","old"],"Invalid regime"),income_from:N().required("Income From is required").min(0,"Income From must be 0 or greater"),income_to:N().nullable().min(0,"Income To must be 0 or greater").test("income-to-greater","Income To must be greater than Income From",function(e){const{income_from:a}=this.parent;return null==e||e>a}),tax_rate:N().required("Tax Rate is required").min(0,"Tax Rate must be 0 or greater").max(100,"Tax Rate cannot exceed 100"),surcharge_rate:N().min(0,"Surcharge Rate must be 0 or greater").max(100,"Surcharge Rate cannot exceed 100").optional(),cess_rate:N().min(0,"Cess Rate must be 0 or greater").max(100,"Cess Rate cannot exceed 100").optional(),status:N().optional()});function O({open:r,setOpen:c,title:d,id:m,edit:u,setEdit:x,refetch:j}){var h;const p=_({}),{data:g,isFetching:v}=S({api:`${null==(h=n)?void 0:h.getIncomeTaxSlabById}?id=${l(String(m))}`,key:"getIncomeTaxSlabById",options:{enabled:u}}),f=e.useMemo(()=>{var e,a,s,t,i,r;return{financial_year:(null==(e=null==g?void 0:g.data)?void 0:e.financial_year)||"",regime:(null==(a=null==g?void 0:g.data)?void 0:a.regime)||"new",income_from:(null==(s=null==g?void 0:g.data)?void 0:s.income_from)||0,income_to:(null==(t=null==g?void 0:g.data)?void 0:t.income_to)||null,tax_rate:(null==(i=null==g?void 0:g.data)?void 0:i.tax_rate)?parseFloat(g.data.tax_rate):0,surcharge_rate:0,cess_rate:4,status:(null==(r=null==g?void 0:g.data)?void 0:r.status)||1}},[g]),b=a({defaultValues:f,resolver:t(L)});e.useEffect(()=>{b.reset(f)},[f,b]);return s.jsx(k,{open:r,setOpen:c,title:d,setEdit:x,edit:u,isLoading:v,children:s.jsxs(A,{methods:b,onSubmit:b.handleSubmit(async e=>{var a,s,t,r,l,o,d,h;try{if(u&&m){const l=await p.mutateAsync({api:`${null==(a=n)?void 0:a.updateIncomeTaxSlab}`,data:{id:Number(m),regime:e.regime,financial_year:e.financial_year,income_from:e.income_from,income_to:e.income_to,tax_rate:e.tax_rate,status:e.status}});(null==(s=l.data)?void 0:s.success)?i.success((null==(t=null==l?void 0:l.data)?void 0:t.message)||"Income Tax Slab updated successfully"):i.error((null==(r=l.data)?void 0:r.message)||"Failed to update Income Tax Slab")}else{const a=await p.mutateAsync({api:null==(l=n)?void 0:l.createIncomeTaxSlab,data:{financial_year:e.financial_year,regime:e.regime,income_from:e.income_from,income_to:e.income_to,tax_rate:e.tax_rate,surcharge_rate:e.surcharge_rate||0,cess_rate:e.cess_rate||4}});(null==(o=a.data)?void 0:o.success)?i.success((null==(d=null==a?void 0:a.data)?void 0:d.message)||"Income Tax Slab created successfully"):i.error((null==(h=a.data)?void 0:h.message)||"Failed to create Income Tax Slab"),b.reset({financial_year:"",regime:"new",income_from:0,income_to:null,tax_rate:0,surcharge_rate:0,cess_rate:4,status:1})}c(!1),x(!1),j()}catch(g){i.error("An error occurred")}}),children:[s.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-4",children:[s.jsx("div",{children:s.jsx($,{name:"financial_year",label:"Financial Year",data:o.map(e=>({label:e,value:e}))})}),s.jsx("div",{children:s.jsx(C,{name:"regime",label:"Regime",data:[{label:"New Regime",value:"new"},{label:"Old Regime",value:"old"}]})}),s.jsx("div",{children:s.jsx(E,{name:"income_from",placeholder:"Enter Income From",label:"Income From",type:"number"})}),s.jsx("div",{children:s.jsx(E,{name:"income_to",placeholder:"Enter Income To (Leave empty for above)",label:"Income To",type:"number"})}),s.jsx("div",{children:s.jsx(E,{name:"tax_rate",placeholder:"Enter Tax Rate (%)",label:"Tax Rate (%)",type:"number"})}),!u&&s.jsxs(s.Fragment,{children:[s.jsx("div",{children:s.jsx(E,{name:"surcharge_rate",placeholder:"Enter Surcharge Rate (%)",label:"Surcharge Rate (%)",type:"number"})}),s.jsx("div",{children:s.jsx(E,{name:"cess_rate",placeholder:"Enter Cess Rate (%)",label:"Cess Rate (%)",type:"number"})})]})]}),s.jsx(I,{}),s.jsx("div",{children:s.jsx(q,{isLoading:b.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:u?"Update":"Create"})})]})})}function P(){var a,t,r,l,o,F;const N=_({}),[w,A]=e.useState(1),[E]=e.useState(10),[q,C]=e.useState(""),[$,k]=e.useState(!1),[L,P]=e.useState(""),[z,D]=e.useState(!1),Y=S({api:`${n.getAllIncomeTaxSlabs}?page=${w}&limit=${E}&q=${q}`,key:"getAllIncomeTaxSlabs",value:[w,E,q],options:{enabled:!0}}),H=e=>null===e?"Above":`â‚¹${e.toLocaleString("en-IN")}`;return s.jsxs("main",{className:"grid items-start",children:[s.jsx(O,{open:$,setOpen:k,title:z?"Edit Income Tax Slab":"Add Income Tax Slab",id:L,edit:z,setEdit:D,refetch:Y.refetch}),s.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[s.jsxs("div",{className:"flex w-full justify-between gap-2",children:[s.jsx("div",{children:s.jsx(T,{search:q,setSearch:C,refetch:Y.refetch,isFetching:null==Y?void 0:Y.isLoading})}),s.jsx("div",{className:"flex gap-2",children:s.jsx(c,{className:"flex items-center gap-2",onClick:()=>k(!0),children:"Add New"})})]}),s.jsx(I,{}),s.jsxs(m,{children:[s.jsx(u,{children:s.jsx(x,{children:"Income Tax Slabs"})}),s.jsx(j,{children:(null==Y?void 0:Y.isLoading)?s.jsx("div",{className:"flex items-center justify-center",children:s.jsx(R,{})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(h,{children:[s.jsx(p,{children:s.jsxs(g,{children:[s.jsx(v,{children:"#"}),s.jsx(v,{children:"Financial Year"}),s.jsx(v,{children:"Regime"}),s.jsx(v,{children:"Income From"}),s.jsx(v,{children:"Income To"}),s.jsx(v,{children:"Tax Rate (%)"}),s.jsx(v,{children:"Description"}),s.jsx(v,{children:"Status"}),s.jsx(v,{children:"Actions"})]})}),s.jsx(f,{children:(null==(a=null==Y?void 0:Y.data)?void 0:a.data)&&(null==(t=null==Y?void 0:Y.data)?void 0:t.data.length)>0?null==(r=null==Y?void 0:Y.data)?void 0:r.data.map((e,a)=>s.jsxs(g,{children:[s.jsx(b,{children:a+1}),s.jsx(b,{className:"font-medium",children:e.financial_year}),s.jsx(b,{children:s.jsx(B,{variant:"new"===e.regime?"default":"secondary",children:"new"===e.regime?"New Regime":"Old Regime"})}),s.jsx(b,{children:H(e.income_from)}),s.jsx(b,{children:H(e.income_to)}),s.jsxs(b,{children:[e.tax_rate,"%"]}),s.jsx(b,{children:e.description}),s.jsx(b,{children:s.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold "+(1===e.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:1===e.status?"Active":"Inactive"})}),s.jsxs(b,{className:"flex gap-2",children:[s.jsx(c,{variant:"outline",size:"sm",onClick:()=>{return a=String(e.id),D(!0),k(!0),void P(a);var a},children:"Edit"}),s.jsx(c,{variant:"destructive",size:"sm",onClick:()=>(async e=>{var a,s,t,r;try{const l=await N.mutateAsync({api:null==(a=n)?void 0:a.deleteIncomeTaxSlab,data:{id:Number(e)}});(null==(s=null==l?void 0:l.data)?void 0:s.success)?(Y.refetch(),i.success((null==(t=null==l?void 0:l.data)?void 0:t.message)||"Income Tax Slab deleted successfully")):i.error((null==(r=l.data)?void 0:r.message)||"Failed to delete Income Tax Slab")}catch(l){i.error(d(l))}})(String(e.id)),children:"Delete"})]})]},e.id)):s.jsx(g,{children:s.jsx(b,{colSpan:9,className:"text-center",children:"No Income Tax Slabs found"})})})]})})})]}),(null==(l=null==Y?void 0:Y.data)?void 0:l.pagination)&&s.jsx(y,{page:w,setPage:A,limit:E,totalPages:(null==(F=null==(o=null==Y?void 0:Y.data)?void 0:o.pagination)?void 0:F.totalPages)||1})]})]})}function z(){return s.jsx(r,{title:"Income Tax Slab",subTitle:"Manage Income Tax Slabs",children:s.jsx("div",{className:"py-12",children:s.jsx(P,{})})})}export{z as default};
