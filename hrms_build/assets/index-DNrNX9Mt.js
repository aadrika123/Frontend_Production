import{i as J,h as M,e as K,r as h,j as e,_ as j,B as I}from"./index-BBv-jxBe.js";import{b as Q,P as re}from"./index-BSKmHp5D.js";import{S as ie,h as E,C as le,a as ne,c as de,d as oe}from"./Spinner-C_5aFvoA.js";import{u as X,b as Z}from"./useCustomQuery-DnwWmgzu.js";import{g as ce}from"./services-KQnp_8oA.js";import{P as me}from"./index-BJ8zQrhn.js";import{F as he,a as U,R as O,B as xe,S as ue,b as pe,c as ge,d as ye,f as fe,g as be,e as je}from"./label-NZF332sR.js";import{a as ve,o as we,c as Ne,b as C,d as Se}from"./yup-BufIYiSe.js";import{R as He}from"./RHFTextArea-YunceHYR.js";import"./input-SE5cd0iG.js";import{D as Ce,L as Me}from"./index-CuIam2nO.js";import{C as _e}from"./calendar-CNgLaRc4.js";import{P as ke}from"./plus-DBHol04b.js";import{C as De}from"./chevron-right-pHfF6_2z.js";import{T as $e}from"./trash-2-BfTOG4Nm.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=J("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Te=Ne().shape({type:C().required().label("Type"),holiday_name:C().required().label("Holiday Name"),description:C().required().label("Description"),date:C().required().label("Date"),days:Se().optional().positive().label("Days"),department_id:C().required().label("Department")});function Fe({open:A,setOpen:p,title:v,id:_,edit:o,setEdit:k,refetch:B}){var N,S,c;const w=Q(),D=X({}),{data:t,isFetching:L}=Z({api:`${(N=M)==null?void 0:N.getHolidayById}?id=${K(String(_))}`,key:"getHolidayById",options:{enabled:o}}),u=ve({defaultValues:{type:"",holiday_name:"",description:"",date:"",days:1,department_id:""},resolver:we(Te)}),$=async l=>{var m,g,y,a,f,Y,T,F;try{if(o&&l){const r=await D.mutateAsync({api:`${(m=M)==null?void 0:m.updateHolidayById}`,data:{id:_,...l}});(g=r.data)!=null&&g.success?j.success((y=r==null?void 0:r.data)==null?void 0:y.message):j.error(((a=r.data)==null?void 0:a.message)||"Holiday not updated successfully")}else{const r=await D.mutateAsync({api:(f=M)==null?void 0:f.createHoliday,data:l});(Y=r.data)!=null&&Y.success?j.success((T=r==null?void 0:r.data)==null?void 0:T.message):j.error(((F=r.data)==null?void 0:F.message)||"Holiday not created successfully"),u.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})}p(!1),k(!1),B()}catch(r){console.log(r)}};h.useEffect(()=>{var l,m,g,y,a,f;o&&t?u.reset({type:String((l=t==null?void 0:t.data)==null?void 0:l.type),holiday_name:(m=t==null?void 0:t.data)==null?void 0:m.holiday_name,description:(g=t==null?void 0:t.data)==null?void 0:g.description,date:(y=t==null?void 0:t.data)==null?void 0:y.date,days:(a=t==null?void 0:t.data)==null?void 0:a.days,department_id:String((f=t==null?void 0:t.data)==null?void 0:f.department_id)}):u.reset({type:"",holiday_name:"",description:"",date:"",days:1,department_id:""})},[o,t]);const P=[{value:"Restricted",label:"Restricted"},{value:"Gazetted",label:"Gazetted"},{value:"Optional",label:"Optional"}];return e.jsx(Ce,{open:A,setOpen:p,title:v,setEdit:k,edit:o,isLoading:L,children:e.jsx(he,{methods:u,onSubmit:u.handleSubmit($),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(U,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(c=(S=w==null?void 0:w.data)==null?void 0:S.data)!=null&&c.length?w.data.data.map(l=>({label:String(l.department_name),value:String(l.id)})):[]})}),e.jsx("div",{children:e.jsx(U,{name:"type",data:P})}),e.jsx("div",{children:e.jsx(O,{name:"holiday_name",placeholder:"Enter Holiday Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx("div",{children:e.jsx(He,{name:"description",placeholder:"Enter Description"})}),e.jsx("div",{children:e.jsx(O,{name:"date",type:"date",placeholder:"Select Date"})}),!o&&e.jsx("div",{children:e.jsx(O,{name:"days",type:"number",placeholder:"Enter Number of Days"})}),e.jsx(ie,{}),e.jsx("div",{children:e.jsx(xe,{isLoading:u.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ie(){var R,q,z,V,G,W;const A=X({}),p=Q(),[v,_]=h.useState(1),[o,k]=h.useState(10),[B,w]=h.useState(""),[D,t]=h.useState(!1),[L,u]=h.useState(""),[$,P]=h.useState(!1),[N,S]=h.useState(null),[c,l]=h.useState(E()),[m,g]=h.useState(""),y=m?`department_id=${K(m)}`:"",a=Z({api:`${M.getAllHolidays}?page=${v}&limit=${o}&q=${B}&${y}`,key:"getAllHolidayList",value:[v,o,m],options:{enabled:!0}}),f=s=>{P(!0),t(!0),u(s)},Y=async s=>{var x,d,b;S(s);try{const i=await A.mutateAsync({api:`${M.deleteHolidayById}`,data:{id:s}});(x=i==null?void 0:i.data)!=null&&x.success?(a.refetch(),j.success((d=i==null?void 0:i.data)==null?void 0:d.message)):j.error((b=i.data)==null?void 0:b.message)}catch(i){j.error(ce(i))}finally{S(null)}},T=()=>{const s=c.clone().startOf("month"),x=c.clone().endOf("month"),d=s.clone().startOf("week"),b=x.clone().endOf("week"),i=[];let H=d.clone();for(;H.isSameOrBefore(b);)i.push(H.clone()),H.add(1,"day");return i},F=s=>{var x;return(x=a==null?void 0:a.data)!=null&&x.data?a.data.data.filter(d=>E(d.date).format("YYYY-MM-DD")===s.format("YYYY-MM-DD")):[]},r=()=>{l(c.clone().subtract(1,"month"))},ee=()=>{l(c.clone().add(1,"month"))},te=()=>{l(E())},se=T(),ae=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e.jsxs("main",{className:"grid items-start",children:[e.jsx(Fe,{open:D,setOpen:t,title:$?"Edit Holiday":"Add Holiday",id:L,edit:$,setEdit:P,refetch:a.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-6 md:gap-6 lg:col-span-2",children:[e.jsxs("div",{className:"flex flex-col gap-4 rounded-lg bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-600 p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-white/20 p-3 backdrop-blur-sm",children:e.jsx(_e,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Holiday Calendar"}),e.jsxs("p",{className:"text-sm text-blue-100",children:[((q=(R=a==null?void 0:a.data)==null?void 0:R.pagination)==null?void 0:q.total)||0," holidays scheduled"]})]})]}),e.jsxs(I,{onClick:()=>t(!0),className:"bg-white text-blue-600 hover:bg-blue-50",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Add Holiday"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs(ue,{onValueChange:s=>g(s),value:m,children:[e.jsx(pe,{className:"w-[180px]",children:e.jsx(ge,{placeholder:"Select Department"})}),e.jsx(ye,{children:e.jsxs(fe,{children:[e.jsx(be,{children:"Select Department"}),(V=(z=p==null?void 0:p.data)==null?void 0:z.data)!=null&&V.length?p.data.data.map(s=>e.jsx(je,{value:String(s.id),children:s.department_name},s.id)):null]})})]})}),e.jsx(I,{variant:"outline",onClick:te,className:"border-white/30 bg-white/10 text-white hover:bg-white/20",children:"Today"})]})]}),e.jsxs(le,{className:"overflow-hidden shadow-xl",children:[e.jsx(ne,{className:"border-b bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{variant:"outline",size:"icon",onClick:r,className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:e.jsx(Pe,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:c.format("MMMM YYYY")}),e.jsx(I,{variant:"outline",size:"icon",onClick:ee,className:"h-10 w-10 rounded-full hover:bg-blue-50 hover:text-blue-600",children:e.jsx(De,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Week starts on Sunday"})]})}),e.jsx(de,{className:"p-0",children:a.isLoading?e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white",children:[e.jsx("div",{className:"grid grid-cols-7 border-b bg-gray-50",children:ae.map(s=>e.jsx("div",{className:"border-r p-4 text-center text-sm font-semibold uppercase tracking-wide text-gray-600 last:border-r-0",children:s.slice(0,3)},s))}),e.jsx("div",{className:"grid grid-cols-7",children:se.map((s,x)=>{const d=F(s),b=s.month()===c.month(),i=s.isSame(E(),"day"),H=s.day()===0||s.day()===6;return e.jsxs("div",{className:`group relative min-h-32 border-b border-r p-3 transition-all last:border-r-0 ${b?H?"bg-blue-50/30":"bg-white hover:bg-gray-50":"bg-gray-50/50"} ${d.length>0?"bg-gradient-to-br from-blue-50 to-indigo-50":""}`,children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-sm font-semibold transition-all ${i?"bg-blue-600 text-white shadow-lg":b?"text-gray-700":"text-gray-400"}`,children:s.format("D")}),d.length>0&&e.jsx("div",{className:"rounded-full bg-blue-600 px-2 py-0.5 text-xs font-semibold text-white shadow-sm",children:d.length})]}),e.jsx("div",{className:"space-y-1.5",children:d.map(n=>e.jsxs("div",{className:"group/item relative overflow-hidden rounded-lg border border-blue-200 bg-white p-2 shadow-sm transition-all hover:shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${n.status==1?"bg-green-500":"bg-gray-400"}`}),e.jsx("h4",{className:"line-clamp-1 text-xs font-semibold text-gray-900",children:n.holiday_name})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:n.type}),n.days>1&&e.jsxs("span",{className:"text-xs text-gray-600",children:[n.days,"d"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 opacity-0 transition-opacity group-hover/item:opacity-100",children:[e.jsx("button",{onClick:()=>f(String(n.id)),className:"flex h-7 w-7 items-center justify-center rounded-md bg-blue-600 text-white shadow-sm transition-all hover:bg-blue-700 hover:shadow-md",title:"Edit Holiday",children:e.jsx(Ye,{className:"h-3.5 w-3.5"})}),e.jsx("button",{onClick:()=>Y(String(n.id)),disabled:N===String(n.id),className:"flex h-7 w-7 items-center justify-center rounded-md bg-red-600 text-white shadow-sm transition-all hover:bg-red-700 hover:shadow-md disabled:opacity-50",title:"Delete Holiday",children:N===String(n.id)?e.jsx(Me,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx($e,{className:"h-3.5 w-3.5"})})]})]}),n.description&&e.jsx("div",{className:"mt-1 line-clamp-2 text-xs text-gray-600",children:n.description})]},n.id))})]},x)})})]}),e.jsx("div",{className:"border-t bg-gray-50 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing holidays for ",c.format("MMMM YYYY")]}),e.jsx(me,{page:v,limit:o,totalPages:(W=(G=a==null?void 0:a.data)==null?void 0:G.pagination)==null?void 0:W.totalPages,setPage:_,setLimit:k})]})})]})})]})]})]})}function Xe(){return e.jsx(re,{title:"Holiday List",subTitle:"Manage all the Holidays",children:e.jsx(Ie,{})})}export{Xe as default};
