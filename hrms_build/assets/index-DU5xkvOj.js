import{h as e,f as i,r as s,j as a,z as t,B as l,e as c}from"./index-C0dR7KKl.js";import{P as r}from"./index-DLwgcCrU.js";import{h as n}from"./moment-CBOc1lqT.js";import{C as d,a as o,b as m,c as u}from"./card-dfHK731x.js";import{T as f,a as j,b as v,c as h,d as p,e as x}from"./table-DGsqq0wP.js";import{u as g,b as y}from"./useCustomQuery-DfubPPhS.js";import{P as C}from"./index-CtQoh3RB.js";import{S as _}from"./separator-DK9wbIss.js";import{S as A}from"./index-DxKRME66.js";import{S as N}from"./Spinner-Bh5S-NfG.js";import{a as R,o as S,c as b,b as H,f as E}from"./yup-D-4eAt9F.js";import{F as Y}from"./datetime-picker-Chw5tpGr.js";import{R as k}from"./RHFTextField-Bf4PLUtQ.js";import{B as w}from"./ButtonLoading-CtnN6-Kp.js";import"./select-PSqof_An.js";import"./input-5m-sj67D.js";import"./switch-DfyNgsks.js";import"./checkbox-5PN_yyUS.js";import"./label-BBEmak6c.js";import{R as F}from"./DateAndTimePicker-CIIj3P6-.js";import{D as q}from"./index-Bak7Z6rK.js";import"./calendar-D3nBqMDA.js";import"./chevron-right-ZD98JKF5.js";import"./clock-zyZI13Cr.js";import"./check-DJnOI1b1.js";const D=b().shape({city_classification:H().required("City Classification is required"),city_name:H().required("City Name is required"),hra_percentage:E().required("HRA Percentage is required").min(0).max(100),effective_from:H().required("Effective From date is required")});function P({open:l,setOpen:c,title:r,id:n,edit:d,setEdit:o,refetch:m}){var u;const f=g({}),{data:j,isFetching:v}=y({api:`${null==(u=e)?void 0:u.getHRACityById}?id=${i(String(n))}`,key:"getHRACityById",options:{enabled:d&&!!n}}),h=R({defaultValues:{city_classification:"",city_name:"",hra_percentage:0,effective_from:""},resolver:S(D)});return s.useEffect(()=>{var e,i,s,a;d&&j?h.reset({city_classification:(null==(e=null==j?void 0:j.data)?void 0:e.city_classification)||"",city_name:(null==(i=null==j?void 0:j.data)?void 0:i.city_name)||"",hra_percentage:Number(null==(s=null==j?void 0:j.data)?void 0:s.hra_percentage)||0,effective_from:(null==(a=null==j?void 0:j.data)?void 0:a.effective_from)||""}):h.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})},[d,j]),a.jsx(q,{open:l,setOpen:c,title:r,setEdit:o,edit:d,isLoading:v,children:a.jsx(Y,{methods:h,onSubmit:h.handleSubmit(async i=>{var s,a,l,r,u,j,v,p;try{if(d&&n){const c=await f.mutateAsync({api:null==(s=e)?void 0:s.updateHRACity,data:{id:Number(n),...i}});(null==(a=c.data)?void 0:a.success)?t.success((null==(l=null==c?void 0:c.data)?void 0:l.message)||"HRA Classification updated successfully"):t.error((null==(r=c.data)?void 0:r.message)||"HRA Classification not updated successfully")}else{const s=await f.mutateAsync({api:null==(u=e)?void 0:u.createHRACity,data:i});(null==(j=s.data)?void 0:j.success)?t.success((null==(v=null==s?void 0:s.data)?void 0:v.message)||"HRA Classification created successfully"):t.error((null==(p=s.data)?void 0:p.message)||"HRA Classification not created successfully"),h.reset({city_classification:"",city_name:"",hra_percentage:0,effective_from:""})}c(!1),o(!1),m()}catch(x){}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(k,{name:"city_classification",placeholder:"Enter City Classification (X, Y, Z)",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(k,{name:"city_name",placeholder:"Enter City Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),a.jsx("div",{children:a.jsx(k,{name:"hra_percentage",placeholder:"Enter HRA Percentage",type:"number"})}),a.jsx("div",{children:a.jsx(F,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),a.jsx(_,{}),a.jsx("div",{children:a.jsx(w,{isLoading:h.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function M(){var i,r,R,S,b,H;const E=g({}),[Y,k]=s.useState(1),[w,F]=s.useState(10),[q,D]=s.useState(""),[M,L]=s.useState(!1),[$,T]=s.useState(""),[B,O]=s.useState(!1),V=y({api:`${e.getAllHRACities}?page=${Y}&limit=${w}&q=${q}`,key:"getAllHRACities",value:[Y,w,q],options:{enabled:!0}});return a.jsxs("main",{className:"grid items-start",children:[a.jsx(P,{open:M,setOpen:L,title:B?"Edit HRA Classification":"Add HRA Classification",id:$,edit:B,setEdit:O,refetch:V.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(A,{search:q,setSearch:D,refetch:V.refetch,isFetching:null==V?void 0:V.isLoading})}),a.jsx("div",{children:a.jsx(l,{className:"flex items-center gap-2",onClick:()=>L(!0),children:"Add New"})})]}),a.jsxs(d,{children:[a.jsx(o,{className:"px-7",children:a.jsxs(m,{children:["HRA Classification List (",(null==(r=null==(i=null==V?void 0:V.data)?void 0:i.pagination)?void 0:r.total)||0,")"]})}),a.jsx(u,{children:V.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(N,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(f,{children:[a.jsx(j,{children:a.jsxs(v,{children:[a.jsx(h,{className:"",children:"#"}),a.jsx(h,{className:"",children:"City Classification"}),a.jsx(h,{className:"",children:"City Name"}),a.jsx(h,{className:"",children:"HRA %"}),a.jsx(h,{className:"",children:"Effective From"}),a.jsx(h,{className:"",children:"Effective To"}),a.jsx(h,{className:"",children:"Created At"}),a.jsx(h,{children:"Action"})]})}),a.jsx(p,{children:null==(S=null==(R=null==V?void 0:V.data)?void 0:R.data)?void 0:S.map((i,s)=>a.jsxs(v,{children:[a.jsx(x,{children:(Y-1)*w+s+1}),a.jsx(x,{children:null==i?void 0:i.city_classification}),a.jsx(x,{children:null==i?void 0:i.city_name}),a.jsxs(x,{children:[null==i?void 0:i.hra_percentage,"%"]}),a.jsx(x,{children:n(null==i?void 0:i.effective_from).format("DD-MM-YYYY")}),a.jsx(x,{children:(null==i?void 0:i.effective_to)?n(null==i?void 0:i.effective_to).format("DD-MM-YYYY"):"N/A"}),a.jsx(x,{children:n(null==i?void 0:i.created_at).format("DD-MM-YYYY")}),a.jsx(x,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(l,{className:"bg-primary",onClick:()=>{return e=String(null==i?void 0:i.id),O(!0),L(!0),void T(e);var e},children:"Edit"}),a.jsx(l,{variant:"destructive",onClick:()=>(async i=>{var s,a,l,r;try{const c=await E.mutateAsync({api:null==(s=e)?void 0:s.deleteHRACity,data:{id:Number(i)}});(null==(a=null==c?void 0:c.data)?void 0:a.success)?(V.refetch(),t.success((null==(l=null==c?void 0:c.data)?void 0:l.message)||"HRA Classification deleted successfully")):t.error((null==(r=c.data)?void 0:r.message)||"Failed to delete HRA Classification")}catch(n){t.error(c(n))}})(String(null==i?void 0:i.id)),children:"Delete"})]})})]},null==i?void 0:i.id))})]}),a.jsx(_,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(C,{page:Y,limit:w,totalPages:(null==(H=null==(b=null==V?void 0:V.data)?void 0:b.pagination)?void 0:H.totalPages)||1,setPage:k,setLimit:F})})]})})]})]})]})}function L(){return a.jsx(r,{title:"HRA Classification",subTitle:"Manage HRA City Classifications",children:a.jsx("div",{className:"py-12",children:a.jsx(M,{})})})}export{L as default};
