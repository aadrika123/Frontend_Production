import{aA as e,r as s,j as t,aB as a,al as i}from"./vendor-RyuIgj66.js";import{P as l}from"./index-DFF4_m_G.js";import{h as n}from"./moment-CBOc1lqT.js";import{h as r,e as d,B as o,g as m}from"./index-ey2GEmQz.js";import{C as c,a as u,b as p,c as j}from"./card-u7M7FP5y.js";import{T as x,a as h,b as v,c as g,d as f,e as y}from"./table-B_npepsp.js";import{u as S,b}from"./useCustomQuery-DTB6aAiD.js";import{P as N}from"./index-BHR1l08i.js";import{S as D}from"./separator-BQijJEjG.js";import{S as w}from"./index-CUStUwt1.js";import{S as E}from"./Spinner-BwGzvoRj.js";import{c as M,a as _}from"./yup-CH6wvET8.js";import{F as A}from"./datetime-picker-dN6E5dqy.js";import{R as $}from"./RHFTextField-BSZ_cEI3.js";import{B as k}from"./ButtonLoading-DDalXO-W.js";import"./select-8PAfYjod.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{D as L}from"./index-B2ia16z0.js";import{q as B}from"./icons-CxCh8mm_.js";import{t as C}from"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const F=M().shape({department_name:_().required("Department is required")});function q({open:l,setOpen:n,title:o,id:m,edit:c,setEdit:u,refetch:p}){var j;const x=S({}),{data:h,isFetching:v}=b({api:`${null==(j=r)?void 0:j.getDepartmentMstrById}/${d(String(m))}`,key:"getDepartmentMstrById",options:{enabled:c}}),g=e({defaultValues:{department_name:""},resolver:a(F)});return s.useEffect(()=>{var e;c&&h?g.reset({department_name:null==(e=null==h?void 0:h.data)?void 0:e.department_name}):g.reset({department_name:""})},[c,h]),t.jsx(L,{open:l,setOpen:n,title:o,setEdit:u,edit:c,isLoading:v,children:t.jsx(A,{methods:g,onSubmit:g.handleSubmit(async e=>{var s,t,a,l,o,j,h,v;try{if(c&&e){const n=await x.mutateAsync({api:`${null==(s=r)?void 0:s.updateDEpartmentMstrById}`,data:{id:d(String(m)),...e}});(null==(t=n.data)?void 0:t.success)?i.success(null==(a=null==n?void 0:n.data)?void 0:a.message):i.error((null==(l=n.data)?void 0:l.message)||"Department not updated successfully")}else{const s=await x.mutateAsync({api:null==(o=r)?void 0:o.createDepartmentMstr,data:e});(null==(j=s.data)?void 0:j.success)?i.success(null==(h=null==s?void 0:s.data)?void 0:h.message):i.error((null==(v=s.data)?void 0:v.message)||"Department not created successfully"),g.reset({department_name:""})}n(!1),u(!1),p()}catch(f){}}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[t.jsx("div",{children:t.jsx($,{name:"department_name",placeholder:"Enter Department",inputValidation:["removeSpecialCharacterExceptSpace"]})}),t.jsx(D,{}),t.jsx("div",{children:t.jsx(k,{isLoading:g.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function P(){var e,a,l,M,_,A;const $=S({}),[k,L]=s.useState(1),[F,P]=s.useState(10),[T,Y]=s.useState(""),[I,O]=s.useState(!1),[R,V]=s.useState(""),[z,H]=s.useState(!1),[Q,Z]=s.useState(null),G=b({api:`${r.getAllDepartmentMstr}?page=${k}&limit=${F}&q=${T}`,key:"getAllDepartmentMstr",value:[k,F],options:{enabled:!0}});return t.jsxs("main",{className:"grid items-start",children:[t.jsx(q,{open:I,setOpen:O,title:z?"Edit Employee Type":"Add Employee Type",id:R,edit:z,setEdit:H,refetch:null==G?void 0:G.refetch}),t.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[t.jsxs("div",{className:"flex w-full justify-between gap-2",children:[t.jsx("div",{children:t.jsx(w,{search:T,setSearch:Y,refetch:null==G?void 0:G.refetch,isFetching:null==G?void 0:G.isLoading})}),t.jsx("div",{children:t.jsx(o,{className:"flex items-center gap-2",onClick:()=>O(!0),children:"Add New"})})]}),t.jsxs(c,{children:[t.jsx(u,{className:"px-7",children:t.jsxs(p,{children:["Department List (",null==(a=null==(e=null==G?void 0:G.data)?void 0:e.pagination)?void 0:a.total,")"]})}),t.jsx(j,{children:(null==G?void 0:G.isLoading)?t.jsx("div",{className:"flex h-32 items-center justify-center",children:t.jsx(E,{})}):t.jsxs(t.Fragment,{children:[t.jsxs(x,{children:[t.jsx(h,{children:t.jsxs(v,{children:[t.jsx(g,{className:"",children:"#"}),t.jsx(g,{className:"",children:"Department"}),t.jsx(g,{className:"",children:"Created at"}),t.jsx(g,{className:"",children:"Status"}),t.jsx(g,{children:"Action"})]})}),t.jsx(f,{children:null==(M=null==(l=null==G?void 0:G.data)?void 0:l.data)?void 0:M.map((e,s)=>t.jsxs(v,{children:[t.jsx(y,{children:s+1}),t.jsx(y,{children:null==e?void 0:e.department_name}),t.jsx(y,{children:n(null==e?void 0:e.created_at).format("DD-MM-YYYY")}),t.jsx(y,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(C,{checked:1==(null==e?void 0:e.status),onChange:()=>(async e=>{var s,t,a,l;Z(e);try{const n=await $.mutateAsync({api:`${null==(s=r)?void 0:s.toggleDepartmentMstr}`,data:{id:d(String(e))}});(null==(t=null==n?void 0:n.data)?void 0:t.success)?(null==G||G.refetch(),i.success(null==(a=null==n?void 0:n.data)?void 0:a.message)):i.error(null==(l=n.data)?void 0:l.message)}catch(n){i.error(m(n))}finally{Z(null)}})(String(null==e?void 0:e.id)),disabled:Q===String(null==e?void 0:e.id),className:((null==e?void 0:e.status)?"bg-primary":"bg-gray-200")+" relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50",children:[t.jsx("span",{className:"sr-only",children:"Enable notifications"}),t.jsx("span",{className:((null==e?void 0:e.status)?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white"})]}),Q===String(null==e?void 0:e.id)&&t.jsx(B,{className:"h-4 w-4 animate-spin text-primary"})]})}),t.jsx(y,{children:t.jsx(o,{className:"bg-primary",onClick:()=>{return s=String(null==e?void 0:e.id),H(!0),O(!0),void V(s);var s},children:"Edit"})})]},null==e?void 0:e.id))})]}),t.jsx(D,{className:"mb-2 mt-4"}),t.jsx("div",{className:"flex w-full justify-end",children:t.jsx(N,{page:k,limit:F,totalPages:null==(A=null==(_=null==G?void 0:G.data)?void 0:_.pagination)?void 0:A.totalPages,setPage:L,setLimit:P})})]})})]})]})]})}function T(){return t.jsx(l,{title:"Department List",subTitle:"Manage all the Departments here",children:t.jsx(P,{})})}export{T as default};
