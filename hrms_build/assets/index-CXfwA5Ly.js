import{r as e,j as s,h as a,z as l}from"./index-C0dR7KKl.js";import{P as t}from"./index-DLwgcCrU.js";import{a as r,o as i,c as n,f as d}from"./yup-D-4eAt9F.js";import{F as c}from"./datetime-picker-Chw5tpGr.js";import{R as m}from"./RHFTextField-Bf4PLUtQ.js";import{B as o}from"./ButtonLoading-CtnN6-Kp.js";import{R as x}from"./RHFSelectField-DetLCX2z.js";import"./input-5m-sj67D.js";import"./switch-DfyNgsks.js";import"./checkbox-5PN_yyUS.js";import"./label-BBEmak6c.js";import{S as u}from"./separator-DK9wbIss.js";import{C as j,a as h,d as p,b as g,c as b}from"./card-dfHK731x.js";import{T as v,a as f,b as y,c as N,d as S,e as w}from"./table-DGsqq0wP.js";import{u as k,b as F}from"./useCustomQuery-DfubPPhS.js";import{B as _}from"./badge-ssHwjf40.js";import{D as M}from"./dollar-sign-C22d60Q2.js";import{L as D}from"./loader-circle-l2PdwOoK.js";import{U as G}from"./users-CT8DcM1n.js";import{T as B}from"./triangle-alert-CyqH-rj2.js";import{C as A}from"./circle-x-BSdROGAg.js";import{C as R}from"./circle-check-big-C251ryKd.js";import"./select-PSqof_An.js";import"./check-DJnOI1b1.js";import"./calendar-D3nBqMDA.js";import"./chevron-right-ZD98JKF5.js";import"./clock-zyZI13Cr.js";const T=n().shape({month:d().required("Month is required").min(1).max(12),year:d().required("Year is required").min(2020).max(2100),department_id:d().nullable()}),L=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}];function Y(){var t,n,d;const Y=k({}),[q,C]=e.useState(null),[E,J]=e.useState(!1),O=F({api:a.getAllDepartmentMstr,key:"getAllDepartments",options:{enabled:!0}}),V=(null==(n=null==(t=null==O?void 0:O.data)?void 0:t.data)?void 0:n.map(e=>({value:e.id,label:e.department_name})))||[],H=r({defaultValues:{month:(new Date).getMonth()+1,year:(new Date).getFullYear(),department_id:void 0},resolver:i(T)}),P=e=>{switch(e){case"success":return s.jsx(R,{className:"h-4 w-4 text-green-500"});case"failed":return s.jsx(A,{className:"h-4 w-4 text-red-500"});case"skipped":return s.jsx(B,{className:"h-4 w-4 text-yellow-500"});default:return null}},Q=e=>{switch(e){case"success":return s.jsx(_,{className:"bg-green-100 text-green-700",children:"Success"});case"failed":return s.jsx(_,{className:"bg-red-100 text-red-700",children:"Failed"});case"skipped":return s.jsx(_,{className:"bg-yellow-100 text-yellow-700",children:"Skipped"});default:return s.jsx(_,{variant:"outline",children:e})}},U=q?Math.round(q.successful/q.total_employees*100):0;return s.jsxs("main",{className:"grid items-start gap-4 lg:grid-cols-2",children:[s.jsxs(j,{children:[s.jsxs(h,{children:[s.jsxs(p,{className:"flex items-center gap-2",children:[s.jsx(M,{className:"h-5 w-5"}),"Generate Bulk Salary"]}),s.jsx(g,{children:"Generate salary for all employees or a specific department"})]}),s.jsx(b,{children:s.jsx(c,{methods:H,onSubmit:H.handleSubmit(async e=>{var s,t,r,i,n;J(!0),C(null);try{const d=await Y.mutateAsync({api:null==(s=a)?void 0:s.bulkGenerateSalary,data:e});(null==(t=d.data)?void 0:t.success)?(l.success((null==(r=null==d?void 0:d.data)?void 0:r.message)||"Bulk salary generation completed"),C(null==(i=d.data)?void 0:i.data)):l.error((null==(n=d.data)?void 0:n.message)||"Failed to generate bulk salary")}catch(d){l.error("Failed to generate bulk salary")}finally{J(!1)}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[s.jsx("div",{children:s.jsx(x,{label:"Month",name:"month",data:L})}),s.jsx("div",{children:s.jsx(m,{label:"Year",name:"year",placeholder:"Enter Year",type:"number"})}),s.jsxs("div",{children:[s.jsx(x,{label:"Department (Optional)",name:"department_id",data:[{value:"",label:"All Departments"},...V]}),s.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Leave empty to generate for all departments"})]}),s.jsxs("div",{children:[s.jsx(u,{className:"my-2"}),s.jsx(o,{isLoading:E,type:"submit",className:"h-11 w-full rounded-xl",children:E?s.jsxs(s.Fragment,{children:[s.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Salaries..."]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{className:"mr-2 h-4 w-4"}),"Generate Bulk Salary"]})})]})]})})})]}),q&&s.jsxs(j,{children:[s.jsxs(h,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:[s.jsx(p,{className:"text-blue-700",children:"Generation Summary"}),s.jsxs(g,{children:[null==(d=L.find(e=>e.value===String(q.month)))?void 0:d.label," ",q.year]})]}),s.jsxs(b,{className:"pt-4",children:[s.jsxs("div",{className:"mb-4 grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"rounded-lg bg-slate-50 p-3 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-slate-700",children:q.total_employees}),s.jsx("div",{className:"text-xs text-slate-500",children:"Total"})]}),s.jsxs("div",{className:"rounded-lg bg-green-50 p-3 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-700",children:q.successful}),s.jsx("div",{className:"text-xs text-green-600",children:"Successful"})]}),s.jsxs("div",{className:"rounded-lg bg-red-50 p-3 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-700",children:q.failed}),s.jsx("div",{className:"text-xs text-red-600",children:"Failed"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"mb-1 flex justify-between text-sm",children:[s.jsx("span",{children:"Success Rate"}),s.jsxs("span",{className:"font-medium",children:[U,"%"]})]}),s.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-200",children:s.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${U}%`}})})]}),q.results&&q.results.length>0&&s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs(v,{children:[s.jsx(f,{children:s.jsxs(y,{children:[s.jsx(N,{children:"Employee"}),s.jsx(N,{children:"Status"}),s.jsx(N,{className:"text-right",children:"Net Salary"})]})}),s.jsx(S,{children:q.results.map(e=>s.jsxs(y,{children:[s.jsx(w,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[P(e.status),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:e.emp_name}),s.jsx("div",{className:"text-xs text-slate-500",children:e.emp_code})]})]})}),s.jsx(w,{children:Q(e.status)}),s.jsx(w,{className:"text-right",children:e.net_salary?`â‚¹${e.net_salary.toLocaleString()}`:e.message||"-"})]},e.emp_id))})]})})]})]}),!q&&s.jsx(j,{className:"border-dashed",children:s.jsxs(b,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(G,{className:"h-12 w-12 text-slate-300"}),s.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Select month, year and click generate to create salaries for all employees"})]})})]})}function q(){return s.jsx(t,{title:"Bulk Salary Generation",subTitle:"Generate Salary for Multiple Employees",children:s.jsx("div",{className:"py-12",children:s.jsx(Y,{})})})}export{q as default};
