import{r as e,j as s,h as a,z as l}from"./index-pqP14EhS.js";import{P as t}from"./index-DZYVnpiZ.js";import{a as r,o as i,c as n,f as d}from"./yup-C8lOt6vX.js";import{F as c}from"./datetime-picker-z1_UvJZu.js";import{R as m}from"./RHFTextField-CcEXXXFB.js";import{B as o}from"./ButtonLoading-CHCIi82E.js";import{R as x}from"./RHFSelectField-Ohwh174t.js";import"./input-BT6hWnw8.js";import"./switch-CvZERcdR.js";import"./checkbox-xsP6xrIs.js";import"./label-xKekv9dA.js";import{S as u}from"./separator-DjchR5HV.js";import{C as j,a as h,d as p,b as g,c as b}from"./card-Bs59ZPbY.js";import{T as v,a as f,b as y,c as N,d as S,e as w}from"./table-CRgXbpGI.js";import{u as k,b as F}from"./useCustomQuery-CzEWxvyG.js";import{B as _}from"./badge-DeVTySeZ.js";import{D}from"./dollar-sign-CSIW_dZq.js";import{L as G}from"./loader-circle-B92or-ec.js";import{U as M}from"./users-CuFeHImX.js";import{T as B}from"./triangle-alert-kqwlgW1C.js";import{C as A}from"./circle-x-6Y3mmM73.js";import{C as R}from"./circle-check-big-BiAG3xNy.js";import"./select-B4keucJT.js";import"./check-BQY2iuAn.js";import"./calendar-By15l6FD.js";import"./format-BkNqQ0tt.js";import"./chevron-right-tcBAQR95.js";import"./clock-Dx15zlBS.js";const T=n().shape({month:d().required("Month is required").min(1).max(12),year:d().required("Year is required").min(2020).max(2100),department_id:d().nullable()}),C=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}];function L(){var t,n,d;const L=k({}),[Y,q]=e.useState(null),[$,E]=e.useState(!1),J=F({api:a.getAllDepartmentMstr,key:"getAllDepartments",options:{enabled:!0}}),H=(null==(n=null==(t=null==J?void 0:J.data)?void 0:t.data)?void 0:n.map(e=>({value:e.id,label:e.department_name})))||[],O=r({defaultValues:{month:(new Date).getMonth()+1,year:(new Date).getFullYear(),department_id:void 0},resolver:i(T)}),Q=e=>{switch(e){case"success":return s.jsx(R,{className:"h-4 w-4 text-green-500"});case"failed":return s.jsx(A,{className:"h-4 w-4 text-red-500"});case"skipped":return s.jsx(B,{className:"h-4 w-4 text-yellow-500"});default:return null}},U=e=>{switch(e){case"success":return s.jsx(_,{className:"bg-green-100 text-green-700",children:"Success"});case"failed":return s.jsx(_,{className:"bg-red-100 text-red-700",children:"Failed"});case"skipped":return s.jsx(_,{className:"bg-yellow-100 text-yellow-700",children:"Skipped"});default:return s.jsx(_,{variant:"outline",children:e})}},V=Y?Math.round(Y.successful/Y.total_employees*100):0;return s.jsxs("main",{className:"grid items-start gap-4 lg:grid-cols-2",children:[s.jsxs(j,{children:[s.jsxs(h,{children:[s.jsxs(p,{className:"flex items-center gap-2",children:[s.jsx(D,{className:"h-5 w-5"}),"Generate Bulk Salary"]}),s.jsx(g,{children:"Generate salary for all employees or a specific department"})]}),s.jsx(b,{children:s.jsx(c,{methods:O,onSubmit:O.handleSubmit(async e=>{var s,t,r,i,n;E(!0),q(null);try{const d=await L.mutateAsync({api:null==(s=a)?void 0:s.bulkGenerateSalary,data:e});(null==(t=d.data)?void 0:t.success)?(l.success((null==(r=null==d?void 0:d.data)?void 0:r.message)||"Bulk salary generation completed"),q(null==(i=d.data)?void 0:i.data)):l.error((null==(n=d.data)?void 0:n.message)||"Failed to generate bulk salary")}catch(d){l.error("Failed to generate bulk salary")}finally{E(!1)}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[s.jsx("div",{children:s.jsx(x,{label:"Month",name:"month",data:C})}),s.jsx("div",{children:s.jsx(m,{label:"Year",name:"year",placeholder:"Enter Year",type:"number"})}),s.jsxs("div",{children:[s.jsx(x,{label:"Department (Optional)",name:"department_id",data:[{value:"",label:"All Departments"},...H]}),s.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Leave empty to generate for all departments"})]}),s.jsxs("div",{children:[s.jsx(u,{className:"my-2"}),s.jsx(o,{isLoading:$,type:"submit",className:"h-11 w-full rounded-xl",children:$?s.jsxs(s.Fragment,{children:[s.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Salaries..."]}):s.jsxs(s.Fragment,{children:[s.jsx(M,{className:"mr-2 h-4 w-4"}),"Generate Bulk Salary"]})})]})]})})})]}),Y&&s.jsxs(j,{children:[s.jsxs(h,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:[s.jsx(p,{className:"text-blue-700",children:"Generation Summary"}),s.jsxs(g,{children:[null==(d=C.find(e=>e.value===String(Y.month)))?void 0:d.label," ",Y.year]})]}),s.jsxs(b,{className:"pt-4",children:[s.jsxs("div",{className:"mb-4 grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"rounded-lg bg-slate-50 p-3 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-slate-700",children:Y.total_employees}),s.jsx("div",{className:"text-xs text-slate-500",children:"Total"})]}),s.jsxs("div",{className:"rounded-lg bg-green-50 p-3 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-700",children:Y.successful}),s.jsx("div",{className:"text-xs text-green-600",children:"Successful"})]}),s.jsxs("div",{className:"rounded-lg bg-red-50 p-3 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-700",children:Y.failed}),s.jsx("div",{className:"text-xs text-red-600",children:"Failed"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"mb-1 flex justify-between text-sm",children:[s.jsx("span",{children:"Success Rate"}),s.jsxs("span",{className:"font-medium",children:[V,"%"]})]}),s.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-200",children:s.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${V}%`}})})]}),Y.results&&Y.results.length>0&&s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs(v,{children:[s.jsx(f,{children:s.jsxs(y,{children:[s.jsx(N,{children:"Employee"}),s.jsx(N,{children:"Status"}),s.jsx(N,{className:"text-right",children:"Net Salary"})]})}),s.jsx(S,{children:Y.results.map(e=>s.jsxs(y,{children:[s.jsx(w,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[Q(e.status),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:e.emp_name}),s.jsx("div",{className:"text-xs text-slate-500",children:e.emp_code})]})]})}),s.jsx(w,{children:U(e.status)}),s.jsx(w,{className:"text-right",children:e.net_salary?`â‚¹${e.net_salary.toLocaleString()}`:e.message||"-"})]},e.emp_id))})]})})]})]}),!Y&&s.jsx(j,{className:"border-dashed",children:s.jsxs(b,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(M,{className:"h-12 w-12 text-slate-300"}),s.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Select month, year and click generate to create salaries for all employees"})]})})]})}function Y(){return s.jsx(t,{title:"Bulk Salary Generation",subTitle:"Generate Salary for Multiple Employees",children:s.jsx("div",{className:"py-12",children:s.jsx(L,{})})})}export{Y as default};
