import{r as e,aA as s,j as a,aB as l,al as t}from"./vendor-RyuIgj66.js";import{P as r}from"./index-DFF4_m_G.js";import{c as i,e as n}from"./yup-CH6wvET8.js";import{F as d}from"./datetime-picker-dN6E5dqy.js";import{R as c}from"./RHFTextField-BSZ_cEI3.js";import{h as m}from"./index-ey2GEmQz.js";import{B as o}from"./ButtonLoading-DDalXO-W.js";import{R as x}from"./RHFSelectField-oISAIiMK.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{S as u}from"./separator-BQijJEjG.js";import{C as j,a as h,d as p,b as v,c as b}from"./card-u7M7FP5y.js";import{T as g,a as f,b as y,c as N,d as S,e as w}from"./table-B_npepsp.js";import{u as k,b as F}from"./useCustomQuery-DTB6aAiD.js";import{B as _}from"./badge-DbWnzWn2.js";import{D,q as B,U as G,aD as M,$ as A,_ as q}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./select-8PAfYjod.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const R=i().shape({month:n().required("Month is required").min(1).max(12),year:n().required("Year is required").min(2020).max(2100),department_id:n().nullable()}),L=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}];function T(){var r,i,n;const T=k({}),[Y,$]=e.useState(null),[E,J]=e.useState(!1),C=F({api:m.getAllDepartmentMstr,key:"getAllDepartments",options:{enabled:!0}}),H=(null==(i=null==(r=null==C?void 0:C.data)?void 0:r.data)?void 0:i.map(e=>({value:e.id,label:e.department_name})))||[],O=s({defaultValues:{month:(new Date).getMonth()+1,year:(new Date).getFullYear(),department_id:void 0},resolver:l(R)}),z=e=>{switch(e){case"success":return a.jsx(q,{className:"h-4 w-4 text-green-500"});case"failed":return a.jsx(A,{className:"h-4 w-4 text-red-500"});case"skipped":return a.jsx(M,{className:"h-4 w-4 text-yellow-500"});default:return null}},P=e=>{switch(e){case"success":return a.jsx(_,{className:"bg-green-100 text-green-700",children:"Success"});case"failed":return a.jsx(_,{className:"bg-red-100 text-red-700",children:"Failed"});case"skipped":return a.jsx(_,{className:"bg-yellow-100 text-yellow-700",children:"Skipped"});default:return a.jsx(_,{variant:"outline",children:e})}},Q=Y?Math.round(Y.successful/Y.total_employees*100):0;return a.jsxs("main",{className:"grid items-start gap-4 lg:grid-cols-2",children:[a.jsxs(j,{children:[a.jsxs(h,{children:[a.jsxs(p,{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-5 w-5"}),"Generate Bulk Salary"]}),a.jsx(v,{children:"Generate salary for all employees or a specific department"})]}),a.jsx(b,{children:a.jsx(d,{methods:O,onSubmit:O.handleSubmit(async e=>{var s,a,l,r,i;J(!0),$(null);try{const n=await T.mutateAsync({api:null==(s=m)?void 0:s.bulkGenerateSalary,data:e});(null==(a=n.data)?void 0:a.success)?(t.success((null==(l=null==n?void 0:n.data)?void 0:l.message)||"Bulk salary generation completed"),$(null==(r=n.data)?void 0:r.data)):t.error((null==(i=n.data)?void 0:i.message)||"Failed to generate bulk salary")}catch(n){t.error("Failed to generate bulk salary")}finally{J(!1)}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[a.jsx("div",{children:a.jsx(x,{label:"Month",name:"month",data:L})}),a.jsx("div",{children:a.jsx(c,{label:"Year",name:"year",placeholder:"Enter Year",type:"number"})}),a.jsxs("div",{children:[a.jsx(x,{label:"Department (Optional)",name:"department_id",data:[{value:"",label:"All Departments"},...H]}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Leave empty to generate for all departments"})]}),a.jsxs("div",{children:[a.jsx(u,{className:"my-2"}),a.jsx(o,{isLoading:E,type:"submit",className:"h-11 w-full rounded-xl",children:E?a.jsxs(a.Fragment,{children:[a.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Salaries..."]}):a.jsxs(a.Fragment,{children:[a.jsx(G,{className:"mr-2 h-4 w-4"}),"Generate Bulk Salary"]})})]})]})})})]}),Y&&a.jsxs(j,{children:[a.jsxs(h,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:[a.jsx(p,{className:"text-blue-700",children:"Generation Summary"}),a.jsxs(v,{children:[null==(n=L.find(e=>e.value===String(Y.month)))?void 0:n.label," ",Y.year]})]}),a.jsxs(b,{className:"pt-4",children:[a.jsxs("div",{className:"mb-4 grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"rounded-lg bg-slate-50 p-3 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-slate-700",children:Y.total_employees}),a.jsx("div",{className:"text-xs text-slate-500",children:"Total"})]}),a.jsxs("div",{className:"rounded-lg bg-green-50 p-3 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-700",children:Y.successful}),a.jsx("div",{className:"text-xs text-green-600",children:"Successful"})]}),a.jsxs("div",{className:"rounded-lg bg-red-50 p-3 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-red-700",children:Y.failed}),a.jsx("div",{className:"text-xs text-red-600",children:"Failed"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"mb-1 flex justify-between text-sm",children:[a.jsx("span",{children:"Success Rate"}),a.jsxs("span",{className:"font-medium",children:[Q,"%"]})]}),a.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-200",children:a.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${Q}%`}})})]}),Y.results&&Y.results.length>0&&a.jsx("div",{className:"max-h-64 overflow-y-auto",children:a.jsxs(g,{children:[a.jsx(f,{children:a.jsxs(y,{children:[a.jsx(N,{children:"Employee"}),a.jsx(N,{children:"Status"}),a.jsx(N,{className:"text-right",children:"Net Salary"})]})}),a.jsx(S,{children:Y.results.map(e=>a.jsxs(y,{children:[a.jsx(w,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[z(e.status),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:e.emp_name}),a.jsx("div",{className:"text-xs text-slate-500",children:e.emp_code})]})]})}),a.jsx(w,{children:P(e.status)}),a.jsx(w,{className:"text-right",children:e.net_salary?`â‚¹${e.net_salary.toLocaleString()}`:e.message||"-"})]},e.emp_id))})]})})]})]}),!Y&&a.jsx(j,{className:"border-dashed",children:a.jsxs(b,{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(G,{className:"h-12 w-12 text-slate-300"}),a.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Select month, year and click generate to create salaries for all employees"})]})})]})}function Y(){return a.jsx(r,{title:"Bulk Salary Generation",subTitle:"Generate Salary for Multiple Employees",children:a.jsx("div",{className:"py-12",children:a.jsx(T,{})})})}export{Y as default};
