import{aA as e,r as t,j as i,aB as a,al as s}from"./vendor-RyuIgj66.js";import{P as l}from"./index-DFF4_m_G.js";import{h as n}from"./moment-CBOc1lqT.js";import{h as r,e as o,B as d,g as c}from"./index-ey2GEmQz.js";import{C as u,a as m,b as f,c as p}from"./card-u7M7FP5y.js";import{T as v,a as j,b,c as x,d as h,e as g}from"./table-B_npepsp.js";import{u as S,b as _}from"./useCustomQuery-DTB6aAiD.js";import{P as y}from"./index-BHR1l08i.js";import{S as E}from"./separator-BQijJEjG.js";import{S as C}from"./index-CUStUwt1.js";import{S as I}from"./Spinner-BwGzvoRj.js";import{c as N,e as w,a as q}from"./yup-CH6wvET8.js";import{F as A}from"./datetime-picker-dN6E5dqy.js";import{R}from"./RHFTextField-BSZ_cEI3.js";import{B as F}from"./ButtonLoading-DDalXO-W.js";import"./select-8PAfYjod.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import"./checkbox-DFFItNXW.js";import"./label-BcY3kv5U.js";import{R as k}from"./DateAndTimePicker-CtTdRVKm.js";import{D as Y}from"./index-B2ia16z0.js";import"./ui-B3c1eQmf.js";import"./icons-CxCh8mm_.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const D=N().shape({employee_contribution_rate:w().required("Employee Contribution Rate is required").min(0).max(100),employer_contribution_rate:w().required("Employer Contribution Rate is required").min(0).max(100),wage_ceiling:w().required("Wage Ceiling is required").min(0),effective_from:q().required("Effective From date is required"),effective_to:q().nullable().optional(),status:w().optional()});function $({open:l,setOpen:n,title:d,id:c,edit:u,setEdit:m,refetch:f}){var p;const v=S({}),{data:j,isFetching:b}=_({api:`${null==(p=r)?void 0:p.getESISlabById}?id=${o(String(c))}`,key:"getESISlabById",options:{enabled:u&&!!c}}),x=e({defaultValues:{employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1},resolver:a(D)});return t.useEffect(()=>{var e,t,i,a,s,l;u&&j?x.reset({employee_contribution_rate:Number(null==(e=null==j?void 0:j.data)?void 0:e.employee_contribution_rate)||0,employer_contribution_rate:Number(null==(t=null==j?void 0:j.data)?void 0:t.employer_contribution_rate)||0,wage_ceiling:Number(null==(i=null==j?void 0:j.data)?void 0:i.wage_ceiling)||0,effective_from:(null==(a=null==j?void 0:j.data)?void 0:a.effective_from)||"",effective_to:(null==(s=null==j?void 0:j.data)?void 0:s.effective_to)||null,status:(null==(l=null==j?void 0:j.data)?void 0:l.status)||1}):x.reset({employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1})},[u,j,x]),i.jsx(Y,{open:l,setOpen:n,title:d,setEdit:m,edit:u,isLoading:b,children:i.jsx(A,{methods:x,onSubmit:x.handleSubmit(async e=>{var t,i,a,l,o,d,p,j;try{if(u&&c){const n=await v.mutateAsync({api:null==(t=r)?void 0:t.updateESISlab,data:{id:Number(c),...e}});(null==(i=n.data)?void 0:i.success)?s.success((null==(a=null==n?void 0:n.data)?void 0:a.message)||"ESI Contribution Slab updated successfully"):s.error((null==(l=n.data)?void 0:l.message)||"ESI Contribution Slab not updated successfully")}else{const t=await v.mutateAsync({api:null==(o=r)?void 0:o.createESISlab,data:e});(null==(d=t.data)?void 0:d.success)?s.success((null==(p=null==t?void 0:t.data)?void 0:p.message)||"ESI Contribution Slab created successfully"):s.error((null==(j=t.data)?void 0:j.message)||"ESI Contribution Slab not created successfully")}x.reset({employee_contribution_rate:0,employer_contribution_rate:0,wage_ceiling:0,effective_from:"",effective_to:null,status:1}),n(!1),null==m||m(!1),null==f||f()}catch(b){}}),children:i.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[i.jsx("div",{children:i.jsx(R,{label:"Employee Contribution Rate",name:"employee_contribution_rate",placeholder:"Enter Employee Contribution Rate (%)",type:"number",step:"0.01"})}),i.jsx("div",{children:i.jsx(R,{label:"Employer Contribution Rate",name:"employer_contribution_rate",placeholder:"Enter Employer Contribution Rate (%)",type:"number",step:"0.01"})}),i.jsx("div",{children:i.jsx(R,{label:"Wage Ceiling",name:"wage_ceiling",placeholder:"Enter Wage Ceiling",type:"number"})}),i.jsx("div",{children:i.jsx(k,{name:"effective_from",label:"Effective From",placeholder:"Select effective from date"})}),i.jsx("div",{children:i.jsx(k,{name:"effective_to",label:"Effective To (Optional)",placeholder:"Select effective to date"})}),i.jsx(E,{}),i.jsx("div",{children:i.jsx(F,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function B(){var e,a,l,o,N,w;const q=S({}),[A,R]=t.useState(1),[F]=t.useState(10),[k,Y]=t.useState(""),[D,B]=t.useState(!1),[P,T]=t.useState(""),[L,M]=t.useState(!1),O=_({api:`${r.getAllESISlabs}?page=${A}&limit=${F}&q=${k}`,key:"getAllESISlabs",value:[A,F,k],options:{enabled:!0}});return i.jsxs("main",{className:"grid items-start",children:[i.jsx($,{open:D,setOpen:B,title:L?"Edit ESI Contribution Slab":"Add ESI Contribution Slab",id:P,edit:L,setEdit:M,refetch:O.refetch}),i.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[i.jsxs("div",{className:"flex w-full justify-between gap-2",children:[i.jsx("div",{children:i.jsx(C,{search:k,setSearch:Y,refetch:O.refetch,isFetching:null==O?void 0:O.isLoading})}),i.jsx("div",{children:i.jsx(d,{className:"flex items-center gap-2",onClick:()=>B(!0),children:"Add New"})})]}),i.jsx(E,{}),i.jsxs(u,{children:[i.jsx(m,{children:i.jsx(f,{children:"ESI Contribution Slabs"})}),i.jsx(p,{children:(null==O?void 0:O.isLoading)?i.jsx("div",{className:"flex items-center justify-center",children:i.jsx(I,{})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs(v,{children:[i.jsx(j,{children:i.jsxs(b,{children:[i.jsx(x,{children:"Employee Rate (%)"}),i.jsx(x,{children:"Employer Rate (%)"}),i.jsx(x,{children:"Wage Ceiling"}),i.jsx(x,{children:"Effective From"}),i.jsx(x,{children:"Effective To"}),i.jsx(x,{children:"Status"}),i.jsx(x,{children:"Actions"})]})}),i.jsx(h,{children:(null==(e=null==O?void 0:O.data)?void 0:e.data)&&(null==(a=null==O?void 0:O.data)?void 0:a.data.length)>0?null==(l=null==O?void 0:O.data)?void 0:l.data.map(e=>i.jsxs(b,{children:[i.jsxs(g,{children:[e.employee_contribution_rate,"%"]}),i.jsxs(g,{children:[e.employer_contribution_rate,"%"]}),i.jsxs(g,{children:["â‚¹",e.wage_ceiling]}),i.jsx(g,{children:n(e.effective_from).format("DD/MM/YYYY")}),i.jsx(g,{children:e.effective_to?n(e.effective_to).format("DD/MM/YYYY"):"-"}),i.jsx(g,{children:i.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold "+(1===e.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:1===e.status?"Active":"Inactive"})}),i.jsxs(g,{className:"flex gap-2",children:[i.jsx(d,{variant:"outline",size:"sm",onClick:()=>{return t=String(e.id),M(!0),B(!0),void T(t);var t},children:"Edit"}),i.jsx(d,{variant:"destructive",size:"sm",onClick:()=>(async e=>{var t,i,a,l;try{const n=await q.mutateAsync({api:null==(t=r)?void 0:t.deleteESISlab,data:{id:Number(e)}});(null==(i=null==n?void 0:n.data)?void 0:i.success)?(O.refetch(),s.success((null==(a=null==n?void 0:n.data)?void 0:a.message)||"ESI Contribution Slab deleted successfully")):s.error((null==(l=n.data)?void 0:l.message)||"Failed to delete ESI Contribution Slab")}catch(n){s.error(c(n))}})(String(e.id)),children:"Delete"})]})]},e.id)):i.jsx(b,{children:i.jsx(g,{colSpan:7,className:"text-center",children:"No ESI Contribution Slabs found"})})})]})})})]}),(null==(o=null==O?void 0:O.data)?void 0:o.pagination)&&i.jsx(y,{page:A,setPage:R,limit:F,totalPages:(null==(w=null==(N=null==O?void 0:O.data)?void 0:N.pagination)?void 0:w.totalPages)||1})]})]})}function P(){return i.jsx(l,{title:"ESI Contribution Slab",subTitle:"Manage ESI Contribution Slabs",children:i.jsx("div",{className:"py-12",children:i.jsx(B,{})})})}export{P as default};
