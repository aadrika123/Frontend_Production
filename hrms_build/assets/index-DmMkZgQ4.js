import{aA as e,r as a,j as s,aB as l,al as t}from"./vendor-RyuIgj66.js";import{g as d,P as r}from"./index-DFF4_m_G.js";import{h as i}from"./moment-CBOc1lqT.js";import{h as n,e as o,B as c,g as m}from"./index-ey2GEmQz.js";import{C as x,c as u,a as h,d as p,b as v}from"./card-u7M7FP5y.js";import{T as j,a as y,b as f,c as _,d as g,e as w}from"./table-B_npepsp.js";import{S as b,a as N,b as S,c as L,e as T,f as C,d as D}from"./select-8PAfYjod.js";import{u as F,b as A}from"./useCustomQuery-DTB6aAiD.js";import{P as q}from"./index-BHR1l08i.js";import{S as E}from"./separator-BQijJEjG.js";import{S as k}from"./index-CUStUwt1.js";import{S as M}from"./Spinner-BwGzvoRj.js";import{c as $,a as B,b as R}from"./yup-CH6wvET8.js";import{F as I}from"./datetime-picker-dN6E5dqy.js";import{R as P}from"./RHFTextField-BSZ_cEI3.js";import{R as V}from"./RHFTextArea-DpBxMoiQ.js";import{B as Y}from"./ButtonLoading-DDalXO-W.js";import{R as O}from"./RHFSelectField-oISAIiMK.js";import"./input-DlX9dTT0.js";import"./switch-Cssv6fnZ.js";import{C as z}from"./checkbox-DFFItNXW.js";import{L as H}from"./label-BcY3kv5U.js";import{D as Q}from"./index-B2ia16z0.js";import{A as Z,O as G,s as J,N as K,P as U,q as W,T as X}from"./icons-CxCh8mm_.js";import"./ui-B3c1eQmf.js";import"./query-BH9sOW2X.js";import"./axios-Dos3PyFQ.js";import"./zustand-C1rkr5lV.js";const ee=$().shape({leave_type_name:B().required("Leave type name is required"),max_days_per_year:B().required("Max days per year is required").min(1,"Max days must be at least 1"),carry_forward_allowed:R().required(),max_carry_forward_days:B().when("carry_forward_allowed",{is:!0,then:e=>e.min(0,"Cannot be negative"),otherwise:e=>e.notRequired()}),encashment_allowed:R().required(),description:B(),department_id:B().required("Department ID is required").min(1,"Department ID must be at least 1")});function ae({open:r,setOpen:i,title:c,id:m,edit:x,setEdit:u,refetch:h}){var p,v,j;const y=F({}),f=d(),{data:_,isFetching:g}=A({api:`${null==(p=n)?void 0:p.getLeaveTypeById}?id=${o(String(m))}`,key:"getLeaveTypeById",options:{enabled:x}}),w=e({defaultValues:{leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""},resolver:l(ee)});return a.useEffect(()=>{var e,a,s,l,t,d,r;x&&_?w.reset({leave_type_name:null==(e=null==_?void 0:_.data)?void 0:e.leave_type_name,max_days_per_year:String(null==(a=null==_?void 0:_.data)?void 0:a.max_days_per_year),carry_forward_allowed:null==(s=null==_?void 0:_.data)?void 0:s.carry_forward_allowed,max_carry_forward_days:String(null==(l=null==_?void 0:_.data)?void 0:l.max_carry_forward_days),encashment_allowed:null==(t=null==_?void 0:_.data)?void 0:t.encashment_allowed,description:null==(d=null==_?void 0:_.data)?void 0:d.description,department_id:String(null==(r=null==_?void 0:_.data)?void 0:r.department_id)}):w.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})},[x,_]),s.jsx(Q,{open:r,setOpen:i,title:c,setEdit:u,edit:x,isLoading:g,children:s.jsx(I,{methods:w,onSubmit:w.handleSubmit(async e=>{var a,s,l,d,r,o,c,p;try{if(x&&e){const r=await y.mutateAsync({api:`${null==(a=n)?void 0:a.updateLeaveTypeById}`,data:{id:m,...e}});(null==(s=r.data)?void 0:s.success)?t.success(null==(l=null==r?void 0:r.data)?void 0:l.message):t.error((null==(d=r.data)?void 0:d.message)||"Leave type not updated successfully")}else{const a=await y.mutateAsync({api:null==(r=n)?void 0:r.createLeaveType,data:e});(null==(o=a.data)?void 0:o.success)?t.success(null==(c=null==a?void 0:a.data)?void 0:c.message):t.error((null==(p=a.data)?void 0:p.message)||"Leave type not created successfully"),w.reset({leave_type_name:"",max_days_per_year:"",carry_forward_allowed:!1,max_carry_forward_days:"",encashment_allowed:!1,description:"",department_id:""})}i(!1),u(!1),h()}catch(v){}}),children:s.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[s.jsx("div",{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[s.jsx(Z,{className:"h-4 w-4 text-gray-400"}),"Department ID"]}),s.jsx(O,{isSearch:!0,selectedText:"department_name",name:"department_id",data:(null==(j=null==(v=null==f?void 0:f.data)?void 0:v.data)?void 0:j.length)?f.data.data.map(e=>({label:String(e.department_name),value:String(e.id)})):[]})]})}),s.jsx("div",{children:s.jsx(P,{name:"leave_type_name",placeholder:"Enter Leave Type Name",label:"Leave Type Name",inputValidation:["removeSpecialCharacterExceptSpace"]})}),s.jsx("div",{children:s.jsx("div",{children:s.jsx(P,{name:"max_days_per_year",placeholder:"Enter Max Days",label:"Max Days Per Year",inputValidation:["number"]})})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(z,{id:"carry_forward_allowed",checked:w.watch("carry_forward_allowed"),onCheckedChange:e=>w.setValue("carry_forward_allowed",e)}),s.jsx(H,{htmlFor:"carry_forward_allowed",className:"text-sm font-medium",children:"Carry Forward Allowed"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(z,{id:"encashment_allowed",checked:w.watch("encashment_allowed"),onCheckedChange:e=>w.setValue("encashment_allowed",e)}),s.jsx(H,{htmlFor:"encashment_allowed",className:"text-sm font-medium",children:"Encashment Allowed"})]})]}),w.watch("carry_forward_allowed")&&s.jsx("div",{children:s.jsx(P,{name:"max_carry_forward_days",placeholder:"Enter Max Carry Forward Days",label:"Max Carry Forward Days",inputValidation:["number"]})}),s.jsx("div",{children:s.jsx(V,{name:"description",placeholder:"Enter Description",label:"Description"})}),s.jsx(E,{}),s.jsx("div",{children:s.jsx(Y,{isLoading:w.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function se(){var e,l,r,$,B,R,I,P,V,Y,O,z;const H=F({}),Q=d(),[Z,ee]=a.useState(1),[se,le]=a.useState(10),[te,de]=a.useState(""),[re,ie]=a.useState(!1),[ne,oe]=a.useState(""),[ce,me]=a.useState(!1),[xe,ue]=a.useState(null),[he,pe]=a.useState(""),ve=A({api:`${n.getAllLeaveTypes}?page=${Z}&limit=${se}&q=${te}&department_id=${o(String(he))}`,key:"getAllLeaveTypes",value:[Z,se,te,he],options:{enabled:!0}});return s.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[s.jsx(ae,{open:re,setOpen:ie,title:ce?"Edit Leave Type":"Add Leave Type",id:ne,edit:ce,setEdit:me,refetch:null==ve?void 0:ve.refetch}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("div",{}),s.jsxs(c,{onClick:()=>ie(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 shadow-lg shadow-blue-500/30 transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:shadow-blue-500/40",children:[s.jsx(G,{className:"mr-2 h-4 w-4"}),"Add Leave Type"]})]}),s.jsx(x,{className:"border-slate-200 shadow-sm",children:s.jsx(u,{className:"pt-6",children:s.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("div",{className:"max-w-md flex-1",children:s.jsx(k,{search:te,setSearch:de,refetch:null==ve?void 0:ve.refetch,isFetching:null==ve?void 0:ve.isLoading})}),s.jsxs(b,{onValueChange:e=>pe(e),value:he,children:[s.jsx(N,{className:"w-full bg-white sm:w-[220px]",children:s.jsx(S,{placeholder:"All Departments"})}),s.jsx(L,{children:s.jsxs(T,{children:[s.jsx(C,{children:"Filter by Department"}),(null==(l=null==(e=null==Q?void 0:Q.data)?void 0:e.data)?void 0:l.length)?Q.data.data.map(e=>s.jsx(D,{value:String(e.id),children:e.department_name},e.id)):null]})})]})]})})}),s.jsxs(x,{className:"overflow-hidden border-slate-200 shadow-lg",children:[s.jsx(h,{className:"border-b bg-gradient-to-r from-slate-50 to-blue-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(p,{className:"text-xl font-semibold text-slate-900",children:"Leave Types Registry"}),s.jsxs(v,{className:"mt-1",children:["Total ",(null==($=null==(r=null==ve?void 0:ve.data)?void 0:r.pagination)?void 0:$.total)||0," leave type(s) configured"]})]}),s.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:s.jsx(J,{className:"h-6 w-6 text-blue-600"})})]})}),s.jsx(u,{className:"p-0",children:(null==ve?void 0:ve.isLoading)?s.jsx("div",{className:"flex h-64 items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(M,{}),s.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"Loading leave types..."})]})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(j,{children:[s.jsx(y,{children:s.jsxs(f,{className:"bg-slate-50 hover:bg-slate-50",children:[s.jsx(_,{className:"w-16 font-semibold text-slate-700",children:"#"}),s.jsx(_,{className:"font-semibold text-slate-700",children:"Leave Type"}),s.jsx(_,{className:"font-semibold text-slate-700",children:"Max Days/Year"}),s.jsx(_,{className:"font-semibold text-slate-700",children:"Carry Forward"}),s.jsx(_,{className:"font-semibold text-slate-700",children:"Encashment"}),s.jsx(_,{className:"font-semibold text-slate-700",children:"Created Date"}),s.jsx(_,{className:"text-right font-semibold text-slate-700",children:"Actions"})]})}),s.jsxs(g,{children:[null==(R=null==(B=null==ve?void 0:ve.data)?void 0:B.data)?void 0:R.map((e,a)=>s.jsxs(f,{className:"border-b border-slate-100 transition-colors hover:bg-slate-50/50",children:[s.jsx(w,{className:"font-medium text-slate-500",children:(Z-1)*se+a+1}),s.jsx(w,{children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(K,{className:"h-4 w-4 text-slate-400"}),s.jsx("span",{className:"font-semibold text-slate-900",children:null==e?void 0:e.leave_type_name})]}),(null==e?void 0:e.description)&&s.jsx("div",{className:"ml-6 text-sm text-slate-500",children:null==e?void 0:e.description})]})}),s.jsx(w,{children:s.jsxs("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2.5 py-1 text-sm font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:[null==e?void 0:e.max_days_per_year," days"]})}),s.jsx(w,{children:(null==e?void 0:e.carry_forward_allowed)?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),s.jsxs("span",{className:"text-sm font-medium text-green-700",children:["Yes (",null==e?void 0:e.max_carry_forward_days," days)"]})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),s.jsx("span",{className:"text-sm text-slate-500",children:"No"})]})}),s.jsx(w,{children:(null==e?void 0:e.encashment_allowed)?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Allowed"})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),s.jsx("span",{className:"text-sm text-slate-500",children:"Not Allowed"})]})}),s.jsx(w,{children:s.jsx("span",{className:"text-sm text-slate-600",children:i(null==e?void 0:e.created_at).format("DD MMM YYYY")})}),s.jsx(w,{children:s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(c,{size:"sm",variant:"outline",onClick:()=>{return a=String(null==e?void 0:e.id),me(!0),ie(!0),void oe(a);var a},className:"h-8 border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700",children:s.jsx(U,{className:"h-3.5 w-3.5"})}),s.jsx(c,{size:"sm",variant:"outline",disabled:xe===String(null==e?void 0:e.id),onClick:()=>(async e=>{var a,s,l,d;ue(e);try{const r=await H.mutateAsync({api:`${null==(a=n)?void 0:a.deleteLeaveTypeById}`,data:{id:e}});(null==(s=null==r?void 0:r.data)?void 0:s.success)?(null==ve||ve.refetch(),t.success(null==(l=null==r?void 0:r.data)?void 0:l.message)):t.error(null==(d=r.data)?void 0:d.message)}catch(r){t.error(m(r))}finally{ue(null)}})(String(null==e?void 0:e.id)),className:"h-8 border-red-200 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 disabled:opacity-50",children:xe===String(null==e?void 0:e.id)?s.jsx(W,{className:"h-3.5 w-3.5 animate-spin"}):s.jsx(X,{className:"h-3.5 w-3.5"})})]})})]},null==e?void 0:e.id)),0===(null==(P=null==(I=null==ve?void 0:ve.data)?void 0:I.data)?void 0:P.length)&&s.jsx(f,{children:s.jsx(w,{colSpan:7,className:"h-64 text-center",children:s.jsxs("div",{className:"flex flex-col items-center justify-center text-slate-500",children:[s.jsx(J,{className:"mb-4 h-12 w-12 text-slate-300"}),s.jsx("p",{className:"text-lg font-medium",children:"No leave types found"}),s.jsx("p",{className:"mt-1 text-sm",children:"Create your first leave type to get started"})]})})})]})]})}),((null==(Y=null==(V=null==ve?void 0:ve.data)?void 0:V.data)?void 0:Y.length)??0)>0&&s.jsxs(s.Fragment,{children:[s.jsx(E,{className:"my-4"}),s.jsx("div",{className:"px-6 pb-4",children:s.jsx(q,{page:Z,limit:se,totalPages:null==(z=null==(O=null==ve?void 0:ve.data)?void 0:O.pagination)?void 0:z.totalPages,setPage:ee,setLimit:le})})]})]})})]})]})]})}function le(){return s.jsx(r,{title:"Leave Type List",subTitle:"Manage all the Leave Types here",children:s.jsx("div",{children:s.jsx(se,{})})})}export{le as default};
