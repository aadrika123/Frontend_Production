import{G as yt,f as xt,_ as bt,r as Pt}from"./index-eed59950.js";function Yt(s){return yt({tag:"svg",attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.854 12.854c-0-0-0-0-0-0l-4.854-4.854 4.854-4.854c0-0 0-0 0-0 0.052-0.052 0.090-0.113 0.114-0.178 0.066-0.178 0.028-0.386-0.114-0.529l-2.293-2.293c-0.143-0.143-0.351-0.181-0.529-0.114-0.065 0.024-0.126 0.062-0.178 0.114 0 0-0 0-0 0l-4.854 4.854-4.854-4.854c-0-0-0-0-0-0-0.052-0.052-0.113-0.090-0.178-0.114-0.178-0.066-0.386-0.029-0.529 0.114l-2.293 2.293c-0.143 0.143-0.181 0.351-0.114 0.529 0.024 0.065 0.062 0.126 0.114 0.178 0 0 0 0 0 0l4.854 4.854-4.854 4.854c-0 0-0 0-0 0-0.052 0.052-0.090 0.113-0.114 0.178-0.066 0.178-0.029 0.386 0.114 0.529l2.293 2.293c0.143 0.143 0.351 0.181 0.529 0.114 0.065-0.024 0.126-0.062 0.178-0.114 0-0 0-0 0-0l4.854-4.854 4.854 4.854c0 0 0 0 0 0 0.052 0.052 0.113 0.090 0.178 0.114 0.178 0.066 0.386 0.029 0.529-0.114l2.293-2.293c0.143-0.143 0.181-0.351 0.114-0.529-0.024-0.065-0.062-0.126-0.114-0.178z"}}]})(s)}var Ve={exports:{}};(function(s,e){(function(){var t=!1,i=function(l){if(l instanceof i)return l;if(!(this instanceof i))return new i(l);this.EXIFwrapped=l};s.exports&&(e=s.exports=i),e.EXIF=i;var r=i.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},a=i.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},o=i.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},u=i.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},c=i.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function m(l){return!!l.exifdata}function C(l,h){h=h||l.match(/^data\:([^\;]+)\;base64,/mi)[1]||"",l=l.replace(/^data\:([^\;]+)\;base64,/gmi,"");for(var f=atob(l),S=f.length,d=new ArrayBuffer(S),p=new Uint8Array(d),g=0;g<S;g++)p[g]=f.charCodeAt(g);return d}function P(l,h){var f=new XMLHttpRequest;f.open("GET",l,!0),f.responseType="blob",f.onload=function(S){(this.status==200||this.status===0)&&h(this.response)},f.send()}function w(l,h){function f(g){var y=A(g);l.exifdata=y||{};var D=T(g);if(l.iptcdata=D||{},i.isXmpEnabled){var x=j(g);l.xmpdata=x||{}}h&&h.call(l)}if(l.src)if(/^data\:/i.test(l.src)){var S=C(l.src);f(S)}else if(/^blob\:/i.test(l.src)){var d=new FileReader;d.onload=function(g){f(g.target.result)},P(l.src,function(g){d.readAsArrayBuffer(g)})}else{var p=new XMLHttpRequest;p.onload=function(){if(this.status==200||this.status===0)f(p.response);else throw"Could not load image";p=null},p.open("GET",l.src,!0),p.responseType="arraybuffer",p.send(null)}else if(self.FileReader&&(l instanceof self.Blob||l instanceof self.File)){var d=new FileReader;d.onload=function(y){f(y.target.result)},d.readAsArrayBuffer(l)}}function A(l){var h=new DataView(l);if(h.getUint8(0)!=255||h.getUint8(1)!=216)return!1;for(var f=2,S=l.byteLength,d;f<S;){if(h.getUint8(f)!=255)return!1;if(d=h.getUint8(f+1),d==225)return be(h,f+4,h.getUint16(f+2)-2);f+=2+h.getUint16(f+2)}}function T(l){var h=new DataView(l);if(h.getUint8(0)!=255||h.getUint8(1)!=216)return!1;for(var f=2,S=l.byteLength,d=function(D,x){return D.getUint8(x)===56&&D.getUint8(x+1)===66&&D.getUint8(x+2)===73&&D.getUint8(x+3)===77&&D.getUint8(x+4)===4&&D.getUint8(x+5)===4};f<S;){if(d(h,f)){var p=h.getUint8(f+7);p%2!==0&&(p+=1),p===0&&(p=4);var g=f+8+p,y=h.getUint16(f+6+p);return z(l,g,y)}f++}}var B={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function z(l,h,f){for(var S=new DataView(l),d={},p,g,y,D,x=h;x<h+f;)S.getUint8(x)===28&&S.getUint8(x+1)===2&&(D=S.getUint8(x+2),D in B&&(y=S.getInt16(x+3),g=B[D],p=W(S,x+5,y),d.hasOwnProperty(g)?d[g]instanceof Array?d[g].push(p):d[g]=[d[g],p]:d[g]=p)),x++;return d}function G(l,h,f,S,d){var p=l.getUint16(f,!d),g={},y,D,x;for(x=0;x<p;x++)y=f+x*12+2,D=S[l.getUint16(y,!d)],!D&&t&&console.log("Unknown tag: "+l.getUint16(y,!d)),g[D]=_(l,y,h,f,d);return g}function _(l,h,f,S,d){var p=l.getUint16(h+2,!d),g=l.getUint32(h+4,!d),y=l.getUint32(h+8,!d)+f,D,x,H,I,J,Y;switch(p){case 1:case 7:if(g==1)return l.getUint8(h+8,!d);for(D=g>4?y:h+8,x=[],I=0;I<g;I++)x[I]=l.getUint8(D+I);return x;case 2:return D=g>4?y:h+8,W(l,D,g-1);case 3:if(g==1)return l.getUint16(h+8,!d);for(D=g>2?y:h+8,x=[],I=0;I<g;I++)x[I]=l.getUint16(D+2*I,!d);return x;case 4:if(g==1)return l.getUint32(h+8,!d);for(x=[],I=0;I<g;I++)x[I]=l.getUint32(y+4*I,!d);return x;case 5:if(g==1)return J=l.getUint32(y,!d),Y=l.getUint32(y+4,!d),H=new Number(J/Y),H.numerator=J,H.denominator=Y,H;for(x=[],I=0;I<g;I++)J=l.getUint32(y+8*I,!d),Y=l.getUint32(y+4+8*I,!d),x[I]=new Number(J/Y),x[I].numerator=J,x[I].denominator=Y;return x;case 9:if(g==1)return l.getInt32(h+8,!d);for(x=[],I=0;I<g;I++)x[I]=l.getInt32(y+4*I,!d);return x;case 10:if(g==1)return l.getInt32(y,!d)/l.getInt32(y+4,!d);for(x=[],I=0;I<g;I++)x[I]=l.getInt32(y+8*I,!d)/l.getInt32(y+4+8*I,!d);return x}}function q(l,h,f){var S=l.getUint16(h,!f);return l.getUint32(h+2+S*12,!f)}function re(l,h,f,S){var d=q(l,h+f,S);if(d){if(d>l.byteLength)return{}}else return{};var p=G(l,h,h+d,u,S);if(p.Compression)switch(p.Compression){case 6:if(p.JpegIFOffset&&p.JpegIFByteCount){var g=h+p.JpegIFOffset,y=p.JpegIFByteCount;p.blob=new Blob([new Uint8Array(l.buffer,g,y)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",p.Compression)}else p.PhotometricInterpretation==2&&console.log("Thumbnail image format is RGB, which is not implemented.");return p}function W(l,h,f){var S="";for(n=h;n<h+f;n++)S+=String.fromCharCode(l.getUint8(n));return S}function be(l,h){if(W(l,h,4)!="Exif")return!1;var f,S,d,p,g,y=h+6;if(l.getUint16(y)==18761)f=!1;else if(l.getUint16(y)==19789)f=!0;else return!1;if(l.getUint16(y+2,!f)!=42)return!1;var D=l.getUint32(y+4,!f);if(D<8)return!1;if(S=G(l,y,y+D,a,f),S.ExifIFDPointer){p=G(l,y,y+S.ExifIFDPointer,r,f);for(d in p){switch(d){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":p[d]=c[d][p[d]];break;case"ExifVersion":case"FlashpixVersion":p[d]=String.fromCharCode(p[d][0],p[d][1],p[d][2],p[d][3]);break;case"ComponentsConfiguration":p[d]=c.Components[p[d][0]]+c.Components[p[d][1]]+c.Components[p[d][2]]+c.Components[p[d][3]];break}S[d]=p[d]}}if(S.GPSInfoIFDPointer){g=G(l,y,y+S.GPSInfoIFDPointer,o,f);for(d in g){switch(d){case"GPSVersionID":g[d]=g[d][0]+"."+g[d][1]+"."+g[d][2]+"."+g[d][3];break}S[d]=g[d]}}return S.thumbnail=re(l,y,D,f),S}function j(l){if("DOMParser"in self){var h=new DataView(l);if(h.getUint8(0)!=255||h.getUint8(1)!=216)return!1;for(var f=2,S=l.byteLength,d=new DOMParser;f<S-4;)if(W(h,f,4)=="http"){var p=f-1,g=h.getUint16(f-2)-1,y=W(h,p,g),D=y.indexOf("xmpmeta>")+8;y=y.substring(y.indexOf("<x:xmpmeta"),D);var x=y.indexOf("x:xmpmeta")+10;y=y.slice(0,x)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+y.slice(x);var H=d.parseFromString(y,"text/xml");return Q(H)}else f++}}function N(l){var h={};if(l.nodeType==1){if(l.attributes.length>0){h["@attributes"]={};for(var f=0;f<l.attributes.length;f++){var S=l.attributes.item(f);h["@attributes"][S.nodeName]=S.nodeValue}}}else if(l.nodeType==3)return l.nodeValue;if(l.hasChildNodes())for(var d=0;d<l.childNodes.length;d++){var p=l.childNodes.item(d),g=p.nodeName;if(h[g]==null)h[g]=N(p);else{if(h[g].push==null){var y=h[g];h[g]=[],h[g].push(y)}h[g].push(N(p))}}return h}function Q(l){try{var h={};if(l.children.length>0)for(var f=0;f<l.children.length;f++){var S=l.children.item(f),d=S.attributes;for(var p in d){var g=d[p],y=g.nodeName,D=g.nodeValue;y!==void 0&&(h[y]=D)}var x=S.nodeName;if(typeof h[x]>"u")h[x]=N(S);else{if(typeof h[x].push>"u"){var H=h[x];h[x]=[],h[x].push(H)}h[x].push(N(S))}}else h=l.textContent;return h}catch(I){console.log(I.message)}}i.enableXmp=function(){i.isXmpEnabled=!0},i.disableXmp=function(){i.isXmpEnabled=!1},i.getData=function(l,h){return(self.Image&&l instanceof self.Image||self.HTMLImageElement&&l instanceof self.HTMLImageElement)&&!l.complete?!1:(m(l)?h&&h.call(l):w(l,h),!0)},i.getTag=function(l,h){if(m(l))return l.exifdata[h]},i.getIptcTag=function(l,h){if(m(l))return l.iptcdata[h]},i.getAllTags=function(l){if(!m(l))return{};var h,f=l.exifdata,S={};for(h in f)f.hasOwnProperty(h)&&(S[h]=f[h]);return S},i.getAllIptcTags=function(l){if(!m(l))return{};var h,f=l.iptcdata,S={};for(h in f)f.hasOwnProperty(h)&&(S[h]=f[h]);return S},i.pretty=function(l){if(!m(l))return"";var h,f=l.exifdata,S="";for(h in f)f.hasOwnProperty(h)&&(typeof f[h]=="object"?f[h]instanceof Number?S+=h+" : "+f[h]+" ["+f[h].numerator+"/"+f[h].denominator+`]\r
`:S+=h+" : ["+f[h].length+` values]\r
`:S+=h+" : "+f[h]+`\r
`);return S},i.readFromBinaryFile=function(l){return A(l)}}).call(xt)})(Ve,Ve.exports);var Se=typeof self<"u"?self:global;const It=typeof navigator<"u",st=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Ue=Se.Buffer,se=Se.BigInt,Le=!!Ue,wt=s=>s;function ge(s,e=wt){if(st)try{return typeof require=="function"?Promise.resolve(e(require(s))):bt(()=>import(s),[]).then(e)}catch{console.warn(`Couldn't load ${s}`)}}let Ee=Se.fetch;const Dt=s=>Ee=s;if(!Se.fetch){const s=ge("http",i=>i),e=ge("https",i=>i),t=(i,{headers:r}={})=>new Promise(async(a,o)=>{let{port:u,hostname:c,pathname:m,protocol:C,search:P}=new URL(i);const w={method:"GET",hostname:c,path:encodeURI(m)+P,headers:r};u!==""&&(w.port=Number(u));const A=(C==="https:"?await e:await s).request(w,T=>{if(T.statusCode===301||T.statusCode===302){let B=new URL(T.headers.location,i).toString();return t(B,{headers:r}).then(a).catch(o)}a({status:T.statusCode,arrayBuffer:()=>new Promise(B=>{let z=[];T.on("data",G=>z.push(G)),T.on("end",()=>B(Buffer.concat(z)))})})});A.on("error",o),A.end()});Dt(t)}function b(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}const ve=s=>at(s)?void 0:s,Tt=s=>s!==void 0;function at(s){return s===void 0||(s instanceof Map?s.size===0:Object.values(s).filter(Tt).length===0)}function F(s){let e=new Error(s);throw delete e.stack,e}function X(s){return(s=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(s).trim())===""?void 0:s}function ke(s){let e=function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048}(s);return s.jfif.enabled&&(e+=50),s.xmp.enabled&&(e+=2e4),s.iptc.enabled&&(e+=14e3),s.icc.enabled&&(e+=6e3),e}const Fe=s=>String.fromCharCode.apply(null,s),ze=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function ot(s){return ze?ze.decode(s):Le?Buffer.from(s).toString("utf8"):decodeURIComponent(escape(Fe(s)))}class L{static from(e,t){return e instanceof this&&e.le===t?e:new L(e,void 0,void 0,t)}constructor(e,t=0,i,r){if(typeof r=="boolean"&&(this.le=r),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let a=new DataView(e,t,i);this._swapDataView(a)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof L){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&F("Creating view outside of available memory in ArrayBuffer");let a=new DataView(e.buffer,t,i);this._swapDataView(a)}else if(typeof e=="number"){let a=new DataView(new ArrayBuffer(e));this._swapDataView(a)}else F("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=L){return e instanceof DataView||e instanceof L?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||F("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new L(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return ot(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return Fe(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let r=0;r<t&&e+r<this.byteLength;r+=2)i.push(this.getUint16(e+r));return Fe(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function Oe(s,e){F(`${s} '${e}' was not loaded, try using full build of exifr.`)}class Be extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||Oe(this.kind,e),t&&(e in t||function(i,r){F(`Unknown ${i} '${r}'.`)}(this.kind,e),t[e].enabled||Oe(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var ne=new Be("file parser"),R=new Be("segment parser"),Ce=new Be("file reader");const At=s=>Ee(s).then(e=>e.arrayBuffer()),He=s=>new Promise((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(s)});class vt extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function k(s,e,t){let i=new vt;for(let[r,a]of t)i.set(r,a);if(Array.isArray(e))for(let r of e)s.set(r,i);else s.set(e,i);return i}function Re(s,e,t){let i,r=s.get(e);for(i of t)r.set(i[0],i[1])}const U=new Map,K=new Map,fe=new Map,ae=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],lt=["jfif","xmp","icc","iptc","ihdr"],Me=["tiff",...lt],v=["ifd0","ifd1","exif","gps","interop"],oe=[...Me,...v],le=["makerNote","userComment"],ht=["translateKeys","translateValues","reviveValues","multiSegment"],he=[...ht,"sanitize","mergeOutput","silentErrors"];class ut{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Z extends ut{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,r){if(super(),b(this,"enabled",!1),b(this,"skip",new Set),b(this,"pick",new Set),b(this,"deps",new Set),b(this,"translateKeys",!1),b(this,"translateValues",!1),b(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=v.includes(e),this.canBeFiltered&&(this.dict=U.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:a,skip:o}=i;a&&a.length>0&&this.translateTagSet(a,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:F(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of ht)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,r,{tagKeys:a,tagValues:o}=this.dict;for(i of e)typeof i=="string"?(r=o.indexOf(i),r===-1&&(r=a.indexOf(Number(i))),r!==-1&&t.add(Number(a[r]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,pe(this.pick,this.deps)):this.enabled&&this.pick.size>0&&pe(this.pick,this.deps)}}var O={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},We=new Map;class ct extends ut{static useCached(e){let t=We.get(e);return t!==void 0||(t=new this(e),We.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):F(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=It?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of ae)this[e]=O[e];for(e of he)this[e]=O[e];for(e of le)this[e]=O[e];for(e of oe)this[e]=new Z(e,O[e],void 0,this)}setupFromTrue(){let e;for(e of ae)this[e]=O[e];for(e of he)this[e]=O[e];for(e of le)this[e]=!0;for(e of oe)this[e]=new Z(e,!0,void 0,this)}setupFromArray(e){let t;for(t of ae)this[t]=O[t];for(t of he)this[t]=O[t];for(t of le)this[t]=O[t];for(t of oe)this[t]=new Z(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,v)}setupFromObject(e){let t;for(t of(v.ifd0=v.ifd0||v.image,v.ifd1=v.ifd1||v.thumbnail,Object.assign(this,e),ae))this[t]=Pe(e[t],O[t]);for(t of he)this[t]=Pe(e[t],O[t]);for(t of le)this[t]=Pe(e[t],O[t]);for(t of Me)this[t]=new Z(t,O[t],e[t],this);for(t of v)this[t]=new Z(t,O[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,v,oe),e.tiff===!0?this.batchEnableWithBool(v,!0):e.tiff===!1?this.batchEnableWithUserValue(v,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,v):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,v)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let r=t[i];this[i].enabled=r!==!1&&r!==void 0}}setupGlobalFilters(e,t,i,r=i){if(e&&e.length){for(let o of r)this[o].enabled=!1;let a=je(e,i);for(let[o,u]of a)pe(this[o].pick,u),this[o].enabled=!0}else if(t&&t.length){let a=je(t,i);for(let[o,u]of a)pe(this[o].skip,u)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:r,icc:a}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),a.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:r}=this;r.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=v.some(a=>this[a].enabled===!0)||this.makerNote||this.userComment;for(let a of v)this[a].finalizeFilters()}get onlyTiff(){return!lt.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of Me)this[e].enabled&&!R.has(e)&&Oe("segment parser",e)}}function je(s,e){let t,i,r,a,o=[];for(r of e){for(a of(t=U.get(r),i=[],t))(s.includes(a[0])||s.includes(a[1]))&&i.push(a[0]);i.length&&o.push([r,i])}return o}function Pe(s,e){return s!==void 0?s:e!==void 0?e:void 0}function pe(s,e){for(let t of e)s.add(t)}b(ct,"default",O);class ye{constructor(e,t,i){b(this,"errors",[]),b(this,"ensureSegmentChunk",async r=>{let a=r.start,o=r.size||65536;if(this.file.chunked)if(this.file.available(a,o))r.chunk=this.file.subarray(a,o);else try{r.chunk=await this.file.readChunk(a,o)}catch(u){F(`Couldn't read segment: ${JSON.stringify(r)}. ${u.message}`)}else this.file.byteLength>a+o?r.chunk=this.file.subarray(a,o):r.size===void 0?r.chunk=this.file.subarray(a):F("Segment unreachable: "+JSON.stringify(r));return r.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(R.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:r}=t,a=this.options[i];if(a&&a.enabled){let o=this.parsers[i];o&&o.append||o||this.createParser(i,r)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class E{static findPosition(e,t){let i=e.getUint16(t+2)+2,r=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,a=t+r,o=i-r;return{offset:t,length:i,headerLength:r,start:a,size:o,end:a+o}}static parse(e,t={}){return new this(e,new ct({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof L?e:new L(e)}constructor(e,t={},i){b(this,"errors",[]),b(this,"raw",new Map),b(this,"handleError",r=>{if(!this.options.silentErrors)throw r;this.errors.push(r.message)}),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=fe.get(t),r=K.get(t),a=U.get(t),o=this.options[t],u=o.reviveValues&&!!i,c=o.translateValues&&!!r,m=o.translateKeys&&!!a,C={};for(let[P,w]of e)u&&i.has(P)?w=i.get(P)(w):c&&r.has(P)&&(w=this.translateValue(w,r.get(P))),m&&a.has(P)&&(P=a.get(P)||P),C[P]=w;return C}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}b(E,"headerLength",4),b(E,"type",void 0),b(E,"multiSegment",!1),b(E,"canHandle",()=>!1);function kt(s){return s===192||s===194||s===196||s===219||s===221||s===218||s===254}function Ft(s){return s>=224&&s<=239}function Ot(s,e,t){for(let[i,r]of R)if(r.canHandle(s,e,t))return i}class Xe extends ye{constructor(...e){super(...e),b(this,"appSegments",[]),b(this,"jpegSegments",[]),b(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(R.keyList())):(e=e===void 0?R.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&R.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:r,wanted:a,remaining:o}=this;if(!r&&this.file.chunked&&(r=Array.from(a).some(u=>{let c=R.get(u),m=this.options[u];return c.multiSegment&&m.multiSegment}),r&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let u=!1;for(;o.size>0&&!u&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:c}=i,m=this.appSegments.some(C=>!this.file.available(C.offset||C.start,C.length||C.size));if(u=e>c&&!m?!await i.readNextChunk(e):!await i.readNextChunk(c),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,r,a,o,u,c,{file:m,findAll:C,wanted:P,remaining:w,options:A}=this;for(;e<t;e++)if(m.getUint8(e)===255){if(i=m.getUint8(e+1),Ft(i)){if(r=m.getUint16(e+2),a=Ot(m,e,r),a&&P.has(a)&&(o=R.get(a),u=o.findPosition(m,e),c=A[a],u.type=a,this.appSegments.push(u),!C&&(o.multiSegment&&c.multiSegment?(this.unfinishedMultiSegment=u.chunkNumber<u.chunkCount,this.unfinishedMultiSegment||w.delete(a)):w.delete(a),w.size===0)))break;A.recordUnknownSegments&&(u=E.findPosition(m,e),u.marker=i,this.unknownSegments.push(u)),e+=r+1}else if(kt(i)){if(r=m.getUint16(e+2),i===218&&A.stopAfterSos!==!1)return;A.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:i}),e+=r+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,i){let r,a,o,u=new Map;for(let c=0;c<t.length;c++)r=t[c],a=r[i],u.has(a)?o=u.get(a):u.set(a,o=[]),o.push(r);return Array.from(u)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,i])=>{let r=R.get(t,this.options);return r.handleMultiSegments?{type:t,chunk:r.handleMultiSegments(i)}:i[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}b(Xe,"type","jpeg"),ne.set("jpeg",Xe);const Rt=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Mt extends E{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:r,skip:a}=this.options[t];r=new Set(r);let o=r.size>0,u=a.size===0,c=this.chunk.getUint16(e);e+=2;for(let m=0;m<c;m++){let C=this.chunk.getUint16(e);if(o){if(r.has(C)&&(i.set(C,this.parseTag(e,C,t)),r.delete(C),r.size===0))break}else!u&&a.has(C)||i.set(C,this.parseTag(e,C,t));e+=12}return i}parseTag(e,t,i){let{chunk:r}=this,a=r.getUint16(e+2),o=r.getUint32(e+4),u=Rt[a];if(u*o<=4?e+=8:e=r.getUint32(e+8),(a<1||a>13)&&F(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${a}, offset ${e}`),e>r.byteLength&&F(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${a}, offset ${e} is outside of chunk size ${r.byteLength}`),a===1)return r.getUint8Array(e,o);if(a===2)return X(r.getString(e,o));if(a===7)return r.getUint8Array(e,o);if(o===1)return this.parseTagValue(a,e);{let c=new(function(C){switch(C){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(a))(o),m=u;for(let C=0;C<o;C++)c[C]=this.parseTagValue(a,e),e+=m;return c}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:F(`Invalid tiff type ${e}`)}}}class Ie extends Mt{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&F("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&F(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,ke(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,ke(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",Ke(...e.get(2),e.get(1))),e.set("longitude",Ke(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,r={};for(t of v)if(e=this[t],!at(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(r,i)}else r[t]=i;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,r]of Object.entries(t))this.assignObjectToOutput(e,i,r)}}function Ke(s,e,t,i){var r=s+e/60+t/3600;return i!=="S"&&i!=="W"||(r*=-1),r}b(Ie,"type","tiff"),b(Ie,"headerLength",10),R.set("tiff",Ie);const Ge={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},Ge,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},Ge,{tiff:!1,ifd1:!0,mergeOutput:!1});Object.assign({},Ge,{firstChunkSize:4e4,ifd0:[274]});if(typeof navigator=="object"){let s=navigator.userAgent;s.includes("iPad")||s.includes("iPhone")?s.match(/OS (\d+)_(\d+)/):s.includes("OS X 10")&&s.match(/OS X 10[_.](\d+)/),s.includes("Chrome/")?s.match(/Chrome\/(\d+)/):s.includes("Firefox/")&&s.match(/Firefox\/(\d+)/)}class Ut extends L{constructor(...e){super(...e),b(this,"ranges",new Lt),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let r=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(r)}else{let r=e+t;if(r>this.byteLength){let{dataView:a}=this._extend(r);this._swapDataView(a)}}}_extend(e){let t;t=Le?Ue.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let r=super.set(e,t);return this.ranges.add(t,r.byteLength),r}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Lt{constructor(){b(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let r=e+t,a=this.list.filter(o=>Je(e,o.offset,r)||Je(e,o.end,r));if(a.length>0){e=Math.min(e,...a.map(u=>u.offset)),r=Math.max(r,...a.map(u=>u.end)),t=r-e;let o=a.shift();o.offset=e,o.length=t,o.end=r,this.list=this.list.filter(u=>!a.includes(u))}else this.list.push({offset:e,length:t,end:r})}available(e,t){let i=e+t;return this.list.some(r=>r.offset<=e&&i<=r.end)}}function Je(s,e,t){return s<=e&&e<=t}class xe extends Ut{constructor(e,t){super(0),b(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Ce.set("blob",class extends xe{async readWhole(){this.chunked=!1;let s=await He(this.input);this._swapArrayBuffer(s)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(s,e){let t=e?s+e:void 0,i=this.input.slice(s,t),r=await He(i);return this.set(r,s,!0)}});Ce.set("url",class extends xe{async readWhole(){this.chunked=!1;let s=await At(this.input);s instanceof ArrayBuffer?this._swapArrayBuffer(s):s instanceof Uint8Array&&this._swapBuffer(s)}async _readChunk(s,e){let t=e?s+e-1:void 0,i=this.options.httpHeaders||{};(s||t)&&(i.range=`bytes=${[s,t].join("-")}`);let r=await Ee(this.input,{headers:i}),a=await r.arrayBuffer(),o=a.byteLength;if(r.status!==416)return o!==e&&(this.size=s+o),this.set(a,s,!0)}});L.prototype.getUint64=function(s){let e=this.getUint32(s),t=this.getUint32(s+4);return e<1048575?e<<32|t:typeof se!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),se(e)<<se(32)|se(t)):void F("Trying to read 64b value but JS can only handle 53b numbers.")};class Et extends ye{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),i.length===0)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(i=>i.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),r=e+8;return t===1&&(t=this.file.getUint64(e+8),r+=8),{offset:e,length:t,kind:i,start:r}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class ft extends Et{static canHandle(e,t){if(t!==0)return!1;let i=e.getUint16(2);if(i>50)return!1;let r=16,a=[];for(;r<i;)a.push(e.getString(r,4)),r+=4;return a.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let r=this.file.subarray(t,i);this.createParser(e,r)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let i=this.findBox(t,"ipco");if(i===void 0)return;let r=this.findBox(i,"colr");r!==void 0&&await this.registerSegment("icc",r.offset+12,r.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let i=this.findBox(e,"iloc");if(i===void 0)return;let r=this.findExifLocIdInIinf(t),a=this.findExtentInIloc(i,r);if(a===void 0)return;let[o,u]=a;await this.file.ensureChunk(o,u);let c=4+this.file.getUint32(o);o+=c,u-=c,await this.registerSegment("tiff",o,u)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,r,a,o=e.start,u=this.file.getUint16(o);for(o+=2;u--;){if(t=this.parseBoxHead(o),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(r=t.version===3?4:2,a=this.file.getString(i+r+2,4),a==="Exif"))return this.file.getUintBytes(i,r);o+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[r,a]=this.get8bits(i++),[o,u]=this.get8bits(i++),c=e.version===2?4:2,m=e.version===1||e.version===2?2:0,C=u+r+a,P=e.version===2?4:2,w=this.file.getUintBytes(i,P);for(i+=P;w--;){let A=this.file.getUintBytes(i,c);i+=c+m+2+o;let T=this.file.getUint16(i);if(i+=2,A===t)return T>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(i+u,r),this.file.getUintBytes(i+u+r,a)];i+=T*C}}}class dt extends ft{}b(dt,"type","heic");class Ye extends ft{}b(Ye,"type","avif"),ne.set("heic",dt),ne.set("avif",Ye),k(U,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),k(U,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),k(U,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),k(K,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let te=k(K,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const $e={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};te.set(37392,$e),te.set(41488,$e);const we={0:"Normal",1:"Low",2:"High"};function _e(s){return typeof s=="object"&&s.length!==void 0?s[0]:s}function qe(s){let e=Array.from(s).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function De(s){if(typeof s=="string"){var[e,t,i,r,a,o]=s.trim().split(/[-: ]/g).map(Number),u=new Date(e,t-1,i);return Number.isNaN(r)||Number.isNaN(a)||Number.isNaN(o)||(u.setHours(r),u.setMinutes(a),u.setSeconds(o)),Number.isNaN(+u)?s:u}}function ee(s){if(typeof s=="string")return s;let e=[];if(s[1]===0&&s[s.length-1]===0)for(let t=0;t<s.length;t+=2)e.push(Qe(s[t+1],s[t]));else for(let t=0;t<s.length;t+=2)e.push(Qe(s[t],s[t+1]));return X(String.fromCodePoint(...e))}function Qe(s,e){return s<<8|e}te.set(41992,we),te.set(41993,we),te.set(41994,we),k(fe,["ifd0","ifd1"],[[50827,function(s){return typeof s!="string"?ot(s):s}],[306,De],[40091,ee],[40092,ee],[40093,ee],[40094,ee],[40095,ee]]),k(fe,"exif",[[40960,qe],[36864,qe],[36867,De],[36868,De],[40962,_e],[40963,_e]]),k(fe,"gps",[[0,s=>Array.from(s).join(".")],[7,s=>Array.from(s).join(":")]]);class Te extends E{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:4+28+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=i.headerLength===79,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:L.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(a){let o={},u={};for(let c of St)o[c]=[],u[c]=0;return a.replace(Vt,(c,m,C)=>{if(m==="<"){let P=++u[C];return o[C].push(P),`${c}#${P}`}return`${c}#${o[C].pop()}`})}(e);let t=$.findAll(e,"rdf","Description");t.length===0&&t.push(new $("rdf","Description",void 0,e));let i,r={};for(let a of t)for(let o of a.properties)i=Nt(o.ns,r),gt(o,i);return function(a){let o;for(let u in a)o=a[u]=ve(a[u]),o===void 0&&delete a[u];return ve(a)}(r)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,r]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",r);break;case"exif":this.assignObjectToOutput(e,"exif",r);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,r)}else e.xmp=t}}b(Te,"type","xmp"),b(Te,"multiSegment",!0),R.set("xmp",Te);class me{static findAll(e){return pt(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(me.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],r=e[3].slice(1,-1);return r=mt(r),new me(t,i,r)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class ${static findAll(e,t,i){if(t!==void 0||i!==void 0){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var r=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else r=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return pt(e,r).map($.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],r=e[4],a=e[8];return new $(t,i,r,a)}constructor(e,t,i,r){this.ns=e,this.name=t,this.attrString=i,this.innerXml=r,this.attrs=me.findAll(i),this.children=$.findAll(r),this.value=this.children.length===0?mt(r):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return Gt(this.children.map(Bt));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)gt(t,e);return this.value!==void 0&&(e.value=this.value),ve(e)}}function gt(s,e){let t=s.serialize();t!==void 0&&(e[s.name]=t)}var Bt=s=>s.serialize(),Gt=s=>s.length===1?s[0]:s,Nt=(s,e)=>e[s]?e[s]:e[s]={};function pt(s,e){let t,i=[];if(!s)return i;for(;(t=e.exec(s))!==null;)i.push(t);return i}function mt(s){if(function(i){return i==null||i==="null"||i==="undefined"||i===""||i.trim()===""}(s))return;let e=Number(s);if(!Number.isNaN(e))return e;let t=s.toLowerCase();return t==="true"||t!=="false"&&s.trim()}const St=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],Vt=new RegExp(`(<|\\/)(${St.join("|")})`,"g");let Ze=ge("fs",s=>s.promises);Ce.set("fs",class extends xe{async readWhole(){this.chunked=!1,this.fs=await Ze;let s=await this.fs.readFile(this.input);this._swapBuffer(s)}async readChunked(){this.chunked=!0,this.fs=await Ze,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(s,e){this.fh===void 0&&await this.open(),s+e>this.size&&(e=this.size-s);var t=this.subarray(s,e,!0);return await this.fh.read(t.dataView,0,e,s),t}async close(){if(this.fh){let s=this.fh;this.fh=void 0,await s.close()}}});Ce.set("base64",class extends xe{constructor(...s){super(...s),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(s,e){let t,i,r=this.input;s===void 0?(s=0,t=0,i=0):(t=4*Math.floor(s/3),i=s-t/4*3),e===void 0&&(e=this.size);let a=s+e,o=t+4*Math.ceil(a/3);r=r.slice(t,o);let u=Math.min(e,this.size-s);if(Le){let c=Ue.from(r,"base64").slice(i,i+u);return this.set(c,s,!0)}{let c=this.subarray(s,u,!0),m=atob(r),C=c.toUint8();for(let P=0;P<u;P++)C[P]=m.charCodeAt(i+P);return c}}});class et extends ye{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:i,iptc:r,icc:a}=e;i.enabled&&t.deps.add(700),r.enabled&&t.deps.add(33723),a.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:r}=this.options;if(e.enabled||t.enabled||i.enabled||r.enabled){let a=Math.max(ke(this.options),this.options.chunkSize);await this.file.ensureChunk(0,a),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}b(et,"type","tiff"),ne.set("tiff",et);let zt=ge("zlib");const Ht=["ihdr","iccp","text","itxt","exif"];class tt extends ye{constructor(...e){super(...e),b(this,"catchError",t=>this.errors.push(t)),b(this,"metaChunks",[]),b(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let r=i.getUint32(e),a=i.getUint32(e+4),o=i.getString(e+4,4).toLowerCase(),u=r+4+4+4,c={type:o,offset:e,length:u,start:e+4+4,size:r,marker:a};Ht.includes(o)?this.metaChunks.push(c):this.unknownChunks.push(c),e+=u}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[i,r]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(i,r)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(u=>u.type==="iccp");if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),r=0;for(;r<80&&i[r]!==0;)r++;let a=r+2,o=t.getString(0,r);if(this.injectKeyValToIhdr("ProfileName",o),st){let u=await zt,c=t.getUint8Array(a);c=u.inflateSync(c),this.injectSegment("icc",c)}}}b(tt,"type","png"),ne.set("png",tt),k(U,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),Re(U,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let it=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];Re(U,"ifd0",it),Re(U,"exif",it),k(K,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Ae extends E{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}b(Ae,"type","jfif"),b(Ae,"headerLength",9),R.set("jfif",Ae),k(U,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class nt extends E{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}b(nt,"type","ihdr"),R.set("ihdr",nt),k(U,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),k(K,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class de extends E{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(t){let i=function(r){let a=r[0].constructor,o=0;for(let m of r)o+=m.length;let u=new a(o),c=0;for(let m of r)u.set(m,c),c+=m.length;return u}(t.map(r=>r.chunk.toUint8()));return new L(i)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&F("ICC header is too short");for(let[t,i]of Object.entries(Wt)){t=parseInt(t,10);let r=i(this.chunk,t);r!=="\0\0\0\0"&&e.set(t,r)}}parseTags(){let e,t,i,r,a,{raw:o}=this,u=this.chunk.getUint32(128),c=132,m=this.chunk.byteLength;for(;u--;){if(e=this.chunk.getString(c,4),t=this.chunk.getUint32(c+4),i=this.chunk.getUint32(c+8),r=this.chunk.getString(t,4),t+i>m)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");a=this.parseTag(r,t,i),a!==void 0&&a!=="\0\0\0\0"&&o.set(e,a),c+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return X(this.chunk.getString(e+12,t))}parseText(e,t){return X(this.chunk.getString(e+8,t-8))}parseSig(e){return X(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),r=t.getUint32(e+12),a=e+16,o=[];for(let u=0;u<i;u++){let c=t.getString(a+0,2),m=t.getString(a+2,2),C=t.getUint32(a+4),P=t.getUint32(a+8)+e,w=X(t.getUnicodeString(P,C));o.push({lang:c,country:m,text:w}),a+=r}return i===1?o[0].text:o}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}b(de,"type","icc"),b(de,"multiSegment",!0),b(de,"headerLength",18);const Wt={4:V,8:function(s,e){return[s.getUint8(e),s.getUint8(e+1)>>4,s.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:V,16:V,20:V,24:function(s,e){const t=s.getUint16(e),i=s.getUint16(e+2)-1,r=s.getUint16(e+4),a=s.getUint16(e+6),o=s.getUint16(e+8),u=s.getUint16(e+10);return new Date(Date.UTC(t,i,r,a,o,u))},36:V,40:V,48:V,52:V,64:(s,e)=>s.getUint32(e),80:V};function V(s,e){return X(s.getString(e,4))}R.set("icc",de),k(U,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const ue={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},rt={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};k(K,"icc",[[4,ue],[12,rt],[40,Object.assign({},ue,rt)],[48,ue],[80,ue],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class ce extends E{static canHandle(e,t,i){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,i)!==void 0}static headerLength(e,t,i){let r,a=this.containsIptc8bim(e,t,i);if(a!==void 0)return r=e.getUint8(t+a+7),r%2!=0&&(r+=1),r===0&&(r=4),a+8+r}static containsIptc8bim(e,t,i){for(let r=0;r<i;r++)if(this.isIptcSegmentHead(e,t+r))return r}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let r=0;r<t;r++)if(this.chunk.getUint8(r)===28&&this.chunk.getUint8(r+1)===2){i=!0;let a=this.chunk.getUint16(r+3),o=this.chunk.getUint8(r+2),u=this.chunk.getLatin1String(r+5,a);e.set(o,this.pluralizeValue(e.get(o),u)),r+=4+a}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}b(ce,"type","iptc"),b(ce,"translateValues",!1),b(ce,"reviveValues",!1),R.set("iptc",ce),k(U,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),k(K,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0});var Ct=Ne.useGeolocated=void 0;const M=Pt;function jt(s={}){const{positionOptions:e={enableHighAccuracy:!0,maximumAge:0,timeout:1/0},isOptimisticGeolocationEnabled:t=!0,userDecisionTimeout:i=void 0,suppressLocationOnMount:r=!1,watchPosition:a=!1,geolocationProvider:o=typeof navigator<"u"?navigator.geolocation:void 0,watchLocationPermissionChange:u=!1,onError:c,onSuccess:m}=s,C=(0,M.useRef)(0),P=(0,M.useRef)(!0),w=(0,M.useRef)(0),[A,T]=(0,M.useState)(t),[B,z]=(0,M.useState)(),[G,_]=(0,M.useState)(),[q,re]=(0,M.useState)(),[W,be]=(0,M.useState)(),j=(0,M.useCallback)(()=>{C.current&&window.clearTimeout(C.current)},[]),N=(0,M.useCallback)(h=>{j(),P.current&&(z(()=>{}),T(!1),re(h)),c==null||c(h)},[c,j]),Q=(0,M.useCallback)(h=>{j(),P.current&&(z(h.coords),_(h.timestamp),T(!0),re(()=>{})),m==null||m(h)},[m,j]),l=(0,M.useCallback)(()=>{if(!o||!o.getCurrentPosition||!o.watchPosition)throw new Error("The provided geolocation provider is invalid");i&&(C.current=window.setTimeout(()=>{N()},i)),a?w.current=o.watchPosition(Q,N,e):o.getCurrentPosition(Q,N,e)},[o,a,i,N,Q,e]);return(0,M.useEffect)(()=>{let h;return u&&o&&"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(f=>{h=f,h.onchange=()=>{be(h.state)}}).catch(f=>{console.error("Error updating the permissions",f)}),()=>{h&&(h.onchange=null)}},[]),(0,M.useEffect)(()=>(r||l(),()=>{j(),a&&w.current&&(o==null||o.clearWatch(w.current))}),[W]),{getPosition:l,coords:B,timestamp:G,isGeolocationEnabled:A,isGeolocationAvailable:!!o,positionError:q}}Ct=Ne.useGeolocated=jt;function $t(){const{isGeolocationAvailable:s,isGeolocationEnabled:e,getPosition:t,coords:i,positionError:r,timestamp:a}=Ct({positionOptions:{enableHighAccuracy:!0,timeout:1/0,maximumAge:localStorage.getItem("geoMaxAge")||1/0},watchPosition:!0,userDecisionTimeout:5e3});return{isGeolocationAvailable:s,isGeolocationEnabled:e,coords:i,positionError:r,timestamp:a,getPosition:t}}class ie{static changeHeightWidth(e,t,i,r,a,o){return i>r&&(e=Math.round(e*r/i),i=r),e>t&&(i=Math.round(i*t/e),e=t),a&&i<a&&(e=Math.round(e*a/i),i=a),o&&e<o&&(i=Math.round(i*o/e),e=o),{height:e,width:i}}static resizeAndRotateImage(e,t,i,r,a,o="jpeg",u=100,c=0){var m=u/100,C=document.createElement("canvas"),P=e.width,w=e.height,A=this.changeHeightWidth(w,i,P,t,r,a);c&&(c===90||c===270)?(C.width=A.height,C.height=A.width):(C.width=A.width,C.height=A.height),P=A.width,w=A.height;var T=C.getContext("2d");return T.fillStyle="rgba(0, 0, 0, 0)",T.fillRect(0,0,P,w),T.imageSmoothingEnabled&&T.imageSmoothingQuality&&(T.imageSmoothingQuality="high"),c&&(T.rotate(c*Math.PI/180),c===90?T.translate(0,-C.width):c===180?T.translate(-C.width,-C.height):c===270?T.translate(-C.height,0):(c===0||c===360)&&T.translate(0,0)),T.drawImage(e,0,0,P,w),C.toDataURL(`image/${o}`,m)}static b64toByteArrays(e,t){for(var i=512,r=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),a=[],o=0;o<r.length;o+=i){for(var u=r.slice(o,o+i),c=new Array(u.length),m=0;m<u.length;m++)c[m]=u.charCodeAt(m);var C=new Uint8Array(c);a.push(C)}return a}static b64toBlob(e,t){const i=this.b64toByteArrays(e,t);var r=new Blob(i,{type:t,lastModified:new Date});return r}static b64toFile(e,t,i){const r=this.b64toByteArrays(e,i);return new File(r,t,{type:i,lastModified:new Date})}static createResizedImage(e,t,i,r,a,o,u,c="base64",m=null,C=null){const P=new FileReader;if(e){if(e.type&&!e.type.includes("image"))throw Error("File Is NOT Image!");P.readAsDataURL(e),P.onload=()=>{var w=new Image;w.src=P.result,w.onload=function(){var A=ie.resizeAndRotateImage(w,t,i,m,C,r,a,o);const T=`image/${r}`;switch(c){case"blob":const B=ie.b64toBlob(A,T);u(B);break;case"base64":u(A);break;case"file":let _=e.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(r.toString());const q=ie.b64toFile(A,_,T);u(q);break;default:u(A)}}},P.onerror=w=>{throw Error(w)}}else throw Error("File Not Found!")}}const Xt={imageFileResizer:(s,e,t,i,r,a,o,u,c,m)=>ie.createResizedImage(s,e,t,i,r,a,o,u,c,m)},Kt=s=>{var a,o,u;const e=s==null?void 0:s.split(","),t=((a=e[0])==null?void 0:a.indexOf("base64"))>=0?atob(e[1]):decodeURI(e[1]),i=(u=(o=e[0])==null?void 0:o.split(":")[1])==null?void 0:u.split(";")[0],r=new Uint8Array(t==null?void 0:t.length);for(let c=0;c<(t==null?void 0:t.length);c++)r[c]=t==null?void 0:t.charCodeAt(c);return new Blob([r],{type:i})},_t=async s=>new Promise(t=>{Xt.imageFileResizer(s,250,250,"JPEG",60,0,i=>{t(i)},"base64")}).then(t=>Kt(t));export{Yt as I,_t as r,$t as u};
