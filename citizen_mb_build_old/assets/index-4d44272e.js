import{R as $,u as M,c as O,Q as n,j as e,b as l,F as B}from"./index-dc2e80f3.js";import{u as G}from"./formik.esm-f3cac482.js";import{c as Q,a as m,b as H}from"./index.esm-915067d4.js";import{F as J,a as K,T as u}from"./LoadingButton-b2bd3adb.js";import{u as W}from"./useCustomGeoLocation-a3c0c476.js";import{r as X}from"./resizeImage-f1558408.js";import{s as E}from"./waterAndSepticTanker-1c2bfdbb.js";import{b as Y,a as Z}from"./useCustomQuery-d19cb7d6.js";import{O as k}from"./OverLayLoader-844e0882.js";import{R as D}from"./RotatingLoader-be809074.js";import{C as ee}from"./CreateConfirmation-faf0f455.js";import"./hoist-non-react-statics.cjs-af4a2eab.js";import"./ThemeStyle-994f51bc.js";import"./index.esm-6caa2901.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-6cd7a8eb.js";function fe(){var h,g,f,N,v,b,w,y,F,C,V,L,R,S,q,A;const[x,P]=$.useState(null),_=M(),p=Y({}),{coords:d,isGeolocationEnabled:z}=W(),{id:o}=O(),a=Z({api:E.bookingDetails,config:{applicationId:o},options:{enabled:!!o}}),t=G({enableReinitialize:!0,initialValues:{applicationId:o,status:1,comments:"",latitude:"",longitude:"",document:null},validationSchema:Q({comments:m().required("Required").min(10,"Minimum 10 characters").max(100,"Maximum 100 characters"),latitude:m().required("Required"),longitude:m().required("Required"),document:H().required("Required").test("fileSize","File Size is too large",i=>i&&i.size<=2e6)}),onSubmit:async(i,{resetForm:c})=>{await ee(t.values.status===1?"Are you sure you want to cancel trip?":"Are you sure you want to successful trip?")&&await I(i,c)}}),I=async(i,c)=>{var r,T,j;try{const s=await p.mutateAsync({api:E.submitDriverAction,data:i});(r=s==null?void 0:s.data)!=null&&r.status?(n.success((T=s==null?void 0:s.data)==null?void 0:T.message),_("/dashboard",{replace:!0}),c()):n.error((j=s==null?void 0:s.data)==null?void 0:j.message)}catch{n.error("Something went wrong")}},U=async i=>{if(!z){n.error("Please enable location"),i.target.value=null;return}let c=i.target.files[0];const r=await X(c);r?(P(URL.createObjectURL(r)),t.setFieldValue("document",r),t.setFieldValue("latitude",d==null?void 0:d.latitude),t.setFieldValue("longitude",d==null?void 0:d.longitude)):(t.setFieldValue("document",null),t.setFieldValue("latitude",""),t.setFieldValue("longitude",""))};return a!=null&&a.isFetching?e("div",{className:"flex justify-center items-center h-screen",children:e(D,{})}):l(B,{children:[p.isLoading&&e(k,{}),l("div",{className:"p-4",children:[l("div",{className:" bg-white w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Septic Tanker"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:l("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(g=(h=a==null?void 0:a.data)==null?void 0:h.data)==null?void 0:g.booking_no})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Applicant Name"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(N=(f=a==null?void 0:a.data)==null?void 0:f.data)==null?void 0:N.applicant_name})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Address"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(b=(v=a==null?void 0:a.data)==null?void 0:v.data)==null?void 0:b.address})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Contact Number"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(y=(w=a==null?void 0:a.data)==null?void 0:w.data)==null?void 0:y.mobile})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(C=(F=a==null?void 0:a.data)==null?void 0:F.data)==null?void 0:C.booking_date})]}),e("hr",{className:"w-full border-b-1 border-gray-200"}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Assigned Date"}),e("div",{className:"col-span-6 font-semibold  text-gray-700 2xl:text-base text-xs",children:(L=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:L.assign_date})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Vehicle No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(S=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:S.vehicle_no})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Cleaning Date"}),l("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:[(A=(q=a==null?void 0:a.data)==null?void 0:q.data)==null?void 0:A.cleaning_date," "]})]})]})})]}),e("p",{className:"border-b"}),e("div",{className:"bg-white py-8  rounded-lg shadow-xl p-4 mt-3",children:e(J,{formik:t,children:l("div",{className:"space-y-5 ",children:[e("div",{className:"flex-1",children:e(K,{label:"comments",name:"comments",placeholder:"Enter comments",formik:t})}),l("div",{className:"flex w-full gap-4",children:[e("div",{className:"w-full",children:e(u,{disabled:!0,label:"Latitude",name:"latitude",placeholder:"Enter Latitude",formik:t})}),e("div",{className:"w-full",children:e(u,{disabled:!0,label:"Longitude",name:"longitude",placeholder:"Enter Longitude",formik:t})})]}),e("div",{className:"flex-1"}),l("div",{className:"flex-1",children:[e(u,{label:"Upload document",name:"document",onChange:U,type:"file",placeholder:"Upload document"}),e("span",{className:"text-red-600 absolute text-xs",children:t.touched.document&&t.errors.document?t.errors.document:null})]}),x&&e("div",{className:"flex justify-center",children:e("img",{src:x,alt:"image",className:""})}),l("div",{className:"flex py-2 justify-between mt-8",children:[e("button",{type:"button",onClick:()=>{t.setFieldValue("status",1),t.handleSubmit()},className:"bg-red-500 text-white rounded-lg px-4 py-1.5 text-sm",children:"Cancel Trip"}),e("button",{type:"button",onClick:()=>{t.setFieldValue("status",2),t.handleSubmit()},className:"bg-[#838FCE] text-white rounded-lg px-4 py-1.5 text-sm",children:"Successful Trip"})]})]})})})]})]})}export{fe as default};
