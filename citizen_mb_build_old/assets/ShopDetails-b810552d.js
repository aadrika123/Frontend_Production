import{u as U,j as e,b as s,M as te,c as se,r as u,d as ne,A as le,F as H,Q as q}from"./index-ebb70fb5.js";import{T as re}from"./ThemeStyle-994f51bc.js";import{u as de}from"./formik.esm-24e7dac8.js";import{c as oe,a as m}from"./index.esm-815bb49a.js";import{n as x}from"./PowerupFunctions-a9e1b4e9.js";import{R as ce}from"./RentalApiList-42f87136.js";import{u as ie,a as M}from"./useCustomQuery-dbdacad1.js";import{B as me}from"./index.esm-eca59129.js";import{C as pe,O as he}from"./CreateConfirmation-9d859290.js";import{R as ue}from"./RotatingLoader-2287eddd.js";import"./Hourglass-2a7de572.js";function xe({shopReceiptListData:o}){var h,f,b;const i=U();return o!=null&&o.isLoading?e("div",{className:"w-full h-32    flex justify-center items-center ",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):o!=null&&o.error?e("div",{className:"w-full h-32    flex justify-center items-center ",children:s("div",{className:"text-red-500",children:["Error: ",(h=o==null?void 0:o.error)==null?void 0:h.message]})}):e("div",{className:"p-5",children:(b=(f=o==null?void 0:o.data)==null?void 0:f.data)==null?void 0:b.map((d,v)=>s("div",{className:"w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg ",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Shop Payment Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:s("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Vendor Name."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.allottee})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Amount"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.amount})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.payment_date})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Mode"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.pmt_mode})]})]})}),s("div",{onClick:()=>i(`/shop-payment-receipt/${d==null?void 0:d.id}`),className:"mb-2 mx-4 relative text-white px-2 2xl:px-4 py-[0.3rem] text-xs 2xl:text-sm md:absolute md:bottom-3 2xl:bottom-2 md:right-2 rounded-md bg-indigo-500 border-indigo-400 hover:border-indigo-600 hover:bg-indigo-600 hover:text-white shadow-sm  cursor-pointer poppins md:mt-0 w-max",children:["View Receipt",e(me,{className:"inline font-semibold text-xl"})]})]},v))})}te.setAppElement("#root");function Ie(){var D,_,S,E;const o=U(),{id:i}=se(),h=ie({}),{api_shopDetailsById:f,api_shopTcPayment:b,api_shop_month_demand:d,api_shop_calculate_price:v,api_shop_payment:j,api_shop_receipt_list:B,api_shop_Payment_chq_dd:Q}=ce(),{titleColor:O,bgHeaderColor:ge}=re(),y=(t,r)=>{q.dismiss(),r=="success"&&q.success(t),r=="error"&&q.error(t)},[V,w]=u.useState(!1),[l,T]=u.useState(),[ye,Y]=u.useState(""),[Ne,G]=u.useState(""),[fe,J]=u.useState(""),[be,K]=u.useState("");u.useState(!1);const C=M({api:d,config:{shopId:i},options:{enabled:!0}}),W=t=>{console.log("==2======",t);const r=new Date,c=t,g=(r.getFullYear()-c.getFullYear())*12+(r.getMonth()-c.getMonth())+1;console.log("==3======",g),Y(g)},X=t=>{console.log("==1======",t);const[r,c,g]=t.split("/"),N=new Date(`${g}/${c}/${r}`);console.log("===1.1= after splitting==",N),W(N)},a=de({initialValues:{month:"",amount:0,paymentMode:"",bankName:"",branchName:"",chequeNo:"",chequeDdDate:"",photo:null},validationSchema:oe({month:m().required("Month is required"),paymentMode:m().required("Payment Mode is required"),bankName:m().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>m().required("Bank Name is required")}),branchName:m().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>m().required("Branch Name is required")}),chequeNo:m().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>m().required("Cheque No is required")}),chequeDdDate:m().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>m().required("Cheque/DD Date is required")})}),onSubmit:async t=>{await pe("Are you sure you want to make payment?")?await R():console.log("cancelled")}});M({api:v,config:{shopId:i,month:a.values.month},value:[a.values.month],options:{enabled:!!a.values.month,onSuccess:t=>{var r;a.setFieldValue("amount",(r=t==null?void 0:t.data)==null?void 0:r.amount)}}});const Z=M({api:B,config:{shopId:i},options:{enabled:!!i}}),L=t=>{let r=t.target.name,c=t.target.value;r=="ddmmyy"&&G(c),r=="fromDate"&&J(c),r=="uptoDate"&&K(c)},R=async t=>{var r,c,g,N,P,z,k,I,A,$,F;if(a.values.paymentMode=="ONLINE",a.values.paymentMode=="CHEQUE"||a.values.paymentMode=="DD"){const n=new FormData;n.append("shopId",i),n.append("month",a.values.month),n.append("amount",a.values.amount),n.append("paymentMode",a.values.paymentMode),n.append("bankName",a.values.bankName),n.append("branchName",a.values.branchName),n.append("chequeNo",a.values.chequeNo),n.append("chequeDdDate",a.values.chequeDdDate),n.append("photo",a.values.photo);const p=await h.mutateAsync({api:Q,data:n});(r=p==null?void 0:p.data)!=null&&r.status?(y("Payment done successfully","success"),o(`/payment-response?response=${(g=(c=p==null?void 0:p.data)==null?void 0:c.data)==null?void 0:g.tranId}&module=shop&id=${(P=(N=p==null?void 0:p.data)==null?void 0:N.data)==null?void 0:P.tranId}`,{replace:!0})):y("Payment failed","error")}else{const n=await(h==null?void 0:h.mutateAsync({api:j,data:{shopId:i,month:a.values.month,paymentMode:a.values.paymentMode}}));(z=n==null?void 0:n.data)!=null&&z.status?(console.log("res",n),y((k=n==null?void 0:n.data)==null?void 0:k.message,"success"),o(`/payment-response?response=${(A=(I=n==null?void 0:n.data)==null?void 0:I.data)==null?void 0:A.tranId}&module=shop&id=${(F=($=n==null?void 0:n.data)==null?void 0:$.data)==null?void 0:F.tranId}`,{replace:!0})):y(n==null?void 0:n.message,"error")}},ee=()=>{if(!a.values.month)return y("Please select month","error");o(`/shop-demand-details?shop_id=${i}&month=${a.values.month}`)};u.useEffect(()=>{ae()},[]);const ae=()=>{w(!0);const t={shopId:i};ne.post(f,t,le()).then(r=>{r.data.status&&(T(r.data.data),X(r.data.data.payment_upto)),w(!1)}).catch(r=>{w(!1)})};return V?e(ue,{}):s(H,{children:[h.isLoading&&e(he,{}),s("div",{className:"bg-[#eff2f0]",children:[s("div",{className:"col-span-12",children:[" ",e("h1",{className:`font-bold ${O} text-xl px-4 py-2 text-gray-600`,children:"Shop Details"})]}),e("div",{className:"flex justify-center items-center  overflow-hidden p-4",children:s("div",{class:"w-full md:w-1/3 rounded-lg bg-[#fdfdfd] shadow-indigo-50 shadow-md",children:[s("div",{className:"bg-[#6c68f0] rounded-lg p-4 text-white",children:[s("p",{class:"text-sm text-center font-semibold ",children:["Toll No. : ",e("span",{children:x(l==null?void 0:l.shop_no)})]}),e("p",{class:"text-center py-1",children:s("span",{class:"text-sm justify-center text-gray-50 flex",children:[e("span",{className:"",children:"Payable Amount : "}),a.values.amount]})}),s("form",{onSubmit:a.handleSubmit,onChange:L,children:[s("div",{className:"space-x-2 py-1",children:[s("select",{name:"paymentMode",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.paymentMode,children:[e("option",{value:"",children:"Select Payment Mode"}),e("option",{value:"CASH",children:"Cash"}),e("option",{value:"ONLINE",children:"Online"}),e("option",{value:"CHEQUE",children:"Cheque"}),e("option",{value:"DD",children:"DD"})]}),e("span",{className:"text-red-400 text-sm",children:a.touched.paymentMode&&a.errors.paymentMode})]}),((D=a==null?void 0:a.values)==null?void 0:D.paymentMode)=="CHEQUE"||((_=a==null?void 0:a.values)==null?void 0:_.paymentMode)=="DD"?s(H,{children:[s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Bank Name"}),e("input",{type:"text",name:"bankName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.bankName}),e("span",{className:"text-red-400 text-sm",children:a.touched.bankName&&a.errors.bankName})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Branch Name"}),e("input",{type:"text",name:"branchName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.branchName}),e("span",{className:"text-red-400 text-sm",children:a.touched.branchName&&a.errors.branchName})]})]}),s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque No."}),e("input",{type:"text",name:"chequeNo",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeNo}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeNo&&a.errors.chequeNo})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque/DD Date"}),e("input",{type:"date",name:"chequeDdDate",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeDdDate}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeDdDate&&a.errors.chequeDdDate})]})]}),e("div",{className:"flex space-x-2  py-1",children:s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Upload Photo"}),e("input",{type:"file",name:"photo",onChange:t=>a.setFieldValue("photo",t.target.files[0])}),e("span",{className:"text-red-400 text-sm",children:a.touched.photo&&a.errors.photo})]})})]}):null,e("div",{className:"flex space-x-2 py-1  ",children:s("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"Select Month"}),s("select",{name:"month",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.month,children:[e("option",{value:"",children:"Select Month"}),(E=(S=C==null?void 0:C.data)==null?void 0:S.data)==null?void 0:E.map(t=>e("option",{value:t==null?void 0:t.monthly,children:t==null?void 0:t.monthly},t==null?void 0:t.id))]}),e("span",{className:"text-red-400 text-sm",children:a.touched.month&&a.errors.month})]})}),s("div",{className:"flex gap-5",children:[e("button",{type:"button",onClick:ee,className:"bg-green-400 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Demand Detail"}),e("button",{type:"submit",className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Pay Now"})]})]})]}),e("div",{class:"bg-white shadow-lg rounded-lg  w-full mt-4",children:e("div",{children:s("ul",{children:[s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["sairat Name :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.allottee)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Present occupier :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.present_occupier)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["Contact no. :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.contact_no)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["circle :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.circle_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["market :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.market_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["monthly rent :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.rate)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["last demand :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:x(l==null?void 0:l.last_payment_amount)})]})]})})})]})}),e(xe,{shopReceiptListData:Z})]})]})}export{Ie as default};
