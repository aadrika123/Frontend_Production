import{e as Z,u as ee,r as q,R as j,j as l,F as f,b as n,Q as L}from"./index-350d2eca.js";import{u as le}from"./formik.esm-e960057b.js";import{c as re,a as h}from"./index.esm-206375ae.js";import{T as ie}from"./ThemeStyle-994f51bc.js";import{R as b}from"./RentalApiList-05ba5791.js";import{F as te,S as d,T as m,a as ne}from"./LoadingButton-6bfde9ea.js";import{b as se,a as y,c as P}from"./useCustomQuery-bf15c1d4.js";import{u as oe}from"./useCustomGeoLocation-6e5ce0b0.js";import{r as ae}from"./resizeImage-f1558408.js";import{O as ue}from"./OverLayLoader-1c33646d.js";import{R as ce}from"./RotatingLoader-fa329848.js";import"./hoist-non-react-statics.cjs-ec51556a.js";import"./index.esm-eeaa0d97.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-114738f8.js";const F=[{isRequired:!0,isVisible:!0,name:"circle",label:"Circle",type:"select"},{isRequired:!0,isVisible:!0,name:"market",label:"Market",type:"select"},{isRequired:!0,isVisible:!0,name:"ulbId",label:"Ulb",type:"select"},{isRequired:!0,isVisible:!0,name:"allottee",label:"Allottee",type:"text",inputValidation:["removeDoubleSpace","string"]},{isRequired:!0,isVisible:!0,name:"address",label:"Address",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"rate",label:"Rate",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"arrear",label:"Arrear",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"lastPayDt",label:"Last payment date",type:"date"},{isRequired:!0,isVisible:!0,name:"lastPayAmt",label:"Last payment amount",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"allottedLength",label:"Allotted Length",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"allottedBreadth",label:"Allotted Breadth",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"allottedHeight",label:"Allotted Height",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"area",label:"Area",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"presentLength",label:"Present Length",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"presentBreadth",label:"Present Breadth",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"presentHeight",label:"Present Height",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"noOfFloors",label:"No. Of Floors",type:"text",inputValidation:["number"]},{isRequired:!0,isVisible:!0,name:"presentOccupier",label:"Present Occupier",type:"text",inputValidation:["removeDoubleSpace","string"]},{isRequired:!0,isVisible:!0,name:"tradeLicense",label:"Trade license no.",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"construction",label:"Construction",type:"select",options:g=>g.map(o=>l("option",{value:o==null?void 0:o.id,children:o==null?void 0:o.construction_type},o.id))},{isRequired:!0,isVisible:!0,name:"electricity",label:"Electricity",type:"select",options:[{value:1,label:"Yes"},{value:0,label:"No"}]},{isRequired:!1,isVisible:!1,name:"electricityNo",label:"Electricity no.",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"water",label:"Water",type:"select",options:[{value:1,label:"Yes"},{value:0,label:"No"}]},{isRequired:!1,isVisible:!1,name:"waterConsumerNo",label:"Water consumer no.",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"contactNo",label:"Contact no.",type:"text",inputValidation:["mobile","number"]},{isRequired:!0,isVisible:!0,name:"longitude",label:n("span",{children:["Longitude ",l("br",{}),l("small",{className:"text-blue-700",children:"(When you choose the photo1, it will be auto filled)"})]}),type:"text",placeholder:"Longitude"},{isRequired:!0,isVisible:!0,name:"latitude",label:n("span",{children:["Latitude ",l("br",{}),l("small",{className:"text-blue-700",children:"(When you choose the photo1, it will be auto filled)"})]}),type:"text",placeholder:"Latitude"},{isRequired:!0,isVisible:!0,name:"photo1Path",label:"Photo 1",type:"file"},{isRequired:!0,isVisible:!0,name:"photo2Path",label:"Photo 2",type:"file"},{isRequired:!0,isVisible:!0,name:"remarks",label:"Remarks",type:"textarea",inputValidation:["removeDoubleSpace"]}];function Le(){var _,B,C;const[g]=Z(),o=g.get("id"),{titleStyle:U}=ie(),{api_UlbCircleList:W,api_locationByCircleList:z,api_addShops:M,api_getConstructionType:Y}=b(),G=ee(),{coords:p}=oe(),[k,Q]=q.useState(""),[A,J]=q.useState(""),S=se({}),v=(e,t)=>{L.dismiss(),t=="success"&&L.success(e),t=="error"&&L.error(e)},r=le({initialValues:F.reduce((e,t)=>(e[t.name]="",e),{}),enableReinitialize:!0,onSubmit:async e=>{await K(e)},validationSchema:re().shape({electricityNo:h().when("electricity",{is:e=>e==1,then:()=>h().required("This field is required")}),waterConsumerNo:h().when("water",{is:e=>e==1,then:()=>h().required("This field is required")}),...F.reduce((e,t)=>(t.isRequired&&(e[t.name]=h().required("This field is required")),e),{})})}),w=y({api:W,options:{enabled:!0}});y({api:z,config:{circleId:r.values.circle},value:[r.values.circle],options:{enabled:!!r.values.circle}});const x=y({api:Y,options:{enabled:!0}}),V=y({api:(_=b())==null?void 0:_.getUlbByWard,config:{},options:{enabled:!0}}),u=P({api:`${b().shopById}?id=${o}`,options:{enabled:!!o}}),N=P({api:b().circleApi,options:{enabled:!0}}),R=P({api:`${(B=b())==null?void 0:B.marketApi}?location_id=${r.values.circle}`,options:{enabled:!!r.values.circle}});q.useEffect(()=>{var e;if((e=u==null?void 0:u.data)!=null&&e.data&&o){const t=u.data.data;r.setValues({...r.values,circle:t.location_id||"",market:t.building_id||"",ulbId:t.ward_no||"",allottee:t.name||"",address:t.address||"",rate:"",arrear:"",lastPayDt:"",lastPayAmt:"",allottedLength:t.length||"",allottedBreadth:t.breadth||"",allottedHeight:t.height||"",area:parseInt(t.length)*parseInt(t.breadth)||t.building_area||"",presentLength:"",presentBreadth:"",presentHeight:"",noOfFloors:t.no_of_floors||"",presentOccupier:t.name||"",tradeLicense:"",construction:"",electricity:"",electricityNo:"",water:"",waterConsumerNo:"",contactNo:"",longitude:"",latitude:"",photo1Path:"",photo2Path:"",remarks:""})}},[(C=u==null?void 0:u.data)==null?void 0:C.data,o]);const K=async e=>{var c;let t,s;t=M,s={circleId:e==null?void 0:e.circle,marketId:e==null?void 0:e.market,allottee:e==null?void 0:e.allottee,address:e==null?void 0:e.address,rate:e==null?void 0:e.rate,arrear:e==null?void 0:e.arrear,lastPayDt:e==null?void 0:e.lastPayDt,lastPayAmt:e==null?void 0:e.lastPayAmt,allottedLength:e==null?void 0:e.allottedLength,allottedBreadth:e==null?void 0:e.allottedBreadth,allottedHeight:e==null?void 0:e.allottedHeight,area:e==null?void 0:e.area,presentLength:e==null?void 0:e.presentLength,presentBreadth:e==null?void 0:e.presentBreadth,presentHeight:e==null?void 0:e.presentHeight,noOfFloors:e==null?void 0:e.noOfFloors,presentOccupier:e==null?void 0:e.presentOccupier,tradeLicense:e==null?void 0:e.tradeLicense,construction:e==null?void 0:e.construction,electricity:e==null?void 0:e.electricity,electricityNo:e==null?void 0:e.electricityNo,water:e==null?void 0:e.water,waterConsumerNo:e==null?void 0:e.waterConsumerNo,contactNo:e==null?void 0:e.contactNo,longitude:e==null?void 0:e.longitude,latitude:e==null?void 0:e.latitude,photo1Path:e==null?void 0:e.photo1Path,photo2Path:e==null?void 0:e.photo2Path,remarks:e==null?void 0:e.remarks};try{const a=await S.mutateAsync({api:t,data:s});(c=a==null?void 0:a.data)!=null&&c.status?(v("Data saved successfully","success"),G("/shopList")):v("Data not saved","error")}catch{v("Data not saved","error")}},X=async(e,t)=>{const s=e.target.files[0],c=await ae(s),a=new File([c],s==null?void 0:s.name,{type:s==null?void 0:s.type});t==="photo1Path"?(r.setFieldValue("photo1Path",a),r.setFieldValue("latitude",p==null?void 0:p.latitude),r.setFieldValue("longitude",p==null?void 0:p.longitude),Q(URL.createObjectURL(a))):(r.setFieldValue("photo2Path",a),J(URL.createObjectURL(a)))};return j.useEffect(()=>{r.values.electricity==0&&r.setFieldValue("electricityNo",""),r.values.water==0&&r.setFieldValue("waterConsumerNo","")},[r.values.electricity,r.values.water]),j.useEffect(()=>{r.values.allottedLength&&r.values.allottedBreadth&&r.setFieldValue("area",parseInt(r.values.allottedLength)*parseInt(r.values.allottedBreadth))},[r.values.allottedLength,r.values.allottedBreadth]),w!=null&&w.isLoading?l(f,{children:l(ce,{})}):n(f,{children:[S.isLoading&&l(ue,{}),l("div",{className:"bg-[#eff2f0] ",children:n("div",{className:" container mx-auto p-4",children:[n("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 p-4 border-b",children:[n("div",{className:"col-span-6 flex space-x-3",children:[l("img",{src:"https://cdn-icons-png.flaticon.com/128/2981/2981313.png",className:"h-10 -mt-2"}),l("h1",{className:`${U}`,children:"Add Shops"})]}),l("div",{className:"col-span-6 flex space-x-3 justify-end"})]}),l(te,{formik:r,children:n("div",{className:"bg-[#fdfdfd]  rounded-2xl shadow-md p-2",children:[l("div",{className:"p-2",children:F.map((e,t)=>{var s,c,a,O,I,T,D,H,$,E;if(e.name==="circle")return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:n(d,{name:e.name,formik:r,label:e.label,children:[l("option",{selected:!0,children:"select"}),(a=(c=(s=N==null?void 0:N.data)==null?void 0:s.data)==null?void 0:c.data)==null?void 0:a.map(i=>l("option",{value:i==null?void 0:i.id,children:i==null?void 0:i.location},i.id))]})},t);if(e.name==="market")return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:n(d,{name:e.name,formik:r,label:e.label,children:[l("option",{selected:!0,children:"select"}),(T=(I=(O=R==null?void 0:R.data)==null?void 0:O.data)==null?void 0:I.data)==null?void 0:T.map(i=>l("option",{value:i==null?void 0:i.building_id,children:i==null?void 0:i.building_name},i.building_id))]})},t);if(e.name==="ulbId")return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:n(d,{name:e.name,formik:r,label:e.label,children:[l("option",{selected:!0,children:"select"}),(H=(D=V==null?void 0:V.data)==null?void 0:D.data)==null?void 0:H.map(i=>l("option",{value:i==null?void 0:i.id,children:i==null?void 0:i.ward_name},i.id))]})},t);if(e.name==="electricity")return n(f,{children:[l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:n(d,{name:e.name,formik:r,label:e.label,children:[l("option",{selected:!0,children:"select"}),e.options.map(i=>l("option",{value:i.value,children:i.label},i.value))]})},t),r.values.electricity==1&&l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:l(m,{name:"electricityNo",formik:r,label:" Electricity No"})},t)]});if(e.name==="water")return n(f,{children:[l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:n(d,{name:e.name,formik:r,label:e.label,children:[l("option",{selected:!0,children:"select"}),e.options.map(i=>l("option",{value:i.value,children:i.label},i.value))]})},t),r.values.water==1&&l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:l(m,{name:"waterConsumerNo",formik:r,label:" Consumer No"})},t)]});if(e.name==="construction")return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:n(d,{name:e.name,formik:r,label:e.label,children:[l("option",{selected:!0,children:"select"}),(E=($=x==null?void 0:x.data)==null?void 0:$.data)==null?void 0:E.map(i=>l("option",{value:i==null?void 0:i.id,children:i==null?void 0:i.construction_type},i.id))]})},t);if(e.type==="text"&&e.isVisible)return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:l(m,{name:e.name,formik:r,label:e.label,inputValidation:e.inputValidation,placeholder:e.placeholder,disabled:e.name==="latitude"||e.name==="longitude"})},t);if(e.type==="date")return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:l(m,{name:e.name,formik:r,label:e.label,type:"date"})},t);if(e.type==="file")return n("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:[l(m,{name:e.name,label:e.label,type:"file",onChange:i=>X(i,e.name)}),l("p",{className:"text-red-600 text-xs",children:(r==null?void 0:r.touched[e.name])&&(r==null?void 0:r.errors[e.name])}),e.name==="photo1Path"&&k&&l("img",{src:k,className:"h-20"}),e.name==="photo2Path"&&A&&l("img",{src:A,className:"h-20"})]},t);if(e.type==="textarea")return l("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:l(ne,{name:e.name,formik:r,label:e.label,inputValidation:e.inputValidation})},t)})}),l("div",{className:"pb-8",children:l("button",{type:"submit",className:"bg-[#6AB783] px-7 py-2 text-white font-semibold rounded leading-5 shadow-lg w-full",children:"Save"})})]})})]})})]})}export{Le as default};
