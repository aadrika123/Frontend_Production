import{r as m,u as J,m as U,A as x,a as f,j as e,b as Y}from"./index-3941a546.js";import{u as z}from"./formik.esm-f1168841.js";import{c as G,a as H}from"./index.esm-6cf26a62.js";import{a as w}from"./PowerupFunctions-d2a7455a.js";import{B as Q}from"./BarLoader-5e24b4d4.js";import{B as W}from"./BottomErrorCard-b06e7e18.js";import{T as X}from"./Tabs-6a332c64.js";import"./hoist-non-react-statics.cjs-39f77784.js";function nt(){var v,N,k;const[E,y]=m.useState(!1),[F,M]=m.useState(null),[I,o]=m.useState(!1),[b,S]=m.useState([]),[g,C]=m.useState([]);m.useState([]),m.useState([]),m.useState([]);const{api_getactiveSubjectData:Z,api_getactiveClassData:_,api_finance_year:$,api_mapsectionData:j,api_getMarksEntryByID:V,api_postMarksEntryData:B,api_editMarksEntryData:D,api_getMarksEntryData:tt}=Y(),p=J(),{id:u}=U(),L=G({classId:H().required("Select Class")}),l=z({enableReinitialize:!0,initialValues:{classId:"",sectionData:[],marksEntries:[]},onSubmit:(t,s)=>{var r;console.log("at submit ",t);const n={marksEntries:[...(r=t==null?void 0:t.marksEntries)==null?void 0:r.map(i=>({classId:t==null?void 0:t.classId,sectionId:i==null?void 0:i.sectionId,subjectId:i==null?void 0:i.subjectId,isMainSubject:(i==null?void 0:i.mainoptional)=="main"?1:0,isOptionalSubject:(i==null?void 0:i.mainoptional)=="main"?0:1,fullMarks:i==null?void 0:i.fullMarks,passMarks:i==null?void 0:i.passMarks}))]};console.log("submitDataForm",n),P(n)},validationSchema:L}),P=t=>{o(!0);let s,a,n={marksEntries:t.marksEntries};u!==void 0?(s=D,a=n,a.id=u):(s=B,a=n),x.post(s,a,f()).then(function(r){var i,h,c;console.log("view discount group master..",(i=r==null?void 0:r.data)==null?void 0:i.data),(h=r==null?void 0:r.data)!=null&&h.status?p("/marks-entry-demo"):d(!0,`${(c=r==null?void 0:r.data)==null?void 0:c.message}`),o(!1)}).catch(function(r){console.log("==2 error list...",r),d(!0,"Error occured in submitting form."),o(!1)})},A=()=>{o(!0);let t={id:u};x.post(V,t,f()).then(function(s){var a,n,r,i;console.log("fetch edit data response..",(a=s==null?void 0:s.data)==null?void 0:a.data),(n=s==null?void 0:s.data)!=null&&n.status?DiscountGroupEdit((r=s==null?void 0:s.data)==null?void 0:r.data):d(!0,`${(i=s==null?void 0:s.data)==null?void 0:i.message}`),o(!1)}).catch(function(s){console.log("= edit data error...",s),y(!0),o(!1)})},q=()=>{o(!0),x.post($,{},f()).then(function(t){t!=null&&t.data?(console.log(t==null?void 0:t.data),S(t==null?void 0:t.data)):d(!0,"Error occured while fetching data."),o(!1)}).catch(function(t){console.log("==2 error list...",t),d(!0,"Error occured while fetching data."),o(!1)})},K=()=>{o(!0),x.post(_,{},f()).then(function(t){var s,a,n;((s=t==null?void 0:t.data)==null?void 0:s.status)===!0?(console.log(t==null?void 0:t.data),C((a=t==null?void 0:t.data)==null?void 0:a.data)):d(!0,`${(n=t==null?void 0:t.data)==null?void 0:n.message}`),o(!1)}).catch(function(t){console.log("==2 error list...",t),d(!0,"Error occured while fetching data."),o(!1)})},O=t=>{o(!0),x.post(j,{classId:t},f()).then(function(s){var a,n,r;((a=s==null?void 0:s.data)==null?void 0:a.status)===!0?(console.log(s==null?void 0:s.data),l.setFieldValue("sectionData",(r=(n=s==null?void 0:s.data)==null?void 0:n.data)==null?void 0:r.section.map(i=>({sectionName:i==null?void 0:i.sectionData,value:!0})))):d(!0,"Error occured while fetching data."),o(!1)}).catch(function(s){console.log("==2 error list...",s),d(!0,"Error occured while fetching data."),o(!1)})},R=t=>{o(!0),x.post(j,{classId:t},f()).then(function(s){var a,n,r,i,h;((a=s==null?void 0:s.data)==null?void 0:a.status)===!0?(console.log((n=s==null?void 0:s.data)==null?void 0:n.data),console.log((r=s==null?void 0:s.data)==null?void 0:r.data),l.setFieldValue("marksEntries",(h=(i=s==null?void 0:s.data)==null?void 0:i.data)==null?void 0:h.subject.map(c=>({className:c==null?void 0:c.class_name,sectionName:c==null?void 0:c.section_name,classId:c==null?void 0:c.class_id,sectionId:c==null?void 0:c.section_group_map_id,subjectId:c==null?void 0:c.id,subjectName:c==null?void 0:c.subject_name,fullMarks:100,passMarks:30,mainoptional:!1,optData:0})))):d(!0,"Error occured while fetching datas."),o(!1)}).catch(function(s){console.log("==2 error list...",s),d(!0,"Error occured while fetching dataes."),o(!1)})};console.log(l.values.sectionData),m.useEffect(()=>{l.values.classId!=""&&O(parseInt(l.values.classId))},[l.values.classId]),m.useEffect(()=>{l.values.classId!=""&&R(parseInt(l.values.classId))},[l.values.classId,l.values.sectionData.length>=0]),m.useEffect(()=>{q(),K(),u!==void 0&&A()},[]);const T=t=>{let s=t.target.name,a=t.target.value;s=="fullMarks"&&l.setFieldValue("fullMarks",w(a.trim(),l.values.fullMarks,3)),s=="passMarks"&&l.setFieldValue("passMarks",w(a.trim(),l.values.passMarks,3))},d=(t,s)=>{M(s),y(t)};return console.log(l.values.sectionData),m.useEffect(()=>{l.values.marksEntries.map((t,s)=>{(t==null?void 0:t.mainoptional)=="main"?l.setFieldValue(`marksEntries.${s}.optData`,0):l.setFieldValue(`marksEntries.${s}.optData`,1)})},[(v=l==null?void 0:l.values)==null?void 0:v.marksEntries]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"main-div",children:e.jsxs("div",{className:"main-inner-div",children:[I&&e.jsx(Q,{}),E&&e.jsx(W,{activateBottomErrorCard:d,errorTitle:F}),e.jsxs("div",{className:"main-sub-div",children:[e.jsx("div",{className:"main-sub-inner-div",children:e.jsxs("div",{className:"text-div",children:[e.jsx("div",{className:"big-text",children:"Marks Entry Master Form"}),e.jsx("div",{className:"small-text",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]})}),u===void 0?e.jsx("div",{className:"tab-div",children:e.jsx("div",{className:"add-button-master-div",children:e.jsxs("button",{onClick:()=>p("/marks-entry-demo-form"),type:"submit",className:" add-button-master",children:["Add"," "]})})}):null]}),e.jsx(X,{listRoute:"/marks-entry-demo",formRoute:"/marks-entry-demo-form"}),e.jsx("div",{className:"details-div",children:e.jsx("span",{className:"detailes",children:"Marks Entry Form"})}),e.jsx("div",{className:"form-div",children:e.jsx("form",{onSubmit:l.handleSubmit,onChange:T,children:e.jsxs("div",{className:"form",children:[e.jsxs("div",{className:"col-span-4 grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4 relative",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Academic Year",e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsx("select",{...l==null?void 0:l.getFieldProps("fy"),disabled:!0,type:"number",className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 h-10 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select class",children:b==null?void 0:b.map((t,s)=>e.jsx("option",{value:t==null?void 0:t.fy,children:t==null?void 0:t.fy}))}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.fy&&l.errors.fy?l.errors.fy:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Class",e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsxs("select",{...l.getFieldProps("classId"),type:"number",className:"form-control h-10 block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select Class",children:[e.jsx("option",{value:"",children:"Select"}),g==null?void 0:g.map((t,s)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.class_name}))]}),e.jsx("span",{className:"text-red-600  text-xs",children:l.touched.classId&&l.errors.classId?l.errors.classId:null})]})]}),l.values.classId&&e.jsx("div",{className:"col-span-12 mt-4",children:e.jsx("div",{className:" pt-4 ",children:e.jsx("div",{className:"w-full flex items-center  justify-center border border-gray-300 ",children:e.jsxs("div",{className:"w-full h-[15vh] md:h-[8vh] flex relative",children:[e.jsxs("div",{className:"absolute",children:[" ",e.jsxs("h1",{className:" bg-white items-start justify-start px-2 mt-[-10px] ml-2 ",children:[" ","Section"," ",e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]}),e.jsxs("div",{className:"mt-3 ml-5",children:[((N=l.values.sectionData)==null?void 0:N.length)==0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"  ml-[10px]  text-[#6b7280]   flex justify-center text-xl items-center font-bold mt-2",children:["No existing section for selected class !!!!"," "]})}):null,l.values.sectionData&&l.values.sectionData.map((t,s)=>e.jsxs(e.Fragment,{children:[e.jsx("input",{name:"value",value:t==null?void 0:t.sectionName,checked:l.values.sectionData[s].value===!0,disabled:!0,onChange:()=>l.setFieldValue(`sectionData.${s}.value`,!(t!=null&&t.value)),type:"checkbox",className:"text-slat-500  ml-[8vh]  text-[#6b7280] w-5 h-5 font-bold mt-2   "})," ",e.jsx("span",{className:"ml-2 -mt-6",children:t.sectionName})]}))]})]})})})}),((k=l.values.sectionData)==null?void 0:k.length)!==0&&e.jsx("div",{className:"col-span-12 mt-4",children:e.jsx("div",{className:"overflow-x-auto pt-4 ",children:e.jsx("div",{className:"w-full flex items-center  justify-center border border-gray-300 p-4",children:e.jsxs("div",{className:"w-full block",children:[e.jsx("div",{className:"w-full items-start justify-start bg-white px-2 relative",children:e.jsxs("h1",{className:"absolute bg-white items-start justify-start px-2 mt-[-25px] ",children:[" ","Subject"," ",e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})}),e.jsx("div",{children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 max-[820px]:w-[820px]",children:[e.jsx("thead",{className:"bg-[#E7EFFC] ",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Class Name"}),e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Section Name"}),e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Subject Name"}),e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Full Marks"}),e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Passing Marks"}),e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Main"}),e.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Optional"})]})}),e.jsx("tbody",{className:" divide-y divide-gray-200 ",children:l.values.marksEntries&&l.values.marksEntries.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t==null?void 0:t.className}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t==null?void 0:t.sectionName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t==null?void 0:t.subjectName}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:e.jsx("input",{...l.getFieldProps(`marksEntries.${s}.fullMarks`),type:"number",onChange:a=>l.setFieldValue(`marksEntries.${s}.fullMarks`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),className:"  text-center form-control h-10  w-1/2 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:e.jsx("input",{...l.getFieldProps(`marksEntries.${s}.passMarks`),type:"number",onChange:a=>l.setFieldValue(`marksEntries.${s}.passMarks`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),className:"text-center form-control h-10  w-1/2 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:e.jsx("input",{...l.getFieldProps(`marksEntries.${s}.mainoptional`),type:"checkbox",value:"main",onChange:a=>l.setFieldValue(`marksEntries.${s}.mainoptional`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),checked:(t==null?void 0:t.mainoptional)=="main",className:"text-center form-control  h-5  w-5 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})}),e.jsxs("td",{className:"px-6 py-3 whitespace-nowrap",children:[e.jsx("input",{...l.getFieldProps(`marksEntries.${s}.mainoptional`),type:"checkbox",value:"optional",onChange:a=>l.setFieldValue(`marksEntries.${s}.mainoptional`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),checked:(t==null?void 0:t.mainoptional)=="optional",className:"text-center form-control h-5 w-5 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("input",{type:"hidden",name:`marksEntries.${s}.optData`,value:(t==null?void 0:t.mainoptional)=="optional"?0:1})]})]}))})]})})]})})})}),e.jsxs("div",{className:"cancel-button-div",children:[e.jsx("div",{className:"    ",children:e.jsx("button",{onClick:()=>p("/marks-entry-demo"),type:"button",className:"cancel-button",children:"Back to List"})}),e.jsx("div",{className:"submit-button-div",children:e.jsx("button",{type:"submit",className:" cypress_next2_button submit-button",children:u!==void 0?"Update":"Save"})})]})]})})})]})})})}export{nt as default};
