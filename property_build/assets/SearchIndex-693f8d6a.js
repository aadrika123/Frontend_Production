import{r as l,bp as H,c as L,e as A,I as $,u as I,s as R,f as U,h as M,k as V,j as e,S as D,L as E,a$ as T,bJ as K,bK as O,N as q,H as G,bL as W,U as j,bm as m,P as J,bM as Q}from"./index-0c1daea7.js";function Z(){const[w,z]=l.useState(),{type:i,filterParam:x,searchValueParam:c}=H(),[v,h]=l.useState(!1),[a,S]=l.useState(),[g,p]=l.useState(!1),{notify:b}=l.useContext(L),[k,f]=l.useState(!1);A("Search Holding"),console.log("search params...",i," ",x," ",c);const{api_getWardListByLogin:X,api_filterPropertyDetails:_}=J(),B=$(),u=I();R(),console.log("last url.......");const y=r=>{f(!1),p(!1),h(!0);let t;(r==null?void 0:r.filterBy)=="khataNo"?t={filteredBy:r==null?void 0:r.filterBy,khataNo:r==null?void 0:r.khataNo,plotNo:r==null?void 0:r.plotNo,maujaName:r==null?void 0:r.maujaName,isLegacy:!1}:t={filteredBy:r==null?void 0:r.filterBy,parameter:r==null?void 0:r.parameter,isLegacy:!1},console.log("before fetch holding details....",t),G.post(_,t,B).then(o=>{var n,d;console.log("search property list",o==null?void 0:o.data),(n=o==null?void 0:o.data)!=null&&n.status?(S((d=o==null?void 0:o.data)==null?void 0:d.data),p(!0),W(`/property/search/fresh/${encodeURIComponent(r==null?void 0:r.filterBy)}/${encodeURIComponent(r==null?void 0:r.parameter)}`)):b("Something went wrong!!","error"),h(!1)}).catch(o=>{console.log("Error while fetching Filter Data",o),b("Something went wrong!!","error"),f(!0),h(!1),p(!1)})},C=U({filterBy:M().required("This is a required field !")}),s=V({initialValues:{filterBy:"",parameter:"",khataNo:"",plotNo:"",maujaName:""},onSubmit:r=>{if(r.filterBy!="khataNo"){if(r.parameter==""){j.info("Enter any keyword...");return}}else if(!(r.khataNo!=""||r.plotNo!=""||r.maujaName!="")){j.info("Enter any keyword...");return}y(r)},validationSchema:C}),P=(r,t)=>{let o=`/holdingPropertyDetails/${t}`;Q(r,o,u)},F=[{Header:"Ward No.",accessor:"ward_name"},{Header:"Owner's Name",accessor:"owner_name"},{Header:"Property Tax No.",accessor:"pt_no",Cell:({cell:r})=>e.jsx("span",{children:m(r.row.original.pt_no)})},{Header:"Holding No",accessor:"new_holding_no",Cell:({cell:r})=>e.jsx("span",{children:m(r.row.original.new_holding_no)})},{Header:"Mobile No",accessor:"mobile_no",Cell:({cell:r})=>e.jsx("span",{children:m(r.row.original.mobile_no)})},{Header:"Address",accessor:"prop_address",Cell:({cell:r})=>e.jsx("span",{children:m(r.row.original.prop_address)})},{Header:"Status",Cell:({cell:r})=>e.jsxs("div",{children:[r.row.original.active_status===1&&e.jsx("span",{className:"text-green-400 font-semibold",children:"Active"}),r.row.original.active_status===0&&e.jsx("span",{className:"text-red-400 font-semibold",children:"Disabled"})]})},{Header:"Action",accessor:"id",Cell:({cell:r})=>e.jsx("button",{onClick:t=>P(t,r.row.values.id),className:"bg-indigo-500 px-3 py-1 rounded-lg shadow-lg hover:shadow-xl hover:bg-indigo-700 text-white",children:"View"})},{Header:"All Modules",Cell:({cell:r})=>e.jsx("button",{onClick:()=>u(`/allmodules-dues/${r.row.values.id}`),className:"px-2 py-1 border border-indigo-500 text-indigo-500 font-medium text-xs leading-tight uppercase rounded shadow-xl hover:bg-indigo-700 hover:text-white hover:shadow-lg  active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"View Dues"})},{Header:"Geo",Cell:({cell:r})=>e.jsx("button",{onClick:t=>{var o,n,d,N;return u(`/geo-map/${(o=r.row.original)==null?void 0:o.latitude}/${(n=r.row.original)==null?void 0:n.longitude}/${(d=r.row.original)==null?void 0:d.new_holding_no}/${(N=r.row.original)==null?void 0:N.prop_address}`)},className:"px-2 py-1 border border-indigo-500 text-indigo-500 font-medium text-xs leading-tight uppercase rounded shadow-xl hover:bg-indigo-700 hover:text-white hover:shadow-lg  active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Geo-Map"})}];return l.useEffect(()=>{c!="direct"&&(s.setFieldValue("filterBy",decodeURIComponent(x)),s.setFieldValue("parameter",decodeURIComponent(c)),y({filterBy:decodeURIComponent(x),parameter:decodeURIComponent(c)}))},[]),k?e.jsx(D,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"}):e.jsxs(e.Fragment,{children:[v&&e.jsx(E,{}),(i=="re"||i=="mu")&&e.jsxs("div",{className:"bg-amber-50 px-4 py-4 mb-4 text-lg rounded-lg shadow-lg text-amber-600 inline-block",children:[e.jsx(T,{className:"inline mr-2 text-3xl"}),"For ",e.jsx("span",{className:"font-semibold",children:i=="re"?"Re-Assessment":"Mutation"})," of property search the property and then apply for ",i=="re"?"Re-Assessment":"Mutation"]}),e.jsxs("div",{className:"border shadow-xl bg-white mt-6",children:[e.jsxs("div",{className:"hidden sm:flex  ml-5 mt-2 ",children:[e.jsx("img",{src:K,alt:"",className:"w-10 h-10"}),e.jsx("p",{className:"font-bold text-3xl ml-4 mt-1 text-gray-600",children:"Holding Search..."})]}),e.jsx("form",{onSubmit:s.handleSubmit,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center sm:space-x-8 my-5 m-10",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Filter By",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...s.getFieldProps("filterBy"),className:"cypress_filterBy cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"ptn",children:"Property Tax No"}),e.jsx("option",{value:"holdingNo",children:"Holding No"}),e.jsx("option",{value:"ownerName",children:"Owner Name"}),e.jsx("option",{value:"mobileNo",children:"Mobile No"}),e.jsx("option",{value:"address",children:"Address"}),e.jsx("option",{value:"khataNo",children:"Khata No"})]}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.filterBy&&s.errors.filterBy?s.errors.filterBy:null})]}),(s.values.filterBy==""||s.values.filterBy!="khataNo")&&e.jsxs("div",{className:"mt-3 sm:mt-0",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Search By ",w," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...s.getFieldProps("parameter"),className:"cypress_parameter w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.parameter&&s.errors.parameter?s.errors.parameter:null})]}),s.values.filterBy=="khataNo"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-3 sm:mt-0",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Khata No."}),e.jsx("input",{type:"text",...s.getFieldProps("khataNo"),className:"cypress_parameter w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.khataNo&&s.errors.khataNo?s.errors.khataNo:null})]}),e.jsxs("div",{className:"mt-3 sm:mt-0",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Plot No."}),e.jsx("input",{type:"text",...s.getFieldProps("plotNo"),className:"cypress_parameter w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.plotNo&&s.errors.plotNo?s.errors.plotNo:null})]}),e.jsxs("div",{className:"mt-3 sm:mt-0",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Mauja Name"}),e.jsx("input",{type:"text",...s.getFieldProps("maujaName"),className:"cypress_parameter w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.maujaName&&s.errors.maujaName?s.errors.maujaName:null})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"submit",className:"cypress_submit_holding_search w-full border rounded-md border-indigo-700 bg-indigo-600 hover:bg-indigo-700 text-white  shadow-lg text-base font-semibold px-5 sm:m-3 py-1",children:[" ",e.jsxs("p",{className:"flex",children:[" ",e.jsxs("span",{className:"mt-1 mr-2",children:[" ",e.jsx(O,{})," "]})," ","Search record"]})]})})]})})]}),e.jsxs("div",{className:"mt-10",children:[g&&(a==null?void 0:a.length)!=0&&e.jsx(q,{exportStatus:!1,columns:F,dataList:a}),g&&(a==null?void 0:a.length)==0&&e.jsx("div",{className:"text-xl font-semibold text-red-400 text-center",children:"Data Not Found"}),e.jsx("div",{className:"w-full h-40"})]})]})}export{Z as default};
