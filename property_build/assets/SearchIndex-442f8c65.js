import{r as a,ad as F,c as L,b as A,l as R,u as I,h as U,d as T,e as y,f as k,j as e,C as V,S as D,k as M,$,L as E,a as q,P as O}from"./index-e310632f.js";import{e as W}from"./index.esm-fc67241b.js";import{s as z,c as G,a as J}from"./superNavigation-177b3a8b.js";import{b as n}from"./PowerupFunctions-286420ed.js";function se(){const[j,K]=a.useState(),{type:i,filterParam:c,searchValueParam:d}=F(),[N,m]=a.useState(!1),[t,w]=a.useState(),[h,x]=a.useState(!1),{notify:p}=a.useContext(L),[v,u]=a.useState(!1);A("Search Holding"),console.log("search params...",i," ",c," ",d);const{api_getWardListByLogin:Q,api_filterPropertyDetails:S}=O(),C=R(),B=I();U(),console.log("last url.......");const g=s=>{u(!1),x(!1),m(!0);const l={filteredBy:s==null?void 0:s.filterBy,parameter:s==null?void 0:s.parameter};console.log("before fetch holding details....",l),q.post(S,l,C).then(r=>{var f,b;console.log("search property list",r==null?void 0:r.data),(f=r==null?void 0:r.data)!=null&&f.status?(w((b=r==null?void 0:r.data)==null?void 0:b.data),x(!0),G(`/property/search/fresh/${encodeURIComponent(s==null?void 0:s.filterBy)}/${encodeURIComponent(s==null?void 0:s.parameter)}`)):p("Something went wrong!!","error"),m(!1)}).catch(r=>{console.log("Error while fetching Filter Data",r),p("Something went wrong!!","error"),u(!0),m(!1),x(!1)})},_=T({filterBy:y().required("This is a required field !"),parameter:y().required("This is a required field !")}),o=k({initialValues:{filterBy:"",parameter:""},onSubmit:s=>{g(s)},validationSchema:_}),H=(s,l)=>{let r=`/holdingPropertyDetails/${l}`;J(s,r,B)},P=[{Header:"Ward No.",accessor:"ward_name"},{Header:"Owner's Name",accessor:"owner_name"},{Header:"Property Tax No.",Cell:({cell:s})=>e.jsx("span",{children:n(s.row.original.pt_no)})},{Header:"Holding No",accessor:"holding_no",Cell:({cell:s})=>e.jsx("span",{children:n(s.row.original.holding_no)})},{Header:"New Holding No",accessor:"new_holding_no",Cell:({cell:s})=>e.jsx("span",{children:n(s.row.original.new_holding_no)})},{Header:"Mobile No",accessor:"mobile_no",Cell:({cell:s})=>e.jsx("span",{children:n(s.row.original.mobile_no)})},{Header:"Address",accessor:"prop_address",Cell:({cell:s})=>e.jsx("span",{children:n(s.row.original.prop_address)})},{Header:"Status",Cell:({cell:s})=>e.jsxs("div",{children:[s.row.original.active_status===1&&e.jsx("span",{className:"text-green-400 font-semibold",children:"Active"}),s.row.original.active_status===0&&e.jsx("span",{className:"text-red-400 font-semibold",children:"Disabled"})]})},{Header:"Action",accessor:"id",Cell:({cell:s})=>e.jsx("button",{onClick:l=>H(l,s.row.values.id),className:"bg-indigo-500 px-3 py-1 rounded-lg shadow-lg hover:shadow-xl hover:bg-indigo-700 text-white",children:"View"})}];return a.useEffect(()=>{d!="direct"&&(o.setFieldValue("filterBy",decodeURIComponent(c)),o.setFieldValue("parameter",decodeURIComponent(d)),g({filterBy:decodeURIComponent(c),parameter:decodeURIComponent(d)}))},[]),v?e.jsx(V,{children:e.jsx(D,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"})}):e.jsxs(e.Fragment,{children:[N&&e.jsx(M,{}),(i=="re"||i=="mu")&&e.jsxs("div",{className:"bg-amber-50 px-4 py-4 mb-4 text-lg rounded-lg shadow-lg text-amber-600 inline-block",children:[e.jsx($,{className:"inline mr-2 text-3xl"}),"For ",e.jsx("span",{className:"font-semibold",children:i=="re"?"Re-Assessment":"Mutation"})," of property search the property and then apply for ",i=="re"?"Re-Assessment":"Mutation"]}),e.jsxs("div",{className:"border shadow-xl bg-white mt-6",children:[e.jsxs("div",{className:"hidden sm:flex  ml-5 mt-2 ",children:[e.jsx("img",{src:z,alt:"",className:"w-10 h-10"}),e.jsx("p",{className:"font-bold text-3xl ml-4 mt-1 text-gray-600",children:"Holding Search..."})]}),e.jsx("form",{onSubmit:o.handleSubmit,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center sm:space-x-8 my-5 m-10",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Filter By",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...o.getFieldProps("filterBy"),className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"ptn",children:"Property Tax No"}),e.jsx("option",{value:"holdingNo",children:"Holding No"}),e.jsx("option",{value:"ownerName",children:"Owner Name"}),e.jsx("option",{value:"mobileNo",children:"Mobile No"}),e.jsx("option",{value:"address",children:"Address"})]}),e.jsx("p",{className:"text-red-500 text-xs",children:o.touched.filterBy&&o.errors.filterBy?o.errors.filterBy:null})]}),e.jsxs("div",{className:"mt-3 sm:mt-0",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Search By ",j," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...o.getFieldProps("parameter"),className:" w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("p",{className:"text-red-500 text-xs",children:o.touched.parameter&&o.errors.parameter?o.errors.parameter:null})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"submit",className:"w-full border rounded-md border-indigo-700 bg-indigo-600 hover:bg-indigo-700 text-white  shadow-lg text-base font-semibold px-5 sm:m-3 py-1",children:[" ",e.jsxs("p",{className:"flex",children:[" ",e.jsxs("span",{className:"mt-1 mr-2",children:[" ",e.jsx(W,{})," "]})," ","Search record"]})]})})]})})]}),e.jsxs("div",{className:"mt-10",children:[h&&(t==null?void 0:t.length)!=0&&e.jsx(E,{exportStatus:!1,columns:P,dataList:t}),h&&(t==null?void 0:t.length)==0&&e.jsx("div",{className:"text-xl font-semibold text-red-400 text-center",children:"Data Not Found"}),e.jsx("div",{className:"w-full h-40"})]})]})}export{se as default};
