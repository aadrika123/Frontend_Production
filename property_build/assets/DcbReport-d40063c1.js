import{b as Z,r,f as q,a as m,l as x,j as s,k as G,ab as J,aI as h,aL as n,an as K}from"./index-6de62aa8.js";import{e as Q}from"./index.esm-8875b763.js";import{C as X}from"./CitizenApplyApiList-d62073d7.js";import{b as C}from"./PowerupFunctions-286420ed.js";import{L as y}from"./ListTable-15e04a89.js";import"./GlobalFilter-c16910d2.js";const ce=()=>{const{get_MasterData:F,searchWardWiseDcb:A,yearList:p,getPieChartData:S}=K(),{api_getAllUlb:T}=X();Z("DCB Report");const[g,L]=r.useState(),[$,k]=r.useState(),[j,E]=r.useState(),[u,f]=r.useState(!1),[I,b]=r.useState(!1),[N,W]=r.useState(!1),[t,B]=r.useState(null),[a,O]=r.useState(null),[P,R]=r.useState(!0),[d,V]=r.useState(null),v="form-control block w-full px-2 py-1 font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",i=q({initialValues:{wardId:"",fiYear:"",reportType:"wardWise",withHh:"0"},onSubmit:e=>{R(!1),console.log("submitting report search values => ",e),Y()}}),Y=e=>{f(!0);let c={ulbId:"2",wardId:i.values.wardId,fiYear:i.values.fiYear};console.log("data before hitting api => ",c),m.post(A,c,x()).then(l=>{var o,w,H,_;((o=l==null?void 0:l.data)==null?void 0:o.status)==!0?(console.log("search success => ",l),B((H=(w=l==null?void 0:l.data)==null?void 0:w.data)==null?void 0:H.dcb),O((_=l==null?void 0:l.data)==null?void 0:_.data)):console.log("error while search => ",l),f(!1)}).catch(l=>(console.log("error while search => ",l),f(!1)))};r.useEffect(()=>{b(!0),m.post(S,{ulbId:"2"},x()).then(e=>{var c,l;((c=e==null?void 0:e.data)==null?void 0:c.status)==!0?(console.log("getting pie chart data => ",e),V((l=e==null?void 0:e.data)==null?void 0:l.data)):console.log("error getting pie chart data",e)}).catch(e=>console.log("error getting pie chart data",e)).finally(()=>b(!1)),m.get(F,x()).then(e=>{var c,l,o;((c=e==null?void 0:e.data)==null?void 0:c.status)==!0?(console.log("getting master list data => ",e),L((o=(l=e==null?void 0:e.data)==null?void 0:l.data)==null?void 0:o.ward_master)):console.log("error getting master list",e)}).catch(e=>console.log("error getting master list",e)),m.post(p,{},x()).then(e=>{var c,l;((c=e==null?void 0:e.data)==null?void 0:c.status)==!0?(console.log("year list data => ",e),E((l=e==null?void 0:e.data)==null?void 0:l.data)):console.log("error year list",e)}).catch(e=>console.log("error year list",e)),m.get(T,x()).then(e=>{var c,l;((c=e==null?void 0:e.data)==null?void 0:c.status)==!0?(console.log("year list data => ",e),k((l=e==null?void 0:e.data)==null?void 0:l.data)):console.log("error year list",e)}).catch(e=>console.log("error year list",e))},[]);const M=e=>{const c=e.target.checked;console.log("checkValue",c),c?i.setFieldValue("withHh","1"):i.setFieldValue("withHh","0")},U=[{Header:"_",columns:[{Header:"S.No.",Cell:({row:e})=>s.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Ward No",accessor:"ward_no",Cell:e=>C(e==null?void 0:e.value)}]},{Header:"HOUSEHOLD",columns:[{Header:"Arrear HH",accessor:"arrear_hh",Cell:e=>h(e==null?void 0:e.value)},{Header:"Current HH",accessor:"current_hh",Cell:e=>h(e==null?void 0:e.value)}]},{Header:"DEMAND",columns:[{Header:"Arrear",accessor:"arrear_demand",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})},{Header:"Current",accessor:"current_demand",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})}]},{Header:"COLLECTION",columns:[{Header:"Arrear",accessor:"arrear_collection",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})},{Header:"Current",accessor:"current_collection",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})}]},{Header:"BALANCE",columns:[{Header:"Arrear",accessor:"old_due",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})},{Header:"Current",accessor:"current_due",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})}]}],z=[{Header:"_",columns:[{Header:"S.No.",Cell:({row:e})=>s.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Ward No",accessor:"ward_no",Cell:e=>C(e==null?void 0:e.value)}]},{Header:"DEMAND",columns:[{Header:"Arrear",accessor:"arrear_demand",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})},{Header:"Current",accessor:"current_demand",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})}]},{Header:"COLLECTION",columns:[{Header:"Arrear",accessor:"arrear_collection",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})},{Header:"Current",accessor:"current_collection",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})}]},{Header:"BALANCE",columns:[{Header:"Arrear",accessor:"old_due",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})},{Header:"Current",accessor:"current_due",Cell:e=>s.jsx(s.Fragment,{children:n(e==null?void 0:e.value)})}]}];return s.jsxs(s.Fragment,{children:[u&&s.jsx(G,{}),I?s.jsxs("div",{className:"my-4 w-screen flex-col items-center justify-center",children:[s.jsx(J,{radius:"9",color:"#4338ca",ariaLabel:"three-dots-loading",wrapperStyle:{},wrapperClassName:"",visible:!0}),s.jsx("span",{className:"italic",children:"Pie Chart Loading"})," "]}):s.jsxs(s.Fragment,{children:[P&&(d==null?void 0:d.length)>0&&s.jsxs("div",{className:"my-4 bg-white rounded-md py-2 shadow-md",children:[s.jsx("div",{className:"flex flex-row-reverse flex-wrap items-end justify-evenly gap-x-2 w-[100%] ",children:d==null?void 0:d.map(e=>s.jsx("div",{className:"w-[20%] flex flex-col",children:s.jsx("div",{className:"bg-indigo-500 w-max px-2 text-white rounded-md text-xs sm:text-sm font-semibold shadow-md shadow-indigo-300",children:e==null?void 0:e.fyear})}))}),s.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-4 items-center pt-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"bg-[#22C55E] h-2 sm:h-4 w-7 sm:w-14 inline-block mr-1"}),s.jsx("span",{className:"text-xs sm:text-base",children:"Demand"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"bg-[#6366F1] h-2 sm:h-4 w-7 sm:w-14 inline-block mr-1"}),s.jsx("span",{className:"text-xs sm:text-base",children:"Collection"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"bg-[#EC4899] h-2 sm:h-4 w-7 sm:w-14 inline-block mr-1"}),s.jsx("span",{className:"text-xs sm:text-base",children:"Balance"})]})]})]})," "]}),s.jsxs("form",{onChange:i.handleChange,onSubmit:i.handleSubmit,className:"mb-4 bg-white shadow-lg rounded-md",children:[s.jsx("h1",{className:"text-xl w-full font-bold px-8 pt-4 text-gray-700",children:"Search Report"}),s.jsxs("div",{className:"flex flex-wrap flex-row justify-start w-full gap-x-6 gap-y-2 text-sm 3xl:text-base p-4 px-8",children:[s.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Ward No. :"}),s.jsx("div",{className:"col-span-6",children:s.jsxs("select",{name:"wardId",id:"",className:v,disabled:u,children:[s.jsx("option",{value:"",children:"All"}),g==null?void 0:g.map(e=>s.jsx(s.Fragment,{children:s.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ward_name})}))]})})]}),s.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Financial Year :"}),s.jsx("div",{className:"col-span-6",children:s.jsx("select",{name:"fiYear",id:"",className:v,disabled:u,children:j==null?void 0:j.map(e=>s.jsx(s.Fragment,{children:s.jsx("option",{value:e,children:e})}))})})]}),s.jsxs("div",{className:"flex flex-col justify-center w-full md:w-[20%]",children:[s.jsxs("div",{className:"col-span-6 font-semibold flex items-center mt-4",children:[s.jsx("label",{htmlFor:"withHh",className:"mr-2",children:"With HH : "}),s.jsx("input",{type:"checkbox",name:"withHh",id:"withHh",className:"w-4 h-4 rounded",onChange:M,onClick:()=>W(!N)})]}),s.jsx("div",{className:"col-span-6"})]}),s.jsx("div",{className:"w-full md:w-[20%] flex justify-start items-end",children:s.jsxs("button",{type:"submit",className:"flex flex-row items-center border border-green-600 bg-green-600 hover:bg-green-500 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold px-5 py-1 w-max",children:[" ",s.jsx("span",{className:"mr-2",children:s.jsx(Q,{})}),"Search"]})})]})]}),!u&&t!=null&&(t==null?void 0:t.length)>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white p-2 rounded-md shadow-md mb-4 flex sm:justify-evenly flex-wrap gap-x-4 gap-y-2",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Arrear HH :"}),s.jsx("span",{className:"font-semibold col-span-6",children:h(a==null?void 0:a.total_arrear_hh)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Current HH :"}),s.jsx("span",{className:"font-semibold col-span-6",children:h(a==null?void 0:a.total_current_hh)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total HH :"}),s.jsx("span",{className:"font-semibold col-span-6",children:h(parseInt(a==null?void 0:a.total_arrear_hh)+parseInt(a==null?void 0:a.total_current_hh))})]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Arrear Demand :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(a==null?void 0:a.total_arrear_demand)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Current Demand :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(a==null?void 0:a.total_current_demand)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Demand :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(parseFloat(a==null?void 0:a.total_arrear_demand)+parseFloat(a==null?void 0:a.total_current_demand))})]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Arrear Collection :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(a==null?void 0:a.total_arrear_collection)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Current Collection :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(a==null?void 0:a.total_current_collection)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Collection :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(parseFloat(a==null?void 0:a.total_arrear_collection)+parseFloat(a==null?void 0:a.total_current_collection))})]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Arrear Balance :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(a==null?void 0:a.total_current_due)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Current Balance :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(a==null?void 0:a.total_old_due)})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-2",children:[s.jsx("span",{className:"text-sm col-span-6",children:"Total Balance :"}),s.jsx("span",{className:"font-semibold col-span-6",children:n(parseFloat(a==null?void 0:a.total_current_due)+parseFloat(a==null?void 0:a.total_old_due))})]})]})]}),s.jsx("div",{className:N?"visible":"hidden",children:s.jsx(y,{columns:U,dataList:t})}),s.jsx("div",{className:N?"hidden":"visible",children:s.jsx(y,{columns:z,dataList:t})})]}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"w-full my-4 text-center text-red-500 text-lg font-bold",children:"No Data Found"})}),s.jsx("div",{className:"h-[20vh]"})]})};export{ce as default};
