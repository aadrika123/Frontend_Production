import{r as u,J as H,j as a,N as L,O as D,T,U as E,b as M,f as R,a as k,l as P,i as W,an as I}from"./index-409cf397.js";import{e as O}from"./index.esm-1b05d138.js";import{G as B}from"./GlobalFilter-ceae6621.js";function Y(s){const[F,w]=u.useState("hidden"),b=u.useMemo(()=>s.columns,[]),A=u.useMemo(()=>s.dataList,[s.dataList]);u.useEffect(()=>{l(10)},[]);const{getTableProps:v,getTableBodyProps:y,headerGroups:r,page:o,nextPage:f,previousPage:j,canNextPage:g,canPreviousPage:x,prepareRow:_,pageOptions:S,gotoPage:e,pageCount:t,setPageSize:l,state:i,setGlobalFilter:d}=H.useTable({columns:b,data:A,initialState:{pageIndex:0}},H.useGlobalFilter,H.useSortBy,H.usePagination),{globalFilter:m,pageIndex:h,pageSize:C}=i;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex mb-2 pb-2",children:[a.jsx("div",{className:"flex-initial",children:a.jsx(B,{filter:m,setFilter:d})}),a.jsx("div",{className:"flex-initial ml-2",children:a.jsxs("button",{className:"bg-sky-400 px-3 pr-3  shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onMouseEnter:()=>w(""),onMouseLeave:()=>w("hidden"),children:[a.jsx(L,{data:s.dataList,children:"Export"}),a.jsx("div",{className:F+" absolute h-full top-3 text-sm left-0 text-center animate-bounce",children:a.jsx(D,{})})]})}),a.jsx("div",{className:"flex-1",children:s.children}),s.assessmentType&&a.jsxs("div",{className:"flex-initial flex",children:[a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-initial h-4 w-4 text-green-900 text-xs font-semibold text-center bg-green-200 rounded-full ml-4 ",children:"N"}),a.jsx("div",{className:"flex-initial text-xs ml-2",children:" New Assessment"}),a.jsx("div",{className:"flex-initial h-4 w-4 bg-blue-200  text-blue-900 text-xs font-semibold text-center rounded-full ml-4",children:"R"}),a.jsx("div",{className:"flex-initial text-xs ml-2",children:" Re-Assessment"}),a.jsx("div",{className:"flex-initial h-4 w-4 bg-red-200  text-red-900 text-xs font-semibold text-center rounded-full ml-4",children:"M"}),a.jsx("div",{className:"flex-initial text-xs ml-2",children:" Mutation"})]}),a.jsx("div",{}),a.jsx("div",{})]})]}),a.jsx("div",{className:" py-2 overflow-x-auto bg-white",children:a.jsxs("div",{className:"inline-block min-w-full rounded-lg overflow-hidden bg-white",children:[a.jsxs("table",{...y,className:"min-w-full leading-normal",children:[a.jsx("thead",{className:"font-bold text-left text-sm bg-sky-50",children:r==null?void 0:r.map(n=>a.jsx("tr",{...n.getHeaderGroupProps(),children:n.headers.map(c=>a.jsxs("th",{...c.getHeaderProps(c.getSortByToggleProps()),className:"px-2 py-3 border-[1px] text-center border-gray-200 text-gray-800 text-xs capitalize",children:[c.render("Header"),a.jsx("span",{children:c.isSorted?c.isSortedDesc?"⬆️":"⬇️":""})]}))}))}),a.jsxs("tbody",{...y(),className:"text-sm",children:[" ",o==null?void 0:o.map(n=>{var c;return _(n),a.jsx("tr",{...n.getRowProps(),className:"bg-white shadow-lg border-[1px] border-gray-200",children:(c=n==null?void 0:n.cells)==null?void 0:c.map(N=>a.jsx("td",{...N.getCellProps(),className:"px-2 py-2 text-sm text-left border-[1px] border-gray-200",children:N.render("Cell")}))})}),a.jsx("tr",{children:a.jsx("td",{})})]})]}),a.jsxs("div",{className:"mt-3 grid grid-cols-12",children:[a.jsxs("div",{className:"col-span-2",children:["  ",a.jsx("select",{className:"h-10 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:C,onChange:n=>l(Number(n.target.value)),children:[5,10,25,50].map(n=>a.jsxs("option",{value:n,children:["show ",n]},n))})]}),a.jsxs("div",{className:"col-span-4 text-center col-start-5",children:["   ",a.jsxs("span",{children:["page ","",a.jsxs("strong",{children:[h+1," of ",S.length]}),""]})]}),a.jsxs("div",{className:"col-span-4 text-right",children:[a.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>e(0),disabled:!x,children:[a.jsx(T,{})," "]}),a.jsx("button",{className:(x?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>j(),disabled:!x,children:"⬅️"}),a.jsx("button",{className:(g?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>f(),disabled:!g,children:"➡️"}),a.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>e(t-1),disabled:!g,children:["  ",a.jsx(E,{})]})]})]})]})})]})}const z=()=>{const{get_MasterData:s,searchWardWiseDcb:F,yearList:w}=I();M("Ward Wise DCB");const[b,A]=u.useState(),[v,y]=u.useState(),[r,o]=u.useState(),[f,j]=u.useState(!1),g="form-control block w-full px-2 py-1 font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",x=R({initialValues:{wardId:"",fiYear:""},onSubmit:e=>{console.log("submitting report search values => ",e),_()}}),_=e=>{j(!0);let t={wardId:x.values.wardId,fiYear:x.values.fiYear};console.log("data before hitting api => ",t),k.post(F,t,P()).then(l=>{var i,d;((i=l==null?void 0:l.data)==null?void 0:i.status)==!0?(console.log("search success => ",l),y((d=l==null?void 0:l.data)==null?void 0:d.data)):console.log("error while search => ",l),j(!1)}).catch(l=>(console.log("error while search => ",l),j(!1)))};u.useEffect(()=>{k.get(s,P()).then(e=>{var t,l,i;((t=e==null?void 0:e.data)==null?void 0:t.status)==!0?(console.log("getting master list data => ",e),A((i=(l=e==null?void 0:e.data)==null?void 0:l.data)==null?void 0:i.ward_master)):console.log("error getting master list",e)}).catch(e=>console.log("error getting master list",e)),k.post(w,{},P()).then(e=>{var t,l;((t=e==null?void 0:e.data)==null?void 0:t.status)==!0?(console.log("year list data => ",e),o((l=e==null?void 0:e.data)==null?void 0:l.data)):console.log("error year list",e)}).catch(e=>console.log("error year list",e))},[]);const S=[{Header:"_",columns:[{Header:"S.No.",Cell:({row:e})=>a.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Ward No",accessor:"ward_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"House Hold",accessor:"current_hh",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}}]},{Header:"DEMAND",columns:[{Header:"Arrear (₹)",accessor:"arrear_demand",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Current (₹)",accessor:"current_demand",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Total Demand (₹)",Cell:({cell:e})=>{var t,l,i,d;return parseFloat((l=(t=e==null?void 0:e.row)==null?void 0:t.original)==null?void 0:l.arrear_demand)+parseFloat((d=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:d.current_demand)}},{Header:"Collection From No of HH (₹)",accessor:"collection_from_hh",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}}]},{Header:"COLLECTION",columns:[{Header:"Arrear (₹)",accessor:"arrear_collection",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Current (₹)",accessor:"current_collection",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Total Collection (₹)",Cell:({cell:e})=>{var t,l,i,d;return parseFloat((l=(t=e==null?void 0:e.row)==null?void 0:t.original)==null?void 0:l.arrear_collection)+parseFloat((d=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:d.current_collection)}},{Header:"Balance HH (₹)",accessor:"balance_hh",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}}]},{Header:"BALANCE",columns:[{Header:"Arrear (₹)",accessor:"old_due",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Current (₹)",accessor:"current_due",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Total Balance (₹)",accessor:"outstanding",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return a.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}}]},{Header:"%",columns:[{Header:"HH % Cover",Cell:({cell:e})=>{var i,d,m,h;let t=parseFloat((d=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:d.current_hh)/100,l=(parseFloat((h=(m=e==null?void 0:e.row)==null?void 0:m.original)==null?void 0:h.collection_from_hh)/t).toFixed(2);return l=="NaN"?"0.00":l}},{Header:"Amount % Cover",Cell:({cell:e})=>{var i,d,m,h,C,n,c,N;let t=(parseFloat((d=(i=e==null?void 0:e.row)==null?void 0:i.original)==null?void 0:d.arrear_demand)+parseFloat((h=(m=e==null?void 0:e.row)==null?void 0:m.original)==null?void 0:h.current_demand))/100,l=((parseFloat((n=(C=e==null?void 0:e.row)==null?void 0:C.original)==null?void 0:n.arrear_collection)+parseFloat((N=(c=e==null?void 0:e.row)==null?void 0:c.original)==null?void 0:N.current_collection))/t).toFixed(2);return l=="NaN"?"0.00":l}}]}];return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onChange:x.handleChange,onSubmit:x.handleSubmit,className:"mb-4 bg-white shadow-lg rounded-md",children:[a.jsx("h1",{className:"text-xl w-full font-bold px-8 pt-4 text-gray-700",children:"Search Report"}),a.jsxs("div",{className:"flex flex-wrap flex-row justify-start w-full gap-x-6 gap-y-2 text-sm 3xl:text-base p-4 px-8",children:[a.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[a.jsx("div",{className:"col-span-6 font-semibold",children:"Ward No. :"}),a.jsx("div",{className:"col-span-6",children:a.jsxs("select",{name:"wardId",id:"",className:g,disabled:f,children:[a.jsx("option",{value:"",children:"All"}),b==null?void 0:b.map(e=>a.jsx(a.Fragment,{children:a.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ward_name})}))]})})]}),a.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[a.jsx("div",{className:"col-span-6 font-semibold",children:"Financial Year :"}),a.jsx("div",{className:"col-span-6",children:a.jsx("select",{name:"fiYear",id:"",className:g,disabled:f,children:r==null?void 0:r.map(e=>a.jsx(a.Fragment,{children:a.jsx("option",{value:e,children:e})}))})})]}),a.jsx("div",{className:"w-full md:w-[20%] flex justify-start items-end",children:f?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx(W,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):a.jsxs("button",{type:"submit",className:"flex flex-row items-center border border-green-600 bg-green-600 hover:bg-green-500 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold px-5 py-1 w-max",children:[" ",a.jsx("span",{className:"mr-2",children:a.jsx(O,{})}),"Search"]})})]})]}),!f&&v!=null&&(v==null?void 0:v.length)!=0?a.jsx(a.Fragment,{children:a.jsx(Y,{columns:S,dataList:v})}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"w-full my-4 text-center text-red-500 text-lg font-bold",children:"No Data Found"})}),a.jsx("div",{className:"h-[20vh]"})]})};export{z as default};
