import{g as J,a as r,u as K,a0 as Q,j as e,b as I}from"./react-304bc6bc.js";import{u as X}from"./formik.esm-b5323b56.js";import{c as ee,a as z}from"./object-f873fecd.js";import{C as te}from"./CitizenApplyApiList-f5f1cc72.js";import{R as ae}from"./Blocks-3268ddde.js";import{c as N,a as oe}from"./PowerupFunctions-89427d0e.js";import{c as se,n as S}from"./index-ff45b2e2.js";import re from"./MobileNoCard-83c804e1.js";import ie from"./OtpCard-89066bb9.js";import{C as le}from"./CommonModal-3143ba46.js";import{S as ne}from"./ServerErrorCard-6686f9f6.js";import{E as de}from"./EPramanLoginLoader-5884fa0f.js";import{A as me}from"./ApiHeader-98968871.js";import"./BackendUrl-b545fbc2.js";import"./index-5febc24e.js";import"./BarLoader-3bc14279.js";/* empty css                  */import"./BottomErrorCard-422f9d4d.js";import"./index-69dc9777.js";import"./index.esm-0f2a749c.js";const ce="/assets/login2-88f52aba.svg",Fe=()=>{const{via:v}=J(),[C,b]=r.useState(!1),[F,h]=r.useState(!1),[V,w]=r.useState(!1),{api_citizenLogin2:_,api_ePramanLogin:L}=te(),[A,D]=r.useState(null),[O,P]=r.useState(!1),{notify:g,setheartBeatCounter:T}=r.useContext(se),l=K(),[R,y]=r.useState();r.useState(!0);const B=()=>{window.localStorage.getItem("citizen_token")&&l("/landingDashboard")},j=Q(),$=()=>{let o=j==null?void 0:j.search,t=o==null?void 0:o.split("?")[1],i=t==null?void 0:t.split("&");const n={};i==null||i.forEach(a=>{const[d,m]=a.split("=");n[d]=m}),P(!0);let c={codeVerifier:window.localStorage.getItem("codeVerifier"),nonce:window.localStorage.getItem("nonce"),code:n==null?void 0:n.code,type:"citizen"};I.post(L,c,me()).then(a=>{var d,m,p,u,x,f,E,M;(d=a==null?void 0:a.data)!=null&&d.status?(window.localStorage.removeItem("codeVerifier"),window.localStorage.removeItem("nonce"),window.localStorage.setItem("citizenMobile",(p=(m=a==null?void 0:a.data)==null?void 0:m.data)==null?void 0:p.mobile),window.localStorage.setItem("citizenName",(x=(u=a==null?void 0:a.data)==null?void 0:u.data)==null?void 0:x.userName),window.localStorage.setItem("citizen_token",(E=(f=a==null?void 0:a.data)==null?void 0:f.data)==null?void 0:E.token),l("/landingDashboard")):(S.error(N((M=a==null?void 0:a.data)==null?void 0:M.message,L,c)),S.error("Oops! Please try again later."),l("/"))}).catch(a=>{S.error("Oops! Please try again later."),l("/")}).finally(()=>{P(!1)})};r.useEffect(()=>{v=="e-pramaan"?$():B()},[]);const q=ee().shape({mobile:z().required("Enter mobile no. !").min(10).max(10),password:z().min(6,"Minimum six character !").max(50,"Too Long!").required("Enter password no. !").matches(/^(?=.\d)(?=.[!@#$%^&])(?=.[a-z])(?=.*[A-Z]).{6,}$/,"Password Must Contains (Capital, Smail, Number, Special) eg - Abc123#.")}),s=X({initialValues:{mobile:"",password:""},onSubmit:o=>{Y(o)},validationSchema:q}),Y=o=>{y(""),b(!0),k(!1),I.post(_,{mobile:o==null?void 0:o.mobile,password:o==null?void 0:o.password}).then(t=>{var i,n,c,a,d,m,p,u,x;((i=t==null?void 0:t.data)==null?void 0:i.status)===!0?(localStorage.setItem("citizen_token",(c=(n=t==null?void 0:t.data)==null?void 0:n.data)==null?void 0:c.token),b(!1),g("Login Success","success"),window.localStorage.setItem("citizenMobile",(d=(a=t==null?void 0:t.data)==null?void 0:a.data)==null?void 0:d.mobile),window.localStorage.setItem("citizenName",(p=(m=t==null?void 0:t.data)==null?void 0:m.data)==null?void 0:p.userName),T(f=>f+1),l("/landingDashboard")):(g(N((u=t==null?void 0:t.data)==null?void 0:u.message),"error"),b(!1)),y(N((x=t==null?void 0:t.data)==null?void 0:x.message))}).catch(t=>{y("Oops! Please try again later."),b(!1),k(!0),g("something went wrongg !!","error")})},H=o=>{let t=o.target.name,i=o.target.value;t=="mobile"&&s.setFieldValue("mobile",oe(i,s.values.mobile,10))},U=()=>{g("Mobile no. has been verified successfully !","success"),l("/change-password/forgot")},W=()=>{h(!1)},Z=()=>{w(!1)},[G,k]=r.useState(!1);return G?e.jsx(le,{children:e.jsx(ne,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"})}):F?e.jsx(re,{cardFor:"Login",closeMobileModal:W,headTitle:"Forgot Password",title:"Enter mobile to get OTP",desc:"Enter your mobile no, which is attached to your account.",setverifedMobileNo:D,setmobileCardStatus:h,setotpCardStatus:w}):V?e.jsx(ie,{verifedMobileNo:A,closeOtpModal:Z,bottomNaviation:!0,headTitle:"Forgot OTP",callback:U,setotpCardStatus:w}):e.jsxs(e.Fragment,{children:[O&&e.jsx(de,{message:"Login Via E-Pramaan"}),v=="local"&&e.jsx("div",{className:" flex items-center justify-center text-center mt-6 md:p-0 mx-auto bg-white md:bg-none shadow-lg md:shadow-none w-full h-full",children:e.jsx("div",{className:" w-full h-full flex justify-center",children:e.jsx("form",{onChange:H,onSubmit:s.handleSubmit,className:"md:w-[60%] w-full md:h-[60%]",children:e.jsxs("div",{className:"grid grid-cols-12 px-6 md:px-0 drop-shadow-md w-full",children:[e.jsx("div",{className:"col-span-6 hidden md:py-10 bg-slate-100 p-5 md:flex justify-center items-center border-r",children:e.jsx("img",{src:ce,className:"hue-rotate-[-30deg] w-[80%]"})}),e.jsx("div",{className:"w-full md:px-10 col-span-12 md:col-span-6 md:shadow-none bg-white py-10 px-4",children:e.jsxs("div",{className:"w-full  pb-6 pt-0 md:py-6 md:mt-10 text-gray-700",children:[e.jsx("h1",{className:"text-center text-md font-semibold md:my-1 capitalize w-full"}),e.jsx("h1",{className:"text-center font-semibold my-1 flex justify-center",children:e.jsxs("span",{className:"px-1 text-semibold text-2xl -mt-5 mb-4 border-b-2 border-b-[#99B37C]",children:["Log In"," "]})}),e.jsxs("div",{className:"my-3 relative text-sm",children:[e.jsxs("div",{className:"text-gray-600 static mb-1 font-semibold text-left px-8 md:px-10 ",children:["Mobile No.",e.jsx("span",{className:"text-red-500 font-bold",children:"*"})]}),e.jsx("input",{type:"text",min:0,...s.getFieldProps("mobile"),className:"cypress_mobile border-b border-b-gray-200 focus:border-b focus:border-b-indigo-500  pl-2 px-3 py-1 w-full md:w-5/6 shadow-sm h-10 outline-none border border-solid border-gray-300 rounded hover:bg-gray-100",placeholder:"Enter Your mobile"}),e.jsx("div",{children:e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.mobile&&s.errors.mobile?s.errors.mobile:null})})]}),e.jsxs("div",{className:"my-3 relative text-sm mt-4",children:[e.jsxs("div",{className:"text-gray-600 static mb-1 font-semibold text-left px-8 md:px-10",children:["Password"," ",e.jsx("span",{className:"text-red-500 font-bold",children:"*"})]}),e.jsx("input",{type:"password",...s.getFieldProps("password"),className:"cypress_password border-b border-b-gray-200 focus:border-b focus:border-b-indigo-500  pl-2 px-3 py-1 w-full md:w-5/6 shadow-sm h-10 outline-none border border-solid border-gray-300 rounded hover:bg-gray-100",placeholder:"Enter Your Password"}),e.jsx("div",{children:e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.password&&s.errors.password?s.errors.password:null})})]}),e.jsx("div",{className:" my-10"}),e.jsx("div",{className:"text-center mt-3 text-xs"}),e.jsxs("div",{className:"my-5 self-center justify-self-center relative",children:[e.jsxs("div",{className:"text-red-600 text-sm font-semibold my-3 ",children:[" ",e.jsxs("span",{className:"",children:[" ",R]})]}),C?e.jsx("div",{className:"flex justify-center",children:e.jsx(ae,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsx("button",{type:"submit",disabled:C,className:"cypress_button_login bg-[#99B37C] hover:bg-[#99B37C] px-5 shadow-xl py-2 w-1/2  rounded-md text-white text-lg font-semibold",children:"Login"})]}),e.jsx("div",{className:"flex flex-row flex-wrap gapx-x-2 gap-y-2 w-full poppins justify-center",children:e.jsx("span",{className:"text-gray-700 text-sm font-semibold cursor-pointer md:w-[40%] w-full",onClick:()=>h(!0),children:"Forgot Password"})}),e.jsx("div",{className:"w-full flex justify-center mt-10",children:e.jsx("span",{onClick:()=>l("/register"),className:"hover:underline text-gray-700 font-semibold hover:bg-white px-3 py-1 cursor-pointer float-right",children:"Register"})})]})})]})})})})]})};export{Fe as default};
