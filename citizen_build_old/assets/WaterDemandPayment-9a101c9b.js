import{j as e}from"./mui-8e804a04.js";import{a as J,u as R,r as d,f as K}from"./router-87042356.js";import{f as Y}from"./index.esm-df462c79.js";import{h as m}from"./moment-fbc5633a.js";import{l as Q,A as b,c as X,d as I,u as Z}from"./index-2e21c499.js";import{W as ee}from"./WaterApiList-63dae849.js";import"./RazorpayPaymentScreen-0604b0ea.js";import{B as se}from"./BarLoader-b687f4d9.js";import{M as te}from"./index-4e794517.js";import{a as oe}from"./index.esm-2e3a7c1f.js";import{i as re}from"./success-39308b33.js";import{U as ne}from"./UseRazorpay-62e4000a.js";import"./react-09dd1212.js";import"./reactIcons-6a3b6da1.js";import"./axios-97164839.js";import"./redux-4db06ad6.js";import"./i18next-e99b4042.js";import"./CitizenApplyApiList-1913babe.js";import"./logo1-66954bc2.js";import"./index-48d14c2d.js";const ae={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"transparent",border:"none"}};function le(x){const[t,f]=J.useState(!1),a=x==null?void 0:x.transData,i=R(),c=x.paymentData;console.log("paymentData======",c),d.useEffect(()=>{f(!0)},[]);function N(){}function p(){f(!1),i("/water-dashboard")}return e.jsx("div",{className:"",children:e.jsx(te,{isOpen:t,onAfterOpen:N,onRequestClose:p,style:ae,contentLabel:"Example Modal",children:e.jsx("div",{children:e.jsxs("div",{className:"bg-green-200 shadow-2xl border border-sky-200 p-5 m-5 rounded-md",children:[e.jsxs("div",{onClick:p,className:"absolute cursor-pointer bg-green-100 hover:bg-gray-300 p-1 rounded-md",children:[e.jsx(oe,{})," "]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:re,className:"h-20",alt:"",srcset:""})}),e.jsx("div",{className:"py-1 pl-3 font-semibold text-center text-2xl text-gray-800",children:" Payment Completed Successfully "}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-base",children:" Payment Transaction No"})," ",e.jsx("span",{className:"font-bold text-blue-700 text-xl",children:a==null?void 0:a.transectionNo})]}),e.jsx("p",{className:"border-b border-gray-300 mx-10 py-1"}),e.jsxs("div",{className:"grid grid-cols-12 px-8 py-3 leading-8 space-x-8 text-sm",children:[e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Application No"}),e.jsx("p",{children:"Transaction Type"})]}),e.jsxs("div",{className:"col-span-6 ml-3",children:[e.jsx("p",{children:(a==null?void 0:a.applicationNo)||"NA"}),e.jsx("p",{children:(a==null?void 0:a.tranType)||"NA"})]})]})}),e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Amount"}),e.jsx("p",{children:"Payment Date"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("p",{children:a==null?void 0:a.amount}),e.jsx("p",{children:a==null?void 0:a.transectionDate})]})]})}),e.jsx("div",{className:"col-span-12 md:mt-4 mt-10",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:p,className:"mx-2 bg-sky-600 hover:bg-sky-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-1 text-sm rounded-sm shadow-xl",children:"Close"}),a&&e.jsx("button",{onClick:()=>i(`/waterUserReceipt/${a==null?void 0:a.transectionNo}`),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"View Receipt"})]})})]})]})})})})}const Re=x=>{var M,k,S;const[t,f]=d.useState(),[a,i]=d.useState(!1),[c,N]=d.useState(),{handlePayment:p}=ne(),[n,j]=d.useState(),[h,U]=d.useState(),[y,E]=d.useState(),[T,de]=d.useState(!1),[O,ce]=d.useState(),[ie,_]=d.useState(!1),{id:g}=K(),v=R(),{notify:A}=d.useContext(Q),{api_generatedreceipt:L,api_getTranNo:me,api_waterApprovedApplicationDetails:W,api_waterListDemand:q,api_waterDemandCalculation:z,api_waterDemandPayment:B,header:u}=ee();d.useEffect(()=>{C(),V()},[g]),d.useEffect(()=>{G()},[y,h]);const G=()=>{if(y==""||h=="")return j();i(!0);const s={consumerId:g,demandFrom:h,demandUpto:y};b.post(z,s,u).then(function(o){console.log("water demand calculation Details",o.data.data),j(o.data.data),i(!1)}).catch(function(o){console.log("Error : water calculating demand",o),i(!1)})},C=()=>{i(!0),b.post(W,{id:g},u).then(function(s){console.log("water Approved Application Details",s.data.data),f(s.data.data),i(!1)}).catch(function(s){console.log("Error : water Approved Application Details",s),i(!1)})},V=()=>{b.post(q,{ConsumerId:g},u).then(s=>{console.log("Fetched Water Demand List",s.data.data),N(s.data.data)}).catch(s=>{console.log("Exception while fetching Water Demand",s)})},$=async s=>{console.log("generateReceipt",s),console.log(s);let o={applicationId:s==null?void 0:s.applicationId,departmentId:s==null?void 0:s.departmentId,status:"",captured:"1",card_id:"",amount:s==null?void 0:s.amount,payment_method:"upi/netbanking",workflow_id:s==null?void 0:s.workflowId,user_id:s==null?void 0:s.userId,ulb_id:s==null?void 0:s.ulbId,payment_order_id:s==null?void 0:s.razorpay_order_id,payment_id:s==null?void 0:s.razorpay_payment_id,created_at:""};console.log("Receipt",s),b.post(L,o,u).then(l=>{var P;console.log("genereted receipt",l),l.data.status==!0?(console.log("Oder ID Generated ++++dddddddddddddddddddddddd+++++",l.data),v(`/waterUserReceipt/${(P=l==null?void 0:l.data)==null?void 0:P.data}`)):toast.error(l.data.message,"error")}).catch(l=>{console.log("Error genrating order id",l),toast.error(l.message,"error")})},F=()=>{i(!0);const s={consumerId:g,demandFrom:h,demandUpto:y,amount:n==null?void 0:n.totalPayAmount,paymentMode:"online",remarks:"citizen payment"};console.log("final submit",s),b.post(B,s,u).then(o=>{var l;console.log("Oder ID Generated",o),_(!1),o.data.status==!0?(p((l=o==null?void 0:o.data)==null?void 0:l.data,$),v("/water-dashboard",{replace:!0})):A(o.data.message,"error")}).catch(o=>{_(!1),console.log("Error genrating order id",o),A(o.message,"error")})},H=X({monthFrom:I().required("Require Field"),monthUpto:I().required("Require Field")}),r=Z({enableReinitialize:!0,initialValues:{monthFrom:"",monthUpto:"",penalty:"",rebate:"",advanced:""},onSubmit:(s,o)=>{F()},validationSchema:H}),D=s=>{let o=s.target.name,l=s.target.value;o=="monthFrom"&&U(l),o=="monthUpto"&&E(l)},w=(M=c==null?void 0:c.consumerDemands)==null?void 0:M.filter(s=>m(s.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=m(h,"YYYY-MM-DD").format("yy-MM"));return e.jsxs(e.Fragment,{children:[a&&e.jsx(se,{}),T&&e.jsx(le,{transData:O}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:e.jsxs("div",{className:"col-span-12 rounded-lg p-4 max-sm:p-0",children:[e.jsx("div",{className:"p-4 max-sm:p-2",children:e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e.jsx(Y,{className:"inline"})," Basic Details"]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:e.jsxs("div",{className:"flex space-x-5 pl-4 max-sm:flex-col max-sm:space-x-0 max-sm:space-y-2 ",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:t!=null&&t.ulb_name?t==null?void 0:t.ulb_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"ULB Name"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t!=null&&t.ward_name?t==null?void 0:t.ward_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ward No."})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t!=null&&t.consumer_no?t==null?void 0:t.consumer_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Consumer No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t!=null&&t.connection_through?t==null?void 0:t.connection_through:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Connection Through"})]}),(t==null?void 0:t.connection_through)=="SAF"?e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:t!=null&&t.saf_no?t==null?void 0:t.saf_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"SAF No"})]}):e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:t!=null&&t.holding_no?t==null?void 0:t.holding_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Holding No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:t!=null&&t.owner_char_type?t==null?void 0:t.owner_char_type:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ownership Type"})]})]})})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-5 p-4",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e.jsx(Y,{className:"inline"}),"Due Demand Details"]}),e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e.jsx("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand From"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Upto"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Amount"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Penalty"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Connection Type"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Payable Amount "})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:(k=c==null?void 0:c.consumerDemands)==null?void 0:k.map((s,o)=>e.jsxs("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:o+1}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.demand_from?m(s==null?void 0:s.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.demand_upto?m(s==null?void 0:s.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.balance_amount?s==null?void 0:s.balance_amount:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.penalty?s==null?void 0:s.penalty:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.connection_type?s==null?void 0:s.connection_type:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.amount?"₹ "+(s==null?void 0:s.amount):"N/A"})]}))})})]})})]})}),e.jsx("div",{className:"col-span-12 rounded-lg p-4",children:e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e.jsx("form",{onSubmit:r.handleSubmit,onChange:D,className:"p-4 relative",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month From"]}),e.jsxs("select",{...r.getFieldProps("monthFrom"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),(S=c==null?void 0:c.consumerDemands)==null?void 0:S.map((s,o)=>e.jsx("option",{value:s.demand_from,children:m(s.demand_from,"YYYY-MM-DD").format("MMM-yy")},o))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.monthFrom&&r.errors.monthFrom?r.errors.monthFrom:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month Upto"]}),e.jsxs("select",{...r.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),w==null?void 0:w.map((s,o)=>e.jsx("option",{value:s.demand_upto,children:m(s.demand_upto,"YYYY-MM-DD").format("MMM-yy")},o))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.monthUpto&&r.errors.monthUpto?r.errors.monthUpto:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Total Demand"}),e.jsx("input",{...r.getFieldProps("amount"),value:(n==null?void 0:n.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.amount&&r.errors.amount?r.errors.amount:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Penalty"}),e.jsx("input",{...r.getFieldProps("penalty"),value:(n==null?void 0:n.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.penalty&&r.errors.penalty?r.errors.penalty:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Rebate"}),e.jsx("input",{...r.getFieldProps("rebate"),value:(n==null?void 0:n.totalRebate)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.rebate&&r.errors.rebate?r.errors.rebate:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Advanced"}),e.jsx("input",{...r.getFieldProps("advanced"),value:(n==null?void 0:n.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.advanced&&r.errors.advanced?r.errors.advanced:null})]}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:["Remain Advance : ",e.jsx("span",{className:"text-orange-700 font-semibold",children:(n==null?void 0:n.remaningAdvanceAmount)||0})]})}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:[" Payable Amount : ",e.jsx("span",{className:"text-green-700 font-semibold",children:n!=null&&n.totalPayAmount?"₹"+(n==null?void 0:n.totalPayAmount):0})]})}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e.jsx("div",{className:""}),e.jsxs("div",{className:"md:pl-10 text-right space-x-5 max-sm:space-x-0 max-sm:pl-0 max-sm:space-y-2",children:[e.jsx("button",{type:"button",onClick:()=>v(-1),className:" px-6 py-2.5 max-sm:px-8 bg-sky-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-sky-700 hover:shadow-lg focus:bg-sky-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Back"}),e.jsx("button",{type:"submit",className:" px-6 py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-600 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Pay Now"})]})]})]})})})})]})})]})};export{Re as default};
