import{u as K,J as U,w as V,d as Q,o as W,r as o,j as a,D as X,F as Z,R as aa,M as D,B as ea,e as sa,f as ta,i as f,_ as c,N as J,x as na,y as ra,z as la,A as ca,G as ia,O as oa}from"./index-sBt8KVQv.js";import{P as da}from"./index-bghbaOW_.js";import{T as pa,a as ha,b as O,c as p,d as ua,e as h}from"./table-DhJaKXns.js";import{g as xa}from"./services-KQnp_8oA.js";import{P as ma}from"./index-CWE-6F3H.js";import{S as ja}from"./index-m0Xp7Z0A.js";import{q as ga}from"./switch-C4sUQQw-.js";import"./badge-k_k0X2i3.js";import"./index-0SY1KMsh.js";import"./circle-check-big-gd_18BkE.js";import"./pagination-C0kqlCDZ.js";const fa=sa().shape({complaintTypeName:ta().required("Complaint type name is required")});function ya({open:u,setOpen:y,title:P,id:d,edit:i,setEdit:x,refetch:v}){const S=K({}),m=U({}),{data:l,isFetching:w}=V({api:`${f.getComplaintTypeById}/${d}`,key:"getComplaintSourceById",options:{enabled:i}}),r=Q({defaultValues:{complaintTypeName:""},resolver:W(fa)}),N=async s=>{var T,C,j,g;try{if(i&&s){const t=await m.mutateAsync({api:`${f.updateComplaintType}/${d}`,data:s});(T=t.data)!=null&&T.success?c.success((C=t==null?void 0:t.data)==null?void 0:C.message):c.error("Complaint Source not updated successfully")}else{const t=await S.mutateAsync({api:f.createComplaintType,data:s});(j=t.data)!=null&&j.success?c.success((g=t==null?void 0:t.data)==null?void 0:g.message):c.error("Complaint Source not created successfully"),r.reset({complaintTypeName:""})}y(!1),x(!1),v()}catch(t){console.log(t)}};return o.useEffect(()=>{var s;i&&l?r.reset({complaintTypeName:(s=l==null?void 0:l.data)==null?void 0:s.complaintTypeName}):r.reset({complaintTypeName:""})},[i,l]),a.jsx(X,{open:u,setOpen:y,title:P,setEdit:x,edit:i,isLoading:w,children:a.jsx(Z,{methods:r,onSubmit:r.handleSubmit(N),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(aa,{name:"complaintTypeName",placeholder:"Enter Complaint Type "})}),a.jsx(D,{}),a.jsx("div",{children:a.jsx(ea,{isLoading:r.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Na(){var j,g,t,$,A,E,F,M,B,k,L;const[u,y]=o.useState(1),P=U({}),[d,i]=o.useState(5),[x,v]=o.useState(""),[S,m]=o.useState(!1),[l,w]=o.useState(""),[r,N]=o.useState(!1),s=V({api:`${f.getAllComplaintType}?page=${u}&limit=${d}&q=${x}`,key:"getAllComplaintSource",value:[u,d],options:{enabled:!0}}),T=e=>{N(!0),m(!0),w(e)},C=async e=>{var b,_,q,I,H,R,Y,z,G;try{const n=await P.mutateAsync({api:`${(b=f)==null?void 0:b.updateComplaintTypeStatus}/${e}`,data:{id:l}});(_=n==null?void 0:n.data)!=null&&_.success?(s.refetch(),((I=(q=n==null?void 0:n.data)==null?void 0:q.data)==null?void 0:I.status)==1&&c.success((H=n.data)==null?void 0:H.message),((Y=(R=n==null?void 0:n.data)==null?void 0:R.data)==null?void 0:Y.status)==0&&c.error((z=n.data)==null?void 0:z.message)):c.error((G=n.data)==null?void 0:G.message)}catch(n){c.error(xa(n))}};return a.jsxs("main",{className:"grid items-start",children:[a.jsx(ya,{open:S,setOpen:m,title:r?"Edit Complaint Type":"Add Complaint Type",id:l,edit:r,setEdit:N,refetch:s.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(ja,{search:x,setSearch:v,refetch:s.refetch,isFetching:s.isLoading})}),a.jsx("div",{children:a.jsx(J,{className:"flex items-center gap-2",onClick:()=>m(!0),children:"Add New"})})]}),a.jsxs(na,{children:[a.jsx(ra,{className:"px-7",children:a.jsxs(la,{children:["Complaint Type List (",(g=(j=s.data)==null?void 0:j.data)==null?void 0:g.totalDocs,")"]})}),a.jsx(ca,{children:s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(ia,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(pa,{children:[a.jsx(ha,{children:a.jsxs(O,{children:[a.jsx(p,{className:"",children:"#"}),a.jsx(p,{className:"",children:" Complaint Type Name"}),a.jsx(p,{className:"",children:"Id"}),a.jsx(p,{className:"",children:"Created at"}),a.jsx(p,{className:"",children:"Status"}),a.jsx(p,{children:"Action"})]})}),a.jsx(ua,{children:(A=($=(t=s==null?void 0:s.data)==null?void 0:t.data)==null?void 0:$.docs)==null?void 0:A.map((e,b)=>a.jsxs(O,{children:[a.jsx(h,{children:b+1}),a.jsx(h,{children:e==null?void 0:e.complaintTypeName}),a.jsx(h,{children:e==null?void 0:e._id}),a.jsx(h,{children:oa(e==null?void 0:e.createdAt).format("DD-MM-YYYY")}),a.jsx(h,{children:a.jsxs(ga,{checked:(e==null?void 0:e.status)==1,onChange:()=>C(e._id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),a.jsx(h,{children:a.jsx(J,{onClick:()=>T(e==null?void 0:e._id),children:"Edit"})})]},e==null?void 0:e._id))})]}),a.jsx(D,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(ma,{page:u,perPage:d,totalPage:(F=(E=s==null?void 0:s.data)==null?void 0:E.data)==null?void 0:F.totalDocs,hasNextPage:(B=(M=s==null?void 0:s.data)==null?void 0:M.data)==null?void 0:B.hasNextPage,hasPrevPage:(L=(k=s==null?void 0:s.data)==null?void 0:k.data)==null?void 0:L.hasPrevPage,setPage:y,setPerPage:i})})]})})]})]})]})}function Ma(){return a.jsx(da,{title:"Complaint Types",subTitle:"Manage all the Complaint Types here",children:a.jsx("div",{className:"",children:a.jsx(Na,{})})})}export{Ma as default};
