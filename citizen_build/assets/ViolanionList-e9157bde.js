import{j as e}from"./mui-7fe93ce1.js";import{r as o}from"./router-e237bf16.js";import{L as E}from"./ListTable-0d379a7d.js";import{c as V,d as D,u as F,A as H,b as h,an as B,P as U,n as x,Y as P}from"./index-28833def.js";import{a as T}from"./axios-ab7cc016.js";import{u as p,w as q}from"./xlsx-f5126985.js";import{B as R}from"./BarLoader-df4e1847.js";import"./reactIcons-fd892024.js";import"./redux-20438136.js";import"./i18next-2edfafb0.js";const Z=()=>{const{api_violation_list:b,api_ulbList:f}=U(),[g,i]=o.useState(!1),[r,c]=o.useState([]),[d,j]=o.useState([]),[Y,v]=o.useState(0),[u,w]=o.useState(null),[N,y]=o.useState(!1),[S,m]=o.useState(!1),_="form-control block w-full px-2 py-1 font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",L=V({ulbId:D().required("Select Your Ulb")}),n=F({initialValues:{ulbId:""},onSubmit:t=>{w({ulbId:t.ulbId}),v(a=>a+1),y(!0)},validationSchema:L}),C=()=>{i(!0),T.get(f,{},h()).then(t=>{var a,s;i(!1),((a=t==null?void 0:t.data)==null?void 0:a.status)==!0&&j((s=t==null?void 0:t.data)==null?void 0:s.data)}).catch(t=>{i(!1),console.log("Error fetching collector list:",t)})};o.useEffect(()=>{C()},[]),o.useEffect(()=>{u&&(m(!0),H.post(b,{userType:"EO",...u},h()).then(t=>{var a,s;(a=t==null?void 0:t.data)!=null&&a.status?(c((s=t==null?void 0:t.data)==null?void 0:s.data),m(!1)):c([])}).catch(t=>{console.log("Error fetching data:",t),c([]),m(!1)}))},[u]);const k=[{Header:"#",Cell:({row:t})=>e.jsx("div",{className:"pr-2",children:(t==null?void 0:t.index)+1})},{Header:"Violation Name",accessor:"violation_name",Cell:({cell:t})=>{var a;return x((a=t.row.original)==null?void 0:a.violation_name)}},{Header:"Violation Section",accessor:"violation_section",Cell:({cell:t})=>{var a;return x((a=t.row.original)==null?void 0:a.violation_section)}},{Header:"Department",accessor:"department_name",Cell:({cell:t})=>{var a;return x((a=t.row.original)==null?void 0:a.department_name)}},{Header:"Penalty Amount",accessor:"penalty_amount",Cell:({cell:t})=>{var a;return P((a=t.row.original)==null?void 0:a.penalty_amount)}}],A=()=>{if(r.length===0){alert("No data available to export.");return}const t=r.map((l,I)=>({"#":I+1,"Violation Name":l.violation_name||"N/A","Violation Section":l.violation_section||"N/A",Department:l.department_name||"N/A","Penalty Amount":l.penalty_amount||"N/A"})),a=p.json_to_sheet(t),s=p.book_new();p.book_append_sheet(s,a,"Violation List"),q(s,"Violation_List.xlsx")};return e.jsxs(e.Fragment,{children:[S&&e.jsx(R,{}),e.jsxs("div",{className:"w-full  md:pt-10 bg-white shadow-lg rounded-md",children:[e.jsx("form",{onChange:n.handleChange,onSubmit:n.handleSubmit,className:"mb-4 ml-[30%]",children:e.jsxs("div",{className:"flex flex-wrap flex-row justify-start w-full gap-x-6 gap-y-2 text-sm 3xl:text-base p-4 px-8",children:[e.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[e.jsx("div",{className:"col-span-6 font-semibold",children:"Select Ulb"}),e.jsx("div",{className:"col-span-6",children:e.jsxs("select",{name:"ulbId",id:"ulbId",className:_,value:n.values.ulbId,onChange:n.handleChange,children:[e.jsx("option",{value:"",children:"Select Your ULB"}),g?e.jsx("option",{value:"",disabled:!0,children:"Loading..."}):d==null?void 0:d.map(t=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.ulb_name},t==null?void 0:t.id))]})}),e.jsx("div",{className:"col-span-12 text-center",children:n.touched.ulbId&&n.errors.ulbId&&e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-red-600 text-xs",children:n.errors.ulbId})})})]}),e.jsx("div",{className:"w-full md:w-[20%] flex justify-start items-center mt-4",children:e.jsxs("button",{type:"submit",className:"flex flex-row items-center border border-green-600 bg-green-600 hover:bg-green-400 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold px-5 py-1 w-max",children:[" ",e.jsx("span",{className:"mr-2",children:e.jsx(B,{})}),"Search "]})})]})}),N&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"uppercase font-semibold text-gray-700 text-2xl py-2 text-center tracking-[0.5rem]",children:"Violation List"}),e.jsx("div",{className:"flex justify-end -mb-5 mr-12",children:e.jsx("button",{type:"button",onClick:()=>A(),className:"border border-blue-600 bg-blue-600 hover:bg-blue-500 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold mr-7 mt-0 px-5 py-1",children:"Export"})}),e.jsx(E,{columns:k,dataList:r,exportStatus:!1})]})]})]})};export{Z as default};
