import{j as t}from"./mui-7fe93ce1.js";import{r as o}from"./router-e237bf16.js";import{L as k}from"./ListTable-28a3dfc5.js";import{c as F,d as H,u as D,A as O,b as h,an as U,P as B,n as f}from"./index-053d917c.js";import{a as P}from"./axios-ab7cc016.js";import{u as x,w as R}from"./xlsx-f5126985.js";import{B as T}from"./BarLoader-419fe7a0.js";import"./reactIcons-fd892024.js";import"./redux-20438136.js";import"./i18next-2edfafb0.js";const X=()=>{const[i,n]=o.useState([]),[c,p]=o.useState([]),[q,b]=o.useState(0),[d,g]=o.useState(null),[w,j]=o.useState(!1),{api_enf_officer:N,api_ulbList:v}=B(),y="form-control block w-full px-2 py-1 font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",[S,m]=o.useState(!1),[E,u]=o.useState(!1),_=F({ulbId:H().required("Select Your Ulb")}),r=D({initialValues:{ulbId:""},onSubmit:e=>{g({ulbId:e.ulbId}),b(a=>a+1),j(!0)},validationSchema:_}),C=()=>{u(!0),P.get(v,{},h()).then(e=>{var a,s;u(!1),((a=e==null?void 0:e.data)==null?void 0:a.status)==!0&&p((s=e==null?void 0:e.data)==null?void 0:s.data)}).catch(e=>{u(!1),console.log("Error fetching collector list:",e)})};o.useEffect(()=>{C()},[]),o.useEffect(()=>{d&&(m(!0),O.post(N,{userType:"EO",...d},h()).then(e=>{var a,s;(a=e==null?void 0:e.data)!=null&&a.status?(n((s=e==null?void 0:e.data)==null?void 0:s.data),m(!1)):n([])}).catch(e=>{console.log("Error fetching data:",e),n([]),m(!1)}))},[d]);const A=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Profile",accessor:"profile",Cell:({cell:e})=>{var a,s;return t.jsx(t.Fragment,{children:(a=e.row.original)!=null&&a.profile_image?t.jsx("img",{className:"border drop-shadow-lg h-8 rounded-sm",src:(s=e.row.original)==null?void 0:s.profile_image,alt:"profile",srcset:""}):"N/A"})}},{Header:"Name",accessor:"user_name",Cell:({cell:e})=>{var a;return f((a=e.row.original)==null?void 0:a.user_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:e})=>{var a;return f((a=e.row.original)==null?void 0:a.mobile)}},{Header:"E-mail",accessor:"email",Cell:({cell:e})=>{var a;return(a=e.row.original)!=null&&a.email?e.row.original.email.replace("@","[at]").replace(".","[dot]"):"N/A"}},{Header:"Address",accessor:"address",Cell:({cell:e})=>{var a;return f((a=e.row.original)==null?void 0:a.address)}}],L=()=>{if(!i||i.length===0){alert("No data available to export.");return}try{const e=i.map((l,I)=>({"Sl no.":I+1,"Profile Image URL":l.profile_image||"N/A",Name:l.user_name||"N/A","Mobile No.":l.mobile||"N/A","E-mail":l.email?l.email.replace("@","[at]").replace(".","[dot]"):"N/A",Address:l.address||"N/A"})),a=x.json_to_sheet(e),s=x.book_new();x.book_append_sheet(s,a,"Enforcement Officers"),a["!cols"]=[{wch:5},{wch:30},{wch:20},{wch:15},{wch:25},{wch:30}],R(s,"Enforcement_Officers.xlsx")}catch(e){console.error("Error exporting to Excel:",e),alert("Failed to export data. Please try again.")}};return t.jsxs(t.Fragment,{children:[S&&t.jsx(T,{}),t.jsxs("div",{className:"w-full  md:pt-10 bg-white shadow-lg rounded-md",children:[t.jsx("form",{onChange:r.handleChange,onSubmit:r.handleSubmit,className:"mb-4 ml-[30%]",children:t.jsxs("div",{className:"flex flex-wrap flex-row justify-start w-full gap-x-6 gap-y-2 text-sm 3xl:text-base p-4 px-8",children:[t.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[t.jsx("div",{className:"col-span-6 font-semibold",children:"Select Ulb"}),t.jsx("div",{className:"col-span-6",children:t.jsxs("select",{name:"ulbId",id:"ulbId",className:y,value:r.values.ulbId,onChange:r.handleChange,children:[t.jsx("option",{value:"",children:"Select Your ULB"}),E?t.jsx("option",{value:"",disabled:!0,children:"Loading..."}):c==null?void 0:c.map(e=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ulb_name},e==null?void 0:e.id))]})}),t.jsx("div",{className:"col-span-12 text-center",children:r.touched.ulbId&&r.errors.ulbId&&t.jsx(t.Fragment,{children:t.jsx("span",{className:"text-red-600 text-xs",children:r.errors.ulbId})})})]}),t.jsx("div",{className:"w-full md:w-[20%] flex justify-start items-center mt-4",children:t.jsxs("button",{type:"submit",className:"flex flex-row items-center border border-green-600 bg-green-600 hover:bg-green-400 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold px-5 py-1 w-max",children:[" ",t.jsx("span",{className:"mr-2",children:t.jsx(U,{})}),"Search "]})})]})}),w&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"uppercase font-semibold text-gray-700 text-2xl py-2 text-center tracking-[0.5rem]",children:"Know Your Enforcement Officer"}),t.jsx("div",{className:"flex justify-end -mb-5 mr-12",children:t.jsx("button",{type:"button",onClick:()=>L(),className:"border border-blue-600 bg-blue-600 hover:bg-blue-500 text-white hover:text-white shadow-lg rounded-sm text-sm font-semibold mr-7 mt-0 px-5 py-1",children:"Export"})}),t.jsx(k,{columns:A,dataList:i,exportStatus:!1})]})]})]})};export{X as default};
