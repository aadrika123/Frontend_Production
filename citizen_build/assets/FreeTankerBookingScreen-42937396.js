import{j as l,a1 as Be}from"./mui-62eaa2c0.js";import{u as R,h as _e,r as t}from"./router-56e993c5.js";import{d as Ee,e as h,f as Ue,s as Le,u as Ae,A as m,c as f,g as Ve,a_ as Me,a as Pe,w as We,t as Oe,ae as He,Q as E}from"./index-01f7897b.js";import{s as ze}from"./check-d24dfc8a.js";import{T as Ge}from"./AdvertisementRoutes-4fca3c16.js";import"./axios-ab7cc016.js";import"./reactIcons-d26c0b2d.js";import"./materialTailwind-f804b899.js";import"./moment-a9aaa855.js";/* empty css                */import"./redux-714e9319.js";import"./i18next-2edfafb0.js";import"./ReuploadDocumentModal-00819850.js";import"./ServerErrorCard-19e56d08.js";import"./createSvgIcon-f66f5d59.js";import"./ValidationFunction-10ed4d73.js";import"./approved-b4ef6d66.js";import"./ProtectedRoutes-fa6c7b61.js";import"./localstorage-fbfe5679.js";import"./user-9843d999.js";import"./index.esm-79e01f48.js";import"./useSetLogout-4a95ea85.js";import"./TitleBar-76ba8fb8.js";import"./index-a188d691.js";import"./swatchBharat-69854ede.js";import"./PrintButton-d9f2d3fd.js";import"./SepticTankPaymentIndex-9414b334.js";function Qe(c){var S,D,T,w;console.log((D=(S=c==null?void 0:c.responseScreenData)==null?void 0:S.data)==null?void 0:D.applicationId,"props?.responseScreenData?.data?.applicationId");const U=R(),{formStyle:a}=Ge(),d=()=>{U("/waterTankerDashboard")};return l.jsx(l.Fragment,{children:l.jsxs("div",{class:`${a} md:w-2/3 mx-auto max-sm:m-2 flex flex-col p-2 `,children:[l.jsxs("div",{class:"relative overflow-hidden h-[8rem] w-[8rem]",children:[l.jsx("div",{class:"absolute inset-0 hover:bg-white opacity-0 transition duration-700 hover:opacity-10"}),l.jsx("img",{className:"max-w-full h-auto mx-auto animate-wiggle p-2 ",src:ze,alt:"alt title"})]}),l.jsx("div",{class:" flex-1",children:l.jsxs("div",{class:"mb-2",children:[l.jsx("h3",{class:"text-2xl  text-center mb-3 text-green-600 font-openSans font-semibold",children:"Application Submitted Successfully"}),l.jsxs("h3",{class:"text-xl  text-center mb-3 text-gray-400 font-openSans font-semibold ",children:["Booking no. - ",(w=(T=c==null?void 0:c.responseScreenData)==null?void 0:T.data)==null?void 0:w.bookingNo]})]})}),l.jsx("div",{className:"flex justify-around m-8",children:l.jsx("div",{class:" text-center",children:l.jsx("button",{className:"bg-[#1A4D8C] text-sm px-8 py-2 text-white  rounded leading-5 shadow-lg",onClick:d,children:"Go back to Home"})})})]})})}function Nl(c){var O,H,z,G;const{saveButtonColor:U,inputStyle:a,labelStyle:d,headingStyle:S,formStyle:D}=Me(),T=R(),w=_e(),r=(O=w.state)==null?void 0:O.editData,M=(H=w.state)==null?void 0:H.applicationId;console.log("eidt data",r);const{api_getBookingDetailsById:ee,api_addFreeBooking:le,api_getWaterTankerMasterData:se,freeTankerUplaodDocument:P,freeBooking:re,editFreeBooking:ne,api_getUlbList:ie,api_getUlbWiseAgency:oe,api_getWardList:te}=Pe(),[L,ce]=t.useState(),[ae,g]=t.useState(!1),[Je,de]=t.useState(),[Ke,ue]=t.useState();t.useState(0);const[$,W]=t.useState(),[v,me]=t.useState(),[A,xe]=t.useState(),[F,he]=t.useState(),[y,fe]=t.useState(),[C,pe]=t.useState(),[j,be]=t.useState((r==null?void 0:r.documents)||null),[ge,ve]=t.useState(""),ye=new Date().toISOString().split("T")[0],[je,q]=t.useState(!1),we=()=>{q(e=>!e)},Ne=e=>{if(!e)return"";const[n,o,u]=e.split("-");return`${u}-${o}-${n}`},p=(e,n)=>{E.dismiss(),n=="success"&&E.success(e),n=="error"&&E.error(e)},ke=Ee({applicantName:h().required("Enter owner name").max(50,"Enter maximum 50 characters"),address:h().required("This field is Required"),mobileNo:Ue().required("Enter mobile no."),location:h().required("This field is Required"),deliveryTime:h().required("This field is Required"),deliveryDate:Le().required("This field is Required"),capacity:h().required("This field is Required"),reason:h().required("This field is Required"),wardId:h().required("This field is Required"),referenceDocument:h().required("Document is Required")}),Ie={ulbId:(r==null?void 0:r.ulb_id)||"",applicantName:(r==null?void 0:r.applicant_name)||"",mobileNo:(r==null?void 0:r.mobile)||"",email:(r==null?void 0:r.email)||"",address:(r==null?void 0:r.address)||"",location:(r==null?void 0:r.location_id)||"",capacity:(r==null?void 0:r.capacity_id)||"",deliveryDate:Ne(r==null?void 0:r.delivery_date)||"",deliveryTime:(r==null?void 0:r.delivery_time)||"",wardId:(r==null?void 0:r.ward_id)||"",reason:(r==null?void 0:r.reason)||"",referenceDocument:(r==null?void 0:r.documents)||""},s=Ae({initialValues:Ie,onSubmit:e=>{console.log("agency",e),Fe(e)},enableReinitialize:!0,validationSchema:ke});t.useEffect(()=>{pe($),B(C),Se()},[$]),console.log("ulbId",C),t.useEffect(()=>{m.get(ie).then(e=>{var n;return console.log("ULB LIsts...",e.data.data),ce((n=e==null?void 0:e.data)==null?void 0:n.data)}).catch(e=>console.log("Error while fetching ulblist",e)),r!=null&&r.ulb_id&&(W(r.ulb_id),B(r.ulb_id))},[]);const Se=()=>{const e={ulbId:$};console.log("request body category id",e),m.post(`${te}`,e,f()).then(function(n){console.log("ward list ",n.data.data),xe(n.data.data)}).catch(function(n){console.log("errorrr.... ",n)})},De=e=>{const n=e.target.files[0];if(n){s.setFieldValue("referenceDocument",n);const o=URL.createObjectURL(n);be(o),ve(n.type)}},Te=e=>{let n=e.target.name,o=e.target.value;n=="deliveryTime"&&qe(o),n=="ulbId"&&W(o),n=="ulbId"&&B(o),n=="applicantName"&&s.setFieldValue("applicantName",We(o,s.values.applicantName,50)),n=="mobileNo"&&s.setFieldValue("mobileNo",Oe(o,s.values.mobileNo,10)),n=="email"&&s.setFieldValue("email",He(o,s.values.email,100))};t.useEffect(()=>{$e()},[]),t.useEffect(()=>{B(C)},[C]);const $e=()=>{const e={deviceId:"resource"};console.log("request body category id",e),m.post(`${se}`,e,f()).then(function(n){console.log("master data",n.data),ue(n.data.data)}).catch(function(n){console.log("errorrr.... ",n)})},Fe=async e=>{var u,N,k,x,b,Q,J,K,X,Y,Z;g(!0);let n,o;r?(n=ne,o={ulbId:e==null?void 0:e.ulbId,applicationId:M,applicantName:e==null?void 0:e.applicantName,mobile:e==null?void 0:e.mobileNo,email:e==null?void 0:e.email,address:e==null?void 0:e.address,reason:e==null?void 0:e.reason,wardId:e==null?void 0:e.wardId,locationId:e==null?void 0:e.location,capacityId:e==null?void 0:e.capacity,deliveryDate:e==null?void 0:e.deliveryDate,deliveryTime:e==null?void 0:e.deliveryTime}):(n=le,o={ulbId:e==null?void 0:e.ulbId,applicantName:e==null?void 0:e.applicantName,agencyId:e==null?void 0:e.agencyName,deliveryDate:e==null?void 0:e.deliveryDate,deliveryTime:e==null?void 0:e.deliveryTime,mobile:e==null?void 0:e.mobileNo,email:e==null?void 0:e.email,locationId:e==null?void 0:e.location,capacityId:e==null?void 0:e.capacity,address:e==null?void 0:e.address,wardId:e==null?void 0:e.wardId,reason:e==null?void 0:e.reason});try{g(!0);const i=await m.post(n,o,f());if(r)if((u=i==null?void 0:i.data)!=null&&u.status){p("Updated successfully","success");const _=(k=(N=i==null?void 0:i.data)==null?void 0:N.data)==null?void 0:k.booking_no,I=await m.post(P,{bookingId:_,document:e==null?void 0:e.referenceDocument},f());((x=I==null?void 0:I.data)==null?void 0:x.status)===!0&&p("Document Uploaded Successfully","success"),T(`/viewTankerBookingDetails/${M}`)}else p((b=i==null?void 0:i.data)==null?void 0:b.message,"error");else{const _=(J=(Q=i==null?void 0:i.data)==null?void 0:Q.data)==null?void 0:J.bookingNo;if(((K=i==null?void 0:i.data)==null?void 0:K.status)===!0&&(e!=null&&e.referenceDocument)){const V=await m.post(P,{bookingId:_,document:e==null?void 0:e.referenceDocument},f());((X=V==null?void 0:V.data)==null?void 0:X.status)===!0&&p("Document Uploaded Successfully","success")}await m.post(re,{bookingId:_},f()),he(i.data),p("Submitted successfully","success"),q(!1),p((Y=i==null?void 0:i.data)==null?void 0:Y.message,"success");const I=Object.keys(((Z=i==null?void 0:i.data)==null?void 0:Z.data)||{});fe(I),q(!1)}}catch(i){console.error("Error:",i),E.error("Error in submitting Form"),q(!1)}finally{g(!1)}};t.useEffect(()=>{Ce()},[c==null?void 0:c.listId]);const Ce=()=>{g(!0);const e={applicationId:c==null?void 0:c.listId};console.log("request body category id",e),m.post(`${ee}`,e,f()).then(function(n){console.log("booking details by id",n.data),de(n.data.data),g(!1)}).catch(function(n){console.log("errorrr.... ",n),g(!1)})},B=e=>{const n={ulbId:e};m.post(`${oe}`,n,f()).then(function(o){var u;console.log("agency data",o.data.data),me((u=o==null?void 0:o.data)==null?void 0:u.data)}).catch(function(o){console.log("errorrr.... ",o)})},qe=e=>{const n=new Date,[o,u]=e.split(":"),N=parseInt(o,10),k=parseInt(u,10);console.log(N,"hours",k,"minutes");const x=s.values.deliveryDate;x.setHours(N),x.setMinutes(k);const b=new Date(n);b.setDate(n.getDate()+1),x<b?(p("Date and Time must be more than 24 hours of current time","error"),s.setFieldValue("deliveryTime",""),s.setFieldValue("deliveryDate",""),console.log(x,"userSetDate",b,"minDateTime"),console.log("wrong time")):(console.log(x,"userSetDate",b,"minDateTime"),console.log("right time"))};return ae?l.jsxs(l.Fragment,{children:[l.jsx(Ve,{}),l.jsx("div",{className:"min-h-screen"})]}):(F==null?void 0:F.status)==!0?l.jsx(l.Fragment,{children:l.jsx(Qe,{responseScreenData:F})}):l.jsx(l.Fragment,{children:l.jsx("div",{className:`${D} pb-10`,children:l.jsx("form",{onSubmit:s.handleSubmit,onChange:Te,children:l.jsx("div",{className:"",children:l.jsx("div",{className:" grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 container mx-auto",children:l.jsxs("div",{className:"col-span-12  w-full",children:[l.jsx("div",{className:" ml-4 p-4 mt-4",children:l.jsxs("h1",{className:`${S}`,children:[r?"Edit":"Free Water Tanker"," Booking"]})}),l.jsx(Be,{variant:"middle"}),l.jsxs("div",{className:"p-12 -mt-4",children:[l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:`${d} inline-block mb-2`,children:"ULB"}),l.jsxs("select",{...s.getFieldProps("ulbId"),className:`${a} inline-block w-full relative`,value:s.values.ulbId,children:[l.jsx("option",{value:"",children:"select"}),L==null?void 0:L.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ulb_name},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.ulbId&&s.errors.ulbId?s.errors.ulbId:null})]}),$!=null&&l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:`${d} inline-block mb-2`,children:"Ward No."}),l.jsxs("select",{...s.getFieldProps("wardId"),className:`${a} inline-block w-full relative`,children:[l.jsx("option",{value:"",children:"select"}),A==null?void 0:A.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ward_name},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs ",children:s.touched.wardId&&s.errors.wardId?s.errors.wardId:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Applicant name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"applicantName",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.applicantName}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.applicantName&&s.errors.applicantName?s.errors.applicantName:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Mobile no. ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"mobileNo",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.mobileNo}),l.jsx("p",{className:"text-red-500 text-xs",children:y!=null&&y.includes("mobile")?"Invalid Mobile Number":null})]})]}),l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:`${d} inline-block mb-2`,children:"Email"}),l.jsx("input",{type:"text",name:"email",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.email}),l.jsx("p",{className:"text-red-500 text-xs ",children:y!=null&&y.includes("email")?"Invalid Email":null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Address ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"address",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.address}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.address&&s.errors.address?s.errors.address:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Location ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{...s.getFieldProps("location"),className:`${a} inline-block w-full relative`,children:[l.jsx("option",{value:"",children:"select"}),(z=v==null?void 0:v.listLocation)==null?void 0:z.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.location},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.location&&s.errors.location?s.errors.location:null})]})]}),l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:`${d} inline-block mb-2`,children:"Capacity (ltr)"}),l.jsxs("select",{...s.getFieldProps("capacity"),className:`${a} inline-block w-full relative`,children:[l.jsx("option",{value:"",children:"select"}),(G=v==null?void 0:v.listCapacity)==null?void 0:G.map(e=>l.jsxs("option",{value:e==null?void 0:e.id,children:[e==null?void 0:e.capacity,"(ltr)"]},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.capacity&&s.errors.capacity?s.errors.capacity:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Delivery date ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"date",min:ye,name:"deliveryDate",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.deliveryDate}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.deliveryDate&&s.errors.deliveryDate?s.errors.deliveryDate:null}),l.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Duration must be more than 24 hours of current time"})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Delivery time ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"time",name:"deliveryTime",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.deliveryTime}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.deliveryTime&&s.errors.deliveryTime?s.errors.deliveryTime:null}),l.jsx("h1",{className:"text-red-600 bg-red-200 px-2 mt-2 border border-red-600",children:"Note:- Delivery time may differ"})]}),l.jsxs("div",{className:"flex flex-col gap-2 px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{htmlFor:"upload",className:"text-sm font-medium text-gray-700",children:"Upload Reference Document"}),l.jsx("input",{id:"upload",name:"referenceDocument",type:"file",onChange:De,className:"block w-full cursor-pointer rounded-lg border border-gray-300 bg-gray-50 p-2 text-sm text-gray-700 file:mr-4 file:rounded-md file:border-0 file:bg-gray-800 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-white hover:file:bg-gray-700"})," ",l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.referenceDocument&&s.errors.referenceDocument?s.errors.referenceDocument:null}),j&&l.jsx("div",{className:"mt-2",children:j!=null&&j.toLowerCase().endsWith(".pdf")||ge==="application/pdf"?l.jsxs("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"w-full h-full flex flex-col items-center justify-center bg-red-50 rounded-lg shadow cursor-pointer hover:scale-105 transition",children:[l.jsx("span",{className:"text-4xl text-red-600",children:"ðŸ“„"}),l.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:"View PDF"})]}):l.jsx("img",{src:j,alt:"Preview",className:"max-w-full h-32 object-contain border rounded"})})]})]}),l.jsx("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Reason ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("textarea",{name:"reason",className:`${a} inline-block w-full relative p-2`,onChange:s.handleChange,value:s.values.reason,rows:"3"}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.reason&&s.errors.reason?s.errors.reason:null})]})}),l.jsxs("div",{className:"flex space-x-4  md:ml-12 lg:ml-12 ml-4 mt-4",children:[l.jsx("input",{type:"checkbox",name:"declaration",className:"",onChange:we}),l.jsx("h1",{className:"font-PublicSans text-sm text-center max-sm:text-left text-red-400 mt-4 ",children:"I hereby declare that the above particulars of facts and information stated are true, correct and complete to the best of my belief and knowledge."})]})]}),je==!0&&l.jsx("div",{className:" mr-8 mb-12",children:l.jsx("button",{type:"submit",className:`${U} float-right`,children:r?"Update":"Save"})})]})})})})})})}export{Nl as default};
