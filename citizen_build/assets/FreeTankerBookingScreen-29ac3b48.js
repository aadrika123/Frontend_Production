import{j as l,a1 as Ee}from"./mui-62eaa2c0.js";import{u as le,h as Ue,r as t}from"./router-56e993c5.js";import{d as Le,e as u,f as Ae,s as Ve,u as Pe,A as x,c as p,g as We,a_ as Me,a as Oe,w as He,t as ze,ae as Ge,Q as _}from"./index-8ce65246.js";import{s as Qe}from"./check-d24dfc8a.js";import{T as Je}from"./AdvertisementRoutes-b0bf8fef.js";import"./axios-ab7cc016.js";import"./reactIcons-d26c0b2d.js";import"./materialTailwind-d6ecb4de.js";import"./moment-a9aaa855.js";/* empty css                */import"./redux-714e9319.js";import"./i18next-2edfafb0.js";import"./ReuploadDocumentModal-e3608a46.js";import"./ServerErrorCard-6b4f4d63.js";import"./createSvgIcon-f66f5d59.js";import"./ValidationFunction-10ed4d73.js";import"./useCustomLocation-a2eb0c23.js";import"./approved-b4ef6d66.js";import"./ProtectedRoutes-a0a67200.js";import"./localstorage-fbfe5679.js";import"./user-9843d999.js";import"./index.esm-79e01f48.js";import"./useSetLogout-288eacdc.js";import"./TitleBar-07c5c287.js";import"./index-a188d691.js";import"./swatchBharat-69854ede.js";import"./PrintButton-60652c61.js";import"./SepticTankPaymentIndex-51edfceb.js";function Ke(c){var I,S,D,y;console.log((S=(I=c==null?void 0:c.responseScreenData)==null?void 0:I.data)==null?void 0:S.applicationId,"props?.responseScreenData?.data?.applicationId");const E=le(),{formStyle:a}=Je(),d=()=>{E("/waterTankerDashboard")};return l.jsx(l.Fragment,{children:l.jsxs("div",{class:`${a} md:w-2/3 mx-auto max-sm:m-2 flex flex-col p-2 `,children:[l.jsxs("div",{class:"relative overflow-hidden h-[8rem] w-[8rem]",children:[l.jsx("div",{class:"absolute inset-0 hover:bg-white opacity-0 transition duration-700 hover:opacity-10"}),l.jsx("img",{className:"max-w-full h-auto mx-auto animate-wiggle p-2 ",src:Qe,alt:"alt title"})]}),l.jsx("div",{class:" flex-1",children:l.jsxs("div",{class:"mb-2",children:[l.jsx("h3",{class:"text-2xl  text-center mb-3 text-green-600 font-openSans font-semibold",children:"Application Submitted Successfully"}),l.jsxs("h3",{class:"text-xl  text-center mb-3 text-gray-400 font-openSans font-semibold ",children:["Booking no. - ",(y=(D=c==null?void 0:c.responseScreenData)==null?void 0:D.data)==null?void 0:y.bookingNo]})]})}),l.jsx("div",{className:"flex justify-around m-8",children:l.jsx("div",{class:" text-center",children:l.jsx("button",{className:"bg-[#1A4D8C] text-sm px-8 py-2 text-white  rounded leading-5 shadow-lg",onClick:d,children:"Go back to Home"})})})]})})}function Sl(c){var O,H,z,G;const{saveButtonColor:E,inputStyle:a,labelStyle:d,headingStyle:I,formStyle:S}=Me(),D=le(),y=Ue(),r=(O=y.state)==null?void 0:O.editData,P=(H=y.state)==null?void 0:H.applicationId;console.log("eidt data",r);const{api_getBookingDetailsById:se,api_addFreeBooking:re,api_getWaterTankerMasterData:ne,freeTankerUplaodDocument:W,freeBooking:oe,editFreeBooking:ie,api_getUlbList:te,api_getUlbWiseAgency:ce,api_getWardList:ae}=Oe(),[U,de]=t.useState(),[me,g]=t.useState(!1),[Xe,ue]=t.useState(),[Ye,xe]=t.useState();t.useState(0);const[T,M]=t.useState(),[v,he]=t.useState(),[L,pe]=t.useState(),[$,fe]=t.useState(),[A,be]=t.useState(),[F,ge]=t.useState(),[j,ve]=t.useState((r==null?void 0:r.documents)||null),[je,ye]=t.useState(""),we=new Date().toISOString().split("T")[0],[Ne,q]=t.useState(!1),ke=()=>{q(e=>!e)},Ie=e=>{if(!e)return"";const[n,i,m]=e.split("-");return`${m}-${i}-${n}`},f=(e,n)=>{_.dismiss(),n=="success"&&_.success(e),n=="error"&&_.error(e)},Se=Le({applicantName:u().required("Enter owner name").max(50,"Enter maximum 50 characters"),ulbId:u().required("This field is Required"),address:u().required("This field is Required"),mobileNo:Ae().required("Enter mobile no."),location:u().required("This field is Required"),deliveryTime:u().required("This field is Required"),deliveryDate:Ve().required("This field is Required"),capacity:u().required("This field is Required"),reason:u().required("This field is Required"),wardId:u().required("This field is Required"),referenceDocument:u().required("Document is Required")}),De={ulbId:(r==null?void 0:r.ulb_id)||"",applicantName:(r==null?void 0:r.applicant_name)||"",mobileNo:(r==null?void 0:r.mobile)||"",email:(r==null?void 0:r.email)||"",address:(r==null?void 0:r.address)||"",location:(r==null?void 0:r.location_id)||"",capacity:(r==null?void 0:r.capacity_id)||"",deliveryDate:Ie(r==null?void 0:r.delivery_date)||"",deliveryTime:(r==null?void 0:r.delivery_time)||"",wardId:(r==null?void 0:r.ward_id)||"",reason:(r==null?void 0:r.reason)||"",referenceDocument:(r==null?void 0:r.documents)||""},s=Pe({initialValues:De,onSubmit:e=>{console.log("agency",e),Ce(e)},enableReinitialize:!0,validationSchema:Se});t.useEffect(()=>{ge(T),C(F),Te()},[T]),console.log("ulbId",F),t.useEffect(()=>{x.get(te).then(e=>{var n;return console.log("ULB LIsts...",e.data.data),de((n=e==null?void 0:e.data)==null?void 0:n.data)}).catch(e=>console.log("Error while fetching ulblist",e)),r!=null&&r.ulb_id&&(M(r.ulb_id),C(r.ulb_id))},[]);const Te=()=>{const e={ulbId:T};console.log("request body category id",e),x.post(`${ae}`,e,p()).then(function(n){console.log("ward list ",n.data.data),pe(n.data.data)}).catch(function(n){console.log("errorrr.... ",n)})},$e=e=>{const n=e.target.files[0];if(n){s.setFieldValue("referenceDocument",n);const i=URL.createObjectURL(n);ve(i),ye(n.type)}},Fe=e=>{let n=e.target.name,i=e.target.value;n=="deliveryTime"&&_e(i),n=="ulbId"&&M(i),n=="ulbId"&&C(i),n=="applicantName"&&s.setFieldValue("applicantName",He(i,s.values.applicantName,50)),n=="mobileNo"&&s.setFieldValue("mobileNo",ze(i,s.values.mobileNo,10)),n=="email"&&s.setFieldValue("email",Ge(i,s.values.email,100))};t.useEffect(()=>{qe()},[]),t.useEffect(()=>{C(F)},[F]);const qe=()=>{const e={deviceId:"resource"};console.log("request body category id",e),x.post(`${ne}`,e,p()).then(function(n){console.log("master data",n.data),xe(n.data.data)}).catch(function(n){console.log("errorrr.... ",n)})},Ce=async e=>{var m,w,N,h,b,Q,J,K,X,Y,Z,R,ee;g(!0);let n,i;r?(n=ie,i={ulbId:e==null?void 0:e.ulbId,applicationId:P,applicantName:e==null?void 0:e.applicantName,mobile:e==null?void 0:e.mobileNo,email:e==null?void 0:e.email,address:e==null?void 0:e.address,reason:e==null?void 0:e.reason,wardId:e==null?void 0:e.wardId,locationId:e==null?void 0:e.location,capacityId:e==null?void 0:e.capacity,deliveryDate:e==null?void 0:e.deliveryDate,deliveryTime:e==null?void 0:e.deliveryTime}):(n=re,i={ulbId:e==null?void 0:e.ulbId,applicantName:e==null?void 0:e.applicantName,agencyId:e==null?void 0:e.agencyName,deliveryDate:e==null?void 0:e.deliveryDate,deliveryTime:e==null?void 0:e.deliveryTime,mobile:e==null?void 0:e.mobileNo,email:e==null?void 0:e.email,locationId:e==null?void 0:e.location,capacityId:e==null?void 0:e.capacity,address:e==null?void 0:e.address,wardId:e==null?void 0:e.wardId,reason:e==null?void 0:e.reason});try{g(!0);const o=await x.post(n,i,p());if(r)if((m=o==null?void 0:o.data)!=null&&m.status){f("Updated successfully","success");const B=(N=(w=o==null?void 0:o.data)==null?void 0:w.data)==null?void 0:N.booking_no,k=await x.post(W,{bookingId:B,document:e==null?void 0:e.referenceDocument},p());((h=k==null?void 0:k.data)==null?void 0:h.status)===!0&&f("Document Uploaded Successfully","success"),D(`/viewTankerBookingDetails/${P}`)}else f((b=o==null?void 0:o.data)==null?void 0:b.message,"error");else{const B=(J=(Q=o==null?void 0:o.data)==null?void 0:Q.data)==null?void 0:J.bookingNo;if(((K=o==null?void 0:o.data)==null?void 0:K.status)===!0&&(e!=null&&e.referenceDocument)){const V=await x.post(W,{bookingId:B,document:e==null?void 0:e.referenceDocument},p());((X=V==null?void 0:V.data)==null?void 0:X.status)===!0&&f("Document Uploaded Successfully","success")}await x.post(oe,{bookingId:B},p()),fe(o.data),q(!1),((Y=o==null?void 0:o.data)==null?void 0:Y.success)===!1?f((Z=o==null?void 0:o.data)==null?void 0:Z.message,"error"):f((R=o==null?void 0:o.data)==null?void 0:R.message,"success");const k=Object.keys(((ee=o==null?void 0:o.data)==null?void 0:ee.data)||{});be(k),q(!1)}}catch(o){console.error("Error:",o),_.error("Error in submitting Form"),q(!1)}finally{g(!1)}};t.useEffect(()=>{Be()},[c==null?void 0:c.listId]);const Be=()=>{g(!0);const e={applicationId:c==null?void 0:c.listId};console.log("request body category id",e),x.post(`${se}`,e,p()).then(function(n){console.log("booking details by id",n.data),ue(n.data.data),g(!1)}).catch(function(n){console.log("errorrr.... ",n),g(!1)})},C=e=>{const n={ulbId:e};x.post(`${ce}`,n,p()).then(function(i){var m;console.log("agency data",i.data.data),he((m=i==null?void 0:i.data)==null?void 0:m.data)}).catch(function(i){console.log("errorrr.... ",i)})},_e=e=>{const n=new Date,[i,m]=e.split(":"),w=parseInt(i,10),N=parseInt(m,10);console.log(w,"hours",N,"minutes");const h=s.values.deliveryDate;h.setHours(w),h.setMinutes(N);const b=new Date(n);b.setDate(n.getDate()+1),h<b?(f("Date and Time must be more than 24 hours of current time","error"),s.setFieldValue("deliveryTime",""),s.setFieldValue("deliveryDate",""),console.log(h,"userSetDate",b,"minDateTime"),console.log("wrong time")):(console.log(h,"userSetDate",b,"minDateTime"),console.log("right time"))};return me?l.jsxs(l.Fragment,{children:[l.jsx(We,{}),l.jsx("div",{className:"min-h-screen"})]}):($==null?void 0:$.status)==!0?l.jsx(l.Fragment,{children:l.jsx(Ke,{responseScreenData:$})}):l.jsx(l.Fragment,{children:l.jsx("div",{className:`${S} pb-10`,children:l.jsx("form",{onSubmit:s.handleSubmit,onChange:Fe,children:l.jsx("div",{className:"",children:l.jsx("div",{className:" grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 container mx-auto",children:l.jsxs("div",{className:"col-span-12  w-full",children:[l.jsx("div",{className:" ml-4 p-4 mt-4",children:l.jsxs("h1",{className:`${I}`,children:[r?"Edit":"Free Water Tanker"," Booking"]})}),l.jsx(Ee,{variant:"middle"}),l.jsxs("div",{className:"p-12 -mt-4",children:[l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["ULB ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{...s.getFieldProps("ulbId"),className:`${a} inline-block w-full relative`,value:s.values.ulbId,children:[l.jsx("option",{value:"",children:"select"}),U==null?void 0:U.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ulb_name},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.ulbId&&s.errors.ulbId?s.errors.ulbId:null})]}),T!=null&&l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:`${d} inline-block mb-2`,children:"Ward No."}),l.jsxs("select",{...s.getFieldProps("wardId"),className:`${a} inline-block w-full relative`,children:[l.jsx("option",{value:"",children:"select"}),L==null?void 0:L.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.ward_name},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs ",children:s.touched.wardId&&s.errors.wardId?s.errors.wardId:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Applicant name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"applicantName",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.applicantName}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.applicantName&&s.errors.applicantName?s.errors.applicantName:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Mobile no. ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"mobileNo",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.mobileNo}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.mobileNo&&s.errors.mobileNo?s.errors.mobileNo:null})]})]}),l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:`${d} inline-block mb-2`,children:"Email"}),l.jsx("input",{type:"text",name:"email",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.email}),l.jsx("p",{className:"text-red-500 text-xs ",children:A!=null&&A.includes("email")?"Invalid Email":null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Address ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"address",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.address}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.address&&s.errors.address?s.errors.address:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Location ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{...s.getFieldProps("location"),className:`${a} inline-block w-full relative`,children:[l.jsx("option",{value:"",children:"select"}),(z=v==null?void 0:v.listLocation)==null?void 0:z.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.location},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.location&&s.errors.location?s.errors.location:null})]})]}),l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Capacity (ltr) ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{...s.getFieldProps("capacity"),className:`${a} inline-block w-full relative`,children:[l.jsx("option",{value:"",children:"select"}),(G=v==null?void 0:v.listCapacity)==null?void 0:G.map(e=>l.jsxs("option",{value:e==null?void 0:e.id,children:[e==null?void 0:e.capacity,"(ltr)"]},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.capacity&&s.errors.capacity?s.errors.capacity:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Delivery date ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"date",min:we,name:"deliveryDate",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.deliveryDate}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.deliveryDate&&s.errors.deliveryDate?s.errors.deliveryDate:null}),l.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Duration must be more than 24 hours of current time"})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Delivery time ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"time",name:"deliveryTime",className:`${a} inline-block w-full relative`,onChange:s.handleChange,value:s.values.deliveryTime}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.deliveryTime&&s.errors.deliveryTime?s.errors.deliveryTime:null}),l.jsx("h1",{className:"text-red-600 bg-red-200 px-2 mt-2 border border-red-600",children:"Note:- Delivery time may differ"})]}),l.jsxs("div",{className:"flex flex-col gap-2 px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{htmlFor:"upload",className:"text-sm font-medium text-gray-700",children:["Upload Reference Document ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{id:"upload",name:"referenceDocument",type:"file",onChange:$e,className:"block w-full cursor-pointer rounded-lg border border-gray-300 bg-gray-50 p-2 text-sm text-gray-700 file:mr-4 file:rounded-md file:border-0 file:bg-gray-800 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-white hover:file:bg-gray-700"})," ",l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.referenceDocument&&s.errors.referenceDocument?s.errors.referenceDocument:null}),j&&l.jsx("div",{className:"mt-2",children:j!=null&&j.toLowerCase().endsWith(".pdf")||je==="application/pdf"?l.jsxs("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"w-full h-full flex flex-col items-center justify-center bg-red-50 rounded-lg shadow cursor-pointer hover:scale-105 transition",children:[l.jsx("span",{className:"text-4xl text-red-600",children:"ðŸ“„"}),l.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:"View PDF"})]}):l.jsx("img",{src:j,alt:"Preview",className:"max-w-full h-32 object-contain border rounded"})})]})]}),l.jsx("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsxs("label",{className:`${d} inline-block mb-2`,children:["Reason ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("textarea",{name:"reason",className:`${a} inline-block w-full relative p-2`,onChange:s.handleChange,value:s.values.reason,rows:"3"}),l.jsx("p",{className:"text-red-500 text-xs",children:s.touched.reason&&s.errors.reason?s.errors.reason:null})]})}),l.jsxs("div",{className:"flex space-x-4  md:ml-12 lg:ml-12 ml-4 mt-4",children:[l.jsx("input",{type:"checkbox",name:"declaration",className:"",onChange:ke}),l.jsx("h1",{className:"font-PublicSans text-sm text-center max-sm:text-left text-red-400 mt-4 ",children:"I hereby declare that the above particulars of facts and information stated are true, correct and complete to the best of my belief and knowledge."})]})]}),Ne==!0&&l.jsx("div",{className:" mr-8 mb-12",children:l.jsx("button",{type:"submit",className:`
                      ${E}
                      float-right
                      bg-blue-600
                      hover:bg-blue-700
                      active:bg-blue-800
                      text-white
                      font-semibold
                      px-6
                      py-2
                      rounded-lg
                      shadow-md
                      hover:shadow-lg
                      transition
                      duration-200
                      ease-in-out
                      disabled:opacity-60
                      disabled:cursor-not-allowed
                    `,children:r?"Update":"Save"})})]})})})})})})}export{Sl as default};
