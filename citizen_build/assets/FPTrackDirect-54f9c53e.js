import{j as e}from"./mui-7fe93ce1.js";import{r as l,u as Z}from"./router-e237bf16.js";import{al as ee,am as ae,b as M,c as te,d as V,u as ne,R as re,an as se,P as oe,n as A,z as le,Y as ie}from"./index-053d917c.js";import{a as Y}from"./axios-ab7cc016.js";import{b as de,c as z}from"./index.esm-81f18b27.js";import{e as ce}from"./index.esm-96a7f5ab.js";import{b as he}from"./index.esm-69468b98.js";import{u as $,w as me}from"./xlsx-f5126985.js";import"./reactIcons-fd892024.js";import"./redux-20438136.js";import"./i18next-2edfafb0.js";const ue=t=>{const[w,C]=l.useState(10),[p,m]=l.useState(1),[x,B]=l.useState(0),[E,H]=l.useState(0),[P,O]=l.useState(0),[D,q]=l.useState(),[T,f]=l.useState(!1),[R,j]=l.useState(!1),[S,a]=l.useState([]),[r,i]=l.useState(!1),b=()=>{j(!1),i(!0),Object.keys(t==null?void 0:t.requestBody).length!==0&&typeof t.loader=="function"&&t.loader(!0),Y.post(t==null?void 0:t.api,{...t==null?void 0:t.requestBody,perPage:w,page:p},M()).then(n=>{var o,d,N,v,y,s,F,g,k,_;((o=n==null?void 0:n.data)==null?void 0:o.status)==!0?(console.log("success getting list => ",n),t!=null&&t.getData&&(t==null||t.allData((d=n==null?void 0:n.data)==null?void 0:d.data)),a((v=(N=n==null?void 0:n.data)==null?void 0:N.data)==null?void 0:v.data),O((s=(y=n==null?void 0:n.data)==null?void 0:y.data)==null?void 0:s.total),B((g=(F=n==null?void 0:n.data)==null?void 0:F.data)==null?void 0:g.current_page),H((_=(k=n==null?void 0:n.data)==null?void 0:k.data)==null?void 0:_.last_page),j(!1)):(console.log("false error while getting list => ",n),j(!0))}).catch(n=>(console.log("error while getting list => ",n),j(!0))).finally(()=>{i(!1),Object.keys(t==null?void 0:t.requestBody).length!==0&&typeof t.loader=="function"&&t.loader(!1),j(!1)})},c=()=>{m(x+1)},h=()=>{m(x-1)},u=n=>{let o=parseInt(P/n),d=parseInt(P%n);if(d==0){o<x&&m(o),C(n);return}if(d!=0){o+1<x&&m(o+1),C(n);return}},J=()=>{m(1)},U=()=>{m(E)},W=n=>{m(n)},I=n=>n==null?void 0:n.map((d,N)=>{var y;const v=(y=t==null?void 0:t.columns)==null?void 0:y.map((s,F)=>{var k,_;var g=d[s==null?void 0:s.accessor];if(s!=null&&s.option&&((k=s==null?void 0:s.option)==null?void 0:k.length)>0){const L=(_=s==null?void 0:s.option)==null?void 0:_.find(X=>X.hasOwnProperty(d[s==null?void 0:s.accessor]));L?g=L[d[s==null?void 0:s.accessor]]:g=d[s==null?void 0:s.accessor]}return(s==null?void 0:s.Header.toLowerCase())!="action"&&{[s==null?void 0:s.Header]:s!=null&&s.accessor?g:N+1}});return Object.assign({},...v)}),G=n=>{},K=n=>{i(!0),f(!1),Y.post(t==null?void 0:t.api,{...t==null?void 0:t.requestBody,perPage:P},M()).then(o=>{var d,N,v,y,s,F,g;((d=o==null?void 0:o.data)==null?void 0:d.status)==!0&&(n=="csv"&&(q(I((v=(N=o==null?void 0:o.data)==null?void 0:N.data)==null?void 0:v.data)),Q()),n=="excel"&&G(I((s=(y=o==null?void 0:o.data)==null?void 0:y.data)==null?void 0:s.data)),n=="pdf"&&exportToPDF(I((g=(F=o==null?void 0:o.data)==null?void 0:F.data)==null?void 0:g.data))),i(!1)}).catch(o=>{i(!1)})},Q=()=>{f(!0)};return l.useEffect(()=>{(t==null?void 0:t.requestBody)!=null&&(m(1),C(10),b())},[t==null?void 0:t.changeData]),l.useEffect(()=>{i(!0),b()},[p,w]),e.jsxs(e.Fragment,{children:[R&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 pl-4 pr-16 py-3 rounded relative text-center",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Sorry! "}),e.jsx("span",{className:"block sm:inline",children:"Some error occured while fetching list. Please try again later."}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}),T&&e.jsx(ee,{data:D}),r,!r&&(S==null?void 0:S.length)>0?e.jsx(e.Fragment,{children:e.jsx(ae,{search:t==null?void 0:t.search,currentPage:x,lastPage:E,goFirst:J,goLast:U,count1:P,columns:t==null?void 0:t.columns,dataList:S,exportStatus:t==null?void 0:t.exportStatus,perPage:w,perPageC:u,totalCount:P,nextPage:c,prevPage:h,exportDataF:K,exportData:D,gotoPage:n=>W(n)})}):e.jsx(e.Fragment,{children:!r&&(t==null?void 0:t.searchParams)!=""&&e.jsxs("div",{className:"bg-indigo-100 border border-indigo-600 text-indigo-600 pl-4 pr-16 py-3 rounded relative text-center",role:"alert",children:[e.jsx("span",{className:"block sm:inline",children:"Oops! No data available."}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]})})]})},Se=()=>{const{api_searchChallanDirect:t}=oe(),w=Z(),C=[{Header:"Sl.No.",Cell:({row:a})=>e.jsx("div",{children:(a==null?void 0:a.index)+1})},{Header:"Name",accessor:"full_name",Cell:({cell:a})=>{var r;return A((r=a.row.original)==null?void 0:r.full_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:a})=>{var r;return A((r=a.row.original)==null?void 0:r.mobile)}},{Header:"Application No",accessor:"application_no",Cell:({cell:a})=>{var r;return A((r=a.row.original)==null?void 0:r.application_no)}},{Header:"Challan No",accessor:"challan_no",Cell:({cell:a})=>{var r;return A((r=a.row.original)==null?void 0:r.challan_no)}},{Header:"Challan Date",accessor:"challan_date",Cell:({cell:a})=>{var r;return le((r=a.row.original)==null?void 0:r.challan_date)},className:"w-[7%]"},{Header:"Penalty Amount",accessor:"total_amount",Cell:({cell:a})=>{var r;return ie((r=a.row.original)==null?void 0:r.total_amount)}},{Header:"ULB Name",accessor:"ulb_name",Cell:({cell:a})=>{var r;return A((r=a.row.original)==null?void 0:r.ulb_name)}},{Header:"Validity",accessor:"hasExpired",Cell:({cell:a})=>{var r,i;return e.jsxs("div",{className:(r=a.row.original)!=null&&r.hasExpired?" text-red-700 pl-4 pr-16 py-3 rounded relative ":" text-green-700 pl-4 pr-16 py-3 rounded relative ",children:[(i=a.row.original)!=null&&i.hasExpired?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"inline mr-2 font-bold text-2xl"}),e.jsx("span",{className:"block sm:inline font-semibold",children:"Expired"})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"inline mr-2 font-bold text-2xl"}),e.jsx("span",{className:"block sm:inline font-semibold",children:"LIVE"})]}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]})}},{Header:"Action",Cell:({cell:a})=>{var r,i,b,c;return e.jsxs("div",{className:"flex items-center flex-wrap md:flex-nowrap flex-row gap-2 ",children:[e.jsxs("button",{onClick:()=>{var h,u;w(`/challan-show/${(u=(h=a==null?void 0:a.row)==null?void 0:h.original)==null?void 0:u.id}/direct`)},className:`border border-sky-700 text-sky-700 w-24 py-1 rounded-sm shadow-md hover:shadow-xl hover:bg-sky-700 \r
                    hover:text-white flex items-center justify-center gap-1 `,children:[e.jsx(z,{})," Challan"]}),!((i=(r=a==null?void 0:a.row)==null?void 0:r.original)!=null&&i.payment_status)&&e.jsxs("button",{onClick:()=>{var h,u;w(`/fp-pay/${(u=(h=a==null?void 0:a.row)==null?void 0:h.original)==null?void 0:u.id}/direct`)},className:`border border-orange-600 text-orange-500 w-24 py-1 rounded-sm shadow-md hover:shadow-xl hover:bg-orange-600 \r
                            hover:text-white flex items-center justify-center gap-1 `,children:[e.jsx(ce,{})," Pay"]}),((c=(b=a==null?void 0:a.row)==null?void 0:b.original)==null?void 0:c.payment_status)&&e.jsxs("button",{onClick:()=>{var h,u;w(`/payment-receipt/${(u=(h=a==null?void 0:a.row)==null?void 0:h.original)==null?void 0:u.transaction_no}/direct`)},className:`border border-green-600 text-green-600 w-24 py-1 rounded-sm shadow-md hover:shadow-xl hover:bg-green-600 \r
                    hover:text-white flex items-center justify-center gap-1 `,children:[e.jsx(z,{})," Receipt"]})]})}}],[p,m]=l.useState({}),[x,B]=l.useState(0),[E,H]=l.useState(!1),[P,O]=l.useState(!1),[D,q]=l.useState(""),T=te({searchBy:V().required("Select filter type"),entry:V().required("Enter the parameter")}),f=ne({initialValues:{searchBy:"",entry:""},validationSchema:T,onSubmit:a=>{q(a==null?void 0:a.entry),R(a)}}),R=a=>{O(!0),m({[a==null?void 0:a.searchBy]:a==null?void 0:a.entry}),B(r=>r+1)};console.log("API----",t),console.log("API----",x),console.log("API----",C);const j=()=>{fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then(a=>a.json()).then(a=>{console.log("Line 225----",a.data.data),S(a.data.data)}).catch(a=>{console.error("Export failed:",a),alert("Failed to export data.")})},S=a=>{if(!a||a.length===0){alert("No data available to export.");return}console.log(a.length,"----------------->>");try{const r=a.map((c,h)=>({"Sl No.":h+1,"Full Name":c.full_name||"N/A","Mobile No.":c.mobile||"N/A","Application No.":c.application_no||"N/A","Challan No.":c.challan_no||"N/A","Challan Date":c.challan_date||"N/A",Amount:c.amount||"N/A","Challan Date":c.challan_no||"N/A"})),i=$.json_to_sheet(r),b=$.book_new();$.book_append_sheet(b,i,"Enforcement Officers"),i["!cols"]=[{wch:5},{wch:30},{wch:20},{wch:15},{wch:25},{wch:30}],me(b,"Challan List.xlsx")}catch(r){console.error("Error exporting to Excel:",r),alert("Failed to export data. Please try again.")}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full md:pt-10",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-center mt-10",children:"Fines & Penalties"}),e.jsxs("div",{className:"w-full flex flex-col gap-5 justify-center items-center p-4 md:p-6 transition-all duration-200",children:[e.jsx("aside",{className:"w-full bg-slate-50 shadow-md h-max",children:e.jsxs("form",{onSubmit:f.handleSubmit,onChange:f.handleChange,className:"bg-white poppins p-4",children:[e.jsx("h1",{className:"text-xl font-semibold uppercase text-center text-gray-700 border-b border-gray-400 mb-4 pb-1",children:"Search Your Challan"}),e.jsxs("div",{className:"flex flex-row flex-wrap gap-x-4 items-center gap-y-2 pb-4 mb-2 border-b",children:[e.jsxs("div",{className:"w-full md:w-[25%]",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Search By",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...f.getFieldProps("searchBy"),className:`${f.errors.searchBy?"text-red-400 font-semibold border border-solid border-red-400 placeholder-red-300 shadow-red-100":"text-gray-700 font-normal border border-solid border-gray-400 placeholder-gray-400 h-10"} cursor-pointer w-full px-3 py-1 text-sm bg-white bg-clip-padding rounded transition ease-in-out focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-sm`,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"applicationNo",children:"Application Number"}),e.jsx("option",{value:"mobile",children:"Mobile Number"}),e.jsx("option",{value:"challanNo",children:"Challan Number"})]})]}),e.jsxs("div",{className:"w-full md:w-[25%]",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Parameter",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...f.getFieldProps("entry"),placeholder:"Enter the parameter",className:"h-10 w-full px-3 py-1 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-gray-400 rounded transition ease-in-out focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-400 shadow-md"})]}),e.jsx("div",{className:"mt-4 w-full md:w-[30%] flex flex-wrap items-center gap-x-4 gap-y-2 md:mt-6",children:E?e.jsx("div",{className:"flex justify-center",children:e.jsx(re,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsxs("button",{type:"submit",className:"py-2 flex items-center border border-green-600 bg-green-500 hover:bg-green-600 text-white shadow-md rounded-md text-sm px-5",children:[e.jsx(se,{}),e.jsx("span",{children:"Search Record"})]})})]})]})}),x!==0&&e.jsx("div",{className:"flex justify-end w-full mr-28 -mb-10",children:e.jsx("button",{onClick:j,className:"py-2 border border-blue-600 bg-blue-600 hover:bg-blue-500 text-white shadow-md rounded-md text-sm px-5",children:"Export"})}),e.jsx("aside",{className:"w-full overflow-clip transition-all duration-300 h-full",children:e.jsx(ue,{api:t,columns:C,requestBody:p,changeData:x,search:!1,loader:a=>H(a),exportStatus:!1,searchParams:D})})]})]})})})};export{Se as default};
