import{G as I,h as n,j as e,R as T,b as g,A as Z}from"./index-7f456209.js";import{c as j,a as v,d as K,u as L,F as W,b as z,e as Y}from"./index.esm-be8b4273.js";import{T as d}from"./TextField-4b7b68fa.js";import{P as G}from"./Page-602aa055.js";import{B as U}from"./Breadcrumb-8cadac2e.js";import{F as b,I as N,S as C,a as w}from"./Select-dfdd65b3.js";import{M as y}from"./MenuItem-40c8af69.js";import{T as J}from"./TextField-9f130bdc.js";function O(r){return I({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Square_Plus"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M18.438,20.938H5.563a2.5,2.5,0,0,1-2.5-2.5V5.564a2.5,2.5,0,0,1,2.5-2.5H18.438a2.5,2.5,0,0,1,2.5,2.5V18.438A2.5,2.5,0,0,1,18.438,20.938ZM5.563,4.064a1.5,1.5,0,0,0-1.5,1.5V18.438a1.5,1.5,0,0,0,1.5,1.5H18.438a1.5,1.5,0,0,0,1.5-1.5V5.564a1.5,1.5,0,0,0-1.5-1.5Z"}},{tag:"path",attr:{d:"M15,12.5H12.5V15a.5.5,0,0,1-1,0V12.5H9a.5.5,0,0,1,0-1h2.5V9a.5.5,0,0,1,1,0v2.5H15A.5.5,0,0,1,15,12.5Z"}}]}]}]})(r)}function Q(r){return I({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Square_Remove"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M18.437,20.937H5.563a2.5,2.5,0,0,1-2.5-2.5V5.563a2.5,2.5,0,0,1,2.5-2.5H18.437a2.5,2.5,0,0,1,2.5,2.5V18.437A2.5,2.5,0,0,1,18.437,20.937ZM5.563,4.063a1.5,1.5,0,0,0-1.5,1.5V18.437a1.5,1.5,0,0,0,1.5,1.5H18.437a1.5,1.5,0,0,0,1.5-1.5V5.563a1.5,1.5,0,0,0-1.5-1.5Z"}},{tag:"path",attr:{d:"M13.767,14.477a.5.5,0,0,0,.71-.71L12.707,12l1.77-1.77a.5.5,0,0,0-.71-.7L12,11.3l-1.77-1.77a.5.5,0,0,0-.7.7c.59.59,1.17,1.18,1.77,1.77l-1.77,1.77c-.46.45.25,1.16.7.71L12,12.707Z"}}]}]}]})(r)}const ne=()=>{const[r,p]=n.useState(!1),{api_class:A,api_fy:$,api_daily_fee_search:D}=Z,[m,V]=n.useState(),[u,R]=n.useState(),[t,S]=n.useState(null),q=async()=>{try{const s=await g.post(`${A}`,{});s.status==200&&(console.log(s.data),V(s.data.data))}catch(s){console.log(s)}},_=async()=>{try{const s=await g.post(`${$}`,{});s.status==200&&(console.log(s.data),R(s.data.data))}catch(s){console.log(s)}};n.useEffect(()=>{q(),_()},[]);const f=new Date;let k=f.getDate(),H=f.getMonth()+1,M=f.getFullYear(),x=`${k}-${H}-${M}`;const E=j({fyId:v().required("Required"),classId:v().required("Required"),admissionNo:v().required("Required"),dailyFeeCollection:K().of(j().shape({feesName:v().required("Required")}))}),l=L({initialValues:{fyId:"",classId:"",admissionNo:"",dailyFeeCollection:[{date:x,feesName:"",amount:0,receivedAmount:0,isReceived:0,dueAmount:0}]},onSubmit:async s=>{console.log("at submit",s);const a=s.dailyFeeCollection.map(c=>({...c,fyId:s.fyId,classId:s.classId,admissionNo:s.admissionNo}));console.log(a),p(!1),l.resetForm()},validationSchema:E});n.useEffect(()=>{}),console.log(l.values.admissionNo,l.values.classId,l.values.fyId,l.values.dailyFeeCollection);const P=()=>{B()},B=async()=>{var s;try{const a=await g.post(`${D}`,{fyId:l.values.fyId,classId:l.values.classId,admissionNo:l.values.admissionNo});console.log(a.data),((s=a==null?void 0:a.data)==null?void 0:s.status)==!0&&(S(a.data.data),p(!0))}catch(a){console.log(a)}};n.useEffect(()=>{p(!1)},[]);const F=(s,a)=>{let c=s?parseInt(s.target.value):s.target.value===""?0:s.target.value;console.log(a);let h=s.target.name;h==`dailyFeeCollection.${a}.amount`&&l.setFieldValue(`dailyFeeCollection.${a}.amount`,c),h==`dailyFeeCollection.${a}.receivedAmount`&&l.setFieldValue(`dailyFeeCollection.${a}.receivedAmount`,s?parseInt(s.target.value):0),l.values.dailyFeeCollection[a].amount&&l.values.dailyFeeCollection[a].receivedAmount?l.setFieldValue(`dailyFeeCollection.${a}.dueAmount`,l.values.dailyFeeCollection[a].amount-l.values.dailyFeeCollection[a].receivedAmount):l.values.dailyFeeCollection[a].amount&&(l.values.dailyFeeCollection[a].receivedAmount===0||l.values.dailyFeeCollection[a].receivedAmount==="")?l.setFieldValue(`dailyFeeCollection.${a}.dueAmount`,l.values.dailyFeeCollection[a].amount-0):l.values.dailyFeeCollection[a].receivedAmount&&(l.values.dailyFeeCollection[a].amount===0||l.values.dailyFeeCollection[a].amount==="")?l.setFieldValue(`dailyFeeCollection.${a}.dueAmount`,0-l.values.dailyFeeCollection[a].receivedAmount):l.setFieldValue(`dailyFeeCollection.${a}.dueAmount`,0)};return e.jsxs(G,{title:"Daily fee collection",pageName:"Daily Fee Collection",children:[e.jsx(U,{list:[{title:"Home",path:"/csms/home"},{title:"Daily Fee Collection",path:"#"}]}),e.jsx("h1",{className:"text-center text-4xl font-semibold mt-[2vh]",children:"Daily Fee Collection"}),e.jsx("div",{children:e.jsx(W,{value:l,children:e.jsxs(z,{autoComplete:"off",onChange:F,onSubmit:l.handleSubmit,children:[e.jsxs("div",{className:"px-10 mt-8 grid grid-cols-12  gap-x-4  ",children:[e.jsx("div",{className:"mt-4 col-span-12 lg:col-span-3 ",children:e.jsxs(b,{fullWidth:!0,error:l.touched.fyId&&!!l.errors.fyId,children:[e.jsx(N,{id:"demo-simple-select-label",sx:{m:-1},children:"Select Financial Year"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Financial Year",...l.getFieldProps("fyId"),fullWidth:!0,size:"small",children:[e.jsx(y,{value:"",children:"Select"}),u&&(u==null?void 0:u.map(s=>e.jsx(y,{value:s==null?void 0:s.id,children:s==null?void 0:s.financial_year})))]}),e.jsx(w,{children:l.touched.fyId&&l.errors.fyId})]})}),e.jsx("div",{className:"mt-4 col-span-12 lg:col-span-3 ",children:e.jsxs(b,{fullWidth:!0,error:l.touched.classId&&!!l.errors.classId,children:[e.jsx(N,{id:"demo-simple-select-label",sx:{m:-1},children:"Select Class"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Class",...l.getFieldProps("classId"),fullWidth:!0,size:"small",children:[e.jsx(y,{value:"",children:"Select"}),m&&(m==null?void 0:m.map(s=>e.jsx(y,{value:s==null?void 0:s.id,children:s==null?void 0:s.class_name})))]}),e.jsx(w,{children:l.touched.classId&&l.errors.classId})]})}),e.jsx("div",{className:"mt-4 col-span-12 lg:col-span-3 ",children:e.jsx(J,{type:"text",...l.getFieldProps("admissionNo"),label:"Admission No",fullWidth:!0,size:"small",error:l.touched.admissionNo&&!!l.errors.admissionNo,helperText:l.touched.admissionNo&&l.errors.admissionNo})})]}),e.jsx("div",{className:"mt-7 flex justify-center items-center  max-[1016px]:py-2",children:e.jsx("button",{onClick:P,type:"button",className:"px-11 py-3 bg-[#0F766E] text-white font-medium text-sm leading-tight  rounded shadow-md  hover:shadow-lg  focus:shadow-lg focus:outline-none focus:ring-0  active:shadow-lg transition duration-150 ease-in-out",children:"Search"})}),r&&t!==null&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border h-[10vh] mb-[5vh] mt-[3vh] ml-[2vh] mr-[2vh]   ",children:[e.jsx("h1",{className:"px-2 font-semibold py-2 text-xl absolute bg-white ml-[2vh] -mt-[2vh] h-[2vh]",children:"Basic Details"}),e.jsxs("div",{className:"flex text-lg px-10 font-bold justify-between mt-[3vh] flex-wrap",children:[e.jsxs("label",{htmlFor:"",children:["Name:"," ",e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.full_name})," "]}),e.jsxs("label",{htmlFor:"",children:["Class:"," ",e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.class_name})," "]}),e.jsxs("label",{htmlFor:"",children:["Section:"," ",e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.section})," "]}),e.jsxs("label",{htmlFor:"",children:["Roll no:"," ",e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.roll_no})]}),e.jsxs("label",{htmlFor:"",children:["Status:"," ",e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.status})]})]})]}),e.jsx("div",{className:"border h-auto mt-[3vh] ml-[2vh] mr-[2vh]   ",children:e.jsx(Y,{name:"dailyFeeCollection",children:s=>{var a,c;return e.jsx(e.Fragment,{children:((a=l==null?void 0:l.values.dailyFeeCollection)==null?void 0:a.length)>0&&((c=l==null?void 0:l.values)==null?void 0:c.dailyFeeCollection.map((h,o)=>e.jsx(T.Fragment,{children:e.jsxs("div",{className:"px-10 flex flex-wrap gap-x-7 ",children:[e.jsx("div",{className:"mt-4 ",children:e.jsx(d,{className:"w-[8vw]",type:"text",disabled:!0,value:x,formik:l,label:"Date",name:`dailyFeeCollection.${o}.date`,isDynamic:!0})}),e.jsx("div",{className:"mt-4 ",children:e.jsx(d,{className:"w-[8vw]",type:"text",formik:l,label:"Fees Name",name:`dailyFeeCollection.${o}.feesName`,isDynamic:!0})}),e.jsx("div",{className:"mt-4 ",children:e.jsx(d,{min:0,className:"w-[8vw]",type:"number",formik:l,label:"Amount",name:`dailyFeeCollection.${o}.amount`,onKeyUp:i=>F(i,o),isDynamic:!0,onKeyDown:i=>["e","E","+","-"," "].includes(i.key)&&i.preventDefault()})}),e.jsx("div",{className:"mt-4 ",children:e.jsx(d,{className:"w-[8vw]",type:"number",min:0,formik:l,label:"Received Amount",name:`dailyFeeCollection.${o}.receivedAmount`,onKeyUp:i=>F(i,o),isDynamic:!0,onKeyDown:i=>["e","E","+","-"," "].includes(i.key)&&i.preventDefault()})}),e.jsx("div",{className:"mt-4 ",children:e.jsx(d,{disabled:!0,min:0,className:"w-[8vw]",type:"number",formik:l,value:l.values.dailyFeeCollection[o].dueAmount,label:"Due Amount",name:`dailyFeeCollection.${o}.dueAmount`,isDynamic:!0,onKeyDown:i=>["e","E","+","-"," "].includes(i.key)&&i.preventDefault()})}),e.jsx("div",{className:"mt-4 ",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700",htmlFor:"",children:"Received"}),e.jsx("input",{formik:l,name:`dailyFeeCollection.${o}.isReceived`,className:"h-6 mt-2",type:"checkbox",checked:l.values.dailyFeeCollection[o].isReceived===1,onChange:i=>{l.setFieldValue(`dailyFeeCollection.${o}.isReceived`,i.target.checked?1:0)}})]})}),e.jsxs("div",{className:"mt-10",children:[o>0&&e.jsx("button",{className:"mt-1",type:"button",onClick:()=>s.remove(o),children:e.jsx(Q,{className:"inline-block w-9 h-9 text-red-600"})}),"|",e.jsx("button",{type:"button",className:"mt-1",onClick:()=>{if(h.feesName==="")return alert("Please fill all fields");s.push({date:x,feesName:"",amount:0,isReceived:0,dueAmount:0,receivedAmount:0})},children:e.jsx(O,{className:"inline-block w-9 h-9 text-blue-600"})})]})]})},o)))})}})}),e.jsx("div",{className:"mt-7 flex justify-center items-center  max-[1016px]:py-2",children:e.jsx("button",{type:"submit",className:"px-11 py-3 bg-[#6366f1] text-white font-medium text-sm leading-tight  rounded shadow-md  hover:shadow-lg  focus:shadow-lg focus:outline-none focus:ring-0  active:shadow-lg transition duration-150 ease-in-out",children:"Submit"})})]})]})})})]})};export{ne as default};
