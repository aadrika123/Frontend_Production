import{j as e,h as Qe,u as Y,k as H,z as P,m as O,r as t,i as Ve,B as Q}from"./index-BSJ1SkMD.js";import{a as He}from"./index-Bh0C4ouL.js";import{C as oe,d as ue,b as we,a as ze,c as Ke}from"./card-CBGUvzyE.js";import{a as xe,T as he,b as me,c as z,d as _,e as je,f as T,S as ne}from"./Spinner-mCpU_Q4c.js";import{g as G}from"./services-KQnp_8oA.js";import{u as De,C as $e,S as Ye,f as Ge,g as Je,h as Xe,i as Le,j as Ze,a as re,F as ge,o as ce,c as J,b as L,B as Re}from"./switch-Cbclq3Df.js";import{I as Be}from"./input-C_krfZFP.js";import{R as ea}from"./SelectField-Azm2kiUz.js";import{L as aa}from"./label-12uNJdn5.js";import{F as be,b as ke}from"./index-Ct6XzkDv.js";import{D as Se,b as pe,a as Ce,P as _e}from"./dialog-LBw3-K_o.js";import{D as fe}from"./index-BdohMXw-.js";import{T as Fe,a as qe,f as Ie,g as Pe,b as Ae,c as Ee,d as sa,e as la}from"./tabs-Dl9WlABJ.js";import{X as Me}from"./x-DJkcKZIJ.js";import{P as Oe}from"./index-BsZVffJD.js";import{R as de}from"./RHFTextField-DY9TkUoq.js";import{I as We}from"./Image-CsjpSzz6.js";import{t as Te}from"./switch-Bs1RRyh8.js";import"./createLucideIcon-CokW7ulW.js";const ta=({children:a,name:y,label:W,selectedText:i,className:b,data:C,initialValue:f,initialValueText:A,...w})=>{const{control:E,setValue:I}=De();return e.jsx($e,{name:y,control:E,render:({field:{ref:F,...V},fieldState:{error:$}})=>e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-gray-700 dark:text-gray-200 ",children:[W," ",$&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs(Ye,{onValueChange:R=>{var k;V.onChange(R),i&&I(i,(k=C==null?void 0:C.find(j=>j.value==R))==null?void 0:k.label)},value:V.value,...w,children:[e.jsx(Ge,{ref:F,className:Qe("h-10 mt-1",$?"border-red-400":null,b),children:e.jsx(Je,{placeholder:"Select"})}),e.jsxs(Xe,{children:[f&&e.jsx(Le,{value:f??"0",children:A??"Select"}),e.jsx(Ze,{children:C==null?void 0:C.map((R,k)=>e.jsx(Le,{value:R.value,children:R.label},k+1))})]})]}),$&&e.jsx("span",{className:"text-red-400 text-xs",children:$==null?void 0:$.message})]})})};function Ue({name:a,label:y,isDynamic:W,isRequired:i,...b}){const{control:C,setValue:f}=De();return e.jsx($e,{name:a,control:C,render:({field:{ref:A},fieldState:{error:w}})=>e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-200",htmlFor:y,children:[y," ",i&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(Be,{type:"file",onChange:E=>{f(a,E.target.files?E.target.files[0]:null)},ref:A,className:`mt-1 ${w?"border-red-400":null}`,...b}),w&&e.jsx("span",{className:"text-red-400 text-xs",children:w.message})]})})}const da=J().shape({service_name:L().required("menu name is required")});function na({open:a,setOpen:y,title:W,edit:i,setEdit:b,serviceList:C,moduleList:f,id:A,menuRoleList:w,moduleId:E,menuRoleId:I,moduleName:F,roleList:V,userPermittedRoles:$,userId:R,permittedModule:k,ulbId:j,permittedModuleListByUlb:q}){var l;const D=Y({}),M=Y({}),d=re({defaultValues:{service_name:""},resolver:ce(da)}),r=async u=>{var g,s,c;try{const m=i?"EditModuleList":"AddmoduleList",h=i&&A?{...u,moduleId:A}:{...u,moduleId:E},v=await D.mutateAsync({api:m,data:h});(g=v==null?void 0:v.data)!=null&&g.success?(P.success((s=v==null?void 0:v.data)==null?void 0:s.message),y(!1),b(!1),C.refetch()):P.error((c=v==null?void 0:v.data)==null?void 0:c.message)}catch(m){P.error(G(m))}},x=async(u,g)=>{var s,c,m,h;console.log(g);try{const v={ulbId:j,moduleList:[{permissionStatus:g,moduleId:u}]},N=await M.mutateAsync({api:(s=O)==null?void 0:s.addRemoveModuleToUlb,data:v});(c=N==null?void 0:N.data)!=null&&c.status?(P.success(((m=N==null?void 0:N.data)==null?void 0:m.message)||"Permission updated successfully"),q.refetch()):P.error(((h=N==null?void 0:N.data)==null?void 0:h.message)||"Failed to update permission")}catch(v){P.error(G(v))}};return H({api:(l=O)==null?void 0:l.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),console.log(k),e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:b,edit:i,children:e.jsx(ge,{methods:d,onSubmit:d.handleSubmit(r),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Module Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(k==null?void 0:k.map((u,g)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:g+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${u.permission_status?"text-green-600":"text-black"}`,children:u.module_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:u.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>x(u.id,!u.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>x(u.id,!u.permission_status),children:"Add"})})]},u.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}const ra=J().shape({service_name:L().required("menu name is required")});function ca({open:a,setOpen:y,title:W,edit:i,setEdit:b,serviceList:C,moduleList:f,id:A,menuRoleList:w,moduleId:E,menuRoleId:I,moduleName:F,roleList:V,userPermittedRoles:$,userId:R,permittedModule:k,ulbId:j,permittedModuleListByUlb:q,getServicesByUlbModule:D,permittedServices:M}){var g;const d=Y({}),r=Y({}),x=re({defaultValues:{service_name:""},resolver:ce(ra)}),l=async s=>{var c,m,h;try{const v=i?"EditModuleList":"AddmoduleList",N=i&&A?{...s,moduleId:A}:{...s,moduleId:E},U=await d.mutateAsync({api:v,data:N});(c=U==null?void 0:U.data)!=null&&c.success?(P.success((m=U==null?void 0:U.data)==null?void 0:m.message),y(!1),b(!1),C.refetch()):P.error((h=U==null?void 0:U.data)==null?void 0:h.message)}catch(v){P.error(G(v))}},u=async(s,c)=>{var m,h,v,N;console.log(c);try{const U={ulbId:j,serviceList:[{permissionStatus:c,serviceId:s}]},S=await r.mutateAsync({api:(m=O)==null?void 0:m.addRemoveServiceByUlbModule,data:U});(h=S==null?void 0:S.data)!=null&&h.status?(P.success(((v=S==null?void 0:S.data)==null?void 0:v.message)||"Permission updated successfully"),D.refetch()):P.error(((N=S==null?void 0:S.data)==null?void 0:N.message)||"Failed to update permission")}catch(U){P.error(G(U))}};return H({api:(g=O)==null?void 0:g.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),console.log(k),e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:b,edit:i,children:e.jsx(ge,{methods:x,onSubmit:x.handleSubmit(l),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Route"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(M==null?void 0:M.map((s,c)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:c+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.services}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.path}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>u(s.id,!s.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>u(s.id,!s.permission_status),children:"Add"})})]},s.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}const ia=J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function oa(a){var U,S,X,ee,ae,p,B,se,le;const[y,W]=t.useState(1),[i,b]=t.useState(10),[C,f]=t.useState(!1),[A,w]=t.useState(""),[E,I]=t.useState(!1),[F,V]=t.useState(!1),[$,R]=t.useState(!1),[k,j]=t.useState(null),[q,D]=t.useState(!1),[M,d]=t.useState(""),[r,x]=t.useState(""),[l,u]=t.useState(""),[g,s]=t.useState(1),[c,m]=t.useState(10);console.log(a==null?void 0:a.ulbId);const h=re({resolver:ce(ia),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),v=Ve({api:`${(U=O)==null?void 0:U.serviceList}?module=${(S=h==null?void 0:h.watch())==null?void 0:S.moduleId}`,key:"serviceMasterList",options:{enabled:!0}});H({api:(X=O)==null?void 0:X.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:y,perPage:i,searchQuery:l,[M]:l},value:[y,i,M,l],options:{enabled:!!(a!=null&&a.ulbId)}});const N=H({api:(ee=O)==null?void 0:ee.getServicesByUlbModule,key:"getServicesByUlbModule",config:{ulbId:a==null?void 0:a.ulbId,moduleId:a==null?void 0:a.moduleId},options:{enabled:!!(a!=null&&a.ulbId)}});return console.log(a==null?void 0:a.moduleId),console.log((ae=N==null?void 0:N.data)==null?void 0:ae.data),e.jsxs(e.Fragment,{children:[e.jsx(Se,{open:q,children:e.jsx(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll"})}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{w(""),I(!1),f(!0)},children:"Restrict More Services"})})}),e.jsx(ca,{open:C,setOpen:f,title:E?"Edit Restrict Service":"Add Restrict Service",id:A,edit:E,setEdit:I,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,ulbId:a==null?void 0:a.ulbId,getServicesByUlbModule:N,permittedServices:(p=N==null?void 0:N.data)==null?void 0:p.data}),e.jsx(oe,{children:e.jsx(ue,{children:v.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Service Name"}),e.jsx(_,{className:"",children:"Service Route"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(le=(se=(B=N==null?void 0:N.data)==null?void 0:B.data)==null?void 0:se.filter(n=>(n==null?void 0:n.permission_status)==!0))==null?void 0:le.map((n,o)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+o+1}),e.jsx(T,{children:n==null?void 0:n.services}),e.jsx(T,{children:n==null?void 0:n.path}),e.jsx(T,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{w(n==null?void 0:n.id),I(!0),f(!0)},children:[e.jsx(be,{})," Edit"]})})]},n==null?void 0:n.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"})]})})})]})})]})}J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function ua(a){var g,s,c,m,h,v,N,U;const[y,W]=t.useState(1),[i,b]=t.useState(10),[C,f]=t.useState(!1),[A,w]=t.useState(""),[E,I]=t.useState(!1),[F,V]=t.useState(!1),[$,R]=t.useState(null),[k,j]=t.useState(1),[q,D]=t.useState(10),M=100,d=S=>{j(S)},r=S=>{D(S),j(1)};console.log(a==null?void 0:a.ulbId);const x=H({api:(g=O)==null?void 0:g.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),l=H({api:(s=O)==null?void 0:s.getModuleByUlbId,key:"permittedModuleListByUlb",config:{ulbId:a==null?void 0:a.ulbId},options:{enabled:!!(a!=null&&a.ulbId)}});console.log((c=l==null?void 0:l.data)==null?void 0:c.data);const u=S=>{R(S),V(!0)};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:F,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:(m=a==null?void 0:a.selectedULB)==null?void 0:m.ulb_name})]}),e.jsxs("div",{children:["Module Name : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:$==null?void 0:$.module_name})]})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>V(!1)})})})]}),e.jsxs(Fe,{defaultValue:"MENULIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsx(qe,{className:"grid w-auto grid-cols-2",children:e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Restricted Services"})})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(oa,{ulbId:a==null?void 0:a.ulbId,moduleId:A,viewService:$})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{w(""),I(!1),f(!0)},children:"Add More Module"})})}),e.jsx(na,{open:C,setOpen:f,title:E?"Edit Module":"Add Module",id:A,edit:E,setEdit:I,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedModule:(h=l==null?void 0:l.data)==null?void 0:h.data,permittedModuleListByUlb:l,ulbId:a==null?void 0:a.ulbId}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:x.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Module"}),e.jsx(_,{className:"",children:"Path"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(U=(N=(v=l==null?void 0:l.data)==null?void 0:v.data)==null?void 0:N.filter(S=>(S==null?void 0:S.permission_status)==!0))==null?void 0:U.map((S,X)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+X+1}),e.jsx(T,{children:S==null?void 0:S.module_name}),e.jsx(T,{children:S==null?void 0:S.url}),e.jsxs(T,{children:[e.jsxs(Q,{variant:"secondary",onClick:()=>{w(S==null?void 0:S.id),I(!0),f(!0)},children:[e.jsx(be,{})," Edit"]}),e.jsxs(Q,{onClick:()=>{u(S),w(S==null?void 0:S.id)},className:"ml-2",variant:"secondary",children:[e.jsx(ke,{})," View"]})]})]},S==null?void 0:S.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(_e,{currentPage:k,totalItems:M,itemsPerPage:q,onPageChange:d,onItemsPerPageChange:r})})]})})})]})})}const xa=J().shape({service_name:L().required("menu name is required")});function ha({open:a,setOpen:y,title:W,edit:i,setEdit:b,serviceList:C,moduleList:f,id:A,menuRoleList:w,moduleId:E,menuRoleId:I,moduleName:F,roleList:V,userPermittedRoles:$,userId:R}){const k=Y({}),j=Y({}),q=re({defaultValues:{service_name:""},resolver:ce(xa)}),D=async d=>{var r,x,l;try{const u=i?"EditModuleList":"AddmoduleList",g=i&&A?{...d,moduleId:A}:{...d,moduleId:E},s=await k.mutateAsync({api:u,data:g});(r=s==null?void 0:s.data)!=null&&r.success?(P.success((x=s==null?void 0:s.data)==null?void 0:x.message),y(!1),b(!1),C.refetch()):P.error((l=s==null?void 0:s.data)==null?void 0:l.message)}catch(u){P.error(G(u))}},M=async(d,r)=>{var x,l,u,g;console.log(r);try{const s={userId:R,permissionStatus:r,menuRoleId:d},c=await j.mutateAsync({api:(x=O)==null?void 0:x.addMenuRoleUser,data:s});(l=c==null?void 0:c.data)!=null&&l.status?(P.success(((u=c==null?void 0:c.data)==null?void 0:u.message)||"Permission updated successfully"),$.refetch()):P.error(((g=c==null?void 0:c.data)==null?void 0:g.message)||"Failed to update permission")}catch(s){P.error(G(s))}};return e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:b,edit:i,children:e.jsx(ge,{methods:q,onSubmit:q.handleSubmit(D),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(V==null?void 0:V.map((d,r)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${d.permission_status?"text-green-600":"text-black"}`,children:d.menu_role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>M(d.id,!d.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>M(d.id,!d.permission_status),children:"Add"})})]},d.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function ma(a){var l,u,g,s,c,m;const[y,W]=t.useState(1),[i,b]=t.useState(10),[C,f]=t.useState(!1),[A,w]=t.useState(""),[E,I]=t.useState(!1),[F,V]=t.useState(!1),[$,R]=t.useState(null),[k,j]=t.useState(1),[q,D]=t.useState(10),M=100,d=h=>{j(h)},r=h=>{D(h),j(1)};console.log(a==null?void 0:a.ulbId);const x=H({api:(l=O)==null?void 0:l.userPermittedRoles,key:"userPermittedRoles",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((u=x==null?void 0:x.data)==null?void 0:u.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{w(""),I(!1),f(!0)},children:"Add More Role Permission"})})}),e.jsx(ha,{open:C,setOpen:f,title:E?"Edit Menu":"Add Menu",id:A,edit:E,setEdit:I,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,roleList:(g=x==null?void 0:x.data)==null?void 0:g.data,userPermittedRoles:x}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:x.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Role Menu"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(m=(c=(s=x==null?void 0:x.data)==null?void 0:s.data)==null?void 0:c.filter(h=>(h==null?void 0:h.permission_status)==!0))==null?void 0:m.map((h,v)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+v+1}),e.jsx(T,{children:h==null?void 0:h.menu_role_name}),e.jsx(T,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{w(h==null?void 0:h.id),I(!0),f(!0)},children:[e.jsx(be,{})," Edit"]})})]},h==null?void 0:h.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(_e,{currentPage:k,totalItems:M,itemsPerPage:q,onPageChange:d,onItemsPerPageChange:r})})]})})})]})})}const ja=J().shape({service_name:L().required("menu name is required")});function ga({open:a,setOpen:y,title:W,edit:i,setEdit:b,serviceList:C,moduleList:f,id:A,menuRoleList:w,moduleId:E,menuRoleId:I,moduleName:F,wardList:V,permittedWardByUsers:$,userId:R}){const k=Y({}),j=Y({}),q=re({defaultValues:{service_name:""},resolver:ce(ja)}),D=async d=>{var r,x,l;try{const u=i?"EditModuleList":"AddmoduleList",g=i&&A?{...d,moduleId:A}:{...d,moduleId:E},s=await k.mutateAsync({api:u,data:g});(r=s==null?void 0:s.data)!=null&&r.success?(P.success((x=s==null?void 0:s.data)==null?void 0:x.message),y(!1),b(!1),C.refetch()):P.error((l=s==null?void 0:s.data)==null?void 0:l.message)}catch(u){P.error(G(u))}},M=async(d,r)=>{var x,l,u,g;console.log(r);try{const s={userId:R,wardList:d?[{permissionStatus:r,wardId:d}]:V.map(m=>({wardId:m.id,permissionStatus:r}))},c=await j.mutateAsync({api:(x=O)==null?void 0:x.addRemoveWard,data:s});(l=c==null?void 0:c.data)!=null&&l.status?(P.success(((u=c==null?void 0:c.data)==null?void 0:u.message)||"Permission updated successfully"),$.refetch()):P.error(((g=c==null?void 0:c.data)==null?void 0:g.message)||"Failed to update permission")}catch(s){P.error(G(s))}};return e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:b,edit:i,children:e.jsx(ge,{methods:q,onSubmit:q.handleSubmit(D),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-4 py-2 rounded-md text-sm font-bold",onClick:()=>M(null,!0),children:"Select All"}),e.jsx("button",{className:"text-red-600 bg-red-200 hover:bg-red-100 px-4 py-2 rounded-md text-sm font-bold",onClick:()=>M(null,!1),children:"Remove All"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Ward No."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(V==null?void 0:V.map((d,r)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${d.permission_status?"text-green-600":"text-black"}`,children:d.ward_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>M(d.id,!d.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>M(d.id,!d.permission_status),children:"Add"})})]},d.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})]})})})}J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function ba(a){var r,x,l,u,g,s,c;const[y,W]=t.useState(1),[i,b]=t.useState(10),[C,f]=t.useState(!1),[A,w]=t.useState(""),[E,I]=t.useState(!1),[F,V]=t.useState(!1),[$,R]=t.useState(null),[k,j]=t.useState(1),[q,D]=t.useState(10);console.log(a==null?void 0:a.ulbId);const M=H({api:(r=O)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),d=H({api:(x=O)==null?void 0:x.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((l=d==null?void 0:d.data)==null?void 0:l.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{w(""),I(!1),f(!0)},children:"Add More Ward Permission"})})}),e.jsx(ga,{open:C,setOpen:f,title:E?"Edit Ward":"Add Ward",id:A,edit:E,setEdit:I,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedWardByUsers:d,wardList:(u=d==null?void 0:d.data)==null?void 0:u.data}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:M.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Wards"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(c=(s=(g=d==null?void 0:d.data)==null?void 0:g.data)==null?void 0:s.filter(m=>(m==null?void 0:m.permission_status)==!0))==null?void 0:c.map((m,h)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+h+1}),e.jsx(T,{children:m==null?void 0:m.ward_name}),e.jsx(T,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{w(m==null?void 0:m.id),I(!0),f(!0)},children:[e.jsx(be,{})," Edit"]})})]},m==null?void 0:m.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"})]})})})]})})}const fa=J().shape({service_name:L().required("menu name is required")});function Na({open:a,setOpen:y,title:W,subtitle:i,edit:b,setEdit:C,serviceList:f,moduleList:A,id:w,menuRoleList:E,moduleId:I,menuRoleId:F,moduleName:V,wardList:$,permittedworkFlowRoleByUser:R,userId:k,workFlowList:j}){const q=Y({}),D=Y({}),M=re({defaultValues:{service_name:""},resolver:ce(fa)}),d=async l=>{var u,g,s;try{const c=b?"EditModuleList":"AddmoduleList",m=b&&w?{...l,moduleId:w}:{...l,moduleId:I},h=await q.mutateAsync({api:c,data:m});(u=h==null?void 0:h.data)!=null&&u.success?(P.success((g=h==null?void 0:h.data)==null?void 0:g.message),y(!1),C(!1),f.refetch()):P.error((s=h==null?void 0:h.data)==null?void 0:s.message)}catch(c){P.error(G(c))}},r=async(l,u)=>{var g,s,c,m;console.log(u);try{const h={userId:k,permissionStatus:u,wfRoleId:l},v=await D.mutateAsync({api:(g=O)==null?void 0:g.AddRemoveWorkFlowRoleByUser,data:h});(s=v==null?void 0:v.data)!=null&&s.status?(P.success(((c=v==null?void 0:v.data)==null?void 0:c.message)||"Permission updated successfully"),R.refetch()):P.error(((m=v==null?void 0:v.data)==null?void 0:m.message)||"Failed to update permission")}catch(h){P.error(G(h))}},x=j==null?void 0:j.some(l=>l.permission_status);return e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:C,subtitle:i,edit:b,children:e.jsx(ge,{methods:M,onSubmit:M.handleSubmit(d),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(j==null?void 0:j.map((l,u)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:u+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${l.permission_status?"text-green-600":"text-black"}`,children:l.role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-bold ${l.permission_status?"text-red-600 bg-red-200 hover:bg-red-100":x?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-green-600 bg-green-200 hover:bg-green-100"}`,onClick:()=>!x||l.permission_status?r(l.id,!l.permission_status):null,disabled:!l.permission_status&&x,children:l.permission_status?"Remove":"Add"})})]},l.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function ya(a){var x,l,u,g,s,c,m,h,v;const[y,W]=t.useState(1),[i,b]=t.useState(10),[C,f]=t.useState(!1),[A,w]=t.useState(""),[E,I]=t.useState(!1),[F,V]=t.useState(!1),[$,R]=t.useState(null),[k,j]=t.useState(1),[q,D]=t.useState(10),M=H({api:(x=O)==null?void 0:x.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),d=H({api:(l=O)==null?void 0:l.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}}),r=H({api:(u=O)==null?void 0:u.workFlowRoleByUser,key:"permittedworkFlowRoleByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((g=d==null?void 0:d.data)==null?void 0:g.data),console.log((s=r==null?void 0:r.data)==null?void 0:s.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{w(""),I(!1),f(!0)},children:"Change Role Permission"})})}),e.jsx(Na,{open:C,setOpen:f,title:E?"Edit Role":"Change Role",subtitle:"You can provide only one workflow role at a time.",id:A,edit:E,setEdit:I,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedworkFlowRoleByUser:r,workFlowList:(c=r==null?void 0:r.data)==null?void 0:c.data}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:M.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Workflow Role Name"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(v=(h=(m=r==null?void 0:r.data)==null?void 0:m.data)==null?void 0:h.filter(N=>(N==null?void 0:N.permission_status)==!0))==null?void 0:v.map((N,U)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+U+1}),e.jsx(T,{children:N==null?void 0:N.role_name}),e.jsx(T,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{w(N==null?void 0:N.id),I(!0),f(!0)},children:[e.jsx(be,{})," Edit"]})})]},N==null?void 0:N.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"})]})})})]})})}const va=J().shape({userType:L().required("User Type is required"),name:L().required("Full Name is required"),mobile:L().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:L().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:L().email("Enter a valid email").required("Email is required"),address:L().required("Address is required"),photo:L().required("User Image is required")});function Sa({open:a,setOpen:y,title:W,edit:i,setEdit:b,adminListFun:C,id:f,ulbId:A,userListByUlbId:w}){var k,j,q;const E=Y({}),I=t.useRef(null),F=re({defaultValues:{userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:ce(va)}),{reset:V}=F;console.log(A,"ulbId"),t.useEffect(()=>{var D,M,d;if(a){if(i&&f){const r=(d=(M=(D=w==null?void 0:w.data)==null?void 0:D.data)==null?void 0:M.data)==null?void 0:d.find(x=>x.id==f);console.log(r,"selectedAdmin"),r&&V({userType:r.user_type||"",name:r.name||"",mobile:r.mobile||"",altMobile:r.alternateMobile||"",email:r.email||"",address:r.address||"",photo:null})}else V({userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});F.setValue("photo",""),I.current&&(I.current.value="")}},[a,i,f,C,V]);const $=async D=>{var M,d,r,x,l;try{const u=i?(M=O)==null?void 0:M.updateAdmin:(d=O)==null?void 0:d.createAdmin,g=i&&f?{...D,id:f}:{...D,ulbId:A},s=new FormData;s.append("name",g.name),s.append("mobile",g.mobile),s.append("altMobile",g.altMobile),s.append("email",g.email),s.append("address",g.address),s.append("userType",g.userType),s.append("photo",F.watch("photo")),i&&f&&s.append("id",f),s.append("ulbId",A||"");const c=await E.mutateAsync({api:u,data:s});(r=c==null?void 0:c.data)!=null&&r.status?(P.success((x=c==null?void 0:c.data)==null?void 0:x.message),y(!1),b(!1),w.refetch()):P.error((l=c==null?void 0:c.data)==null?void 0:l.message)}catch(u){P.error(G(u))}},R=H({api:(k=O)==null?void 0:k.createUserType,key:"createUserTypeList",options:{enabled:!0}});return console.log((j=R==null?void 0:R.data)==null?void 0:j.data,"createUserTypeList"),e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:b,edit:i,children:e.jsx(ge,{methods:F,onSubmit:F.handleSubmit($),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(ta,{label:"User Type",name:"userType",data:((q=R==null?void 0:R.data)==null?void 0:q.data.map(D=>({value:String(D),label:String(D)})))||[]})}),e.jsx("div",{children:e.jsx(de,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Full Name"})}),e.jsx("div",{children:e.jsx(de,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter Alt Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(de,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Ue,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(ne,{}),e.jsx("div",{children:e.jsx(Re,{isLoading:F.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const pa=J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function Ia(a){var m,h,v,N,U,S,X,ee,ae,p,B,se,le,n;const[y,W]=t.useState(1),[i,b]=t.useState(10),C=Y({}),[f,A]=t.useState(!1),[w,E]=t.useState(""),[I,F]=t.useState(!1),[V,$]=t.useState(!1),[R,k]=t.useState(!1),[j,q]=t.useState(""),[D,M]=t.useState(""),[d,r]=t.useState(""),x=o=>{q(o)},l=o=>{M(o.target.value)};t.useEffect(()=>{const o=setTimeout(()=>{r(D)},700);return()=>clearTimeout(o)},[D]),console.log(a==null?void 0:a.ulbId);const u=re({resolver:ce(pa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),g=Ve({api:`${(m=O)==null?void 0:m.serviceList}?module=${(h=u==null?void 0:u.watch())==null?void 0:h.moduleId}`,key:"serviceMasterList",options:{enabled:!0}}),s=H({api:(v=O)==null?void 0:v.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:y,perPage:i,searchQuery:d,[j]:d},value:[y,i,j],options:{enabled:!0}});t.useEffect(()=>{d&&(W(1),b(10)),s.refetch()},[d]);const c=async(o,te)=>{var K,ye,ve,Ne;try{const Z={id:o,isSuspended:te},ie=await C.mutateAsync({api:(K=O)==null?void 0:K.enableDisableUserByModule,data:Z});(ye=ie==null?void 0:ie.data)!=null&&ye.status?(P.success(((ve=ie==null?void 0:ie.data)==null?void 0:ve.message)||"Permission updated successfully"),s.refetch()):P.error(((Ne=ie==null?void 0:ie.data)==null?void 0:Ne.message)||"Failed to update permission")}catch(Z){P.error(G(Z))}};return console.log(j),e.jsxs(e.Fragment,{children:[e.jsxs(Se,{open:R,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"h-[700px] max-h-[700px] overflow-scroll sm:max-w-[1200px]",children:[e.jsxs(we,{className:"mt-4 flex justify-between  text-xl font-bold text-gray-500",children:[e.jsxs("div",{children:["User :"," ",e.jsx("span",{className:"text-lg font-bold text-yellow-500",children:V==null?void 0:V.name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>k(!1)})})})]}),e.jsxs(Fe,{defaultValue:"ROLELIST",className:"w-full",children:[e.jsx("div",{className:"flex justify-between py-4",children:e.jsxs(qe,{className:"grid w-auto grid-cols-3 rounded-md bg-gray-100 py-1",children:[e.jsx(Ae,{className:"rounded-md px-2 text-gray-400 data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"ROLELIST",children:"Permitted Roles"}),e.jsx(Ae,{className:"rounded-md px-2 text-gray-400 data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"PERMITTED_WARDS",children:"Permitted Wards"}),e.jsx(Ae,{className:"rounded-md px-2 text-gray-400 data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"PERMITTED_WORKFLOW_ROLE",children:"Permitted Workflow Role"})]})}),e.jsx(Ee,{value:"ROLELIST",children:e.jsx(ma,{selectedULB:V,id:w})}),e.jsx(Ee,{value:"PERMITTED_WARDS",children:e.jsx(ba,{selectedULB:V,id:w})}),e.jsx(Ee,{value:"PERMITTED_WORKFLOW_ROLE",children:e.jsx(ya,{selectedULB:V,id:w})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{E(""),F(!1),A(!0)},children:"Create User"})})}),e.jsx(Sa,{open:f,setOpen:A,title:I?"Edit user":"Create User",id:w,edit:I,setEdit:F,ulbId:a==null?void 0:a.ulbId,userListByUlbId:s}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:j,onChange:o=>x(o.target.value),className:"w-[200px] cursor-pointer rounded-md border bg-background p-2",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:D,onChange:l,placeholder:`Search by ${j}`,className:"rounded-md border p-2",maxLength:j=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Users : ",(U=(N=s==null?void 0:s.data)==null?void 0:N.data)==null?void 0:U.total]}),e.jsx(oe,{children:e.jsx(ue,{children:g.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"User Image"}),e.jsx(_,{className:"",children:"Name"}),e.jsx(_,{className:"",children:"Mobile No"}),e.jsx(_,{className:"",children:"Alt Mobile No"}),e.jsx(_,{className:"",children:"Email"}),e.jsx(_,{className:"",children:"User Type"}),e.jsx(_,{className:"",children:"Address"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(ee=(X=(S=s==null?void 0:s.data)==null?void 0:S.data)==null?void 0:X.data)==null?void 0:ee.map((o,te)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+te+1}),e.jsx(T,{children:e.jsx(We,{src:o.documentUrl,alt:o.name,className:"h-10 w-10 rounded-full border-2 object-cover"})}),e.jsx(T,{className:o.suspended?"text-red-600":"text-black",children:o==null?void 0:o.name}),e.jsx(T,{className:o.suspended?"text-red-600":"text-black",children:o==null?void 0:o.mobile}),e.jsx(T,{className:o.suspended?"text-red-600":"text-black",children:o==null?void 0:o.alternateMobile}),e.jsx(T,{className:o.suspended?"text-red-600":"text-black",children:o==null?void 0:o.email}),e.jsx(T,{className:o.suspended?"text-red-600":"text-black",children:o==null?void 0:o.user_type}),e.jsx(T,{className:o.suspended?"text-red-600":"text-black",children:o==null?void 0:o.address}),e.jsx(T,{children:e.jsxs(Te,{checked:o==null?void 0:o.suspended,onChange:()=>c(o.id,!o.suspended),className:`${o!=null&&o.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${o!=null&&o.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(T,{children:e.jsxs("td",{className:"flex",children:[e.jsxs(Q,{variant:"secondary",onClick:()=>{E(o==null?void 0:o.id),F(!0),A(!0)},children:[e.jsx(be,{})," Edit"]}),e.jsxs(Q,{onClick:()=>{$(o),k(!0),E(o==null?void 0:o.id)},className:"ml-2",variant:"secondary",children:[e.jsx(ke,{})," View"]})]})})]},o==null?void 0:o.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Oe,{page:y,perPage:i,totalPage:(p=(ae=s==null?void 0:s.data)==null?void 0:ae.data)==null?void 0:p.total,setPage:W,setPerPage:b,hasNextPage:((se=(B=s==null?void 0:s.data)==null?void 0:B.data)==null?void 0:se.current_page)>=y,hasPrevPage:(n=(le=s==null?void 0:s.data)==null?void 0:le.data)==null?void 0:n.current_page})})]})})})]})})]})}const Pa=J().shape({name:L().required("Full Name is required"),mobile:L().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:L().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:L().email("Enter a valid email").required("Email is required"),address:L().required("Address is required"),photo:L().required("User Image is required")});function wa({open:a,setOpen:y,title:W,edit:i,setEdit:b,adminListFun:C,id:f,ulbId:A}){const w=Y({}),E=t.useRef(null),I=re({defaultValues:{name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:ce(Pa)}),{reset:F}=I;t.useEffect(()=>{var $,R,k;if(a){if(i&&f){const j=(k=(R=($=C==null?void 0:C.data)==null?void 0:$.data)==null?void 0:R.data)==null?void 0:k.find(q=>q.id==f);console.log(j,"selectedAdmin"),j&&F({name:j.name||"",mobile:j.mobile||"",altMobile:j.alternateMobile||"",email:j.email||"",address:j.address||"",photo:null})}else F({name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});I.setValue("photo",""),E.current&&(E.current.value="")}},[a,i,f,C,F,I]);const V=async $=>{var R,k,j,q,D;try{const M=i?(R=O)==null?void 0:R.updateAdmin:(k=O)==null?void 0:k.createAdmin,d=i&&f?{...$,id:f}:{...$,userType:"Admin",role:"ADMIN",ulbId:A},r=new FormData;i&&f&&r.append("id",f),r.append("name",d.name),r.append("mobile",d.mobile),r.append("altMobile",d.altMobile),r.append("email",d.email),r.append("address",d.address),r.append("photo",I.watch("photo")),r.append("userType","Admin"),r.append("role","ADMIN"),r.append("ulbId",d.ulbId||"");const x=await w.mutateAsync({api:M,data:r});(j=x==null?void 0:x.data)!=null&&j.status?(P.success((q=x==null?void 0:x.data)==null?void 0:q.message),y(!1),b(!1),C.refetch()):P.error((D=x==null?void 0:x.data)==null?void 0:D.message)}catch(M){P.error(G(M))}};return e.jsx(fe,{open:a,setOpen:y,title:W,setEdit:b,edit:i,children:e.jsx(ge,{methods:I,onSubmit:I.handleSubmit(V),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(de,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Full Name"})}),e.jsx("div",{children:e.jsx(de,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter Alt Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(de,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Ue,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(ne,{}),e.jsx("div",{children:e.jsx(Re,{isLoading:I.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ca(a){var g,s,c,m,h,v,N,U,S,X,ee,ae,p,B,se,le;const[y,W]=t.useState(1),[i,b]=t.useState(10),C=Y({}),[f,A]=t.useState(!1),[w,E]=t.useState(""),[I,F]=t.useState(!1),[V,$]=t.useState(!1),[R,k]=t.useState(""),[j,q]=t.useState(""),[D,M]=t.useState(""),d=n=>{k(n)},r=n=>{q(n.target.value)};t.useEffect(()=>{const n=setTimeout(()=>{M(j)},700);return()=>clearTimeout(n)},[j]);const x=H({api:(g=O)==null?void 0:g.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),l=H({api:(s=O)==null?void 0:s.adminList,key:"adminListFun",config:{ulbId:a==null?void 0:a.ulbId,page:y,perPage:i,parameter:D||"",filterBy:R||""},value:[y,i,R],options:{enabled:!0}});t.useEffect(()=>{D&&(W(1),b(10)),l.refetch()},[D]);const u=async(n,o)=>{var te,K,ye,ve;try{const Ne={id:n,isSuspended:o},Z=await C.mutateAsync({api:(te=O)==null?void 0:te.enableDisableUserByModule,data:Ne});(K=Z==null?void 0:Z.data)!=null&&K.status?(P.success(((ye=Z==null?void 0:Z.data)==null?void 0:ye.message)||"Permission updated successfully"),l.refetch()):P.error(((ve=Z==null?void 0:Z.data)==null?void 0:ve.message)||"Failed to update permission")}catch(Ne){P.error(G(Ne))}};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:V,children:[e.jsx(Ce,{}),e.jsx(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsx("div",{children:e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:(c=a==null?void 0:a.selectedULB)==null?void 0:c.ulb_name})]})}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>$(!1)})})})]})})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{E(""),F(!1),A(!0)},children:"Create Admin"})})}),e.jsx(wa,{open:f,setOpen:A,title:I?"Edit Admin":"Create Admin",id:w,edit:I,setEdit:F,ulbId:a==null?void 0:a.ulbId,adminListFun:l,adminListData:(h=(m=l==null?void 0:l.data)==null?void 0:m.data)==null?void 0:h.data}),e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:R,onChange:n=>d(n.target.value),className:"cursor-pointer w-[200px] bg-background border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:j,onChange:r,placeholder:`Search by ${R}`,className:"border p-2 rounded-md",maxLength:R=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Records : ",(N=(v=l==null?void 0:l.data)==null?void 0:v.data)==null?void 0:N.total]}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:x.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"User Image"}),e.jsx(_,{className:"",children:"Name"}),e.jsx(_,{className:"",children:"Mobile No"}),e.jsx(_,{className:"",children:"Alt Mobile No"}),e.jsx(_,{className:"",children:"Email"}),e.jsx(_,{className:"",children:"Address"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Action"})]})}),e.jsx(je,{children:(X=(S=(U=l==null?void 0:l.data)==null?void 0:U.data)==null?void 0:S.data)==null?void 0:X.map((n,o)=>e.jsxs(z,{children:[e.jsx(T,{children:y*i-i+o+1}),e.jsx(T,{children:e.jsx(We,{src:n.documentUrl,alt:n.name,className:"w-10 h-10 border-2 rounded-full object-cover"})}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.name}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.mobile}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.alternateMobile}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.email}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.address}),e.jsx(T,{children:e.jsxs(Te,{checked:n==null?void 0:n.suspended,onChange:()=>u(n.id,!n.suspended),className:`${n!=null&&n.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${n!=null&&n.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(T,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{E(n==null?void 0:n.id),F(!0),A(!0)},children:[e.jsx(be,{})," Edit"]})})]},n==null?void 0:n.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Oe,{page:y,perPage:i,totalPage:(ae=(ee=l==null?void 0:l.data)==null?void 0:ee.data)==null?void 0:ae.total,setPage:W,setPerPage:b,hasNextPage:((B=(p=l==null?void 0:l.data)==null?void 0:p.data)==null?void 0:B.current_page)>=y,hasPrevPage:(le=(se=l==null?void 0:l.data)==null?void 0:se.data)==null?void 0:le.current_page})})]})})})]})})}const Ma=J().shape({ulbId:L(),moduleId:L(),complaintRefNo:L()});function Aa(){var h,v,N,U,S,X,ee,ae;const[a,y]=t.useState(1),[W,i]=t.useState(10),[b,C]=t.useState(!1),f=Y({}),[A,w]=t.useState(!1),[E,I]=t.useState(""),[F,V]=t.useState(!1),[$,R]=t.useState(""),[k,j]=t.useState(1),[q,D]=t.useState(10),[M,d]=t.useState(!1),r=100,x=p=>{j(p)},l=p=>{D(p),j(1)},u=re({resolver:ce(Ma),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),g=async p=>{R(p.moduleId)},s=H({api:(h=O)==null?void 0:h.getAllJuidcoUlbList,key:"ulbLists",options:{enabled:!0}});console.log((v=s==null?void 0:s.data)==null?void 0:v.data),console.log($);const c=async(p,B)=>{var se,le,n,o;try{const te={ulbId:p,permissionStatus:B},K=await f.mutateAsync({api:(se=O)==null?void 0:se.ulbEnableDisable,data:te});(le=K==null?void 0:K.data)!=null&&le.status?(P.success(((n=K==null?void 0:K.data)==null?void 0:n.message)||"Permission updated successfully"),s.refetch()):P.error(((o=K==null?void 0:K.data)==null?void 0:o.message)||"Failed to update permission")}catch(te){P.error(G(te))}},m=(U=(N=s==null?void 0:s.data)==null?void 0:N.data)==null?void 0:U.filter(p=>p.id==$);return e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:M,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:b==null?void 0:b.ulb_name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>d(!1)})})})]}),e.jsxs(sa,{defaultValue:"MENULIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsxs(la,{className:"grid w-auto grid-cols-3",children:[e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Permitted Modules"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"SERVICE_LIST",children:"User List"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"ADMIN_LIST",children:"Admin List"})]})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(ua,{ulbId:b==null?void 0:b.id,selectedULB:b})}),e.jsx(Pe,{value:"SERVICE_LIST",children:e.jsx(Ia,{ulbId:b==null?void 0:b.id,selectedULB:b})}),e.jsx(Pe,{value:"ADMIN_LIST",children:e.jsx(Ca,{ulbId:b==null?void 0:b.id,selectedULB:b})})]})]})]}),e.jsxs(oe,{children:[e.jsx(ge,{methods:u,onSubmit:u.handleSubmit(g),children:e.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[e.jsxs("div",{children:[e.jsx(aa,{htmlFor:"moduleId",children:"Module name"}),e.jsx(ea,{className:"cursor-pointer bg-background",name:"moduleId",data:((X=(S=s==null?void 0:s.data)==null?void 0:S.data)==null?void 0:X.map(p=>({value:p==null?void 0:p.id,label:p==null?void 0:p.ulb_name})))??[]})]}),e.jsx("div",{className:"mt-6 flex justify-start",children:e.jsx(Re,{variant:"secondary",isLoading:u.formState.isSubmitting,type:"submit",className:"float-right w-auto px-10",children:"Search"})}),e.jsx("div",{className:"mt-6 flex justify-end "}),e.jsx("div",{className:"mt-6 flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{I(""),V(!1),w(!0)},children:"Add New"})})]})}),e.jsx(ze,{className:"px-7",children:e.jsx(Ke,{})}),e.jsx(ue,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"ULB"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(ae=(m==null?void 0:m.length)>0?m:(ee=s==null?void 0:s.data)==null?void 0:ee.data)==null?void 0:ae.map((p,B)=>e.jsxs(z,{children:[e.jsx(T,{children:a*W-W+B+1}),e.jsx(T,{className:p.active_status?"text-black":"text-red-600",children:p==null?void 0:p.ulb_name}),e.jsx(T,{children:e.jsxs(Te,{checked:p==null?void 0:p.active_status,onChange:()=>c(p.id,!p.active_status),className:`${p!=null&&p.active_status?"bg-green-600":"bg-red-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${p!=null&&p.active_status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(T,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{I(p==null?void 0:p.id),C(p),d(!0)},className:"ml-2",children:[e.jsx(ke,{})," View"]})})]},p==null?void 0:p.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(_e,{currentPage:k,totalItems:r,itemsPerPage:q,onPageChange:x,onItemsPerPageChange:l})})]})})]})]})})}function Ga(){return e.jsx(He,{title:"ULB List",subTitle:"Control all ULB here",children:e.jsx("div",{children:e.jsx(Aa,{})})})}export{Ga as default};
