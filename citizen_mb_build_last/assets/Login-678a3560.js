import{a as C,r as s,c as j,b as a,F as D,j as n}from"./index-618f86f9.js";import{c as F,a as R,b as _,u as J}from"./index.esm-c768bfda.js";import{l as O}from"./logo1-44af78fe.js";/* empty css                */import{P}from"./ProjectApiList-f293eba9.js";import{a as q,A as T}from"./axios-28c6f114.js";import{R as $}from"./Blocks-0d439705.js";const Y=()=>{C();const{notify:d,setisLoggedIn:y}=s.useContext(j),[r,N]=s.useState(null),[l,S]=s.useState(),{api_login:v}=P(),[k,u]=s.useState(!1),I=F({email:R().required("Enter email"),password:_().required("Enter password")}),t=J({initialValues:{email:"",password:""},onSubmit:o=>{A()},validationSchema:I}),g=["Tax Collector","ULB Tax Collector"],L=s.useMemo(()=>Array.isArray(r)&&r.some(o=>g.includes(o)),[r]);s.useEffect(()=>{var o,e,i;r!=null&&(L?(d("Login Successfull !!! ","success"),window.localStorage.setItem("menuList",JSON.stringify((o=l==null?void 0:l.userDetails)==null?void 0:o.menuPermission)),window.localStorage.setItem("userName",JSON.stringify((e=l==null?void 0:l.userDetails)==null?void 0:e.userName)),window.localStorage.setItem("roles",JSON.stringify((i=l==null?void 0:l.userDetails)==null?void 0:i.role)),window.location.replace("/property/mobile-property-options")):d("You don't have permission of Tax Collector !!!","warn"))},[r]);const m=JSON.parse(window.localStorage.getItem("roles")),c=window.localStorage.getItem("token"),E=s.useMemo(()=>Array.isArray(m)&&m.some(o=>g.includes(o)),[m,c]);s.useEffect(()=>{c!=""&&c!=null&&c!=null&&E&&window.location.replace("/property/mobile-property-options")},[]);const A=()=>{let o={email:t.values.email,password:t.values.password,type:"mobile"};console.log("--1--before login send...",o),q.post(v,o,T()).then(function(e){var i,p,w,f,x,h,b;console.log("login response => ",e),e.data.status==!0?(console.log("--2--login response...",e),window.localStorage.setItem("token",(p=(i=e==null?void 0:e.data)==null?void 0:i.data)==null?void 0:p.token),window.localStorage.setItem("isLoggedIn",!0),S((w=e==null?void 0:e.data)==null?void 0:w.data),N((h=(x=(f=e==null?void 0:e.data)==null?void 0:f.data)==null?void 0:x.userDetails)==null?void 0:h.role),y(!0)):(u(!1),d((b=e==null?void 0:e.data)==null?void 0:b.message,"error"))}).catch(function(e){u(!1),console.log("--2--login error...",e),d("Something went wrong !!! ","error")})};return a(D,{children:a("div",{className:" h-screen bg-zinc-100 flex flex-row flex-wrap justify-center items-center",children:n("form",{onChange:t.handleChange,onSubmit:t.handleSubmit,className:"flex flex-col gap-2 w-max h-max shadow-lg rounded-md px-10 py-4 bg-white text-zinc-700 animate__animated animate__fadeInDown",children:[n("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[a("img",{src:O,alt:"",className:"w-16"}),n("div",{className:"text-xl uppercase tracking-wide font-semibold",children:["Urban Development & ",a("br",{})," Housing Department"]})]}),a("hr",{}),n("div",{className:"mt-6 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"email",className:"text-sm",children:"Email :"}),a("input",{type:"email",name:"email",id:"email",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter email"}),t.errors.email&&t.touched.email&&a("span",{className:"text-red-600 text-xs",children:t.errors.email})]}),n("div",{className:"mt-4 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"password",className:"text-sm",children:"Password :"}),a("input",{type:"password",name:"password",id:"password",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter password"}),t.errors.password&&t.touched.password&&a("span",{className:"text-red-600 text-xs",children:t.errors.password})]}),a("div",{className:"text-center mb-6 mt-4",children:k?a("div",{className:"flex justify-center",children:a($,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):a("button",{type:"submit",className:"px-4 py-1.5 bg-green-200 hover:bg-green-300 rounded-md shadow-md text-sm",children:" Login "})})]})})})};export{Y as default};
