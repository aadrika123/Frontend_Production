import{j as a,c as V,n as E}from"./index-4f36318b.js";import{r,b as N}from"./router-b87f8164.js";import{P as i,r as g}from"./tailwind-64fa9e48.js";import{F as W,d as _,g as R,A as O,u as Z,c as K,a as U}from"./ApiHeader-060855c5.js";import{u as G,b as Q}from"./reactQuery-8705a202.js";import{a as T}from"./axios-096c69c8.js";function o({title:e,titleId:n,...t},c){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const J=r.forwardRef(o),X=J;function Y({title:e,titleId:n,...t},c){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const m=r.forwardRef(Y),k=m;function p({title:e,titleId:n,...t},c){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const ee=r.forwardRef(p),ae=ee;q.propTypes={formik:i.object.isRequired,children:i.node.isRequired,className:i.string};function q({children:e,formik:n,className:t}){return a.jsx(W,{value:n,children:a.jsx(_,{onSubmit:n==null?void 0:n.handleSubmit,className:t,children:e})})}B.propTypes={name:i.string.isRequired,label:i.string,formik:i.object,isDynamic:i.bool,isRequiredLabel:i.bool,className:i.string};function B({label:e,name:n,formik:t,isDynamic:c,isRequiredLabel:b=!1,className:A,...j}){return a.jsxs("div",{className:"mb-1",children:[a.jsx("label",{htmlFor:n,className:"block text-gray-600 text-sm mb-1",children:e}),a.jsx("input",{type:"text",name:n,id:n,...t&&(t==null?void 0:t.getFieldProps(n)),className:`${A} w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600`,placeholder:e,...j}),a.jsx("span",{className:"text-red-600  text-xs",children:c?R(t==null?void 0:t.touched,n)&&R(t==null?void 0:t.errors,n):(t==null?void 0:t.touched[n])&&(t==null?void 0:t.errors[n])})]})}$.propTypes={name:i.string.isRequired,label:i.string,formik:i.object,isDynamic:i.bool,selectedText:i.string,isRequiredLabel:i.bool,children:i.node.isRequired};function $({label:e,name:n="",formik:t,selectedText:c,isDynamic:b,isRequiredLabel:A=!1,children:j,...C}){return a.jsxs("div",{children:[a.jsxs("label",{htmlFor:n,className:"block text-gray-600 text-sm mb-1",children:[e," "]}),a.jsx("select",{name:n,value:(t==null?void 0:t.values[n])??void 0,onChange:f=>(t==null||t.setFieldValue(n,f.target.value),t==null||t.setFieldValue(c,f.target.options[f.target.selectedIndex].text==="Select"?"":f.target.options[f.target.selectedIndex].text),t==null?void 0:t.handleChange(f)),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600",...C,children:j}),a.jsx("span",{className:"text-red-600 text-xs",children:b?R(t==null?void 0:t.touched,n)&&R(t==null?void 0:t.errors,n):t!=null&&t.touched[n]&&(t!=null&&t.errors[n])?t==null?void 0:t.errors[n]:null})]})}i.string.isRequired,i.string,i.object,i.bool,i.bool,i.string,i.func;i.node,i.bool,i.string,i.bool;function D({key:e,api:n,options:t,value:c,config:b}){return G({queryKey:[e??n,...c??[]],queryFn:async()=>{const j=await T.post(n,{...b},O());return j==null?void 0:j.data},refetchOnReconnect:"always",refetchOnWindowFocus:!1,...t})}const te=(e,n)=>T.post(e,n,{...O()}),M=({options:e})=>Q({mutationFn:({api:n,data:t})=>te(n,t),...e}),le=e=>{var A,j,C,f;const{setFormikInitialValues:n}=N.useContext(V),t=M({}),c=Z({enableReinitialize:!0,initialValues:{...(A=e==null?void 0:e.formData)==null?void 0:A.reduce((l,s)=>(l[s==null?void 0:s.name]=s==null?void 0:s.value,l),{})},validationSchema:K().shape({...(j=e==null?void 0:e.formData)==null?void 0:j.reduce((l,s)=>(s!=null&&s.isRequired&&(l[s==null?void 0:s.name]=U().required(`${s==null?void 0:s.label} is required`)),l),{})}),onSubmit:async l=>{var s,u,d,y,w,v;try{if(e!=null&&e.isEdit){const x=await(t==null?void 0:t.mutateAsync({api:e==null?void 0:e.editApi,data:l}));(s=x==null?void 0:x.data)!=null&&s.status?(E.success((u=x==null?void 0:x.data)==null?void 0:u.message),b()):E.error((d=x==null?void 0:x.data)==null?void 0:d.message)}else{const x=l==null?!0:delete l.id,h=await(t==null?void 0:t.mutateAsync({api:e==null?void 0:e.createApi,data:l}));(y=h==null?void 0:h.data)!=null&&y.status?(E.success((w=h==null?void 0:h.data)==null?void 0:w.message),b()):E.error((v=h==null?void 0:h.data)==null?void 0:v.message)}e==null||e.refetch()}catch(x){E.error(x==null?void 0:x.message)}}}),b=()=>{e==null||e.setOpen(!(e!=null&&e.open))};return r.useEffect(()=>{var l;c==null||c.setValues({...(l=e==null?void 0:e.formData)==null?void 0:l.reduce((s,u)=>(u!=null&&u.type?s[u==null?void 0:u.name]="":s[u==null?void 0:u.name]=u==null?void 0:u.value,s),{})})},[e==null?void 0:e.addNew]),N.useEffect(()=>{n(c==null?void 0:c.values)},[c==null?void 0:c.values]),a.jsx(a.Fragment,{children:a.jsxs(g.Dialog,{open:e==null?void 0:e.open,handler:b,children:[a.jsx(g.DialogHeader,{className:"text-base",children:e!=null&&e.isEdit?"Edit":"Create"}),a.jsx("div",{className:"border-t border-gray-200"}),(C=e==null?void 0:e.editData)!=null&&C.isFetching?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"flex justify-center items-center",children:a.jsx("span",{className:"ml-2",children:"Loading..."})})})}):a.jsxs(q,{formik:c,children:[a.jsx(g.DialogBody,{children:a.jsx("div",{className:`grid grid-cols-1 lg:grid-cols-${(e==null?void 0:e.noOfColumn)||"2"} gap-4`,children:(f=e==null?void 0:e.formData)==null?void 0:f.map((l,s)=>{var u;return a.jsxs(N.Fragment,{children:[(l==null?void 0:l.type)==="text"||(l==null?void 0:l.type)==="email"||(l==null?void 0:l.type)==="number"?a.jsx(B,{name:l==null?void 0:l.name,label:l==null?void 0:l.label,formik:c,type:l==null?void 0:l.type,maxLength:l==null?void 0:l.maxLength}):null,(l==null?void 0:l.type)==="select"?a.jsxs($,{name:l==null?void 0:l.name,label:l!=null&&l.isLabel?l==null?void 0:l.label:"",formik:c,children:[a.jsx("option",{value:"",children:"Select"}),(u=l==null?void 0:l.options)==null?void 0:u.map((d,y)=>a.jsx("option",{value:d==null?void 0:d.value,children:d==null?void 0:d.label},y))]}):null]},s)})})}),a.jsxs(g.DialogFooter,{children:[a.jsx(g.Button,{variant:"text",color:"red",onClick:b,className:"mr-1",size:"sm",children:"Cancel"}),a.jsx(g.Button,{type:"submit",variant:"gradient",color:"green",size:"sm",loading:t==null?void 0:t.isLoading,disabled:t==null?void 0:t.isLoading,children:a.jsx("span",{children:e!=null&&e.isEdit?"Update":"Create"})})]})]})]})})},ne=N.memo(le);function ce({title:e,titleId:n,...t},c){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const de=r.forwardRef(ce),se=de;function ie(e){var b,A,j,C,f,l,s,u;const n=M({}),t=(b=e==null?void 0:e.data)==null?void 0:b.filter(d=>Object.keys(d).some(y=>{var w;return d[y].toString().toLowerCase().includes((w=e==null?void 0:e.search)==null?void 0:w.toLowerCase())})),c=async(d,y,w)=>{var v,x;try{const h=await(n==null?void 0:n.mutateAsync({api:e==null?void 0:e.deleteApi,data:{[d]:y,status:w==1||w==!0?0:1}}));(v=h==null?void 0:h.data)!=null&&v.status&&((x=e==null?void 0:e.getAll)==null||x.refetch(),w==1||w==!0?E.error("Inactive"):E.success("Active"))}catch(h){E.error(h==null?void 0:h.message)}};return(A=e==null?void 0:e.getAll)!=null&&A.isLoading?a.jsx("div",{className:"flex justify-center items-center ",children:a.jsx(g.Typography,{variant:"h6",color:"blue-gray",className:"font-normal",children:"Loading..."})}):(j=e==null?void 0:e.getAll)!=null&&j.isError?a.jsx("div",{className:"flex justify-center items-center h-96",children:a.jsx(g.Typography,{variant:"h6",color:"blue-gray",className:"font-normal",children:(s=(l=(f=(C=e==null?void 0:e.getAll)==null?void 0:C.error)==null?void 0:f.response)==null?void 0:l.data)==null?void 0:s.message})}):a.jsx("div",{children:a.jsxs("table",{className:"mt-4 w-full min-w-max table-auto text-left",children:[a.jsx("thead",{children:a.jsx("tr",{children:(u=e==null?void 0:e.tableHead)==null?void 0:u.map(d=>a.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-4",children:a.jsx(g.Typography,{variant:"small",color:"blue-gray",className:"font-normal leading-none opacity-70",children:d})},d))})}),a.jsx("tbody",{children:t==null?void 0:t.map((d,y)=>{var x,h;const v=y===((x=e==null?void 0:e.data)==null?void 0:x.length)-1?"p-4":"p-4 border-b border-blue-gray-50";return a.jsxs("tr",{children:[(h=e==null?void 0:e.fields)==null?void 0:h.map((F,P)=>a.jsx("td",{className:v,children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("div",{className:"flex flex-col",children:a.jsx(g.Typography,{variant:"small",color:"blue-gray",className:"font-normal opacity-70",children:d[F]})})})},P)),(e==null?void 0:e.isStatus)&&a.jsx("td",{className:v,children:a.jsx("div",{className:"w-max",children:a.jsx(g.Chip,{variant:"ghost",size:"sm",value:d.is_suspended==1||d.is_suspended==!0?"Active":"In-Active",color:d.is_suspended==1||d.is_suspended==!0?"green":"red"})})}),(e==null?void 0:e.edit)&&(e==null?void 0:e.action)&&a.jsx("td",{className:v,children:a.jsx(g.Tooltip,{content:"Edit User",className:"text-[11px] bg-gray-700",children:a.jsx(g.IconButton,{color:"green",variant:"text",onClick:()=>{e==null||e.setId(d.id),e==null||e.setOpen(!0),e==null||e.setIsEdit(!0)},children:a.jsx(se,{className:"h-4 w-4"})})})}),(e==null?void 0:e.delete)&&(e==null?void 0:e.action)&&a.jsx("td",{className:v,children:a.jsx(g.Switch,{ripple:!1,className:"h-full w-full checked:bg-[#2ec946]",containerProps:{className:"w-11 h-6"},circleProps:{className:"before:hidden left-0.5 border-none"},checked:d.is_suspended==1||d.is_suspended==!0,onChange:()=>{c(Object.keys(d)[0],d[Object.keys(d)[0]],d.is_suspended)}})})]},y)})})]})})}const I=[{id:0,label:"5",value:5},{id:1,label:"10",value:10},{id:2,label:"20",value:20},{id:3,label:"50",value:50},{id:4,label:"100",value:100}];function ue(e){const n=()=>{(e==null?void 0:e.page)!==(e==null?void 0:e.noOfPage)&&(e==null||e.setPage((e==null?void 0:e.page)+1))},t=()=>{(e==null?void 0:e.page)!==1&&(e==null||e.setPage((e==null?void 0:e.page)-1))};return N.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[e==null?void 0:e.page]),a.jsxs("div",{className:"flex items-center gap-4 mt-2 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g.IconButton,{className:"w-7 h-7",size:"sm",variant:"outlined",onClick:t,disabled:(e==null?void 0:e.page)===1||(e==null?void 0:e.page)===0,children:a.jsx(X,{strokeWidth:2,className:"h-3 w-3"})}),a.jsxs(g.Typography,{color:"gray",className:"font-normal text-sm",children:[a.jsx("strong",{className:"text-gray-900 text-sm",children:e==null?void 0:e.page})," of"," ",a.jsx("strong",{className:"text-gray-900",children:e==null?void 0:e.noOfPage})]}),a.jsx(g.IconButton,{className:"w-7 h-7",size:"sm",variant:"outlined",onClick:n,disabled:(e==null?void 0:e.page)===(e==null?void 0:e.noOfPage)||(e==null?void 0:e.page)===0,children:a.jsx(k,{strokeWidth:2,className:"h-3 w-3"})})]}),a.jsx("div",{className:"flex items-center gap-5",children:a.jsx("select",{className:"border border-gray-300 rounded-md text-gray-900 text-sm p-1.5",value:e==null?void 0:e.perPage,onChange:c=>e==null?void 0:e.setPerPage(parseInt(c.target.value)),children:I==null?void 0:I.map(c=>a.jsx("option",{value:c.value,children:c.label},c.id))})})]})}function ye(e){var S;const{isCreate:n=!0,action:t=!0}=e,[c,b]=N.useState(!1),[A,j]=N.useState(!1),[C,f]=N.useState(""),[l,s]=N.useState(""),[u,d]=N.useState(!1),[y,w]=N.useState(1),[v,x]=N.useState(5),h=D({api:e==null?void 0:e.getById,config:{[e==null?void 0:e.getIdByKey]:C},value:[C,c],options:{enabled:!!C,onSuccess:L=>{e==null||e.setEditData(L)}}}),F=D({api:e==null?void 0:e.listApi,options:{enabled:!0,onSuccess:L=>{e==null||e.setListData(L)}}}),P=L=>{const z=(y-1)*v,H=y*v;return L==null?void 0:L.slice(z,H)};return a.jsxs("div",{className:"p-2 ml-2",children:[a.jsx(ne,{editData:h,open:c,setOpen:b,editApi:e==null?void 0:e.editApi,createApi:e==null?void 0:e.createApi,isEdit:A,noOfColumn:1,refetch:F.refetch,formData:e==null?void 0:e.formData,addNew:u,setAddNew:d}),a.jsxs(g.Card,{className:"h-full w-full",children:[a.jsxs(g.CardHeader,{floated:!1,shadow:!1,className:"rounded-none",children:[a.jsxs("div",{className:"mb-5 flex items-center justify-between gap-8",children:[a.jsx("div",{children:a.jsx(g.Typography,{variant:"h5",color:"blue-gray",children:e==null?void 0:e.title})}),a.jsx("div",{className:"flex shrink-0 flex-col gap-2 sm:flex-row",children:n&&a.jsx(g.Button,{className:"flex items-center gap-3",size:"sm",onClick:()=>{b(!0),j(!1),d(!u)},children:"Add"})})]}),a.jsx("div",{className:"flex flex-col items-center justify-between gap-4 md:flex-row",children:a.jsx("div",{className:"w-full md:w-72",children:a.jsx(g.Input,{label:"Search",value:l,onChange:L=>{s(L.target.value)},icon:a.jsx(ae,{className:"h-5 w-5"})})})})]}),a.jsx(g.CardBody,{className:"overflow-scroll px-0",children:a.jsx(ie,{action:t,search:l,getAll:F,data:l?e==null?void 0:e.data:P(e==null?void 0:e.data),tableHead:e==null?void 0:e.HEAD,fields:e==null?void 0:e.fields,isStatus:!0,edit:!0,view:!0,delete:!0,setId:f,setOpen:b,setIsEdit:j,deleteApi:e==null?void 0:e.deleteApi})}),a.jsx(g.CardFooter,{className:"flex items-center justify-end border-t border-blue-gray-50 p-4 ",children:a.jsx("div",{className:"flex gap-2",children:a.jsx(ue,{page:y,setPage:w,noOfPage:Math.ceil(((S=e==null?void 0:e.data)==null?void 0:S.length)/v),setPerPage:x,perPage:v})})})]})]})}export{ye as T,D as u};
