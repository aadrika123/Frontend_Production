import{l as e,a9 as Z,H as G,j as n,B as l,_ as d}from"./index-CeORiDKo.js";import{c as C,C as g,d as p,e as y,a as f,A as J,i as K,h as Q,j as V,k as W,b as Y,L as $}from"./index-CTo54kSO.js";import{B as ee}from"./badge-Dd78fmAk.js";import{D as m,d as u,a as j,b as v,c as N,T as A}from"./dialog-BBA50jNa.js";import{S as se,P as ae,f as P}from"./PriorityBadge-C3tVj3Ua.js";import{A as L,f as le,C as te,R as ce}from"./formatDistanceToNow-rSV-FbgL.js";import"./en-US-8upN5vI8.js";const re=C("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const ie=C("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const ne=C("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const de=C("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);function oe({activities:o,comments:r}){const x=[...o.map(s=>({...s,type:"activity"})),...r.map(s=>({...s,type:"comment"}))].sort((s,h)=>new Date(h.timestamp).getTime()-new Date(s.timestamp).getTime());return e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Activity Timeline"]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:x.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No activity yet"}):x.map((s,h)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{className:"h-8 w-8",children:e.jsx(K,{className:"text-xs",children:s.type==="activity"?s.performedBy.split(" ").map(i=>i[0]).join(""):s.author.split(" ").map(i=>i[0]).join("")})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.type==="activity"?e.jsx(L,{className:"h-4 w-4 text-blue-500"}):e.jsx(de,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium text-sm",children:s.type==="activity"?s.performedBy:s.author}),e.jsx("span",{className:"text-xs text-gray-500",children:s.type==="activity"?s.performedByRole:s.authorRole}),e.jsx("span",{className:"text-xs text-gray-400",children:le(new Date(s.timestamp),{addSuffix:!0})})]}),e.jsx("div",{className:"text-sm text-gray-700",children:s.type==="activity"?s.description:s.comment}),s.type==="activity"&&s.oldStatus&&s.newStatus&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Status changed from ",e.jsx("span",{className:"font-medium",children:s.oldStatus})," to"," ",e.jsx("span",{className:"font-medium",children:s.newStatus})]})]})]},s.id))})})]})}function ye({userRole:o="Bug Reporter"}){const{bugId:r}=Z(),x=G(),[s,h]=n.useState(""),[i,k]=n.useState(""),[O,b]=n.useState(!1),[I,w]=n.useState(!1),[M,R]=n.useState(!1),[E,B]=n.useState(!1),a=Q.find(t=>t.id===r),H=V.filter(t=>t.bugId===r),F=W.filter(t=>t.bugId===r);if(!a)return e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Bug Not Found"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"The requested bug report could not be found."}),e.jsx(l,{onClick:()=>x("/bug-tracking/dashboard/bug/list"),className:"mt-4",children:"Back to Bug List"})]});const z=()=>{if(!s.trim()){d.error("Please provide a resolution summary");return}d.success("Bug marked as resolved"),b(!1),h("")},_=()=>{if(!i.trim()){d.error("Please provide a rejection reason");return}d.success("Bug marked as rejected"),w(!1),k("")},q=()=>{d.success("Bug closed successfully"),R(!1)},U=()=>{d.success("Bug reopened successfully"),B(!1)},D=o==="Developer"&&["Pending","Re-Open"].includes(a.status),S=a.status==="Resolved",T=a.status==="Closed";return e.jsx(Y,{children:e.jsxs(g,{children:[e.jsx(p,{className:"border-b bg-muted/40",children:e.jsxs("div",{children:[e.jsx(y,{className:"text-xl font-semibold",children:a.id}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.title})]})}),e.jsxs(f,{className:"pt-6",children:[e.jsxs(l,{variant:"outline",onClick:()=>x("/bug-tracking/dashboard/bug/list"),className:"mb-6",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Back to Bug List"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsxs(g,{children:[e.jsx(p,{children:e.jsx(y,{children:"Bug Details"})}),e.jsxs(f,{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsx(c,{label:"Status",children:e.jsx(se,{status:a.status})}),e.jsx(c,{label:"Priority",children:e.jsx(ae,{priority:a.priority})}),e.jsx(c,{label:"Type",children:e.jsx(ee,{variant:a.type==="Bug"?"destructive":"default",children:a.type})}),e.jsx(c,{label:"Module",children:a.module}),e.jsx(c,{label:"Source",children:a.source}),a.complexity&&e.jsx(c,{label:"Complexity",children:a.complexity})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs(c,{label:"Reported By",children:[a.reportedBy," (",a.reportedByRole,")"]}),a.assignedTo&&e.jsx(c,{label:"Assigned To",children:a.assignedTo})]}),e.jsx(c,{label:"Description",children:e.jsx("p",{className:"whitespace-pre-wrap text-muted-foreground",children:a.description})}),a.resolutionSummary&&e.jsx(c,{label:"Resolution Summary",children:e.jsx("div",{className:"rounded-lg bg-green-50 p-3",children:a.resolutionSummary})}),a.rejectionReason&&e.jsx(c,{label:"Rejection Reason",children:e.jsx("div",{className:"rounded-lg bg-red-50 p-3",children:a.rejectionReason})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Created: ",P(new Date(a.createdDate),"PPP p")]}),e.jsxs("span",{children:["Updated: ",P(new Date(a.updatedDate),"PPP p")]})]})]})]}),a.screenshots.length>0&&e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Screenshots (",a.screenshots.length,")"]})}),e.jsx(f,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:a.screenshots.map((t,X)=>e.jsxs(m,{children:[e.jsx(u,{asChild:!0,children:e.jsx("img",{src:t,className:"h-32 w-full cursor-pointer rounded-lg border object-cover hover:opacity-80"})}),e.jsx(j,{className:"max-w-4xl",children:e.jsx("img",{src:t,className:"max-h-96 w-full object-contain"})})]},X))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g,{children:[e.jsx(p,{children:e.jsx(y,{children:"Actions"})}),e.jsxs(f,{className:"space-y-3",children:[D&&e.jsxs(e.Fragment,{children:[e.jsxs(m,{open:O,onOpenChange:b,children:[e.jsx(u,{asChild:!0,children:e.jsxs(l,{className:"w-full",variant:"default",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Resolve"]})}),e.jsxs(j,{children:[e.jsx(v,{children:e.jsx(N,{children:"Resolve Bug"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{placeholder:"Enter resolution summary...",value:s,onChange:t=>h(t.target.value),rows:4}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(l,{onClick:z,children:"Resolve Bug"})]})]})]})]}),e.jsxs(m,{open:I,onOpenChange:w,children:[e.jsx(u,{asChild:!0,children:e.jsxs(l,{className:"w-full",variant:"destructive",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Reject"]})}),e.jsxs(j,{children:[e.jsx(v,{children:e.jsx(N,{children:"Reject Bug"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{placeholder:"Enter rejection reason...",value:i,onChange:t=>k(t.target.value),rows:4}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(l,{variant:"destructive",onClick:_,children:"Reject Bug"})]})]})]})]})]}),S&&e.jsxs(m,{open:M,onOpenChange:R,children:[e.jsx(u,{asChild:!0,children:e.jsxs(l,{className:"w-full",variant:"outline",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Close"]})}),e.jsxs(j,{children:[e.jsx(v,{children:e.jsx(N,{children:"Close Bug"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Are you sure you want to close this bug? This action will mark the bug as completed."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsx(l,{onClick:q,children:"Close Bug"})]})]})]})]}),T&&e.jsxs(m,{open:E,onOpenChange:B,children:[e.jsx(u,{asChild:!0,children:e.jsxs(l,{className:"w-full",variant:"outline",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Re-Open"]})}),e.jsxs(j,{children:[e.jsx(v,{children:e.jsx(N,{children:"Re-Open Bug"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Are you sure you want to re-open this bug? This will change the status back to Pending."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),e.jsx(l,{onClick:U,children:"Re-Open Bug"})]})]})]})]}),!D&&!S&&!T&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No actions available for current status"})]})]}),e.jsx(oe,{activities:H,comments:F})]})]})]})]})})}const c=({label:o,children:r})=>e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-xs font-medium text-muted-foreground",children:o}),r]});export{ye as default};
