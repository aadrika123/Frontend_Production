var pt=i=>{throw TypeError(i)};var Y=(i,t,e)=>t.has(i)||pt("Cannot "+e);var s=(i,t,e)=>(Y(i,t,"read from private field"),e?e.call(i):t.get(i)),p=(i,t,e)=>t.has(i)?pt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),l=(i,t,e,r)=>(Y(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e),d=(i,t,e)=>(Y(i,t,"access private method"),e);import{a6 as St,a7 as w,a8 as H,a9 as q,aa as Mt,ab as bt,ac as yt,ad as Ut,ae as Dt,af as Pt,ag as vt,ah as N,ai as mt,aj as Tt,r as R,ak as Et,al as ot}from"./index-DL2S5zgO.js";var v,n,j,y,D,L,E,W,A,K,P,T,x,_,u,B,Z,tt,et,st,it,rt,nt,wt,Ot,Lt=(Ot=class extends St{constructor(t,e){super();p(this,u);p(this,v);p(this,n);p(this,j);p(this,y);p(this,D);p(this,L);p(this,E);p(this,W);p(this,A);p(this,K);p(this,P);p(this,T);p(this,x);p(this,_,new Set);this.options=e,l(this,v,t),l(this,E,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,n).addObserver(this),Rt(s(this,n),this.options)?d(this,u,B).call(this):this.updateResult(),d(this,u,st).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return at(s(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return at(s(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,u,it).call(this),d(this,u,rt).call(this),s(this,n).removeObserver(this)}setOptions(t,e){const r=this.options,h=s(this,n);if(this.options=s(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof w(this.options.enabled,s(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,u,nt).call(this),s(this,n).setOptions(this.options),r._defaulted&&!H(this.options,r)&&s(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,n),observer:this});const c=this.hasListeners();c&&gt(s(this,n),h,this.options,r)&&d(this,u,B).call(this),this.updateResult(e),c&&(s(this,n)!==h||w(this.options.enabled,s(this,n))!==w(r.enabled,s(this,n))||q(this.options.staleTime,s(this,n))!==q(r.staleTime,s(this,n)))&&d(this,u,Z).call(this);const a=d(this,u,tt).call(this);c&&(s(this,n)!==h||w(this.options.enabled,s(this,n))!==w(r.enabled,s(this,n))||a!==s(this,x))&&d(this,u,et).call(this,a)}getOptimisticResult(t){const e=s(this,v).getQueryCache().build(s(this,v),t),r=this.createResult(e,t);return Kt(this,r)&&(l(this,y,r),l(this,L,this.options),l(this,D,s(this,n).state)),r}getCurrentResult(){return s(this,y)}trackResult(t,e){const r={};return Object.keys(t).forEach(h=>{Object.defineProperty(r,h,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(h),e==null||e(h),t[h])})}),r}trackProp(t){s(this,_).add(t)}getCurrentQuery(){return s(this,n)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,v).defaultQueryOptions(t),r=s(this,v).getQueryCache().build(s(this,v),e);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,u,B).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,y)))}createResult(t,e){var ft;const r=s(this,n),h=this.options,c=s(this,y),a=s(this,D),f=s(this,L),C=t!==r?t.state:s(this,j),{state:b}=t;let o={...b},k=!1,O;if(e._optimisticResults){const S=this.hasListeners(),X=!S&&Rt(t,e),It=S&&gt(t,r,e,h);(X||It)&&(o={...o,...Pt(b.data,t.options)}),e._optimisticResults==="isRestoring"&&(o.fetchStatus="idle")}let{error:V,errorUpdatedAt:ct,status:U}=o;if(e.select&&o.data!==void 0)if(c&&o.data===(a==null?void 0:a.data)&&e.select===s(this,W))O=s(this,A);else try{l(this,W,e.select),O=e.select(o.data),O=vt(c==null?void 0:c.data,O,e),l(this,A,O),l(this,E,null)}catch(S){l(this,E,S)}else O=o.data;if(e.placeholderData!==void 0&&O===void 0&&U==="pending"){let S;if(c!=null&&c.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))S=c.data;else if(S=typeof e.placeholderData=="function"?e.placeholderData((ft=s(this,K))==null?void 0:ft.state.data,s(this,K)):e.placeholderData,e.select&&S!==void 0)try{S=e.select(S),l(this,E,null)}catch(X){l(this,E,X)}S!==void 0&&(U="success",O=vt(c==null?void 0:c.data,S,e),k=!0)}s(this,E)&&(V=s(this,E),O=s(this,A),ct=Date.now(),U="error");const G=o.fetchStatus==="fetching",$=U==="pending",J=U==="error",lt=$&&G,dt=O!==void 0;return{status:U,fetchStatus:o.fetchStatus,isPending:$,isSuccess:U==="success",isError:J,isInitialLoading:lt,isLoading:lt,data:O,dataUpdatedAt:o.dataUpdatedAt,error:V,errorUpdatedAt:ct,failureCount:o.fetchFailureCount,failureReason:o.fetchFailureReason,errorUpdateCount:o.errorUpdateCount,isFetched:o.dataUpdateCount>0||o.errorUpdateCount>0,isFetchedAfterMount:o.dataUpdateCount>C.dataUpdateCount||o.errorUpdateCount>C.errorUpdateCount,isFetching:G,isRefetching:G&&!$,isLoadingError:J&&!dt,isPaused:o.fetchStatus==="paused",isPlaceholderData:k,isRefetchError:J&&dt,isStale:ut(t,e),refetch:this.refetch}}updateResult(t){const e=s(this,y),r=this.createResult(s(this,n),this.options);if(l(this,D,s(this,n).state),l(this,L,this.options),s(this,D).data!==void 0&&l(this,K,s(this,n)),H(r,e))return;l(this,y,r);const h={},c=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options,f=typeof a=="function"?a():a;if(f==="all"||!f&&!s(this,_).size)return!0;const g=new Set(f??s(this,_));return this.options.throwOnError&&g.add("error"),Object.keys(s(this,y)).some(C=>{const b=C;return s(this,y)[b]!==e[b]&&g.has(b)})};(t==null?void 0:t.listeners)!==!1&&c()&&(h.listeners=!0),d(this,u,wt).call(this,{...h,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,u,st).call(this)}},v=new WeakMap,n=new WeakMap,j=new WeakMap,y=new WeakMap,D=new WeakMap,L=new WeakMap,E=new WeakMap,W=new WeakMap,A=new WeakMap,K=new WeakMap,P=new WeakMap,T=new WeakMap,x=new WeakMap,_=new WeakMap,u=new WeakSet,B=function(t){d(this,u,nt).call(this);let e=s(this,n).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Mt)),e},Z=function(){d(this,u,it).call(this);const t=q(this.options.staleTime,s(this,n));if(bt||s(this,y).isStale||!yt(t))return;const r=Ut(s(this,y).dataUpdatedAt,t)+1;l(this,P,setTimeout(()=>{s(this,y).isStale||this.updateResult()},r))},tt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,n)):this.options.refetchInterval)??!1},et=function(t){d(this,u,rt).call(this),l(this,x,t),!(bt||w(this.options.enabled,s(this,n))===!1||!yt(s(this,x))||s(this,x)===0)&&l(this,T,setInterval(()=>{(this.options.refetchIntervalInBackground||Dt.isFocused())&&d(this,u,B).call(this)},s(this,x)))},st=function(){d(this,u,Z).call(this),d(this,u,et).call(this,d(this,u,tt).call(this))},it=function(){s(this,P)&&(clearTimeout(s(this,P)),l(this,P,void 0))},rt=function(){s(this,T)&&(clearInterval(s(this,T)),l(this,T,void 0))},nt=function(){const t=s(this,v).getQueryCache().build(s(this,v),this.options);if(t===s(this,n))return;const e=s(this,n);l(this,n,t),l(this,j,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},wt=function(t){N.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,y))}),s(this,v).getQueryCache().notify({query:s(this,n),type:"observerResultsUpdated"})})},Ot);function At(i,t){return w(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function Rt(i,t){return At(i,t)||i.state.data!==void 0&&at(i,t,t.refetchOnMount)}function at(i,t,e){if(w(t.enabled,i)!==!1){const r=typeof e=="function"?e(i):e;return r==="always"||r!==!1&&ut(i,t)}return!1}function gt(i,t,e,r){return(i!==t||w(r.enabled,i)===!1)&&(!e.suspense||i.state.status!=="error")&&ut(i,e)}function ut(i,t){return w(t.enabled,i)!==!1&&i.isStaleByTime(q(t.staleTime,i))}function Kt(i,t){return!H(i.getCurrentResult(),t)}var I,M,m,Q,F,z,ht,Ct,_t=(Ct=class extends St{constructor(t,e){super();p(this,F);p(this,I);p(this,M);p(this,m);p(this,Q);l(this,I,t),this.setOptions(e),this.bindMethods(),d(this,F,z).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const e=this.options;this.options=s(this,I).defaultMutationOptions(t),H(this.options,e)||s(this,I).getMutationCache().notify({type:"observerOptionsUpdated",mutation:s(this,m),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&mt(e.mutationKey)!==mt(this.options.mutationKey)?this.reset():((r=s(this,m))==null?void 0:r.state.status)==="pending"&&s(this,m).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=s(this,m))==null||t.removeObserver(this)}onMutationUpdate(t){d(this,F,z).call(this),d(this,F,ht).call(this,t)}getCurrentResult(){return s(this,M)}reset(){var t;(t=s(this,m))==null||t.removeObserver(this),l(this,m,void 0),d(this,F,z).call(this),d(this,F,ht).call(this)}mutate(t,e){var r;return l(this,Q,e),(r=s(this,m))==null||r.removeObserver(this),l(this,m,s(this,I).getMutationCache().build(s(this,I),this.options)),s(this,m).addObserver(this),s(this,m).execute(t)}},I=new WeakMap,M=new WeakMap,m=new WeakMap,Q=new WeakMap,F=new WeakSet,z=function(){var e;const t=((e=s(this,m))==null?void 0:e.state)??Tt();l(this,M,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},ht=function(t){N.batch(()=>{var e,r,h,c,a,f,g,C;if(s(this,Q)&&this.hasListeners()){const b=s(this,M).variables,o=s(this,M).context;(t==null?void 0:t.type)==="success"?((r=(e=s(this,Q)).onSuccess)==null||r.call(e,t.data,b,o),(c=(h=s(this,Q)).onSettled)==null||c.call(h,t.data,null,b,o)):(t==null?void 0:t.type)==="error"&&((f=(a=s(this,Q)).onError)==null||f.call(a,t.error,b,o),(C=(g=s(this,Q)).onSettled)==null||C.call(g,void 0,t.error,b,o))}this.listeners.forEach(b=>{b(s(this,M))})})},Ct),Qt=R.createContext(!1),kt=()=>R.useContext(Qt);Qt.Provider;function Bt(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}}var jt=R.createContext(Bt()),Wt=()=>R.useContext(jt);function Ft(i,t){return typeof i=="function"?i(...t):!!i}function Vt(){}var qt=(i,t)=>{(i.suspense||i.throwOnError)&&(t.isReset()||(i.retryOnMount=!1))},zt=i=>{R.useEffect(()=>{i.clearReset()},[i])},Ht=({result:i,errorResetBoundary:t,throwOnError:e,query:r})=>i.isError&&!t.isReset()&&!i.isFetching&&r&&Ft(e,[i.error,r]),Nt=i=>{i.suspense&&typeof i.staleTime!="number"&&(i.staleTime=1e3)},Gt=(i,t)=>(i==null?void 0:i.suspense)&&t.isPending,$t=(i,t,e)=>t.fetchOptimistic(i).catch(()=>{e.clearReset()});function Jt(i,t,e){var C,b,o,k;const r=Et(),h=kt(),c=Wt(),a=r.defaultQueryOptions(i);(b=(C=r.getDefaultOptions().queries)==null?void 0:C._experimental_beforeQuery)==null||b.call(C,a),a._optimisticResults=h?"isRestoring":"optimistic",Nt(a),qt(a,c),zt(c);const[f]=R.useState(()=>new t(r,a)),g=f.getOptimisticResult(a);if(R.useSyncExternalStore(R.useCallback(O=>{const V=h?()=>{}:f.subscribe(N.batchCalls(O));return f.updateResult(),V},[f,h]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),R.useEffect(()=>{f.setOptions(a,{listeners:!1})},[a,f]),Gt(a,g))throw $t(a,f,c);if(Ht({result:g,errorResetBoundary:c,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash)}))throw g.error;return(k=(o=r.getDefaultOptions().queries)==null?void 0:o._experimental_afterQuery)==null||k.call(o,a,g),a.notifyOnChangeProps?g:f.trackResult(g)}function xt(i,t){return Jt(i,Lt)}function Xt(i,t){const e=Et(),[r]=R.useState(()=>new _t(e,i));R.useEffect(()=>{r.setOptions(i)},[r,i]);const h=R.useSyncExternalStore(R.useCallback(a=>r.subscribe(N.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),c=R.useCallback((a,f)=>{r.mutate(a,f).catch(Vt)},[r]);if(h.error&&Ft(r.options.throwOnError,[h.error]))throw h.error;return{...h,mutate:c,mutateAsync:h.mutate}}const Yt=async(i,t)=>(await ot.get(i,{...t})).data;function ie({key:i,api:t,options:e,value:r,config:h}){return xt({queryKey:[i??t,...r??[]],queryFn:async()=>Yt(t,h),refetchOnReconnect:"always",refetchOnWindowFocus:!1,...e})}function re({key:i,api:t,options:e,value:r,config:h}){return xt({queryKey:[i??t,...r??[]],queryFn:async()=>(await ot.post(t,{...h})).data,refetchOnReconnect:"always",refetchOnWindowFocus:!1,...e})}const Zt=(i,t)=>ot.post(i,t),ne=({options:i})=>Xt({mutationFn:({api:t,data:e})=>Zt(t,e),...i});export{ie as a,re as b,ne as u};
