import{j as e,h as Qe,u as X,r as d,z as w,m as U,k as Y,i as Ve,B as K}from"./index-C7yuYAMH.js";import{a as He}from"./index-C5LGJ9uB.js";import{C as oe,d as ue,b as we,a as ze,c as Ke}from"./card-MnZHCR0Z.js";import{a as xe,T as he,b as me,c as G,d as k,e as je,f as T,S as ne}from"./Spinner-Be-1_9LR.js";import{g as Z}from"./services-KQnp_8oA.js";import{u as De,C as $e,S as Ye,f as Ge,g as Je,h as Xe,i as Le,j as Ze,a as re,F as ge,o as ce,c as B,b as D,B as Ee}from"./switch-BeqCNwiX.js";import{I as Be}from"./input-CnhuRAMI.js";import{R as ea}from"./SelectField-BZGJUjha.js";import{L as aa}from"./label-BDsy0Hn-.js";import{F as be,b as Re}from"./index-CqaRoLfa.js";import{D as Se,b as pe,a as Ce,P as ke}from"./dialog-BBqtXzJt.js";import{D as fe}from"./index-CayZ_14C.js";import{T as Fe,a as qe,f as Ie,g as Pe,b as Ae,c as _e,d as sa,e as la}from"./tabs-DB_uqEcK.js";import{X as Me}from"./x-CWuDy4se.js";import{P as Oe}from"./index-BEaEm1h1.js";import{R as de}from"./RHFTextField-Dr8ao_OA.js";import{I as We}from"./Image-D1HlVH_m.js";import{t as Te}from"./switch-L6Hz-Syj.js";import"./iconBase-Q_i1e9oq.js";import"./createLucideIcon-DFZxyBN9.js";const ta=({children:a,name:v,label:W,selectedText:c,className:f,data:M,initialValue:N,initialValueText:A,...C})=>{const{control:_,setValue:P}=De();return e.jsx($e,{name:v,control:_,render:({field:{ref:q,...$},fieldState:{error:F}})=>e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-gray-700 dark:text-gray-200 ",children:[W," ",F&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs(Ye,{onValueChange:E=>{var L;$.onChange(E),c&&P(c,(L=M==null?void 0:M.find(b=>b.value==E))==null?void 0:L.label)},value:$.value,...C,children:[e.jsx(Ge,{ref:q,className:Qe("h-10 mt-1",F?"border-red-400":null,f),children:e.jsx(Je,{placeholder:"Select"})}),e.jsxs(Xe,{children:[N&&e.jsx(Le,{value:N??"0",children:A??"Select"}),e.jsx(Ze,{children:M==null?void 0:M.map((E,L)=>e.jsx(Le,{value:E.value,children:E.label},L+1))})]})]}),F&&e.jsx("span",{className:"text-red-400 text-xs",children:F==null?void 0:F.message})]})})};function Ue({name:a,label:v,isDynamic:W,isRequired:c,...f}){const{control:M,setValue:N}=De();return e.jsx($e,{name:a,control:M,render:({field:{ref:A},fieldState:{error:C}})=>e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-200",htmlFor:v,children:[v," ",c&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(Be,{type:"file",onChange:_=>{N(a,_.target.files?_.target.files[0]:null)},ref:A,className:`mt-1 ${C?"border-red-400":null}`,...f}),C&&e.jsx("span",{className:"text-red-400 text-xs",children:C.message})]})})}const da=B().shape({service_name:D().required("menu name is required")});function na({open:a,setOpen:v,title:W,edit:c,setEdit:f,serviceList:M,moduleList:N,id:A,menuRoleList:C,moduleId:_,menuRoleId:P,moduleName:q,roleList:$,userPermittedRoles:F,userId:E,permittedModule:L,ulbId:b,permittedModuleListByUlb:O}){const V=X({}),R=X({}),m=re({defaultValues:{service_name:""},resolver:ce(da)}),[x,j]=d.useState(""),t=async s=>{var r,h,l;try{const u=c?"EditModuleList":"AddmoduleList",g=c&&A?{...s,moduleId:A}:{...s,moduleId:_},S=await V.mutateAsync({api:u,data:g});(r=S==null?void 0:S.data)!=null&&r.success?(w.success((h=S==null?void 0:S.data)==null?void 0:h.message),v(!1),f(!1),M.refetch()):w.error((l=S==null?void 0:S.data)==null?void 0:l.message)}catch(u){w.error(Z(u))}},y=async(s,r)=>{var h,l,u,g;console.log(r);try{const S={ulbId:b,moduleList:[{permissionStatus:r,moduleId:s}]},o=await R.mutateAsync({api:(h=U)==null?void 0:h.addRemoveModuleToUlb,data:S});(l=o==null?void 0:o.data)!=null&&l.status?(w.success(((u=o==null?void 0:o.data)==null?void 0:u.message)||"Permission updated successfully"),O.refetch()):w.error(((g=o==null?void 0:o.data)==null?void 0:g.message)||"Failed to update permission")}catch(S){w.error(Z(S))}},p=L==null?void 0:L.filter(s=>{var r;return(r=s.module_name)==null?void 0:r.toLowerCase().includes(x.toLowerCase())});return e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:f,edit:c,setSearchValue:j,value:x,children:e.jsx(ge,{methods:m,onSubmit:m.handleSubmit(t),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Module Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(p==null?void 0:p.map((s,r)=>e.jsxs("tr",{className:"text-sm hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.module_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.permission_status?e.jsx("button",{className:"rounded-md  bg-red-200 px-2 py-1 text-xs font-bold text-red-600 hover:bg-red-100",onClick:()=>y(s.id,!s.permission_status),children:"Remove"}):e.jsx("button",{className:"rounded-md bg-green-200 px-2 py-1 text-xs font-bold text-green-600 hover:bg-green-100",onClick:()=>y(s.id,!s.permission_status),children:"Add"})})]},s.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center",children:"No data available"})})})]})})})})})}const ra=B().shape({service_name:D().required("menu name is required")});function ca({open:a,setOpen:v,title:W,edit:c,setEdit:f,serviceList:M,moduleList:N,id:A,menuRoleList:C,moduleId:_,menuRoleId:P,moduleName:q,roleList:$,userPermittedRoles:F,userId:E,permittedModule:L,ulbId:b,permittedModuleListByUlb:O,getServicesByUlbModule:V,permittedServices:R}){var h;const m=X({}),x=X({}),j=re({defaultValues:{service_name:""},resolver:ce(ra)}),[t,y]=d.useState(""),p=async l=>{var u,g,S;try{const o=c?"EditModuleList":"AddmoduleList",z=c&&A?{...l,moduleId:A}:{...l,moduleId:_},Q=await m.mutateAsync({api:o,data:z});(u=Q==null?void 0:Q.data)!=null&&u.success?(w.success((g=Q==null?void 0:Q.data)==null?void 0:g.message),v(!1),f(!1),M.refetch()):w.error((S=Q==null?void 0:Q.data)==null?void 0:S.message)}catch(o){w.error(Z(o))}},s=async(l,u)=>{var g,S,o,z;console.log(u);try{const Q={ulbId:b,serviceList:[{permissionStatus:u,serviceId:l}]},H=await x.mutateAsync({api:(g=U)==null?void 0:g.addRemoveServiceByUlbModule,data:Q});(S=H==null?void 0:H.data)!=null&&S.status?(w.success(((o=H==null?void 0:H.data)==null?void 0:o.message)||"Permission updated successfully"),V.refetch()):w.error(((z=H==null?void 0:H.data)==null?void 0:z.message)||"Failed to update permission")}catch(Q){w.error(Z(Q))}};Y({api:(h=U)==null?void 0:h.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}});const r=R==null?void 0:R.filter(l=>{var u;return(u=l.services)==null?void 0:u.toLowerCase().includes(t.toLowerCase())});return e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:f,edit:c,setSearchValue:y,value:t,children:e.jsx(ge,{methods:j,onSubmit:j.handleSubmit(p),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Route"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(r==null?void 0:r.map((l,u)=>e.jsxs("tr",{className:"text-sm hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:u+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${l.permission_status?"text-green-600":"text-black"}`,children:l.services}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${l.permission_status?"text-green-600":"text-black"}`,children:l.path}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:l.permission_status?e.jsx("button",{className:"rounded-md  bg-red-200 px-2 py-1 text-xs font-bold text-red-600 hover:bg-red-100",onClick:()=>s(l.id,!l.permission_status),children:"Remove"}):e.jsx("button",{className:"rounded-md bg-green-200 px-2 py-1 text-xs font-bold text-green-600 hover:bg-green-100",onClick:()=>s(l.id,!l.permission_status),children:"Add"})})]},l.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center",children:"No data available"})})})]})})})})})}const ia=B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function oa(a){var S,o,z,Q,H,I,ae,se,le;const[v,W]=d.useState(1),[c,f]=d.useState(10),[M,N]=d.useState(!1),[A,C]=d.useState(""),[_,P]=d.useState(!1),[q,$]=d.useState(!1),[F,E]=d.useState(!1),[L,b]=d.useState(null),[O,V]=d.useState(!1),[R,m]=d.useState(""),[x,j]=d.useState(""),[t,y]=d.useState(""),[p,s]=d.useState(1),[r,h]=d.useState(10);console.log(a==null?void 0:a.ulbId);const l=re({resolver:ce(ia),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),u=Ve({api:`${(S=U)==null?void 0:S.serviceList}?module=${(o=l==null?void 0:l.watch())==null?void 0:o.moduleId}`,key:"serviceMasterList",options:{enabled:!0}});Y({api:(z=U)==null?void 0:z.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:c,searchQuery:t,[R]:t},value:[v,c,R,t],options:{enabled:!!(a!=null&&a.ulbId)}});const g=Y({api:(Q=U)==null?void 0:Q.getServicesByUlbModule,key:"getServicesByUlbModule",config:{ulbId:a==null?void 0:a.ulbId,moduleId:a==null?void 0:a.moduleId},options:{enabled:!!(a!=null&&a.ulbId)}});return console.log(a==null?void 0:a.moduleId),console.log((H=g==null?void 0:g.data)==null?void 0:H.data),e.jsxs(e.Fragment,{children:[e.jsx(Se,{open:O,children:e.jsx(pe,{className:"h-[600px] max-h-[600px] overflow-scroll sm:max-w-[1200px]"})}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),P(!1),N(!0)},children:"Restrict More Services"})})}),e.jsx(ca,{open:M,setOpen:N,title:_?"Edit Restrict Service":"Add Restrict Service",id:A,edit:_,setEdit:P,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,ulbId:a==null?void 0:a.ulbId,getServicesByUlbModule:g,permittedServices:(I=g==null?void 0:g.data)==null?void 0:I.data}),e.jsx(oe,{children:e.jsx(ue,{children:u.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Service Name"}),e.jsx(k,{className:"",children:"Service Route"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(le=(se=(ae=g==null?void 0:g.data)==null?void 0:ae.data)==null?void 0:se.filter(n=>(n==null?void 0:n.permission_status)==!0))==null?void 0:le.map((n,i)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+i+1}),e.jsx(T,{children:n==null?void 0:n.services}),e.jsx(T,{children:n==null?void 0:n.path}),e.jsx(T,{children:e.jsxs(K,{variant:"secondary",onClick:()=>{C(n==null?void 0:n.id),P(!0),N(!0)},children:[e.jsx(be,{})," Edit"]})})]},n==null?void 0:n.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"})]})})})]})})]})}B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function ua(a){var p,s,r,h,l,u,g,S;const[v,W]=d.useState(1),[c,f]=d.useState(10),[M,N]=d.useState(!1),[A,C]=d.useState(""),[_,P]=d.useState(!1),[q,$]=d.useState(!1),[F,E]=d.useState(null),[L,b]=d.useState(1),[O,V]=d.useState(10),R=100,m=o=>{b(o)},x=o=>{V(o),b(1)};console.log(a==null?void 0:a.ulbId);const j=Y({api:(p=U)==null?void 0:p.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),t=Y({api:(s=U)==null?void 0:s.getModuleByUlbId,key:"permittedModuleListByUlb",config:{ulbId:a==null?void 0:a.ulbId},options:{enabled:!!(a!=null&&a.ulbId)}});console.log((r=t==null?void 0:t.data)==null?void 0:r.data);const y=o=>{E(o),$(!0)};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:q,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"h-[700px] max-h-[700px] overflow-scroll sm:max-w-[1200px]",children:[e.jsxs(we,{className:"mt-4 flex justify-between text-xl font-bold text-gray-500 h-fit",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["ULB :"," ",e.jsx("span",{className:"text-lg font-bold text-yellow-500",children:(h=a==null?void 0:a.selectedULB)==null?void 0:h.ulb_name})]}),e.jsxs("div",{children:["Module Name :"," ",e.jsx("span",{className:"text-lg font-bold text-yellow-500",children:F==null?void 0:F.module_name})]})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>$(!1)})})})]}),e.jsxs(Fe,{defaultValue:"MENULIST",className:"w-full -mt-60",children:[e.jsx("div",{className:"flex justify-between py-4",children:e.jsx(qe,{className:"grid w-auto grid-cols-2",children:e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Restricted Services"})})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(oa,{ulbId:a==null?void 0:a.ulbId,moduleId:A,viewService:F})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),P(!1),N(!0)},children:"Add More Module"})})}),e.jsx(na,{open:M,setOpen:N,title:_?"Edit Module":"Add Module",id:A,edit:_,setEdit:P,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedModule:(l=t==null?void 0:t.data)==null?void 0:l.data,permittedModuleListByUlb:t,ulbId:a==null?void 0:a.ulbId}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:j.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Module"}),e.jsx(k,{className:"",children:"Path"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(S=(g=(u=t==null?void 0:t.data)==null?void 0:u.data)==null?void 0:g.filter(o=>(o==null?void 0:o.permission_status)==!0))==null?void 0:S.map((o,z)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+z+1}),e.jsx(T,{children:o==null?void 0:o.module_name}),e.jsx(T,{children:o==null?void 0:o.url}),e.jsxs(T,{children:[e.jsxs(K,{variant:"secondary",onClick:()=>{C(o==null?void 0:o.id),P(!0),N(!0)},children:[e.jsx(be,{})," Edit"]}),e.jsxs(K,{onClick:()=>{y(o),C(o==null?void 0:o.id)},className:"ml-2",variant:"secondary",children:[e.jsx(Re,{})," View"]})]})]},o==null?void 0:o.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{currentPage:L,totalItems:R,itemsPerPage:O,onPageChange:m,onItemsPerPageChange:x})})]})})})]})})}const xa=B().shape({service_name:D().required("menu name is required")});function ha({open:a,setOpen:v,title:W,edit:c,setEdit:f,serviceList:M,moduleList:N,id:A,menuRoleList:C,moduleId:_,menuRoleId:P,moduleName:q,roleList:$,userPermittedRoles:F,userId:E}){const[L,b]=d.useState(""),O=X({}),V=X({}),R=re({defaultValues:{service_name:""},resolver:ce(xa)}),m=$==null?void 0:$.filter(t=>t.menu_role_name.toLowerCase().includes(L.toLowerCase())),x=async t=>{var y,p,s;try{const r=c?"EditModuleList":"AddmoduleList",h=c&&A?{...t,moduleId:A}:{...t,moduleId:_},l=await O.mutateAsync({api:r,data:h});(y=l==null?void 0:l.data)!=null&&y.success?(w.success((p=l==null?void 0:l.data)==null?void 0:p.message),v(!1),f(!1),M.refetch()):w.error((s=l==null?void 0:l.data)==null?void 0:s.message)}catch(r){w.error(Z(r))}},j=async(t,y)=>{var p,s,r,h;console.log(y);try{const l={userId:E,permissionStatus:y,menuRoleId:t},u=await V.mutateAsync({api:(p=U)==null?void 0:p.addMenuRoleUser,data:l});(s=u==null?void 0:u.data)!=null&&s.status?(w.success(((r=u==null?void 0:u.data)==null?void 0:r.message)||"Permission updated successfully"),F.refetch()):w.error(((h=u==null?void 0:u.data)==null?void 0:h.message)||"Failed to update permission")}catch(l){w.error(Z(l))}};return e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:f,edit:c,setSearchValue:b,value:L,children:e.jsx(ge,{methods:R,onSubmit:R.handleSubmit(x),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4 ",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-48 table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(m==null?void 0:m.map((t,y)=>e.jsxs("tr",{className:"text-sm hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:y+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${t.permission_status?"text-green-600":"text-black"}`,children:t.menu_role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:t.permission_status?e.jsx("button",{className:"rounded-md  bg-red-200 px-2 py-1 text-xs font-bold text-red-600 hover:bg-red-100",onClick:()=>j(t.id,!t.permission_status),children:"Remove"}):e.jsx("button",{className:"rounded-md bg-green-200 px-2 py-1 text-xs font-bold text-green-600 hover:bg-green-100",onClick:()=>j(t.id,!t.permission_status),children:"Add"})})]},t.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center",children:"No data available"})})})]})})})})})}B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function ma(a){var t,y,p,s,r,h;const[v,W]=d.useState(1),[c,f]=d.useState(10),[M,N]=d.useState(!1),[A,C]=d.useState(""),[_,P]=d.useState(!1),[q,$]=d.useState(!1),[F,E]=d.useState(null),[L,b]=d.useState(1),[O,V]=d.useState(10),R=100,m=l=>{b(l)},x=l=>{V(l),b(1)};console.log(a==null?void 0:a.ulbId);const j=Y({api:(t=U)==null?void 0:t.userPermittedRoles,key:"userPermittedRoles",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((y=j==null?void 0:j.data)==null?void 0:y.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),P(!1),N(!0)},children:"Add More Role Permission"})})}),e.jsx(ha,{open:M,setOpen:N,title:_?"Edit Menu":"Add Menu",id:A,edit:_,setEdit:P,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,roleList:(p=j==null?void 0:j.data)==null?void 0:p.data,userPermittedRoles:j}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:j.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Role Menu"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(h=(r=(s=j==null?void 0:j.data)==null?void 0:s.data)==null?void 0:r.filter(l=>(l==null?void 0:l.permission_status)==!0))==null?void 0:h.map((l,u)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+u+1}),e.jsx(T,{children:l==null?void 0:l.menu_role_name}),e.jsx(T,{children:e.jsxs(K,{variant:"secondary",onClick:()=>{C(l==null?void 0:l.id),P(!0),N(!0)},children:[e.jsx(be,{})," Edit"]})})]},l==null?void 0:l.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{currentPage:L,totalItems:R,itemsPerPage:O,onPageChange:m,onItemsPerPageChange:x})})]})})})]})})}const ja=B().shape({service_name:D().required("menu name is required")});function ga({open:a,setOpen:v,title:W,edit:c,setEdit:f,serviceList:M,moduleList:N,id:A,menuRoleList:C,moduleId:_,menuRoleId:P,moduleName:q,wardList:$,permittedWardByUsers:F,userId:E}){const L=X({}),b=X({}),O=re({defaultValues:{service_name:""},resolver:ce(ja)}),[V,R]=d.useState(""),m=async t=>{var y,p,s;try{const r=c?"EditModuleList":"AddmoduleList",h=c&&A?{...t,moduleId:A}:{...t,moduleId:_},l=await L.mutateAsync({api:r,data:h});(y=l==null?void 0:l.data)!=null&&y.success?(w.success((p=l==null?void 0:l.data)==null?void 0:p.message),v(!1),f(!1),M.refetch()):w.error((s=l==null?void 0:l.data)==null?void 0:s.message)}catch(r){w.error(Z(r))}},x=async(t,y)=>{var p,s,r,h;console.log(y);try{const l={userId:E,wardList:t?[{permissionStatus:y,wardId:t}]:$.map(g=>({wardId:g.id,permissionStatus:y}))},u=await b.mutateAsync({api:(p=U)==null?void 0:p.addRemoveWard,data:l});(s=u==null?void 0:u.data)!=null&&s.status?(w.success(((r=u==null?void 0:u.data)==null?void 0:r.message)||"Permission updated successfully"),F.refetch()):w.error(((h=u==null?void 0:u.data)==null?void 0:h.message)||"Failed to update permission")}catch(l){w.error(Z(l))}},j=$==null?void 0:$.filter(t=>String(t.ward_name??"").toLowerCase().includes(V.toLowerCase()));return e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:f,edit:c,setSearchValue:R,value:V,children:e.jsx(ge,{methods:O,onSubmit:O.handleSubmit(m),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"rounded-md bg-green-200 px-4 py-2 text-sm font-bold text-green-600 hover:bg-green-100",onClick:()=>x(null,!0),children:"Select All"}),e.jsx("button",{className:"rounded-md bg-red-200 px-4 py-2 text-sm font-bold text-red-600 hover:bg-red-100",onClick:()=>x(null,!1),children:"Remove All"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Ward No."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(j==null?void 0:j.map((t,y)=>e.jsxs("tr",{className:"text-sm hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:y+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${t.permission_status?"text-green-600":"text-black"}`,children:t.ward_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:t.permission_status?e.jsx("button",{className:"rounded-md  bg-red-200 px-2 py-1 text-xs font-bold text-red-600 hover:bg-red-100",onClick:()=>x(t.id,!t.permission_status),children:"Remove"}):e.jsx("button",{className:"rounded-md bg-green-200 px-2 py-1 text-xs font-bold text-green-600 hover:bg-green-100",onClick:()=>x(t.id,!t.permission_status),children:"Add"})})]},t.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center",children:"No data available"})})})]})})]})})})}B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function ba(a){var x,j,t,y,p,s,r;const[v,W]=d.useState(1),[c,f]=d.useState(10),[M,N]=d.useState(!1),[A,C]=d.useState(""),[_,P]=d.useState(!1),[q,$]=d.useState(!1),[F,E]=d.useState(null),[L,b]=d.useState(1),[O,V]=d.useState(10);console.log(a==null?void 0:a.ulbId);const R=Y({api:(x=U)==null?void 0:x.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),m=Y({api:(j=U)==null?void 0:j.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((t=m==null?void 0:m.data)==null?void 0:t.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),P(!1),N(!0)},children:"Add More Ward Permission"})})}),e.jsx(ga,{open:M,setOpen:N,title:_?"Edit Ward":"Add Ward",id:A,edit:_,setEdit:P,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedWardByUsers:m,wardList:(y=m==null?void 0:m.data)==null?void 0:y.data}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:R.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Wards"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(r=(s=(p=m==null?void 0:m.data)==null?void 0:p.data)==null?void 0:s.filter(h=>(h==null?void 0:h.permission_status)==!0))==null?void 0:r.map((h,l)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+l+1}),e.jsx(T,{children:h==null?void 0:h.ward_name}),e.jsx(T,{children:e.jsxs(K,{variant:"secondary",onClick:()=>{C(h==null?void 0:h.id),P(!0),N(!0)},children:[e.jsx(be,{})," Edit"]})})]},h==null?void 0:h.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"})]})})})]})})}const fa=B().shape({service_name:D().required("menu name is required")});function Na({open:a,setOpen:v,title:W,subtitle:c,edit:f,setEdit:M,serviceList:N,moduleList:A,id:C,menuRoleList:_,moduleId:P,menuRoleId:q,moduleName:$,wardList:F,permittedworkFlowRoleByUser:E,userId:L,workFlowList:b}){const O=X({}),V=X({}),R=re({defaultValues:{service_name:""},resolver:ce(fa)}),[m,x]=d.useState(""),j=async s=>{var r,h,l;try{const u=f?"EditModuleList":"AddmoduleList",g=f&&C?{...s,moduleId:C}:{...s,moduleId:P},S=await O.mutateAsync({api:u,data:g});(r=S==null?void 0:S.data)!=null&&r.success?(w.success((h=S==null?void 0:S.data)==null?void 0:h.message),v(!1),M(!1),N.refetch()):w.error((l=S==null?void 0:S.data)==null?void 0:l.message)}catch(u){w.error(Z(u))}},t=async(s,r)=>{var h,l,u,g;try{const S={userId:L,permissionStatus:r,wfRoleId:s},o=await V.mutateAsync({api:(h=U)==null?void 0:h.AddRemoveWorkFlowRoleByUser,data:S});(l=o==null?void 0:o.data)!=null&&l.status?(w.success(((u=o==null?void 0:o.data)==null?void 0:u.message)||"Permission updated successfully"),E.refetch()):w.error(((g=o==null?void 0:o.data)==null?void 0:g.message)||"Failed to update permission")}catch(S){w.error(Z(S))}},y=b==null?void 0:b.some(s=>s.permission_status),p=b==null?void 0:b.filter(s=>{var r;return(r=s.role_name)==null?void 0:r.toLowerCase().includes(m.toLowerCase())});return e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:M,subtitle:c,edit:f,setSearchValue:x,value:m,children:e.jsx(ge,{methods:R,onSubmit:R.handleSubmit(j),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(p==null?void 0:p.map((s,r)=>e.jsxs("tr",{className:"text-sm hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx("button",{className:`rounded-md px-2 py-1 text-xs font-bold ${s.permission_status?"bg-red-200 text-red-600 hover:bg-red-100":y?"cursor-not-allowed bg-gray-200 text-gray-400":"bg-green-200 text-green-600 hover:bg-green-100"}`,onClick:()=>!y||s.permission_status?t(s.id,!s.permission_status):null,disabled:!s.permission_status&&y,children:s.permission_status?"Remove":"Add"})})]},s.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center",children:"No data available"})})})]})})})})})}B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function ya(a){var j,t,y,p,s,r,h,l,u;const[v,W]=d.useState(1),[c,f]=d.useState(10),[M,N]=d.useState(!1),[A,C]=d.useState(""),[_,P]=d.useState(!1),[q,$]=d.useState(!1),[F,E]=d.useState(null),[L,b]=d.useState(1),[O,V]=d.useState(10),R=Y({api:(j=U)==null?void 0:j.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),m=Y({api:(t=U)==null?void 0:t.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}}),x=Y({api:(y=U)==null?void 0:y.workFlowRoleByUser,key:"permittedworkFlowRoleByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((p=m==null?void 0:m.data)==null?void 0:p.data),console.log((s=x==null?void 0:x.data)==null?void 0:s.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),P(!1),N(!0)},children:"Change Role Permission"})})}),e.jsx(Na,{open:M,setOpen:N,title:_?"Edit Role":"Change Role",subtitle:"You can provide only one workflow role at a time.",id:A,edit:_,setEdit:P,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedworkFlowRoleByUser:x,workFlowList:(r=x==null?void 0:x.data)==null?void 0:r.data}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:R.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Workflow Role Name"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(u=(l=(h=x==null?void 0:x.data)==null?void 0:h.data)==null?void 0:l.filter(g=>(g==null?void 0:g.permission_status)==!0))==null?void 0:u.map((g,S)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+S+1}),e.jsx(T,{children:g==null?void 0:g.role_name}),e.jsx(T,{children:e.jsxs(K,{variant:"secondary",onClick:()=>{C(g==null?void 0:g.id),P(!0),N(!0)},children:[e.jsx(be,{})," Edit"]})})]},g==null?void 0:g.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"})]})})})]})})}const va=B().shape({userType:D().required("User Type is required"),name:D().required("Full Name is required"),mobile:D().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:D().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:D().email("Enter a valid email").required("Email is required"),address:D().required("Address is required"),photo:D().required("User Image is required")});function Sa({open:a,setOpen:v,title:W,edit:c,setEdit:f,adminListFun:M,id:N,ulbId:A,userListByUlbId:C}){var L,b,O;const _=X({}),P=d.useRef(null),q=re({defaultValues:{userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:ce(va)}),{reset:$}=q;console.log(A,"ulbId"),d.useEffect(()=>{var V,R,m;if(a){if(c&&N){const x=(m=(R=(V=C==null?void 0:C.data)==null?void 0:V.data)==null?void 0:R.data)==null?void 0:m.find(j=>j.id==N);console.log(x,"selectedAdmin"),x&&$({userType:x.user_type||"",name:x.name||"",mobile:x.mobile||"",altMobile:x.alternateMobile||"",email:x.email||"",address:x.address||"",photo:null})}else $({userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});q.setValue("photo",""),P.current&&(P.current.value="")}},[a,c,N,M,$]);const F=async V=>{var R,m,x,j,t;try{const y=c?(R=U)==null?void 0:R.updateAdmin:(m=U)==null?void 0:m.createAdmin,p=c&&N?{...V,id:N}:{...V,ulbId:A},s=new FormData;s.append("name",p.name),s.append("mobile",p.mobile),s.append("altMobile",p.altMobile),s.append("email",p.email),s.append("address",p.address),s.append("userType",p.userType),s.append("photo",q.watch("photo")),c&&N&&s.append("id",N),s.append("ulbId",A||"");const r=await _.mutateAsync({api:y,data:s});(x=r==null?void 0:r.data)!=null&&x.status?(w.success((j=r==null?void 0:r.data)==null?void 0:j.message),v(!1),f(!1),C.refetch()):w.error((t=r==null?void 0:r.data)==null?void 0:t.message)}catch(y){w.error(Z(y))}},E=Y({api:(L=U)==null?void 0:L.createUserType,key:"createUserTypeList",options:{enabled:!0}});return console.log((b=E==null?void 0:E.data)==null?void 0:b.data,"createUserTypeList"),e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:f,edit:c,hideSearch:!0,children:e.jsx(ge,{methods:q,onSubmit:q.handleSubmit(F),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(ta,{label:"User Type",name:"userType",data:((O=E==null?void 0:E.data)==null?void 0:O.data.map(V=>({value:String(V),label:String(V)})))||[]})}),e.jsx("div",{children:e.jsx(de,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Full Name"})}),e.jsx("div",{children:e.jsx(de,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter Alt Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(de,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Ue,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(ne,{}),e.jsx("div",{children:e.jsx(Ee,{isLoading:q.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const pa=B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function Ia(a){var h,l,u,g,S,o,z,Q,H,I,ae,se,le,n;const[v,W]=d.useState(1),[c,f]=d.useState(10),M=X({}),[N,A]=d.useState(!1),[C,_]=d.useState(""),[P,q]=d.useState(!1),[$,F]=d.useState(!1),[E,L]=d.useState(!1),[b,O]=d.useState(""),[V,R]=d.useState(""),[m,x]=d.useState(""),j=i=>{O(i)},t=i=>{R(i.target.value)};d.useEffect(()=>{const i=setTimeout(()=>{x(V)},700);return()=>clearTimeout(i)},[V]),console.log(a==null?void 0:a.ulbId);const y=re({resolver:ce(pa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),p=Ve({api:`${(h=U)==null?void 0:h.serviceList}?module=${(l=y==null?void 0:y.watch())==null?void 0:l.moduleId}`,key:"serviceMasterList",options:{enabled:!0}}),s=Y({api:(u=U)==null?void 0:u.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:c,searchQuery:m,[b]:m},value:[v,c,b],options:{enabled:!0}});d.useEffect(()=>{m&&(W(1),f(10)),s.refetch()},[m]);const r=async(i,te)=>{var J,ye,ve,Ne;try{const ee={id:i,isSuspended:te},ie=await M.mutateAsync({api:(J=U)==null?void 0:J.enableDisableUserByModule,data:ee});(ye=ie==null?void 0:ie.data)!=null&&ye.status?(w.success(((ve=ie==null?void 0:ie.data)==null?void 0:ve.message)||"Permission updated successfully"),s.refetch()):w.error(((Ne=ie==null?void 0:ie.data)==null?void 0:Ne.message)||"Failed to update permission")}catch(ee){w.error(Z(ee))}};return console.log(b),e.jsxs(e.Fragment,{children:[e.jsx(Se,{open:E,children:e.jsx(Ce,{children:e.jsxs(pe,{className:"flex h-[90%] max-h-[90%] flex-col overflow-hidden sm:max-w-[1200px]",children:[e.jsxs(we,{className:"flex justify-between border-b pb-2 text-xl font-bold text-gray-500",children:[e.jsxs("div",{children:["User :"," ",e.jsx("span",{className:"text-lg font-bold text-yellow-500",children:$==null?void 0:$.name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>L(!1)})})})]}),e.jsxs(Fe,{defaultValue:"ROLELIST",className:"flex flex-1 flex-col overflow-hidden",children:[e.jsxs(qe,{className:"grid w-auto grid-cols-3 rounded-md bg-gray-100 py-1 mb-2",children:[e.jsx(Ae,{className:"rounded-md px-2 text-gray-400 data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"ROLELIST",children:"Permitted Roles"}),e.jsx(Ae,{className:"rounded-md px-2 text-gray-400 data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"PERMITTED_WARDS",children:"Permitted Wards"}),e.jsx(Ae,{className:"rounded-md px-2 text-gray-400 data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"PERMITTED_WORKFLOW_ROLE",children:"Permitted Workflow Role"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx(_e,{value:"ROLELIST",children:e.jsx(ma,{selectedULB:$,id:C})}),e.jsx(_e,{value:"PERMITTED_WARDS",children:e.jsx(ba,{selectedULB:$,id:C})}),e.jsx(_e,{value:"PERMITTED_WORKFLOW_ROLE",children:e.jsx(ya,{selectedULB:$,id:C})})]})]})]})})}),e.jsx(Sa,{open:N,setOpen:A,title:P?"Edit user":"Create User",id:C,edit:P,setEdit:q,ulbId:a==null?void 0:a.ulbId,userListByUlbId:s}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:" flex justify-between gap-4",children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:b,onChange:i=>j(i.target.value),className:"w-[200px] cursor-pointer rounded-md border bg-background p-2",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:V,onChange:t,placeholder:`Search by ${b}`,className:"rounded-md border p-2",maxLength:b=="mobile"?10:void 0})]}),e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{_(""),q(!1),A(!0)},children:"Create User"})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Users : ",(S=(g=s==null?void 0:s.data)==null?void 0:g.data)==null?void 0:S.total]}),e.jsx(oe,{children:e.jsx(ue,{children:p.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"User Image"}),e.jsx(k,{className:"",children:"Name"}),e.jsx(k,{className:"",children:"Mobile No"}),e.jsx(k,{className:"",children:"Alt Mobile No"}),e.jsx(k,{className:"",children:"Email"}),e.jsx(k,{className:"",children:"User Type"}),e.jsx(k,{className:"",children:"Address"}),e.jsx(k,{className:"",children:"Status"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(Q=(z=(o=s==null?void 0:s.data)==null?void 0:o.data)==null?void 0:z.data)==null?void 0:Q.map((i,te)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+te+1}),e.jsx(T,{children:e.jsx(We,{src:i.documentUrl,alt:i.name,className:"h-10 w-10 rounded-full border-2 object-cover"})}),e.jsx(T,{className:i.suspended?"text-red-600":"text-black",children:i==null?void 0:i.name}),e.jsx(T,{className:i.suspended?"text-red-600":"text-black",children:i==null?void 0:i.mobile}),e.jsx(T,{className:i.suspended?"text-red-600":"text-black",children:i==null?void 0:i.alternateMobile}),e.jsx(T,{className:i.suspended?"text-red-600":"text-black",children:i==null?void 0:i.email}),e.jsx(T,{className:i.suspended?"text-red-600":"text-black",children:i==null?void 0:i.user_type}),e.jsx(T,{className:i.suspended?"text-red-600":"text-black",children:i==null?void 0:i.address}),e.jsx(T,{children:e.jsxs(Te,{checked:i==null?void 0:i.suspended,onChange:()=>r(i.id,!i.suspended),className:`${i!=null&&i.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${i!=null&&i.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(T,{children:e.jsxs("td",{className:"flex",children:[e.jsxs(K,{variant:"secondary",onClick:()=>{_(i==null?void 0:i.id),q(!0),A(!0)},children:[e.jsx(be,{})," Edit"]}),e.jsxs(K,{onClick:()=>{F(i),L(!0),_(i==null?void 0:i.id)},className:"ml-2",variant:"secondary",children:[e.jsx(Re,{})," View"]})]})})]},i==null?void 0:i.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Oe,{page:v,perPage:c,totalPage:(I=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:I.total,setPage:W,setPerPage:f,hasNextPage:((se=(ae=s==null?void 0:s.data)==null?void 0:ae.data)==null?void 0:se.current_page)>=v,hasPrevPage:(n=(le=s==null?void 0:s.data)==null?void 0:le.data)==null?void 0:n.current_page})})]})})})]})})]})}const Pa=B().shape({name:D().required("Full Name is required"),mobile:D().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:D().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:D().email("Enter a valid email").required("Email is required"),address:D().required("Address is required"),photo:D().required("User Image is required")});function wa({open:a,setOpen:v,title:W,edit:c,setEdit:f,adminListFun:M,id:N,ulbId:A}){const C=X({}),_=d.useRef(null),P=re({defaultValues:{name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:ce(Pa)}),{reset:q}=P;d.useEffect(()=>{var F,E,L;if(a){if(c&&N){const b=(L=(E=(F=M==null?void 0:M.data)==null?void 0:F.data)==null?void 0:E.data)==null?void 0:L.find(O=>O.id==N);console.log(b,"selectedAdmin"),b&&q({name:b.name||"",mobile:b.mobile||"",altMobile:b.alternateMobile||"",email:b.email||"",address:b.address||"",photo:null})}else q({name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});P.setValue("photo",""),_.current&&(_.current.value="")}},[a,c,N,M,q,P]);const $=async F=>{var E,L,b,O,V;try{const R=c?(E=U)==null?void 0:E.updateAdmin:(L=U)==null?void 0:L.createAdmin,m=c&&N?{...F,id:N}:{...F,userType:"Admin",role:"ADMIN",ulbId:A},x=new FormData;c&&N&&x.append("id",N),x.append("name",m.name),x.append("mobile",m.mobile),x.append("altMobile",m.altMobile),x.append("email",m.email),x.append("address",m.address),x.append("photo",P.watch("photo")),x.append("userType","Admin"),x.append("role","ADMIN"),x.append("ulbId",m.ulbId||"");const j=await C.mutateAsync({api:R,data:x});(b=j==null?void 0:j.data)!=null&&b.status?(w.success((O=j==null?void 0:j.data)==null?void 0:O.message),v(!1),f(!1),M.refetch()):w.error((V=j==null?void 0:j.data)==null?void 0:V.message)}catch(R){w.error(Z(R))}};return e.jsx(fe,{open:a,setOpen:v,title:W,setEdit:f,edit:c,hideSearch:!0,children:e.jsx(ge,{methods:P,onSubmit:P.handleSubmit($),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(de,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Full Name"})}),e.jsx("div",{children:e.jsx(de,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter Alt Mobile No "})}),e.jsx("div",{children:e.jsx(de,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(de,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Ue,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(ne,{}),e.jsx("div",{children:e.jsx(Ee,{isLoading:P.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Ca(a){var p,s,r,h,l,u,g,S,o,z,Q,H,I,ae,se,le;const[v,W]=d.useState(1),[c,f]=d.useState(10),M=X({}),[N,A]=d.useState(!1),[C,_]=d.useState(""),[P,q]=d.useState(!1),[$,F]=d.useState(!1),[E,L]=d.useState(""),[b,O]=d.useState(""),[V,R]=d.useState(""),m=n=>{L(n)},x=n=>{O(n.target.value)};d.useEffect(()=>{const n=setTimeout(()=>{R(b)},700);return()=>clearTimeout(n)},[b]);const j=Y({api:(p=U)==null?void 0:p.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),t=Y({api:(s=U)==null?void 0:s.adminList,key:"adminListFun",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:c,parameter:V||"",filterBy:E||""},value:[v,c,E],options:{enabled:!0}});d.useEffect(()=>{V&&(W(1),f(10)),t.refetch()},[V]);const y=async(n,i)=>{var te,J,ye,ve;try{const Ne={id:n,isSuspended:i},ee=await M.mutateAsync({api:(te=U)==null?void 0:te.enableDisableUserByModule,data:Ne});(J=ee==null?void 0:ee.data)!=null&&J.status?(w.success(((ye=ee==null?void 0:ee.data)==null?void 0:ye.message)||"Permission updated successfully"),t.refetch()):w.error(((ve=ee==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to update permission")}catch(Ne){w.error(Z(Ne))}};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:$,children:[e.jsx(Ce,{}),e.jsx(pe,{className:"h-[700px] max-h-[700px] overflow-scroll sm:max-w-[1200px]",children:e.jsxs(we,{className:"mt-4 flex justify-between text-xl font-bold text-gray-500",children:[e.jsx("div",{children:e.jsxs("div",{children:["ULB :"," ",e.jsx("span",{className:"text-lg font-bold text-yellow-500",children:(r=a==null?void 0:a.selectedULB)==null?void 0:r.ulb_name})]})}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>F(!1)})})})]})})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{_(""),q(!1),A(!0)},children:"Create Admin"})})}),e.jsx(wa,{open:N,setOpen:A,title:P?"Edit Admin":"Create Admin",id:C,edit:P,setEdit:q,ulbId:a==null?void 0:a.ulbId,adminListFun:t,adminListData:(l=(h=t==null?void 0:t.data)==null?void 0:h.data)==null?void 0:l.data}),e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:E,onChange:n=>m(n.target.value),className:"w-[200px] cursor-pointer rounded-md border bg-background p-2",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:b,onChange:x,placeholder:`Search by ${E}`,className:"rounded-md border p-2",maxLength:E=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Records : ",(g=(u=t==null?void 0:t.data)==null?void 0:u.data)==null?void 0:g.total]}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:j.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"User Image"}),e.jsx(k,{className:"",children:"Name"}),e.jsx(k,{className:"",children:"Mobile No"}),e.jsx(k,{className:"",children:"Alt Mobile No"}),e.jsx(k,{className:"",children:"Email"}),e.jsx(k,{className:"",children:"Address"}),e.jsx(k,{className:"",children:"Status"}),e.jsx(k,{className:"",children:"Action"})]})}),e.jsx(je,{children:(z=(o=(S=t==null?void 0:t.data)==null?void 0:S.data)==null?void 0:o.data)==null?void 0:z.map((n,i)=>e.jsxs(G,{children:[e.jsx(T,{children:v*c-c+i+1}),e.jsx(T,{children:e.jsx(We,{src:n.documentUrl,alt:n.name,className:"h-10 w-10 rounded-full border-2 object-cover"})}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.name}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.mobile}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.alternateMobile}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.email}),e.jsx(T,{className:n.suspended?"text-red-600":"text-black",children:n==null?void 0:n.address}),e.jsx(T,{children:e.jsxs(Te,{checked:n==null?void 0:n.suspended,onChange:()=>y(n.id,!n.suspended),className:`${n!=null&&n.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${n!=null&&n.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(T,{children:e.jsxs(K,{variant:"secondary",onClick:()=>{_(n==null?void 0:n.id),q(!0),A(!0)},children:[e.jsx(be,{})," Edit"]})})]},n==null?void 0:n.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Oe,{page:v,perPage:c,totalPage:(H=(Q=t==null?void 0:t.data)==null?void 0:Q.data)==null?void 0:H.total,setPage:W,setPerPage:f,hasNextPage:((ae=(I=t==null?void 0:t.data)==null?void 0:I.data)==null?void 0:ae.current_page)>=v,hasPrevPage:(le=(se=t==null?void 0:t.data)==null?void 0:se.data)==null?void 0:le.current_page})})]})})})]})})}const Ma=B().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function Aa(){var l,u,g,S,o,z,Q,H;const[a,v]=d.useState(1),[W,c]=d.useState(10),[f,M]=d.useState(!1),N=X({}),[A,C]=d.useState(!1),[_,P]=d.useState(""),[q,$]=d.useState(!1),[F,E]=d.useState(""),[L,b]=d.useState(1),[O,V]=d.useState(10),[R,m]=d.useState(!1),x=100,j=I=>{b(I)},t=I=>{V(I),b(1)},y=re({resolver:ce(Ma),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),p=async I=>{E(I.moduleId)},s=Y({api:(l=U)==null?void 0:l.getAllJuidcoUlbList,key:"ulbLists",options:{enabled:!0}});console.log((u=s==null?void 0:s.data)==null?void 0:u.data),console.log(F);const r=async(I,ae)=>{var se,le,n,i;try{const te={ulbId:I,permissionStatus:ae},J=await N.mutateAsync({api:(se=U)==null?void 0:se.ulbEnableDisable,data:te});(le=J==null?void 0:J.data)!=null&&le.status?(w.success(((n=J==null?void 0:J.data)==null?void 0:n.message)||"Permission updated successfully"),s.refetch()):w.error(((i=J==null?void 0:J.data)==null?void 0:i.message)||"Failed to update permission")}catch(te){w.error(Z(te))}},h=(S=(g=s==null?void 0:s.data)==null?void 0:g.data)==null?void 0:S.filter(I=>I.id==F);return e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx(Se,{open:R,children:e.jsx(Ce,{children:e.jsxs(pe,{className:"flex h-[90%] max-h-[90%] flex-col overflow-hidden sm:max-w-[70%]",children:[e.jsxs(we,{className:"flex justify-between border-b pb-2 text-xl font-bold text-gray-500",children:[e.jsxs("div",{children:["ULB :"," ",e.jsx("span",{className:"text-lg font-bold text-yellow-500",children:f==null?void 0:f.ulb_name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>m(!1)})})})]}),e.jsxs(sa,{defaultValue:"MENULIST",className:"flex  flex-1 flex-col overflow-hidden",children:[e.jsxs(la,{className:"grid w-auto grid-cols-3 mb-2 max-w-xl",children:[e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Permitted Modules"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"SERVICE_LIST",children:"User List"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"ADMIN_LIST",children:"Admin List"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx(Pe,{value:"MENULIST",children:e.jsx(ua,{ulbId:f==null?void 0:f.id,selectedULB:f})}),e.jsx(Pe,{value:"SERVICE_LIST",children:e.jsx(Ia,{ulbId:f==null?void 0:f.id,selectedULB:f})}),e.jsx(Pe,{value:"ADMIN_LIST",children:e.jsx(Ca,{ulbId:f==null?void 0:f.id,selectedULB:f})})]})]})]})})}),e.jsxs(oe,{children:[e.jsx(ge,{methods:y,onSubmit:y.handleSubmit(p),children:e.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[e.jsxs("div",{children:[e.jsx(aa,{htmlFor:"moduleId",children:"Module name"}),e.jsx(ea,{className:"cursor-pointer bg-background",name:"moduleId",data:((z=(o=s==null?void 0:s.data)==null?void 0:o.data)==null?void 0:z.map(I=>({value:I==null?void 0:I.id,label:I==null?void 0:I.ulb_name})))??[]})]}),e.jsx("div",{className:"mt-6 flex justify-start",children:e.jsx(Ee,{variant:"secondary",isLoading:y.formState.isSubmitting,type:"submit",className:"float-right w-auto px-10",children:"Search"})}),e.jsx("div",{className:"mt-6 flex justify-end "}),e.jsx("div",{className:"mt-6 flex justify-end ",children:e.jsx(K,{type:"button",className:"flex items-center gap-2",onClick:()=>{P(""),$(!1),C(!0)},children:"Add New"})})]})}),e.jsx(ze,{className:"px-7",children:e.jsx(Ke,{})}),e.jsx(ue,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(G,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"ULB"}),e.jsx(k,{className:"",children:"Status"}),e.jsx(k,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(H=(h==null?void 0:h.length)>0?h:(Q=s==null?void 0:s.data)==null?void 0:Q.data)==null?void 0:H.map((I,ae)=>e.jsxs(G,{children:[e.jsx(T,{children:a*W-W+ae+1}),e.jsx(T,{className:I.active_status?"text-black":"text-red-600",children:I==null?void 0:I.ulb_name}),e.jsx(T,{children:e.jsxs(Te,{checked:I==null?void 0:I.active_status,onChange:()=>r(I.id,!I.active_status),className:`${I!=null&&I.active_status?"bg-green-600":"bg-red-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${I!=null&&I.active_status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(T,{children:e.jsxs(K,{variant:"secondary",onClick:()=>{P(I==null?void 0:I.id),M(I),m(!0)},className:"ml-2",children:[e.jsx(Re,{})," View"]})})]},I==null?void 0:I.id))})]}),e.jsx(ne,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{currentPage:L,totalItems:x,itemsPerPage:O,onPageChange:j,onItemsPerPageChange:t})})]})})]})]})})}function Ja(){return e.jsx(He,{title:"ULB List",subTitle:"Control all ULB here",children:e.jsx("div",{children:e.jsx(Aa,{})})})}export{Ja as default};
