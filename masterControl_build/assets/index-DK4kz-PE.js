import{u as X,i as $,j as a,m as o,z as c,r as l,k as da,B as na}from"./index-CAjEFoKT.js";import{a as la}from"./index-D1S-7-76.js";import{C as ca,a as oa,c as ia,d as ua}from"./card-D4epNph5.js";import{S as Y,a as xa,T as pa,b as ha,c as Q,d as I,e as ja,f as h}from"./Spinner-BssXC1AG.js";import{a as Z,F as aa,B as ea,o as sa,c as ra,d as W,b as P}from"./switch-CyMtw3em.js";import"./input-CGlpwASr.js";import{g as ta}from"./services-KQnp_8oA.js";import{R as A}from"./SelectField-leHwCcXk.js";import{D as fa}from"./index-C6oDUnME.js";import{L as ma,c as ga}from"./index.es-B6EQHRhG.js";import{L as ba}from"./label-M3sJvL_e.js";import{t as Sa}from"./switch-Ci-lH2fU.js";import"./iconBase-LcP1rySH.js";const va=ra().shape({ulb_id:W().required("ulb id is required"),service_id:W().required("service id is required")});function ya({open:C,setOpen:L,title:_,edit:j,setEdit:k,serviceList:T}){var b,i,S,u,v,n,y;const D=X({}),f=Z({defaultValues:{ulb_id:0,service_id:0},resolver:sa(va)}),F=async s=>{var r,N,x,p;try{const t=await D.mutateAsync({api:(r=o)==null?void 0:r.createServiceMapping,data:s});(N=t==null?void 0:t.data)!=null&&N.success?(c.success((x=t==null?void 0:t.data)==null?void 0:x.message),L(!1),k(!1),T.refetch()):c.error((p=t==null?void 0:t.data)==null?void 0:p.message)}catch(t){c.error(ta(t))}},m=$({api:`${(b=o)==null?void 0:b.getAllJuidcoUlbList}`,key:"getAllJuidcoUlbList",options:{enabled:!0}}),g=$({api:`${(i=o)==null?void 0:i.serviceList}`,key:"serviceList",options:{enabled:!0}});return a.jsx(fa,{open:C,setOpen:L,title:_,setEdit:k,edit:j,children:a.jsx(aa,{methods:f,onSubmit:f.handleSubmit(F),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(A,{name:"service_id",data:((v=(u=(S=g==null?void 0:g.data)==null?void 0:S.data)==null?void 0:u.data)==null?void 0:v.map(s=>({value:s==null?void 0:s.id,label:s==null?void 0:s.service_name})))??[]})}),a.jsx("div",{children:a.jsx(A,{name:"ulb_id",data:((y=(n=m==null?void 0:m.data)==null?void 0:n.data)==null?void 0:y.map(s=>({value:s==null?void 0:s.id,label:s==null?void 0:s.ulb_name})))??[]})}),a.jsx(Y,{}),a.jsx("div",{children:a.jsx(ea,{isLoading:f.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const Na=ra().shape({ulbId:P(),moduleId:P(),complaintRefNo:P()});function wa(){var x,p,t,M,B,R,U,E;const[C,L]=l.useState(1),_=X({}),[j,k]=l.useState(10),[T,D]=l.useState(!1),[f,F]=l.useState(""),[m,g]=l.useState(""),[b,i]=l.useState(!1),[S]=l.useState(""),[u,v]=l.useState(!1),n=Z({resolver:sa(Na),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),y=async e=>{r==null||r.refetch()},s=da({api:(x=o)==null?void 0:x.userManagementModuleList,key:"userManagementModuleList",options:{enabled:!0}}),r=$({api:`${(p=o)==null?void 0:p.getServiceMapping}`,key:"getServiceMapping",options:{enabled:!0}}),N=async e=>{var w,q,z,H,J,V,O,G,K;try{const d=await _.mutateAsync({api:`${(w=o)==null?void 0:w.updateServiceMapping}`,data:{id:e}});(q=d==null?void 0:d.data)!=null&&q.success?(r.refetch(),((H=(z=d==null?void 0:d.data)==null?void 0:z.data)==null?void 0:H.status)==1&&c.success((J=d.data)==null?void 0:J.message),((O=(V=d==null?void 0:d.data)==null?void 0:V.data)==null?void 0:O.status)==0&&c.error((G=d.data)==null?void 0:G.message)):c.error((K=d.data)==null?void 0:K.message)}catch(d){c.error(ta(d))}};return a.jsxs("main",{className:"grid items-start",children:[T&&a.jsx("div",{style:{zIndex:1001},className:"fixed left-0 top-0 z-50 flex h-full w-full items-center justify-center bg-white",children:a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(ma,{className:"w-24",animationData:ga,loop:!0}),a.jsx("div",{className:"font-semibold",children:"Permission Updated"})]})}),a.jsx(ya,{open:b,setOpen:i,title:u?"Edit Service":"Add Service",id:S,edit:u,setEdit:v,serviceList:r}),a.jsx("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:a.jsxs(ca,{children:[a.jsx(aa,{methods:n,onSubmit:n.handleSubmit(y),children:a.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[a.jsxs("div",{children:[a.jsx(ba,{htmlFor:"moduleId",children:"Module name"}),a.jsx(A,{className:"cursor-pointer bg-background",name:"moduleId",data:((M=(t=s==null?void 0:s.data)==null?void 0:t.data)==null?void 0:M.map(e=>({value:e==null?void 0:e.id,label:e==null?void 0:e.module_name})))??[]})]}),a.jsx("div",{className:"mt-6 flex justify-start",children:a.jsx(ea,{variant:"secondary",isLoading:(B=n==null?void 0:n.formState)==null?void 0:B.isSubmitting,type:"submit",className:"float-right  w-auto px-10",children:"Search"})}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx(na,{type:"button",className:"flex items-center gap-2",onClick:()=>i(!0),children:"Add New"})})]})}),a.jsx(oa,{className:"px-7",children:a.jsx(ia,{})}),a.jsx(ua,{children:r!=null&&r.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(xa,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(pa,{children:[a.jsx(ha,{children:a.jsxs(Q,{children:[a.jsx(I,{className:"",children:"#"}),a.jsx(I,{className:"",children:"Service"}),a.jsx(I,{className:"",children:"Module"}),a.jsx(I,{className:"",children:"ULB"})]})}),a.jsx(ja,{children:(E=(U=(R=r==null?void 0:r.data)==null?void 0:R.data)==null?void 0:U.data)==null?void 0:E.map((e,w)=>a.jsxs(Q,{children:[a.jsx(h,{children:C*j-j+w+1}),a.jsx(h,{children:e==null?void 0:e.service_name}),a.jsx(h,{children:e==null?void 0:e.module_name}),a.jsx(h,{children:e==null?void 0:e.ulb_name}),a.jsx(h,{children:a.jsxs(Sa,{checked:(e==null?void 0:e.status)==1,onChange:()=>N(e==null?void 0:e.id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})})]},e==null?void 0:e.id))})]}),a.jsx(Y,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end"})]})})]})})]})}function Ra(){return a.jsx(la,{title:"JUIDCO Service Mapping",subTitle:"Control all services here",children:a.jsx("div",{children:a.jsx(wa,{})})})}export{Ra as default};
