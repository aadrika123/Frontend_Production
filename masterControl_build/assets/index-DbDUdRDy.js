import{r as t,j as e,B as L,m as R,_ as O}from"./index-B4b_osHm.js";import{a as fe}from"./index-D4Q12d4N.js";import{C as H,d as q,b as ce,a as Ne,c as be}from"./card-f_mZSNLJ.js";import{T as K,a as U,b as k,c as j,d as J,e as g,S as X}from"./separator-BgdfknP-.js";import{b as F,u as te,a as ie}from"./useCustomQuery-h_ByQs0a.js";import{S as z}from"./Spinner-DRZy3emU.js";import{a as Z,o as B,F as oe,c as ee,b as D,S as ve,B as ye}from"./SelectField-BPaJ0zWa.js";import"./input-D2046blx.js";import{L as Pe}from"./label-BmxwmphA.js";import{F as G,a as se}from"./index-CXWaoASY.js";import{P as ae}from"./index-BSJeAWBy.js";import{D as xe,a as ue,b as he}from"./dialog-CmV3NNiS.js";import{T as Se,a as Ie,b as Q,c as Y,d as pe,e as we,f as le,g as ne}from"./tabs-B_X1IXxK.js";import{g as de}from"./services-KQnp_8oA.js";import{D as Ce}from"./index-CK5Gzo2o.js";import{P as Te}from"./index-DzNImsg5.js";import{X as je}from"./x-CPTa5GzD.js";import"./createLucideIcon-DDazC7sV.js";function Ee(s){var c,l,_;const[b]=t.useState(1),[o]=t.useState(10),[v,S]=t.useState(!1),[C,p]=t.useState(""),[f,N]=t.useState(!1),[T,y]=t.useState(!1),[u,M]=t.useState(null);console.log(v,C,u,T,f);const[E,w]=t.useState(1),[I,n]=t.useState(10),a=100,P=d=>{w(d)},h=d=>{n(d),w(1)};console.log(s==null?void 0:s.ulbId);const m=F({api:(c=R)==null?void 0:c.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),x=d=>{M(d),y(!0)};return e.jsx("main",{className:"grid items-start ",children:e.jsx("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:e.jsx(H,{className:"",children:e.jsx(q,{children:m.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(z,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(k,{children:[e.jsx(j,{className:"",children:"#"}),e.jsx(j,{className:"",children:"Menu"}),e.jsx(j,{className:"",children:"Path"}),e.jsx(j,{className:"",children:"Actions"})]})}),e.jsx(J,{children:(_=(l=m==null?void 0:m.data)==null?void 0:l.data)==null?void 0:_.map((d,A)=>e.jsxs(k,{children:[e.jsx(g,{children:b*o-o+A+1}),e.jsx(g,{children:d==null?void 0:d.module_name}),e.jsx(g,{children:d==null?void 0:d.url}),e.jsxs(g,{children:[e.jsxs(L,{variant:"secondary",onClick:()=>{p(d==null?void 0:d.id),N(!0),S(!0)},children:[e.jsx(G,{})," Edit"]}),e.jsxs(L,{onClick:()=>{x(d),p(d==null?void 0:d.id)},className:"ml-2",variant:"secondary",children:[e.jsx(se,{})," View"]})]})]},d==null?void 0:d.id))})]}),e.jsx(X,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ae,{currentPage:E,totalItems:a,itemsPerPage:I,onPageChange:P,onItemsPerPageChange:h})})]})})})})})}const Me=ee().shape({service_name:D().required("menu name is required")});function ge({open:s,setOpen:b,title:o,edit:v,setEdit:S,serviceList:C,id:p,moduleId:f,roleList:N,userPermittedRoles:T,userId:y}){const u=te({}),M=te({}),E=Z({defaultValues:{service_name:""},resolver:B(Me)}),w=async n=>{var a,P,h;try{const m=v?"EditModuleList":"AddmoduleList",x=v&&p?{...n,moduleId:p}:{...n,moduleId:f},c=await u.mutateAsync({api:m,data:x});(a=c==null?void 0:c.data)!=null&&a.success?(O.success((P=c==null?void 0:c.data)==null?void 0:P.message),b(!1),S(!1),C.refetch()):O.error((h=c==null?void 0:c.data)==null?void 0:h.message)}catch(m){O.error(de(m))}},I=async(n,a)=>{var P,h,m,x;console.log(a);try{const c={userId:y,permissionStatus:a,menuRoleId:n},l=await M.mutateAsync({api:(P=R)==null?void 0:P.addMenuRoleUser,data:c});(h=l==null?void 0:l.data)!=null&&h.status?(O.success(((m=l==null?void 0:l.data)==null?void 0:m.message)||"Permission updated successfully"),T.refetch()):O.error(((x=l==null?void 0:l.data)==null?void 0:x.message)||"Failed to update permission")}catch(c){O.error(de(c))}};return e.jsx(Ce,{open:s,setOpen:b,title:o,setEdit:S,edit:v,children:e.jsx(oe,{methods:E,onSubmit:E.handleSubmit(w),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(N==null?void 0:N.map((n,a)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:a+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${n.permission_status?"text-green-600":"text-black"}`,children:n.menu_role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:n.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>I(n.id,!n.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>I(n.id,!n.permission_status),children:"Add"})})]},n.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}function Le(s){var a,P,h,m,x,c;const[b]=t.useState(1),[o]=t.useState(10),[v,S]=t.useState(!1),[C,p]=t.useState(""),[f,N]=t.useState(!1),[T,y]=t.useState(1),[u,M]=t.useState(10),E=100,w=l=>{y(l)},I=l=>{M(l),y(1)};console.log(s==null?void 0:s.ulbId);const n=F({api:(a=R)==null?void 0:a.userPermittedRoles,key:"userPermittedRoles",config:{userId:s==null?void 0:s.id},options:{enabled:!0}});return console.log((P=n==null?void 0:n.data)==null?void 0:P.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(L,{type:"button",className:"flex items-center gap-2",onClick:()=>{p(""),N(!1),S(!0)},children:"Add More Role Permission"})})}),e.jsx(ge,{open:v,setOpen:S,title:f?"Edit Menu":"Add Menu",id:C,edit:f,setEdit:N,moduleId:s==null?void 0:s.moduleId,userId:s==null?void 0:s.id,moduleName:s==null?void 0:s.moduleName,roleList:(h=n==null?void 0:n.data)==null?void 0:h.data,userPermittedRoles:n}),e.jsx(H,{className:"",children:e.jsx(q,{children:n.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(z,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(k,{children:[e.jsx(j,{className:"",children:"#"}),e.jsx(j,{className:"",children:"Menu"}),e.jsx(j,{className:"",children:"Actions"})]})}),e.jsx(J,{children:(c=(x=(m=n==null?void 0:n.data)==null?void 0:m.data)==null?void 0:x.filter(l=>(l==null?void 0:l.permission_status)==!0))==null?void 0:c.map((l,_)=>e.jsxs(k,{children:[e.jsx(g,{children:b*o-o+_+1}),e.jsx(g,{children:l==null?void 0:l.menu_role_name}),e.jsx(g,{children:e.jsxs(L,{variant:"secondary",onClick:()=>{p(l==null?void 0:l.id),N(!0),S(!0)},children:[e.jsx(G,{})," Edit"]})})]},l==null?void 0:l.id))})]}),e.jsx(X,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ae,{currentPage:T,totalItems:E,itemsPerPage:u,onPageChange:w,onItemsPerPageChange:I})})]})})})]})})}function re(s){var u,M,E,w,I,n;const[b]=t.useState(1),[o]=t.useState(10),[v,S]=t.useState(!1),[C,p]=t.useState(""),[f,N]=t.useState(!1);console.log(s==null?void 0:s.ulbId);const T=F({api:(u=R)==null?void 0:u.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),y=F({api:(M=R)==null?void 0:M.permittedWardByUser,key:"permittedWardByUser",config:{userId:s==null?void 0:s.id},options:{enabled:!0}});return console.log((E=y==null?void 0:y.data)==null?void 0:E.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(L,{type:"button",className:"flex items-center gap-2",onClick:()=>{p(""),N(!1),S(!0)},children:"Add More Ward Permission"})})}),e.jsx(ge,{open:v,setOpen:S,title:f?"Edit Menu":"Add Menu",id:C,edit:f,setEdit:N,moduleId:s==null?void 0:s.moduleId,userId:s==null?void 0:s.id,moduleName:s==null?void 0:s.moduleName}),e.jsx(H,{className:"",children:e.jsx(q,{children:T.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(z,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(k,{children:[e.jsx(j,{className:"",children:"#"}),e.jsx(j,{className:"",children:"Wards"}),e.jsx(j,{className:"",children:"Actions"})]})}),e.jsx(J,{children:(n=(I=(w=y==null?void 0:y.data)==null?void 0:w.data)==null?void 0:I.filter(a=>(a==null?void 0:a.permission_status)==!0))==null?void 0:n.map((a,P)=>e.jsxs(k,{children:[e.jsx(g,{children:b*o-o+P+1}),e.jsx(g,{children:a==null?void 0:a.ward_name}),e.jsx(g,{children:e.jsxs(L,{variant:"secondary",onClick:()=>{p(a==null?void 0:a.id),N(!0),S(!0)},children:[e.jsx(G,{})," Edit"]})})]},a==null?void 0:a.id))})]}),e.jsx(X,{className:"mb-2 mt-4"})]})})})]})})}const _e=ee().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function ke(s){var P,h,m,x,c,l,_,d,A,V,$,W;const[b,o]=t.useState(1),[v,S]=t.useState(10),[C,p]=t.useState(!1),[f,N]=t.useState(""),[T,y]=t.useState(!1),[u,M]=t.useState(!1),[E,w]=t.useState(!1);console.log(s==null?void 0:s.ulbId,C,T);const I=Z({resolver:B(_e),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),n=ie({api:`${(P=R)==null?void 0:P.serviceList}?module=${(h=I==null?void 0:I.watch())==null?void 0:h.moduleId}`,key:"serviceMasterList",options:{enabled:!0}}),a=F({api:(m=R)==null?void 0:m.userListByULBId,key:"userListByUlbId",config:{ulbId:s==null?void 0:s.ulbId,page:b,perPage:v},value:[b,v],options:{enabled:!0}});return console.log("the service maste rlist..",u==null?void 0:u.name),e.jsxs(e.Fragment,{children:[e.jsxs(xe,{open:E,children:[e.jsx(ue,{}),e.jsxs(he,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(ce,{className:"mt-4 text-xl text-gray-500  font-bold flex justify-between",children:[e.jsxs("div",{children:["User : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:u==null?void 0:u.name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(je,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>w(!1)})})})]}),e.jsxs(Se,{defaultValue:"ROLELIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsxs(Ie,{className:"grid w-auto grid-cols-3 bg-gray-100 rounded-md py-1",children:[e.jsx(Q,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"ROLELIST",children:"Permitted Roles"}),e.jsx(Q,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"PERMITTED_WARDS",children:"Permitted Wards"}),e.jsx(Q,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"PERMITTED_WORKFLOW_ROLE",children:"Permitted Workflow Role"})]})}),e.jsx(Y,{value:"ROLELIST",children:e.jsx(Le,{selectedULB:u,id:f})}),e.jsx(Y,{value:"PERMITTED_WARDS",children:e.jsx(re,{selectedULB:u,id:f})}),e.jsx(Y,{value:"PERMITTED_WORKFLOW_ROLE",children:e.jsx(re,{selectedULB:u,id:f})})]})]})]}),e.jsx("main",{className:"grid items-start",children:e.jsx("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:e.jsx(H,{children:e.jsx(q,{children:n.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(z,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(k,{children:[e.jsx(j,{className:"",children:"#"}),e.jsx(j,{className:"",children:"Name"}),e.jsx(j,{className:"",children:"Mobile No"}),e.jsx(j,{className:"",children:"Email"}),e.jsx(j,{className:"",children:"User Type"}),e.jsx(j,{className:"",children:"Address"}),e.jsx(j,{className:"",children:"Actions"})]})}),e.jsx(J,{children:(l=(c=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:c.data)==null?void 0:l.map((r,i)=>e.jsxs(k,{children:[e.jsx(g,{children:b*v-v+i+1}),e.jsx(g,{children:r==null?void 0:r.name}),e.jsx(g,{children:r==null?void 0:r.mobile}),e.jsx(g,{children:r==null?void 0:r.email}),e.jsx(g,{children:r==null?void 0:r.user_type}),e.jsx(g,{children:r==null?void 0:r.address}),e.jsxs(g,{children:[e.jsxs(L,{variant:"secondary",onClick:()=>{N(r==null?void 0:r.id),y(!0),p(!0)},children:[e.jsx(G,{})," Edit"]}),e.jsxs(L,{onClick:()=>{M(r),w(!0),N(r==null?void 0:r.id)},className:"ml-2",variant:"secondary",children:[e.jsx(se,{})," View"]})]})]},r==null?void 0:r.id))})]}),e.jsx(X,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Te,{page:b,perPage:v,totalPage:(d=(_=a==null?void 0:a.data)==null?void 0:_.data)==null?void 0:d.last_page,setPage:o,setPerPage:S,hasNextPage:((V=(A=a==null?void 0:a.data)==null?void 0:A.data)==null?void 0:V.current_page)>=b,hasPrevPage:(W=($=a==null?void 0:a.data)==null?void 0:$.data)==null?void 0:W.current_page})})]})})})})})]})}const Re=ee().shape({ulbId:D(),moduleId:D(),complaintRefNo:D()});function Ae(){var l,_,d,A,V,$,W,r;const[s]=t.useState(1),[b]=t.useState(10),[o,v]=t.useState(!1),[S,C]=t.useState(!1),[p,f]=t.useState(""),[N,T]=t.useState(!1);console.log(S,p,N);const[y,u]=t.useState(1),[M,E]=t.useState(10),[w,I]=t.useState(!1),n=100,a=i=>{u(i)},P=i=>{E(i),u(1)},h=Z({resolver:B(Re),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),m=async()=>{c==null||c.refetch()},x=F({api:(l=R)==null?void 0:l.getAllJuidcoUlbList,key:"ulbLists",options:{enabled:!0}});console.log((_=x==null?void 0:x.data)==null?void 0:_.data);const c=ie({api:`${(d=R)==null?void 0:d.serviceList}?module=${(A=h==null?void 0:h.watch())==null?void 0:A.moduleId}`,key:"serviceList",options:{enabled:!0}});return e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(xe,{open:w,children:[e.jsx(ue,{}),e.jsxs(he,{className:"sm:max-w-[1200px] h-auto max-h-[700px] overflow-scroll",children:[e.jsxs(ce,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:o==null?void 0:o.ulb_name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(je,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>I(!1)})})})]}),e.jsxs(pe,{defaultValue:"MENULIST",className:"w-full",children:[e.jsxs("div",{className:"py-4 flex justify-between",children:[e.jsxs(we,{className:"grid w-auto grid-cols-2",children:[e.jsx(le,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Permitted Modules"}),e.jsx(le,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"SERVICE_LIST",children:"User List"})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(L,{type:"button",className:"flex items-center gap-2",onClick:()=>{f(""),T(!1),C(!0)},children:"Add More Menu Permission"})})})]}),e.jsx(ne,{value:"MENULIST",children:e.jsx(Ee,{ulbId:o==null?void 0:o.id})}),e.jsx(ne,{value:"SERVICE_LIST",children:e.jsx(ke,{ulbId:o==null?void 0:o.id})})]})]})]}),e.jsxs(H,{children:[e.jsx(oe,{methods:h,onSubmit:h.handleSubmit(m),children:e.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[e.jsxs("div",{children:[e.jsx(Pe,{htmlFor:"moduleId",children:"Module name"}),e.jsx(ve,{className:"cursor-pointer bg-background",name:"moduleId",data:(($=(V=x==null?void 0:x.data)==null?void 0:V.data)==null?void 0:$.map(i=>({value:i==null?void 0:i.id,label:i==null?void 0:i.ulb_name})))??[]})]}),e.jsx("div",{className:"mt-6 flex justify-start",children:e.jsx(ye,{variant:"secondary",isLoading:h.formState.isSubmitting,type:"submit",className:"float-right w-auto px-10",children:"Search"})}),e.jsx("div",{className:"mt-6 flex justify-end "}),e.jsx("div",{className:"mt-6 flex justify-end ",children:e.jsx(L,{type:"button",className:"flex items-center gap-2",onClick:()=>{f(""),T(!1),C(!0)},children:"Add New"})})]})}),e.jsx(Ne,{className:"px-7",children:e.jsx(be,{})}),e.jsx(q,{children:c.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(z,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(k,{children:[e.jsx(j,{className:"",children:"#"}),e.jsx(j,{className:"",children:"ULB"}),e.jsx(j,{className:"",children:"Actions"})]})}),e.jsx(J,{children:(r=(W=x==null?void 0:x.data)==null?void 0:W.data)==null?void 0:r.map((i,me)=>e.jsxs(k,{children:[e.jsx(g,{children:s*b-b+me+1}),e.jsx(g,{children:i==null?void 0:i.ulb_name}),e.jsxs(g,{children:[e.jsxs(L,{variant:"secondary",onClick:()=>{f(i==null?void 0:i.id),T(!0),C(!0)},children:[e.jsx(G,{})," Edit"]}),e.jsxs(L,{variant:"secondary",onClick:()=>{f(i==null?void 0:i.id),v(i),I(!0)},className:"ml-2",children:[e.jsx(se,{})," View"]})]})]},i==null?void 0:i.id))})]}),e.jsx(X,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ae,{currentPage:y,totalItems:n,itemsPerPage:M,onPageChange:a,onItemsPerPageChange:P})})]})})]})]})})}function es(){return e.jsx(fe,{title:"ULB List",subTitle:"Control all ULB here",children:e.jsx("div",{children:e.jsx(Ae,{})})})}export{es as default};
