import{c as D,g as w,j as e,s as P,a as f,n as m}from"./index-8b0a5769.js";import{r as h,u as _}from"./router-b87f8164.js";import{c as F,a as v,u as M}from"./index.esm-913f3050.js";import{R as q}from"./Hourglass-cc0b59fa.js";import{P as B}from"./ProjectApiList-d75cf0ca.js";import{A as I}from"./ApiHeader-9bf9519f.js";import{A as p,C as i}from"./index-8eba9f0d.js";import{c as R}from"./PowerupFunctions-57110510.js";import"./react-5403e0b7.js";import"./reactQuery-8705a202.js";import"./reactQueryDevtools-9a5be7d4.js";import"./axios-096c69c8.js";const{api_login:H,api_getFreeMenuList:V}=B(),U=F({username:v().required("Enter Username"),password:v().required("Enter Password")});function ee(){const{setmenuList:j,setuserDetails:k,setheartBeatCounter:S}=h.useContext(D),[N,d]=h.useState(!1);function L(n){const a="c2ec6f788fb85720bf48c8cc7c2db572596c585a15df18583e1234f147b1c2897aad12e7bebbc4c03c765d0e878427ba6370439d38f39340d7e",t=i.enc.Latin1.parse(i.SHA256(a).toString(i.enc.Latin1)),s=i.SHA256(a).toString().substring(0,16),o=i.enc.Latin1.parse(s),l=i.AES.encrypt(n,t,{iv:o,mode:i.mode.CBC,padding:i.pad.Pkcs7});return i.enc.Base64.stringify(l.ciphertext)}const r=M({initialValues:{username:"",password:""},onSubmit:n=>{E()},validationSchema:U}),x=_();h.useEffect(()=>{w("token")!="null"&&w("token")!=null&&x("/home")},[]);const A={headers:{Accept:"application/json"}},E=n=>{d(!0);let a={email:r.values.username,password:L(r.values.password)};p.post(H,a,A).then(function(t){var s,o,l,c,u;t.data.status==!0?(P("token",(o=(s=t==null?void 0:t.data)==null?void 0:s.data)==null?void 0:o.token),f("userDetails",(c=(l=t==null?void 0:t.data)==null?void 0:l.data)==null?void 0:c.userDetails),C(),S(g=>g+1),x("/home"),m.success("Login Successfull")):(d(!1),m.error((u=t==null?void 0:t.data)==null?void 0:u.message))}).catch(function(t){d(!1),m.error("Server Error")})},C=()=>{let n={moduleId:1};p.post(V,n,I()).then(function(a){var t,s,o,l,c,u,g,b,y;a.data.status==!0?(f("menuList",(s=(t=a==null?void 0:a.data)==null?void 0:t.data)==null?void 0:s.permission),f("userDetails",(l=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:l.userDetails),j((u=(c=a==null?void 0:a.data)==null?void 0:c.data)==null?void 0:u.permission),k((b=(g=a==null?void 0:a.data)==null?void 0:g.data)==null?void 0:b.userDetails)):(d(!1),seterrorMsg(R(a.data.message)),m.error((y=a==null?void 0:a.data)==null?void 0:y.message))}).catch(function(a){d(!1),seterroState(!0),m.error("Server Error (Menu List)")})};return e.jsx(e.Fragment,{children:e.jsx("main",{className:"border h-[100vh] w-screen bg-gray-100 flex justify-center items-center p-4",children:e.jsxs("form",{onSubmit:r.handleSubmit,className:" p-4 md:p-10 py-10 md:py-16 bg-white shadow-lg w-full md:w-[25vw] animate__animated animate__slideInDown animate__faster",children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl leading-normal mb-3 font-bold text-gray-800 darks:text-gray-300 text-center",children:"Admin Login"})}),e.jsx("hr",{className:"block w-12 h-0.5 mx-auto my-5 bg-gray-700 border-gray-700"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"inputemail",className:"inline-block mb-2",children:"Username"}),e.jsx("input",{...r.getFieldProps("username"),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600",defaultValue:!0,"aria-label":"email",type:"email",required:!0}),e.jsx("span",{className:"text-red-600",children:r.touched.username&&r.errors.username?r.errors.username:null})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex flex-wrap flex-row",children:e.jsx("div",{className:"flex-shrink max-w-full w-1/2",children:e.jsx("label",{htmlFor:"inputpass",className:"inline-block mb-2",children:"Password"})})}),e.jsx("input",{...r.getFieldProps("password"),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600","aria-label":"password",type:"password",defaultValue:!0,required:!0}),e.jsx("span",{className:"text-red-600",children:r.touched.password&&r.errors.password?r.errors.password:null})]}),e.jsx("div",{className:"grid",children:N?e.jsx("div",{className:"flex justify-center",children:e.jsx(q,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsxs("button",{type:"submit",className:"py-2 px-4 inline-block text-center rounded leading-normal text-gray-100 bg-indigo-500 border border-indigo-500 hover:text-white hover:bg-indigo-600 hover:ring-0 hover:border-indigo-600 focus:bg-indigo-600 focus:border-indigo-600 focus:outline-none focus:ring-0",children:[e.jsxs("svg",{xmlnsXlink:"http://www.w3.org/2000/svg",fill:"currentColor",className:"inline-block w-4 h-4 ltr:mr-2 rtl:ml-2 bi bi-box-arrow-in-right",viewBox:"0 0 16 16",children:[e.jsx("path",{fillRule:"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),e.jsx("path",{fillRule:"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})]}),"Login"]})})]})})})}export{ee as default};
