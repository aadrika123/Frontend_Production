import{r as x,N as S,j as e}from"./index-5jE5k8l3.js";import{a as $}from"./useCustomQuery-Bh1LdxlD.js";import{P as W}from"./index-B07AlrGf.js";const T=()=>{const[g,y]=x.useState(""),[h,f]=x.useState("all"),[b,v]=x.useState(new Set),[p,w]=x.useState(new Set),[j,u]=x.useState("compact"),{data:m,isLoading:C}=$({api:S.roleCountByModule,key:"roleCountByModule",config:{},options:{enabled:!0}}),d=(m==null?void 0:m.data)||[],L=x.useMemo(()=>{let s=d||[];return h!=="all"&&(s=s.filter(r=>(r==null?void 0:r.moduleName)===h)),g&&(s=s.map(r=>{var c;return{...r,ulbs:((c=r==null?void 0:r.ulbs)==null?void 0:c.filter(l=>{var t,n;return((t=l==null?void 0:l.ulbName)==null?void 0:t.toLowerCase().includes(g.toLowerCase()))||((n=l==null?void 0:l.userCount)==null?void 0:n.some(i=>{var a;return(a=i==null?void 0:i.roleName)==null?void 0:a.toLowerCase().includes(g.toLowerCase())}))}))||[]}}).filter(r=>{var c;return(((c=r==null?void 0:r.ulbs)==null?void 0:c.length)||0)>0})),s},[d,g,h]),N=s=>{const r=new Set(p);r.has(s)?r.delete(s):r.add(s),w(r)},M=s=>{const r=new Set(b);r.has(s)?r.delete(s):r.add(s),v(r)},U=new Set((d||[]).flatMap(s=>((s==null?void 0:s.ulbs)||[]).map(r=>r==null?void 0:r.ulbName).filter(Boolean))).size;if(C)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx("div",{className:"text-lg",children:"Loading..."})});const B=({role:s,index:r})=>e.jsxs("div",{className:"flex items-center justify-between rounded px-3 py-2 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.roleName}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:s.count})]});return e.jsx(W,{title:"ULB Modules Users",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-gray-900 dark:to-gray-800",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold text-gray-900 dark:text-white",children:"ULB Modules Users"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["User role counts across ",(d==null?void 0:d.length)||0," modules and"," ",U," ULBs"]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative min-w-64 flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search ULBs or roles...",value:g,onChange:s=>y(s.target.value),className:"w-full rounded-lg border border-gray-300 py-2 pl-10 pr-4 focus:border-transparent focus:ring-2 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("select",{value:h,onChange:s=>f(s.target.value),className:"rounded-lg border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Modules"}),(d||[]).map(s=>e.jsx("option",{value:(s==null?void 0:s.moduleName)||"",children:(s==null?void 0:s.moduleName)||"Unknown Module"},(s==null?void 0:s.moduleName)||"unknown"))]}),e.jsxs("div",{className:"flex rounded-lg border border-gray-300 dark:border-gray-600",children:[e.jsx("button",{onClick:()=>u("compact"),className:`px-3 py-2 text-sm ${j==="compact"?"bg-indigo-600 text-white":"bg-white text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:"Compact"}),e.jsx("button",{onClick:()=>u("grid"),className:`px-3 py-2 text-sm ${j==="grid"?"bg-indigo-600 text-white":"bg-white text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:"Grid"})]})]}),e.jsx("div",{className:"space-y-4",children:(L||[]).map(s=>{var l;const r=b.has((s==null?void 0:s.moduleName)||""),c=((s==null?void 0:s.ulbs)||[]).reduce((t,n)=>t+(((n==null?void 0:n.userCount)||[]).reduce((i,a)=>i+((a==null?void 0:a.count)||0),0)||0),0);return e.jsxs("div",{className:"rounded-lg bg-white shadow dark:bg-gray-800",children:[e.jsxs("div",{className:"flex cursor-pointer items-center justify-between rounded-t-lg bg-gradient-to-r from-blue-600 to-purple-600 p-4 hover:from-blue-700 hover:to-purple-700",onClick:()=>M((s==null?void 0:s.moduleName)||""),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[r?e.jsx("svg",{className:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):e.jsx("svg",{className:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),e.jsx("h2",{className:"text-lg font-semibold uppercase text-white",children:(s==null?void 0:s.moduleName)||"Unknown Module"})]}),e.jsxs("span",{className:"text-base font-semibold text-blue-100",children:["(",((l=s==null?void 0:s.ulbs)==null?void 0:l.length)||0," ULBs, ",c," users)"]})]}),!r&&e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:j==="compact"?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.ulbs.map(t=>{const n=`${s.moduleName}-${t.ulbName}`,i=p.has(n);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-3 flex cursor-pointer items-center justify-between rounded bg-gray-100 p-2 hover:bg-gray-50 dark:bg-gray-600 dark:hover:bg-gray-700",onClick:()=>N(n),children:[e.jsxs("div",{className:"flex items-center space-x-2 ",children:[i?e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),e.jsxs("h3",{className:"block  font-medium text-blue-600 dark:text-blue-500",children:[t.ulbName," "]})]}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-300 text-right",children:["(",t.userCount.reduce((a,o)=>a+o.count,0)," ","users)"]})]}),!i&&e.jsx("div",{className:"grid grid-cols-1 gap-x-6 md:grid-cols-2 lg:grid-cols-3",children:t.userCount.map((a,o)=>e.jsx(B,{role:a,index:o},`${a.roleName}-${o}`))})]},t.ulbName)})}):e.jsx("div",{className:"p-4",children:s.ulbs.map(t=>{const n=`${s.moduleName}-${t.ulbName}`,i=p.has(n),a=t.userCount.reduce((o,k)=>o+k.count,0);return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-3 flex cursor-pointer items-center justify-between rounded bg-gray-100 p-2 hover:bg-gray-50 dark:bg-gray-600 dark:hover:bg-gray-700",onClick:()=>N(n),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[i?e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),e.jsx("h3",{className:"font-medium text-blue-600 dark:text-blue-400",children:t.ulbName})]}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["(",a," users)"]})]}),!i&&e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.userCount.map((o,k)=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-600 dark:bg-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:o.roleName}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.count})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-indigo-100 dark:bg-indigo-900",children:e.jsx("svg",{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})},`${o.roleName}-${k}`))})]},t.ulbName)})})})]},(s==null?void 0:s.moduleName)||"unknown")})})]})})})};export{T as default};
