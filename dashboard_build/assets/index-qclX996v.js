import{r as o,N as U,j as e}from"./index-CMOwcSn-.js";import{a as B}from"./useCustomQuery-I_wYvlCi.js";import{P as S}from"./index-BfCUF2u3.js";const A=()=>{const[i,j]=o.useState(""),[c,y]=o.useState("all"),[h,N]=o.useState(new Set),[p,k]=o.useState(new Set),[m,b]=o.useState("compact"),{data:u,isLoading:f}=B({api:U.roleCountByModule,key:"roleCountByModule",config:{},options:{enabled:!0}}),n=(u==null?void 0:u.data)||[],v=o.useMemo(()=>{let s=n;return c!=="all"&&(s=s.filter(r=>r.moduleName===c)),i&&(s=s.map(r=>({...r,ulbs:r.ulbs.filter(x=>x.ulbName.toLowerCase().includes(i.toLowerCase())||x.userCount.some(t=>t.roleName.toLowerCase().includes(i.toLowerCase())))})).filter(r=>r.ulbs.length>0)),s},[n,i,c]),w=s=>{const r=new Set(p);r.has(s)?r.delete(s):r.add(s),k(r)},C=s=>{const r=new Set(h);r.has(s)?r.delete(s):r.add(s),N(r)},L=new Set(n.flatMap(s=>s.ulbs.map(r=>r.ulbName))).size;if(f)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx("div",{className:"text-lg",children:"Loading..."})});const M=({role:s,index:r})=>e.jsxs("div",{className:"flex items-center justify-between rounded px-3 py-2 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.roleName}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:s.count})]});return e.jsx(S,{title:"ULB Modules Users",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-gray-900 dark:to-gray-800",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold text-gray-900 dark:text-white",children:"ULB Modules Users"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["User role counts across ",n.length," modules and"," ",L," ULBs"]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative min-w-64 flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search ULBs or roles...",value:i,onChange:s=>j(s.target.value),className:"w-full rounded-lg border border-gray-300 py-2 pl-10 pr-4 focus:border-transparent focus:ring-2 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("select",{value:c,onChange:s=>y(s.target.value),className:"rounded-lg border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Modules"}),n.map(s=>e.jsx("option",{value:s.moduleName,children:s.moduleName},s.moduleName))]}),e.jsxs("div",{className:"flex rounded-lg border border-gray-300 dark:border-gray-600",children:[e.jsx("button",{onClick:()=>b("compact"),className:`px-3 py-2 text-sm ${m==="compact"?"bg-indigo-600 text-white":"bg-white text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:"Compact"}),e.jsx("button",{onClick:()=>b("grid"),className:`px-3 py-2 text-sm ${m==="grid"?"bg-indigo-600 text-white":"bg-white text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:"Grid"})]})]}),e.jsx("div",{className:"space-y-4",children:v.map(s=>{const r=h.has(s.moduleName),x=s.ulbs.reduce((t,a)=>t+a.userCount.reduce((l,d)=>l+d.count,0),0);return e.jsxs("div",{className:"rounded-lg bg-white shadow dark:bg-gray-800",children:[e.jsx("div",{className:"rounded-t-lg flex cursor-pointer items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700",onClick:()=>C(s.moduleName),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[r?e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),e.jsx("h2",{className:"text-lg font-semibold uppercase text-gray-900 dark:text-white",children:s.moduleName}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",s.ulbs.length," ULBs, ",x," users)"]})]})}),!r&&e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:m==="compact"?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.ulbs.map(t=>{const a=`${s.moduleName}-${t.ulbName}`,l=p.has(a);return e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex cursor-pointer items-center justify-between mb-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded p-2",onClick:()=>w(a),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[l?e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white",children:[t.ulbName," (",t.userCount.reduce((d,g)=>d+g.count,0)," users)"]})]})}),!l&&e.jsx("div",{className:"grid grid-cols-1 gap-x-6 md:grid-cols-2 lg:grid-cols-3",children:t.userCount.map((d,g)=>e.jsx(M,{role:d,index:g},`${d.roleName}-${g}`))})]},t.ulbName)})}):e.jsx("div",{className:"p-4",children:s.ulbs.map(t=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"mb-3 font-medium text-gray-900 dark:text-white",children:t.ulbName}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.userCount.map((a,l)=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-600 dark:bg-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:a.roleName}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.count})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-indigo-100 dark:bg-indigo-900",children:e.jsx("svg",{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})},`${a.roleName}-${l}`))})]},t.ulbName))})})]},s.moduleName)})})]})})})};export{A as default};
