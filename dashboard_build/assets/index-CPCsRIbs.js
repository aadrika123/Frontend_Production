import{r as n,j as e,c as x,a5 as X,B as w,a6 as Y}from"./index-CMOwcSn-.js";import{c as D}from"./useCustomQuery-I_wYvlCi.js";import{c as p,P as ee}from"./index-BfCUF2u3.js";const te=p("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const S=p("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const H=p("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const F=p("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const L=p("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const se=p("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const ie=p("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);const ae=p("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const re=p("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const ne=p("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);const oe=p("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),k=n.forwardRef(({className:s,...i},a)=>e.jsx("div",{ref:a,className:x("rounded-xl border bg-card text-card-foreground shadow",s),...i}));k.displayName="Card";const v=n.forwardRef(({className:s,...i},a)=>e.jsx("div",{ref:a,className:x("flex flex-col space-y-1.5 p-6",s),...i}));v.displayName="CardHeader";const M=n.forwardRef(({className:s,...i},a)=>e.jsx("h3",{ref:a,className:x("font-semibold leading-none tracking-tight",s),...i}));M.displayName="CardTitle";const le=n.forwardRef(({className:s,...i},a)=>e.jsx("p",{ref:a,className:x("text-sm text-muted-foreground",s),...i}));le.displayName="CardDescription";const b=n.forwardRef(({className:s,...i},a)=>e.jsx("div",{ref:a,className:x("p-6 pt-0",s),...i}));b.displayName="CardContent";const ce=n.forwardRef(({className:s,...i},a)=>e.jsx("div",{ref:a,className:x("flex items-center p-6 pt-0",s),...i}));ce.displayName="CardFooter";var de=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],pe=de.reduce((s,i)=>{const a=X(`Primitive.${i}`),l=n.forwardRef((c,h)=>{const{asChild:m,...g}=c,d=m?a:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...g,ref:h})});return l.displayName=`Primitive.${i}`,{...s,[i]:l}},{}),he="Separator",I="horizontal",me=["horizontal","vertical"],$=n.forwardRef((s,i)=>{const{decorative:a,orientation:l=I,...c}=s,h=xe(l)?l:I,g=a?{role:"none"}:{"aria-orientation":h==="vertical"?h:void 0,role:"separator"};return e.jsx(pe.div,{"data-orientation":h,...g,...c,ref:i})});$.displayName=he;function xe(s){return me.includes(s)}var q=$;const U=n.forwardRef(({className:s,orientation:i="horizontal",decorative:a=!0,...l},c)=>e.jsx(q,{ref:c,decorative:a,orientation:i,className:x("shrink-0 bg-border",i==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...l}));U.displayName=q.displayName;function ge(){var P,E,O;const[s,i]=n.useState([]),[a,l]=n.useState(!1),[c,h]=n.useState(null),[m,g]=n.useState(!0),[d,j]=n.useState(null),[A,R]=n.useState(null),r=D({api:Y.healthCheck,key:"health check api",options:{enabled:!0,refetchInterval:m?15e3:!1}}),W=t=>({property:{category:"Property",priority:"high",description:"Property management"},water:{category:"Utilities",priority:"critical",description:"Water services"},trade:{category:"Commerce",priority:"high",description:"Trade license"},menu:{category:"Frontend",priority:"medium",description:"Menu service"},payment:{category:"Payment",priority:"critical",description:"Payment gateway"},grievance:{category:"Support",priority:"high",description:"Grievance system"},dashboard:{category:"Frontend",priority:"critical",description:"Main dashboard"},citizen:{category:"Citizens",priority:"critical",description:"Citizen portal"},finance:{category:"Finance",priority:"critical",description:"Finance system"},hrms:{category:"HR",priority:"high",description:"HR management"},fines:{category:"Legal",priority:"high",description:"Fines system"}})[t]??{category:"Other",priority:"medium",description:"Service"},z=t=>{var o;return(o=t==null?void 0:t.original)!=null&&o.services?Object.entries(t.original.services).map(([u,f],J)=>{const N=W(u),Q=f.response_time?Number(f.response_time.replace(" ms","")):null,C=f.status==="UP"?"online":"offline";return{id:J+1,name:u.replace(/-/g," ").toUpperCase(),url:f.url,category:N.category,priority:N.priority,description:N.description,status:C,responseTime:Q,uptime:C==="online"?+(Math.random()*5+95).toFixed(1):+(Math.random()*30+70).toFixed(1),lastChecked:new Date,statusMessage:C==="online"?`HTTP ${f.response_code} OK`:`HTTP ${f.response_code} Error`}}):[]};n.useEffect(()=>{var t;if(r){if(r.isError){R(((t=r.error)==null?void 0:t.message)??"Health check failed"),i(o=>o.map(u=>({...u,status:"offline",statusMessage:"Health check failed",lastChecked:new Date})));return}r.isSuccess&&r.data&&(R(null),i(z(r.data)),h(new Date))}},[r.isError,r.isSuccess,(P=r.error)==null?void 0:P.message]),n.useEffect(()=>{r!=null&&r.isSuccess&&r.data&&(i(z(r.data)),h(new Date))},[(O=(E=r==null?void 0:r.data)==null?void 0:E.original)==null?void 0:O.services]);const _=n.useCallback(async()=>{l(!0),i(t=>t.map(o=>({...o,status:"checking",statusMessage:"Checking..."}))),await r.refetch(),l(!1)},[r.refetch]),T=s.filter(t=>t.status==="online").length,B=s.filter(t=>t.status==="offline").length,G=s.filter(t=>t.status==="checking").length,V=n.useMemo(()=>{const t=s.filter(o=>o.responseTime!==null);return t.length?t.reduce((o,u)=>o+(u.responseTime??0),0)/t.length:0},[s]),Z=d?s.filter(t=>t.status===d):s,K=t=>t==="online"?e.jsx(H,{className:"text-green-500"}):t==="offline"?e.jsx(S,{className:"text-red-500"}):t==="checking"?e.jsx(F,{className:"animate-spin text-yellow-500"}):e.jsx(L,{});return e.jsx(ee,{children:e.jsx("div",{className:"min-h-screen p-6",children:e.jsxs("div",{className:"mx-auto max-w-[1600px] space-y-6",children:[e.jsx(k,{children:e.jsxs(v,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-primary p-4",children:e.jsx(te,{className:"text-white"})}),e.jsxs("div",{children:[e.jsx(M,{className:"text-3xl",children:"System Health Monitor"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time monitoring"}),A&&e.jsxs("p",{className:"flex items-center gap-2 text-red-500",children:[e.jsx(S,{size:16})," ",A]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(w,{onClick:()=>g(!m),variant:m?"default":"outline",children:[m?e.jsx(ne,{}):e.jsx(re,{})," Auto Scan"]}),e.jsxs(w,{onClick:_,disabled:a,children:[e.jsx(se,{className:a?"animate-spin":""}),a?"Scanning":"Rescan"]}),e.jsx(w,{variant:"outline",size:"icon",children:e.jsx(ae,{})})]})]})}),e.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[e.jsx(y,{title:"Total",value:s.length,icon:e.jsx(ie,{}),isActive:d===null,onClick:()=>j(null)}),e.jsx(y,{title:"Online",value:T,icon:e.jsx(H,{}),isActive:d==="online",onClick:()=>j(d==="online"?null:"online")}),e.jsx(y,{title:"Offline",value:B,icon:e.jsx(S,{}),isActive:d==="offline",onClick:()=>j(d==="offline"?null:"offline")}),e.jsx(y,{title:"Checking",value:G,icon:e.jsx(F,{}),isActive:d==="checking",onClick:()=>j(d==="checking"?null:"checking")}),e.jsx(y,{title:"Avg Resp",value:`${Math.round(V)}ms`,icon:e.jsx(oe,{})}),e.jsx(y,{title:"Health",value:`${Math.round(T/(s.length||1)*100)}%`,icon:e.jsx(L,{})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:Z.map((t,o)=>e.jsxs(k,{children:[e.jsxs(v,{className:"flex flex-row justify-between",children:[e.jsxs(M,{children:[e.jsxs("span",{className:"mr-2 text-muted-foreground font-bold",children:[o+1,"."]}),t.name]}),K(t.status)]}),e.jsxs(b,{className:"space-y-2",children:[e.jsx("p",{className:"text-muted-foreground",children:t.description}),e.jsx(U,{}),e.jsxs("p",{children:["Status: ",e.jsx("strong",{children:t.status})]}),e.jsxs("p",{children:["Response: ",t.responseTime??"-"," ms"]}),e.jsxs("p",{children:["Uptime: ",e.jsx("strong",{children:"NA%"})]}),e.jsx("p",{className:"break-all font-mono text-xs",children:t.url})]})]},t.id))}),e.jsxs("p",{className:"text-center text-muted-foreground",children:["Last Scan: ",(c==null?void 0:c.toLocaleTimeString())||"Initializing..."]})]})})})}function y({title:s,value:i,icon:a,isActive:l,onClick:c}){return e.jsxs(k,{onClick:c,className:`cursor-pointer transition-all hover:shadow-md ${l?"shadow-md ring-2 ring-primary":""}`,children:[e.jsxs(v,{className:"flex flex-row justify-between pb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s}),a]}),e.jsx(b,{children:e.jsx("p",{className:"text-2xl font-bold",children:i})})]})}export{ge as default};
