import{r as e,y as r,j as t,af as i,aD as a,al as s,ai as l,aE as o,A as d,z as n}from"./vendor-BYEve7Lm.js";import{c,a as u,d as m}from"./yup-rnfMwIpx.js";import{F as p,R as b,B as h}from"./datetime-picker-CVy54M0Q.js";import{d as x}from"./index-D-WK3WBg.js";import{g}from"./services-Bn_cfjy0.js";import"./select-64z5B__J.js";import"./input-rV9H863X.js";import"./switch-C2b8-GuS.js";import"./label-DkEWzZ9r.js";import{u as v}from"./useCustomQuery-BqJuBb9h.js";import{D as j}from"./index-CQ_yaZx1.js";import{X as y}from"./icons-Z8aKJdqm.js";const N=c().shape({id:u().nullable(),ulbName:u().required("Ulb Name is required"),ulbType:u().required("Ulb Type is required"),remarks:u().nullable(),cityId:m().typeError("City Id must be a number").required("City Id is required"),incorporationDate:u().required("Incorporation Date is required"),departmentId:m().typeError("Department Id must be a number").required("Department Id is required"),districtCode:u().required("District Code is required"),category:u().required("Category is required"),code:u().required("Code is required"),shortName:u().required("Short Name is required"),tollFreeNo:u().required("Toll Free No is required"),currentWebsite:u().url("Enter a valid URL").required("Current Website is required"),parentWebsite:u().url("Enter a valid URL").required("Parent Website is required"),email:u().email("Enter a valid email").required("Email is required"),mobileNo:u().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile No is required"),stateId:m().typeError("State ID must be a number").required("State ID is required"),districtId:m().typeError("District ID must be a number").required("District ID is required"),associationWith:u().required("Association With is required"),latitude:u().required("Latitude is required"),longitude:u().required("Longitude is required"),ulb_logo:u().nullable()});function f({open:c,setOpen:u,title:m,edit:f,setEdit:q,editData:I,refetch:D}){const C=v({}),[_,W]=e.useState(null),w=r({defaultValues:{id:"",ulbName:"",ulbType:"",remarks:"",cityId:void 0,incorporationDate:"",departmentId:void 0,districtCode:"",category:"",code:"",shortName:"",tollFreeNo:"",currentWebsite:"",parentWebsite:"",email:"",mobileNo:"",stateId:void 0,districtId:void 0,associationWith:"",latitude:"",longitude:""},resolver:d(N)}),{reset:U}=w;e.useEffect(()=>{c&&U(f&&I?{id:(null==I?void 0:I.id)||"",ulbName:(null==I?void 0:I.ulb_name)||"",ulbType:(null==I?void 0:I.ulb_type)||"",remarks:(null==I?void 0:I.remarks)||"",cityId:Number(null==I?void 0:I.city_id)||0,incorporationDate:(null==I?void 0:I.incorporation_date)||"",departmentId:Number(null==I?void 0:I.department_id)||0,districtCode:(null==I?void 0:I.district_code)||"",category:(null==I?void 0:I.category)||"",code:(null==I?void 0:I.code)||"",shortName:(null==I?void 0:I.short_name)||"",tollFreeNo:(null==I?void 0:I.toll_free_no)||"",currentWebsite:(null==I?void 0:I.current_website)||"",parentWebsite:(null==I?void 0:I.parent_website)||"",email:(null==I?void 0:I.email)||"",mobileNo:(null==I?void 0:I.mobile_no)||"",stateId:Number(null==I?void 0:I.state_id)||0,districtId:Number(null==I?void 0:I.district_id)||0,associationWith:(null==I?void 0:I.association_with)||"",latitude:(null==I?void 0:I.latitude)||"",longitude:(null==I?void 0:I.longitude)||""}:{id:"",ulbName:"",ulbType:"",remarks:"",cityId:void 0,incorporationDate:"",departmentId:void 0,districtCode:"",category:"",code:"",shortName:"",tollFreeNo:"",currentWebsite:"",parentWebsite:"",email:"",mobileNo:"",stateId:void 0,districtId:void 0,associationWith:"",latitude:"",longitude:""})},[c,f,I,U]);const[k,E]=e.useState(""),L=e.useRef(null);return e.useEffect(()=>{(null==I?void 0:I.ulb_logo)&&E(I.ulb_logo)},[I,c]),t.jsx(j,{open:c,setOpen:u,title:m,setEdit:q,edit:f,children:t.jsx("div",{className:"p-1",children:t.jsx(p,{methods:w,onSubmit:w.handleSubmit(async e=>{var r,t,i,a,s;const l=new FormData;Object.entries(e).forEach(([e,r])=>{l.append(e,r)}),_&&l.append("ulb_logo",_);try{const e=f?null==(r=x)?void 0:r.api_updateUlb:null==(t=x)?void 0:t.api_PostUlb,o=await C.mutateAsync({api:e,data:l});(null==(i=null==o?void 0:o.data)?void 0:i.status)?(n.success((null==(a=null==o?void 0:o.data)?void 0:a.message)||(f?"ULB Account updated successfully":"ULB Account created successfully")),u(!1),q&&q(!1),D()):n.error((null==(s=null==o?void 0:o.data)?void 0:s.message)||"Something went wrong")}catch(o){n.error(g(o))}}),children:t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx("div",{className:"max-h-[60vh] overflow-y-auto px-1",children:t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[t.jsx(i,{className:"text-primary"})," Basic Information"]}),t.jsx(b,{label:"Ulb Name",name:"ulbName",placeholder:"e.g. Deoghar Municipal Corporation"}),t.jsx(b,{label:"Ulb Type",name:"ulbType",placeholder:"e.g. Municipal Corporation"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(b,{label:"Short Name",name:"shortName",placeholder:"DMC"}),t.jsx(b,{label:"Code",name:"code",placeholder:"e.g. DMC001"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(b,{label:"Category",name:"category",placeholder:"e.g. Urban"}),t.jsx(b,{label:"City Id",name:"cityId",type:"number",placeholder:"12"})]}),t.jsx(b,{label:"Incorporation Date",name:"incorporationDate",type:"date"}),t.jsxs("div",{className:"flex flex-col gap-1 ",children:[t.jsx("label",{className:"text-sm",htmlFor:"ulb_logo",children:"Upload Image"}),t.jsx("input",{name:"ulb_logo",type:"file",className:"text-sm bg-secondary py-1.5 rounded-md px-3",onChange:e=>{var r;const t=null==(r=e.target.files)?void 0:r[0];if(t){const e=URL.createObjectURL(t);W(t),E(e)}else(null==I?void 0:I.ulb_logo)&&E(I.ulb_logo)},ref:L})]}),k&&t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:k,alt:"Preview",style:{width:"200px",marginTop:"10px"}}),t.jsx("span",{onClick:()=>{E(""),L.current&&(L.current.value="")},className:"absolute right-10 top-0 flex h-6 w-6 cursor-pointer items-center justify-center rounded-full bg-red-300 transition-all ease-in-out hover:bg-red-400",children:t.jsx(y,{className:"p-0.5 text-gray-600"})})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[t.jsx(a,{className:"text-primary"})," Remarks & Info"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(b,{label:"Remarks",name:"remarks",placeholder:"Special notes..."}),t.jsx(b,{label:"Association With",name:"associationWith",placeholder:"State Government"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[t.jsx(s,{className:"text-primary"})," Contact & Web"]}),t.jsx(b,{label:"Email Address",name:"email",placeholder:"contact@deoghar.gov.in"}),t.jsx(b,{label:"Mobile No",name:"mobileNo",placeholder:"9876543210"}),t.jsx(b,{label:"Toll Free No",name:"tollFreeNo",placeholder:"1800123456"}),t.jsx(b,{label:"Current Website",name:"currentWebsite",placeholder:"https://deoghar.gov.in"}),t.jsx(b,{label:"Parent Website",name:"parentWebsite",placeholder:"https://jharkhand.gov.in"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[t.jsx(l,{className:"text-primary"})," Regional Information"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(b,{label:"State ID",name:"stateId",type:"number",placeholder:"20"}),t.jsx(b,{label:"District ID",name:"districtId",type:"number",placeholder:"5"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(b,{label:"District Code",name:"districtCode",placeholder:"e.g. DGHR"}),t.jsx(b,{label:"Dept Id",name:"departmentId",type:"number",placeholder:"3"})]})]}),t.jsxs("div",{className:"space-y-4 md:col-span-2",children:[t.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[t.jsx(o,{className:"text-primary"})," Location Coordinates"]}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[t.jsx(b,{label:"Latitude",name:"latitude",placeholder:"24.4850"}),t.jsx(b,{label:"Longitude",name:"longitude",placeholder:"86.6950"})]})]})]})}),t.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:t.jsx(h,{isLoading:w.formState.isSubmitting,type:"submit",className:"h-12 rounded-xl bg-primary px-10 text-sm font-bold text-primary-foreground shadow-lg shadow-primary/25 transition-all hover:bg-primary/95 hover:shadow-xl active:scale-[0.98]",children:f?"Update ULB Account":"Create ULB Account"})})]})})})})}export{f as C};
