import{r as e,y as s,b5 as a,j as i,J as t,bi as n,X as d,Y as r,am as l,an as c,Z as o,bc as u,bj as m}from"./vendor-D8EavInP.js";import{C as x,a as h,D as p,e as g,f as j,g as v,P as f}from"./card-D9KSG9du.js";import{d as N,b as y}from"./index-DkV-K92L.js";import{u as b,a as _}from"./useCustomQuery-CDyLuuCr.js";import{L as k}from"./label-BCyDt2Ps.js";import{I as w}from"./input-E4qDHzT4.js";import{S}from"./switch-DYOXjAR0.js";import{T as C,a as H,b as A,c as L,d as M,e as D}from"./table-LRjUu_pZ.js";import{S as q}from"./Spinner-DVulOLCZ.js";import"./icons-B7NtgHiY.js";import"./ui-BhL1dNIh.js";import"./query-DU6DGVMZ.js";import"./axios-Dos3PyFQ.js";import"./zustand-q0JsXtuM.js";const F={id:"",heading:""},P={id:"",description:"",user_manual_link:"",video_link:"",headingId:""};function I(){var f;const[I,U]=e.useState(null),[z,E]=e.useState(!1),[V,B]=e.useState(!1),[$,O]=e.useState(!1),[T,J]=e.useState(!1),[Q,X]=e.useState(null),[Y,Z]=e.useState(null),G=s({defaultValues:F}),K=s({defaultValues:P}),R=b({}),W=_({api:N.api_getHeadingApiList,key:"userManualList",options:{enabled:!0}}),ee=(null==(f=null==W?void 0:W.data)?void 0:f.data)||[],se=_({api:N.api_getHeadingById,key:`headingById_${Q??""}`,config:{id:Q},options:{enabled:!!Q&&V&&z}}),ae=_({api:N.api_getHeadingDescriptionById,key:`descById_${Y??""}`,config:{id:Y},options:{enabled:!!Y&&T&&$}});e.useEffect(()=>{var e;if(!z||!V)return;const s=null==(e=null==se?void 0:se.data)?void 0:e.data;if(!s)return;const a=Array.isArray(s)?s[0]:s;a&&G.reset({id:String(a.id)||"",heading:a.heading||""})},[z,V,null==se?void 0:se.data,G]),e.useEffect(()=>{var e;if(!$||!T)return;const s=null==(e=null==ae?void 0:ae.data)?void 0:e.data;if(!s)return;const a=Array.isArray(s)?s[0]:s;a&&K.reset({id:String(a.description_id)||"",description:a.description||"",user_manual_link:a.user_manual_link||"",video_link:a.video_link||"",headingId:String(a.heading_id)||""})},[$,T,null==ae?void 0:ae.data,K]);const ie=G.handleSubmit(async e=>{var s,i,t;try{const n=await R.mutateAsync({api:V?N.api_updateHeadingApi:N.api_PostHeadingApi,data:V?{id:Q,heading:e.heading}:{heading:e.heading}});(null==(s=null==n?void 0:n.data)?void 0:s.status)?(a.success((null==(i=null==n?void 0:n.data)?void 0:i.message)||(V?"Heading updated successfully":"Heading created successfully")),E(!1),B(!1),X(null),G.reset(F),W.refetch()):a.error((null==(t=null==n?void 0:n.data)?void 0:t.message)||"Failed to save heading")}catch(n){a.error("Something went wrong.")}}),te=K.handleSubmit(async e=>{var s,i,t;try{const n=await R.mutateAsync({api:T?N.api_updateHeadingDescriptionApi:N.api_PostHeadingDescriptionApi,data:T?{id:Y,description:e.description,user_manual_link:e.user_manual_link,video_link:e.video_link}:{headingId:Q,description:e.description,user_manual_link:e.user_manual_link,video_link:e.video_link}});(null==(s=null==n?void 0:n.data)?void 0:s.status)?(a.success((null==(i=null==n?void 0:n.data)?void 0:i.message)||(T?"Description updated successfully":"Description created successfully")),O(!1),J(!1),Z(null),K.reset(P),W.refetch()):a.error((null==(t=null==n?void 0:n.data)?void 0:t.message)||"Failed to save description")}catch(n){a.error("Something went wrong.")}});return i.jsxs("div",{children:[i.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:i.jsxs(x,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[i.jsx("div",{className:"border-b bg-muted/30 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-orange-600/10 text-orange-600",children:i.jsx(n,{className:"h-6 w-6"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-foreground",children:"User Manual"}),i.jsxs("div",{className:"inline-block rounded-full bg-orange-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-orange-600",children:[null==ee?void 0:ee.length," Headings Found"]})]})]}),i.jsxs(y,{type:"button",onClick:()=>E(!0),className:"flex items-center gap-2 bg-primary shadow-md transition-all hover:bg-primary/90 active:scale-95",children:[i.jsx(d,{className:"h-4 w-4"}),"Add Heading"]})]})}),i.jsxs(h,{className:"p-0",children:[W.isLoading?i.jsx("div",{className:"flex h-64 items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(q,{}),i.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading User Manual..."})]})}):i.jsx("div",{className:"space-y-3 p-4",children:i.jsx(r,{children:null==ee?void 0:ee.map(e=>i.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"overflow-hidden rounded-xl border",children:[i.jsxs("div",{className:"flex items-center justify-between bg-muted/20 p-4 transition-colors hover:bg-muted/40",children:[i.jsxs("div",{className:"flex flex-1 cursor-pointer items-center gap-3",onClick:()=>U(I===e.id?null:e.id),children:[I===e.id?i.jsx(l,{className:"text-orange-600"}):i.jsx(c,{className:"text-orange-600"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-foreground",children:e.heading}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.data.length," manuals"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(y,{variant:"ghost",size:"icon",onClick:s=>{s.stopPropagation(),(e=>{B(!0),X(e.id),E(!0)})(e)},className:"h-8 w-8 text-blue-600 hover:bg-blue-600/10",children:i.jsx(o,{className:"h-4 w-4"})}),i.jsx(S,{checked:1===e.is_suspended,onCheckedChange:()=>(async(e,s)=>{var i,t,n;try{const d=await R.mutateAsync({api:N.api_deleteHeadingApi,data:{id:e,status:1===s?0:1}});(null==(i=null==d?void 0:d.data)?void 0:i.status)?(a.success((null==(t=null==d?void 0:d.data)?void 0:t.message)||`Heading ${1===s?"deactivated":"activated"} successfully`),W.refetch()):a.error((null==(n=null==d?void 0:d.data)?void 0:n.message)||"Failed to update status")}catch(d){a.error("Something went wrong.")}})(e.id,e.is_suspended),className:"data-[state=checked]:bg-green-500"}),i.jsxs(y,{size:"sm",onClick:s=>{var a;s.stopPropagation(),a=e.id,J(!1),Z(null),X(a),K.reset(P),O(!0)},className:"ml-2 flex items-center gap-2",children:[i.jsx(d,{className:"h-3 w-3"}),"Add Manual"]})]})]}),I===e.id&&i.jsx(t.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"border-t bg-background",children:0===e.data.length?i.jsx("p",{className:"py-8 text-center text-sm text-muted-foreground",children:"No manuals available"}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs(C,{children:[i.jsx(H,{children:i.jsxs(A,{className:"hover:bg-transparent",children:[i.jsx(L,{className:"w-12 text-center",children:"#"}),i.jsx(L,{children:"Description"}),i.jsx(L,{children:"Manual Link"}),i.jsx(L,{children:"Video Link"}),i.jsx(L,{className:"text-center",children:"Status"}),i.jsx(L,{className:"text-center",children:"Actions"})]})}),i.jsx(M,{children:e.data.map((s,t)=>i.jsxs(A,{children:[i.jsx(D,{className:"py-2 text-center text-muted-foreground",children:t+1}),i.jsx(D,{className:"font-medium",children:s.description}),i.jsx(D,{children:i.jsxs("a",{href:s.user_manual_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-xs text-blue-600 hover:underline",children:[i.jsx(u,{className:"h-3 w-3"}),"Manual"]})}),i.jsx(D,{children:i.jsxs("a",{href:s.video_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-xs text-red-600 hover:underline",children:[i.jsx(m,{className:"h-3 w-3"}),"Video"]})}),i.jsx(D,{className:"text-center",children:i.jsx(S,{checked:1===s.is_suspended_v1,onCheckedChange:()=>(async(e,s)=>{var i,t,n;try{const d=await R.mutateAsync({api:N.api_deleteHeadingDescriptionApi,data:{id:e,status:1===s?0:1}});(null==(i=null==d?void 0:d.data)?void 0:i.status)?(a.success((null==(t=null==d?void 0:d.data)?void 0:t.message)||`Description ${1===s?"deactivated":"activated"} successfully`),W.refetch()):a.error((null==(n=null==d?void 0:d.data)?void 0:n.message)||"Failed to update status")}catch(d){a.error("Something went wrong.")}})(s.description_id,s.is_suspended_v1),className:"data-[state=checked]:bg-green-500"})}),i.jsx(D,{children:i.jsx("div",{className:"flex items-center justify-center gap-2",children:i.jsx(y,{variant:"ghost",size:"icon",onClick:()=>((e,s)=>{J(!0),Z(e.description_id),X(s),O(!0)})(s,e.id),className:"h-7 w-7 text-blue-600 hover:bg-blue-600/10",children:i.jsx(o,{className:"h-3 w-3"})})})})]},s.description_id))})]})})})]},e.id))})}),!W.isLoading&&0===(null==ee?void 0:ee.length)&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[i.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:i.jsx(n,{className:"h-12 w-12 text-muted-foreground/40"})}),i.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No Headings found"}),i.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Create your first heading to get started."})]})]})]})}),i.jsx(p,{open:z,onOpenChange:e=>{E(e),e||(G.reset(F),B(!1),X(null))},children:i.jsxs(g,{children:[i.jsx(j,{children:i.jsx(v,{children:V?"Update Heading":"Add New Heading"})}),V&&se.isLoading?i.jsxs("div",{className:"py-10 text-center",children:[i.jsx(q,{}),i.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Loading heading details..."})]}):i.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(k,{htmlFor:"heading",children:"Heading *"}),i.jsx(w,{id:"heading",...G.register("heading",{required:"Heading is required"}),placeholder:"Enter heading"}),G.formState.errors.heading&&i.jsx("p",{className:"text-sm text-red-500",children:G.formState.errors.heading.message})]}),i.jsxs("div",{className:"flex items-center justify-end gap-2 border-t pt-4",children:[i.jsx(y,{type:"button",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),i.jsx(y,{type:"submit",disabled:R.isPending,children:R.isPending?"Saving...":V?"Update Heading":"Create Heading"})]})]})]})}),i.jsx(p,{open:$,onOpenChange:e=>{O(e),e||(K.reset(P),J(!1),Z(null))},children:i.jsxs(g,{className:"min-w-[60vw]",children:[i.jsx(j,{children:i.jsx(v,{children:T?"Update Manual":"Add New Manual"})}),T&&ae.isLoading?i.jsxs("div",{className:"py-10 text-center",children:[i.jsx(q,{}),i.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Loading manual details..."})]}):i.jsxs("form",{onSubmit:te,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(k,{htmlFor:"description",children:"Description *"}),i.jsx(w,{id:"description",...K.register("description",{required:"Description is required"}),placeholder:"Enter description"}),K.formState.errors.description&&i.jsx("p",{className:"text-sm text-red-500",children:K.formState.errors.description.message})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(k,{htmlFor:"user_manual_link",children:"User Manual Link *"}),i.jsx(w,{id:"user_manual_link",...K.register("user_manual_link",{required:"Manual link is required"}),placeholder:"Enter user manual link"}),K.formState.errors.user_manual_link&&i.jsx("p",{className:"text-sm text-red-500",children:K.formState.errors.user_manual_link.message})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(k,{htmlFor:"video_link",children:"Video Link *"}),i.jsx(w,{id:"video_link",...K.register("video_link",{required:"Video link is required"}),placeholder:"Enter video link"}),K.formState.errors.video_link&&i.jsx("p",{className:"text-sm text-red-500",children:K.formState.errors.video_link.message})]}),i.jsxs("div",{className:"flex items-center justify-end gap-2 border-t pt-4",children:[i.jsx(y,{type:"button",variant:"outline",onClick:()=>O(!1),children:"Cancel"}),i.jsx(y,{type:"submit",disabled:R.isPending,children:R.isPending?"Saving...":T?"Update Manual":"Create Manual"})]})]})]})})]})}function U(){return i.jsx(f,{title:"Citizen Desk",subTitle:"Manage Citizen Desk Masters",children:i.jsx(I,{})})}export{U as default};
