import{r as e,j as s,aA as t,ah as a,K as r,J as l,G as d,I as i,E as n,z as o,m as c,ab as m,ac as x,af as u}from"./vendor-C2pSf0e_.js";import{u as h,b as g,e as f,n as p,S as v,C as j,f as b,q as N,m as w,g as y,w as k,x as S,y as C,z as I,P as L}from"./index-DHN82BNk.js";import{T as M,a as _,b as z,c as A}from"./tabs-Bp5PGmLE.js";import"./query-DWeUG8lz.js";import"./ui-DEgguNHf.js";import"./icons-EVOHFWxn.js";import"./axios-Dos3PyFQ.js";import"./zustand-DirRCQQf.js";import"./yup-D2FteOaG.js";function P(c){var m,x,u;const[k,S]=e.useState(""),[C,I]=e.useState("all"),L=e.useRef(null),M=h({}),_=g({api:null==(m=w)?void 0:m.getServicesByUlbModule,key:"getServicesByUlbModule",config:{ulbId:null==c?void 0:c.ulbId,moduleId:null==c?void 0:c.moduleId},options:{enabled:!!(null==c?void 0:c.ulbId)&&!!(null==c?void 0:c.moduleId)}});e.useEffect(()=>{const e=e=>{var s;!e.altKey||"s"!==e.key&&"S"!==e.key||(e.preventDefault(),e.stopPropagation(),null==(s=L.current)||s.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[]);const z=(null==(u=null==(x=null==_?void 0:_.data)?void 0:x.data)?void 0:u.filter(e=>{var s;return null==(s=e.services)?void 0:s.toLowerCase().includes(k.toLowerCase())}))||[],A=z.filter(e=>"active"===C?!0===e.permission_status:"inactive"!==C||!1===e.permission_status),P=z.filter(e=>e.permission_status).length,B=z.filter(e=>!e.permission_status).length;return s.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[s.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/10 text-primary",children:s.jsx(t,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Service Restrictions"}),s.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-widest text-muted-foreground",children:"Manage access to specific services with quick toggle"})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[s.jsxs("div",{className:"flex items-center gap-2 rounded-xl border bg-muted/30 p-1",children:[s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>I("all"),className:p("h-8 gap-2 rounded-lg px-3 text-xs font-bold transition-all","all"===C?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[s.jsx(a,{className:"h-3 w-3"}),"All (",z.length,")"]}),s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>I("active"),className:p("h-8 gap-2 rounded-lg px-3 text-xs font-bold transition-all","active"===C?"bg-primary text-white shadow-sm hover:bg-primary":"text-muted-foreground hover:text-foreground"),children:[s.jsx(r,{className:"h-3 w-3"}),"Restricted (",P,")"]}),s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>I("inactive"),className:p("h-8 gap-2 rounded-lg px-3 text-xs font-bold transition-all","inactive"===C?"bg-muted text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[s.jsx(l,{className:"h-3 w-3"}),"Allowed (",B,")"]})]}),s.jsxs("div",{className:"relative flex items-center",children:[s.jsx(d,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),s.jsx("input",{ref:L,type:"text",placeholder:"Search services...",value:k,onChange:e=>S(e.target.value),className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-20 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 sm:w-64"}),s.jsx("div",{className:"absolute right-2.5 hidden items-center gap-1 sm:flex",children:s.jsxs("kbd",{className:"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[s.jsx("span",{className:"text-xs",children:"Alt"}),"S"]})})]})]})]}),_.isLoading?s.jsx("div",{className:"flex h-64 items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(v,{}),s.jsx("p",{className:"mt-4 text-xs font-medium text-muted-foreground",children:"Loading services..."})]})}):s.jsx(s.Fragment,{children:0===A.length?s.jsx(j,{className:"overflow-hidden rounded-2xl border bg-card shadow-sm",children:s.jsx(b,{className:"p-12",children:s.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[s.jsx("div",{className:"mb-3 flex h-16 w-16 items-center justify-center rounded-full bg-muted/50",children:s.jsx(t,{className:"h-8 w-8 text-muted-foreground/30"})}),s.jsx("h4",{className:"text-sm font-bold text-foreground",children:"No services found"}),s.jsx("p",{className:"text-[11px] text-muted-foreground",children:k||"all"!==C?"Try adjusting your filters or search criteria":"No services available for this module"})]})})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4",children:s.jsx(i,{mode:"popLayout",children:A.map((e,t)=>{const a=e.permission_status;return s.jsx(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2,delay:.02*t},children:s.jsx(j,{className:p("group overflow-hidden rounded-xl border transition-all hover:shadow-md",a?"border-primary/20 bg-primary/5":"border-border bg-card hover:border-primary/30"),children:s.jsx(b,{className:"p-4",children:s.jsx("div",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex gap-3 items-center",children:[s.jsx("div",{className:p("flex h-10 w-10 items-center justify-center rounded-lg transition-all",a?"bg-primary/20 text-primary":"bg-muted text-muted-foreground group-hover:bg-primary/10 group-hover:text-primary"),children:a?s.jsx(r,{className:"h-5 w-5"}):s.jsx(l,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"line-clamp-2 text-sm font-bold text-foreground",children:e.services}),s.jsx("p",{className:"mt-1 font-mono text-[10px] text-muted-foreground",children:e.path||"N/A"})]})]}),s.jsx(N,{checked:a,onCheckedChange:s=>(async(e,s)=>{var t,a,r,l;try{const d={ulbId:null==c?void 0:c.ulbId,moduleId:null==c?void 0:c.moduleId,serviceList:[{permissionStatus:s,serviceId:e}]},i=await M.mutateAsync({api:null==(t=w)?void 0:t.addRemoveServiceByUlbModule,data:d});(null==(a=null==i?void 0:i.data)?void 0:a.status)?(o.success((null==(r=null==i?void 0:i.data)?void 0:r.message)||"Permission updated successfully"),_.refetch()):o.error((null==(l=null==i?void 0:i.data)?void 0:l.message)||"Failed to update permission")}catch(d){o.error(y(d))}})(e.id,s),disabled:M.isPending,className:"data-[state=checked]:bg-primary"})]})})})})},e.id)})})}),s.jsxs("div",{className:"flex flex-col gap-2 rounded-xl border bg-muted/20 px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest text-muted-foreground",children:["Showing: ",A.length," of ",z.length," ","Services"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-primary"}),s.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["Restricted: ",P]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-muted-foreground"}),s.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["Allowed: ",B]})]})]})]})]})})]})}function B(){var L,B,E;const R=c(),[U]=m(),F=U.get("ulb_id"),T=U.get("ulb_name"),[q,K]=e.useState(""),[D,V]=e.useState("all"),G=e.useRef(null),[H,J]=e.useState(!1),[O,Q]=e.useState(null),[W,X]=e.useState(""),Y=h({}),Z=g({api:null==(L=w)?void 0:L.getModuleByUlbId,key:"permittedModuleListByUlb",config:{ulbId:F},options:{enabled:!!F}});e.useEffect(()=>{const e=e=>{var s;!e.altKey||"s"!==e.key&&"S"!==e.key||(e.preventDefault(),e.stopPropagation(),null==(s=G.current)||s.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[]);const $=(null==(E=null==(B=null==Z?void 0:Z.data)?void 0:B.data)?void 0:E.filter(e=>{var s;return null==(s=e.module_name)?void 0:s.toLowerCase().includes(q.toLowerCase())}))||[],ee=$.filter(e=>"active"===D?!!e.is_enabled:"inactive"!==D||!e.is_enabled),se=$.filter(e=>e.is_enabled).length,te=$.filter(e=>!e.is_enabled).length;return s.jsxs("div",{children:[s.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:s.jsxs(j,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[s.jsx("div",{className:"border-b bg-muted/30 p-4",children:s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>R(-1),className:"flex items-center gap-2 text-muted-foreground transition-all hover:bg-accent hover:text-foreground",children:[s.jsx(x,{className:"h-4 w-4"}),"Back"]}),s.jsx("div",{className:"mx-1 h-6 w-[1px] bg-border"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Permitted Modules"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:["ULB:"," ",s.jsx("span",{className:"font-semibold text-emerald-600",children:T})]}),s.jsxs("div",{className:"inline-block rounded-full bg-emerald-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-emerald-600",children:[$.length," Modules"]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[s.jsxs("div",{className:"flex items-center gap-2 rounded-xl border bg-muted/30 p-1",children:[s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>V("all"),className:p("h-8 gap-2 rounded-lg px-3 text-xs font-bold transition-all","all"===D?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[s.jsx(a,{className:"h-3 w-3"}),"All (",$.length,")"]}),s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>V("active"),className:p("h-8 gap-2 rounded-lg px-3 text-xs font-bold transition-all","active"===D?"bg-emerald-600 text-white shadow-sm hover:bg-emerald-600":"text-muted-foreground hover:text-foreground"),children:[s.jsx(r,{className:"h-3 w-3"}),"Active (",se,")"]}),s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>V("inactive"),className:p("h-8 gap-2 rounded-lg px-3 text-xs font-bold transition-all","inactive"===D?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[s.jsx(l,{className:"h-3 w-3"}),"Inactive (",te,")"]})]}),s.jsxs("div",{className:"relative flex items-center",children:[s.jsx(d,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),s.jsx("input",{ref:G,type:"text",placeholder:"Search modules...",value:q,onChange:e=>K(e.target.value),className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-20 text-sm outline-none transition-all focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 sm:w-64"}),s.jsx("div",{className:"absolute right-2.5 hidden items-center gap-1 sm:flex",children:s.jsxs("kbd",{className:"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[s.jsx("span",{className:"text-xs",children:"Alt"}),"S"]})})]})]})]})}),s.jsx(b,{className:"p-6",children:Z.isLoading?s.jsx("div",{className:"flex h-64 items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(v,{}),s.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading modules..."})]})}):s.jsx(s.Fragment,{children:0===ee.length?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[s.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:s.jsx(t,{className:"h-12 w-12 text-muted-foreground/40"})}),s.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No modules found"}),s.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:q||"all"!==D?"Try adjusting your filters or search criteria":"No modules available for this ULB yet."})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:s.jsx(i,{mode:"popLayout",children:ee.map((e,a)=>{const r=!!e.is_enabled;return s.jsx(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2,delay:.01*a},children:s.jsxs(j,{className:p("group relative overflow-hidden rounded-xl border transition-all duration-300 hover:shadow-lg",r?"border-emerald-500/20 bg-emerald-500/5 shadow-emerald-500/5":"border-border bg-card"),children:[s.jsx(b,{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:p("flex h-12 w-12 shrink-0 items-center justify-center rounded-xl transition-all duration-300",r?"bg-emerald-500/20 text-emerald-600 shadow-inner":"bg-muted text-muted-foreground"),children:s.jsx(t,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex min-w-0 flex-1 flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h4",{className:"truncate text-sm font-bold text-foreground",children:null==e?void 0:e.module_name}),s.jsx(N,{checked:r,onCheckedChange:()=>(async e=>{var s,t,a,r;try{const l={ulbId:Number(F),moduleId:e},d=await Y.mutateAsync({api:null==(s=w)?void 0:s.toggleModulePermission,data:l});(null==(t=null==d?void 0:d.data)?void 0:t.status)?(o.success((null==(a=null==d?void 0:d.data)?void 0:a.message)||"Permission updated successfully"),Z.refetch()):o.error((null==(r=null==d?void 0:d.data)?void 0:r.message)||"Failed to update permission")}catch(l){o.error(y(l))}})(e.id),disabled:Y.isPending,className:"data-[state=checked]:bg-emerald-600"})]}),s.jsxs("div",{className:"mt-1.5 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:p("h-1.5 w-1.5 rounded-full",r?" bg-emerald-500":"bg-muted-foreground/30")}),s.jsx("div",{className:"flex items-center justify-between gap-2",children:s.jsx("span",{className:"text-xs text-muted-foreground",children:(null==e?void 0:e.url)||"N/A"})})]}),r&&s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>{return Q(s=e),X(s.id),void J(!0);var s},className:"h-4 gap-1.5 px-2 text-[10px] font-bold text-emerald-600 transition-colors hover:bg-emerald-500/10",children:[s.jsx(u,{className:"h-3 w-3"}),"SERVICES"]})]})]})]})}),r&&s.jsx("div",{className:"pointer-events-none absolute -right-2 -top-2 opacity-5 transition-transform duration-500 group-hover:scale-110",children:s.jsx(t,{size:60,className:"text-emerald-600"})})]})},e.id)})})}),s.jsxs("div",{className:"mt-6 flex flex-col gap-2 rounded-xl border border-emerald-500/10 bg-emerald-500/5 px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest text-muted-foreground",children:["Showing: ",ee.length," of"," ",$.length," Modules"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-emerald-500"}),s.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["Active: ",se]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-muted-foreground/30"}),s.jsxs("span",{className:"text-xs font-medium text-muted-foreground transition-all",children:["Inactive: ",te]})]})]})]})]})})})]})}),s.jsx(k,{open:H,onOpenChange:J,children:s.jsxs(S,{className:"mx-auto my-auto flex h-[80%] w-[70%] max-w-none flex-col overflow-hidden rounded-none border-gray-600 p-0 shadow-none duration-0",children:[s.jsx(C,{className:"shrink-0 border-b bg-muted/30 px-8 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>J(!1),className:"flex h-10 items-center gap-2 text-muted-foreground transition-all hover:bg-accent hover:text-foreground",children:[s.jsx(x,{className:"h-4 w-4"}),"Back"]}),s.jsx("div",{className:"mx-1 h-6 w-[1px] bg-border"}),s.jsx("div",{className:"rounded-xl bg-primary/10 p-3 text-primary ring-1 ring-primary/20",children:s.jsx(t,{size:24})}),s.jsxs("div",{children:[s.jsx(I,{className:"text-2xl font-black tracking-tight text-foreground",children:"Service Management"}),s.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[s.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest text-muted-foreground",children:["ULB: ",s.jsx("span",{className:"text-primary",children:T})]}),s.jsx("div",{className:"h-1 w-1 rounded-full bg-muted-foreground/30"}),s.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest text-muted-foreground",children:["Module:"," ",s.jsx("span",{className:"text-primary",children:null==O?void 0:O.module_name})]})]})]})]})}),s.jsx("div",{className:"flex-1 overflow-auto px-8 py-6",children:s.jsxs(M,{defaultValue:"restricted",className:"w-full",children:[s.jsx(_,{className:"mb-6 h-12 rounded-xl bg-muted p-1",children:s.jsx(z,{value:"restricted",className:"rounded-lg px-8 py-2 text-xs font-black uppercase tracking-widest data-[state=active]:bg-background data-[state=active]:text-primary data-[state=active]:shadow-sm",children:"Restricted Services"})}),s.jsx(A,{value:"restricted",className:"mt-0 transition-all",children:s.jsx("div",{className:"overflow-hidden rounded-2xl border bg-card shadow-sm",children:s.jsx(P,{ulbId:F,moduleId:W,viewService:O})})})]})})]})})]})}function E(){return s.jsx(L,{title:"Permitted Modules",subTitle:"Manage All Permitted Modules Here.",children:s.jsx(B,{})})}export{E as default};
