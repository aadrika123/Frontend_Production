import{r as e,y as a,j as l,af as t,aD as s,al as i,ai as r,aE as o,A as d,z as n}from"./vendor-Cw0yupI3.js";import{c,a as m,d as u}from"./yup-CjHziZVU.js";import{F as p,R as b,B as x}from"./datetime-picker-BU5WKTF9.js";import{d as h}from"./index-Uy6CRp-L.js";import{g}from"./services-Bn_cfjy0.js";import{R as v}from"./RHFSelectField-BPPcoVxy.js";import"./input-DbQNgrMd.js";import"./switch-Bwt2DsG8.js";import"./label-CaZSqfZ1.js";import{u as j,a as N}from"./useCustomQuery-C4KcVbng.js";import{D as f}from"./index-B-sTde5x.js";import{X as y}from"./icons-DfkRqyLz.js";const w=c().shape({id:m().nullable(),ulbName:m().required("Ulb Name is required"),ulbType:m().required("Ulb Type is required"),remarks:m().nullable(),incorporationDate:m().nullable(),code:m().nullable(),shortName:m().required("Short Name is required"),tollFreeNo:m().nullable(),email:m().email("Enter a valid email").required("Email is required"),mobileNo:m().matches(/^\d{10}$/,"Mobile number must be 10 digits").nullable(),stateId:u().typeError("State ID must be a number").required("State ID is required"),districtId:u().typeError("District ID must be a number").required("District ID is required"),associationWith:m().nullable(),latitude:m().nullable(),longitude:m().nullable(),document:m().nullable()});function D({open:c,setOpen:m,title:u,edit:D,setEdit:I,editData:_,refetch:k}){var C,S;const U=j({}),[q,L]=e.useState(null),E=a({defaultValues:{id:"",ulbName:"",ulbType:"",remarks:"",incorporationDate:"",code:"",shortName:"",tollFreeNo:"",email:"",mobileNo:"",stateId:void 0,districtId:void 0,associationWith:"",latitude:"",longitude:""},resolver:d(w)}),{reset:F,setValue:T,watch:M}=E;M("stateId"),e.useEffect(()=>{c&&F(D&&_?{id:(null==_?void 0:_.id)||"",ulbName:(null==_?void 0:_.ulb_name)||"",ulbType:(null==_?void 0:_.ulb_type)||"",remarks:(null==_?void 0:_.remarks)||"",incorporationDate:(null==_?void 0:_.incorporation_date)||"",code:(null==_?void 0:_.code)||"",shortName:(null==_?void 0:_.short_name)||"",tollFreeNo:(null==_?void 0:_.toll_free_no)||"",email:(null==_?void 0:_.email)||"",mobileNo:(null==_?void 0:_.mobile_no)||"",stateId:Number(null==_?void 0:_.state_id)||0,districtId:Number(null==_?void 0:_.district_id)||0,associationWith:(null==_?void 0:_.association_with)||"",latitude:(null==_?void 0:_.latitude)||"",longitude:(null==_?void 0:_.longitude)||""}:{id:"",ulbName:"",ulbType:"",remarks:"",incorporationDate:"",code:"",shortName:"",tollFreeNo:"",email:"",mobileNo:"",stateId:void 0,districtId:void 0,associationWith:"",latitude:"",longitude:""})},[c,D,_,F]);const R=N({api:h.getDistrictList,config:{stateId:16},options:{enabled:!0}}),A=(null==(S=null==(C=null==R?void 0:R.data)?void 0:C.data)?void 0:S.map(e=>({value:String(e.id),label:e.district_name})))||[],[W,B]=e.useState(""),O=e.useRef(null);e.useEffect(()=>{(null==_?void 0:_.ulb_logo)&&B(_.ulb_logo)},[_,c]);return l.jsx(f,{open:c,setOpen:m,title:u,setEdit:I,edit:D,children:l.jsx("div",{className:"p-1",children:l.jsx(p,{methods:E,onSubmit:E.handleSubmit(async e=>{var a,l,t,s,i;const r=new FormData;Object.entries(e).forEach(([e,a])=>{r.append(e,a)}),q&&r.append("document",q);try{const e=D?null==(a=h)?void 0:a.api_updateUlb:null==(l=h)?void 0:l.api_PostUlb,o=await U.mutateAsync({api:e,data:r});(null==(t=null==o?void 0:o.data)?void 0:t.status)?(n.success((null==(s=null==o?void 0:o.data)?void 0:s.message)||(D?"ULB Account updated successfully":"ULB Account created successfully")),m(!1),I&&I(!1),k()):n.error((null==(i=null==o?void 0:o.data)?void 0:i.message)||"Something went wrong")}catch(o){n.error(g(o))}}),children:l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsx("div",{className:"max-h-[60vh] overflow-y-auto px-3",children:l.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[l.jsx(t,{className:"text-primary"})," Basic Information"]}),l.jsx(b,{label:"Ulb Name",name:"ulbName",placeholder:"e.g. Deoghar Municipal Corporation"}),l.jsx(v,{label:"Ulb Type",name:"ulbType",data:[{label:"Town Panchayat",value:"Town Panchayat"},{label:"Municipal Council",value:"Municipal Council"},{label:"Municipal Corporation",value:"Municipal Corporation"}]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsx(b,{label:"Short Name",name:"shortName",placeholder:"DMC"}),l.jsx(b,{label:"Code",name:"code",placeholder:"e.g. DMC001"})]}),l.jsx("div",{className:"grid grid-cols-2 gap-4"}),l.jsx(b,{label:"Incorporation Date",name:"incorporationDate",type:"date"}),l.jsxs("div",{className:"flex flex-col gap-1 ",children:[l.jsx("label",{className:"text-sm",htmlFor:"document",children:"Upload Logo"}),l.jsx("input",{name:"document",type:"file",className:"rounded-md bg-secondary px-3 py-1.5 text-sm",onChange:e=>{var a;const l=null==(a=e.target.files)?void 0:a[0];if(l){const e=URL.createObjectURL(l);L(l),B(e)}else(null==_?void 0:_.ulb_logo)&&B(_.ulb_logo)},ref:O})]}),W&&l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:W,alt:"Preview",style:{width:"200px",marginTop:"10px"}}),l.jsx("span",{onClick:()=>{B(""),O.current&&(O.current.value="")},className:"absolute right-10 top-0 flex h-6 w-6 cursor-pointer items-center justify-center rounded-full bg-red-300 transition-all ease-in-out hover:bg-red-400",children:l.jsx(y,{className:"p-0.5 text-gray-600"})})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[l.jsx(s,{className:"text-primary"})," Remarks & Info"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(b,{label:"Remarks",name:"remarks",placeholder:"Special notes..."}),l.jsx(b,{label:"Association With",name:"associationWith",placeholder:"State Government"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[l.jsx(i,{className:"text-primary"})," Contact & Web"]}),l.jsx(b,{label:"Email Address",name:"email",placeholder:"contact@deoghar.gov.in"}),l.jsx(b,{label:"Mobile No",name:"mobileNo",placeholder:"9876543210"}),l.jsx(b,{label:"Toll Free No",name:"tollFreeNo",placeholder:"1800123456"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[l.jsx(r,{className:"text-primary"})," Regional Information"]}),l.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.jsx(v,{label:"District",name:"districtId",data:A})})]}),l.jsxs("div",{className:"space-y-4 md:col-span-2",children:[l.jsxs("h4",{className:"flex items-center gap-2 border-b pb-2 text-sm font-bold uppercase tracking-wider text-muted-foreground",children:[l.jsx(o,{className:"text-primary"})," Location Coordinates"]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[l.jsx(b,{label:"Latitude",name:"latitude",placeholder:"24.4850"}),l.jsx(b,{label:"Longitude",name:"longitude",placeholder:"86.6950"})]})]})]})}),l.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:l.jsx(x,{isLoading:E.formState.isSubmitting,type:"submit",className:"h-12 rounded-xl bg-primary px-10 text-sm font-bold text-primary-foreground shadow-lg shadow-primary/25 transition-all hover:bg-primary/95 hover:shadow-xl active:scale-[0.98]",children:D?"Update ULB Account":"Create ULB Account"})})]})})})})}export{D as C};
