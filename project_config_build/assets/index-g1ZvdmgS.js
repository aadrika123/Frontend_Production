import{y as e,A as s,r as t,j as a,z as r,a2 as l,m as i,c as o,J as n,a3 as d,W as c,X as m,Y as u,a1 as x,a6 as h,a7 as p,Z as g,$ as j,a8 as f,V as b,a0 as v,H as N}from"./vendor-C4evAtTJ.js";import{C as w,a as y,b as k,P as S}from"./card-DiAP098P.js";import{u as R,a as _}from"./useCustomQuery-776SQh42.js";import{m as C,B as A,c as L}from"./index-nOKeclHv.js";import{g as D}from"./services-Bn_cfjy0.js";import{T as E,a as I,b as $,c as P,d as M,e as z}from"./table-BMiE1PKG.js";import{S as q}from"./Spinner-V_xsUq7L.js";import{P as B}from"./index-DtmLDMmO.js";import{c as O,a as V}from"./yup-CKFt8x4I.js";import{F,R as T,B as W}from"./datetime-picker-C5RqqAbw.js";import"./select-BMZmzcxe.js";import"./input-BmuDym1d.js";import{S as H}from"./switch-DiVucjTg.js";import"./label-DG1IsmQj.js";import{S as J}from"./separator-5XQgJy4z.js";import{D as Q}from"./index-h9tpnovL.js";import"./icons-s1CkBPDV.js";import"./ui-BtaoVrnA.js";import"./query-CtA7BnhH.js";import"./axios-Dos3PyFQ.js";import"./zustand-DzHKdda2.js";const U=O().shape({menuRoleName:V().required("Role name is required")});function X({open:l,setOpen:i,title:o,edit:n,setEdit:d,id:c,moduleId:m,refetch:u,editData:x}){const h=R({}),p=e({defaultValues:{menuRoleName:""},resolver:s(U)}),{reset:g,handleSubmit:j,formState:{isSubmitting:f}}=p;t.useEffect(()=>{l&&g(n&&x?{menuRoleName:x.menu_role_name||""}:{menuRoleName:""})},[l,n,x,g]);return a.jsx(Q,{open:l,setOpen:i,title:o||(n?"Edit Role":"Add Role"),setEdit:d,edit:n,children:a.jsx("div",{className:"p-1",children:a.jsx(F,{methods:p,onSubmit:j(async e=>{var s,t,a,l,o;try{const x=n?null==(s=C)?void 0:s.editMenuList:null==(t=C)?void 0:t.addMenuList,p=n?{...e,id:c}:{...e,moduleId:Number(m)},g=await h.mutateAsync({api:x,data:p});(null==(a=null==g?void 0:g.data)?void 0:a.status)?(r.success((null==(l=null==g?void 0:g.data)?void 0:l.message)||`Role ${n?"updated":"added"} successfully`),i(!1),d&&d(!1),u&&u()):r.error((null==(o=null==g?void 0:g.data)?void 0:o.message)||"Something went wrong")}catch(x){r.error(D(x))}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[a.jsx("div",{className:"space-y-4",children:a.jsx(T,{label:"Role Name",name:"menuRoleName",placeholder:"Enter role name"})}),a.jsx(J,{className:"opacity-50"}),a.jsx(W,{isLoading:f,type:"submit",className:"h-12 w-full rounded-xl bg-[#7C3AED] text-sm font-bold text-white shadow-lg shadow-purple-500/20 transition-all hover:bg-[#6D28D9] active:scale-[0.98]",children:n?"Update Role":"Submit"})]})})})})}function Y(){var e,s,S,O;const[V]=l(),F=i(),T=V.get("module_name"),W=V.get("id"),[J,Q]=t.useState(1),[U,Y]=t.useState(10),[Z,G]=t.useState(""),[K,ee]=t.useState(!1),[se,te]=t.useState(!1),[ae,re]=t.useState(null),[le,ie]=t.useState(null),[oe,ne]=t.useState({}),[de,ce]=t.useState(!1),[me,ue]=t.useState(null),xe=_({api:null==(e=C)?void 0:e.getMenuRoleList,key:"roleMasterList",options:{enabled:!0}}),he=R({}),pe=R({}),ge=(null==(O=null==(S=null==(s=null==xe?void 0:xe.data)?void 0:s.data)?void 0:S.filter(e=>e.module_id==Number(W)))?void 0:O.filter(e=>{var s;return null==(s=e.menu_role_name)?void 0:s.toLowerCase().includes(Z.toLowerCase())}))||[],je=J*U,fe=je-U,be=ge.slice(fe,je),ve=e=>void 0!==oe[e.id]?oe[e.id]:!0===e.is_suspended;o.useEffect(()=>{de&&(pe.isSuccess&&(r.success("Role status updated successfully"),xe.refetch(),ue(null),ce(!1),pe.reset()),pe.isError&&(r.error(D(pe.error)),ne(e=>{const s={...e};return me&&delete s[me.roleId],s}),ue(null),ce(!1),pe.reset()))},[pe.isSuccess,pe.isError,de,xe,me,pe]);const Ne=[{key:"menu-list",label:"Menu List",icon:a.jsx(b,{className:"h-4 w-4"}),color:"bg-blue-600/10 hover:bg-blue-600/20 text-blue-600 border-blue-600/20"},{key:"service-list",label:"Service List",icon:a.jsx(v,{className:"h-4 w-4"}),color:"bg-emerald-600/10 hover:bg-emerald-600/20 text-emerald-600 border-emerald-600/20"},{key:"role-list",label:"Role List",icon:a.jsx(x,{className:"h-4 w-4"}),color:"bg-violet-600/10 hover:bg-violet-600/20 text-violet-600 border-violet-600/20"},{key:"workflow-list",label:"Workflow Role",icon:a.jsx(N,{className:"h-4 w-4"}),color:"bg-amber-600/10 hover:bg-amber-600/20 text-amber-600 border-amber-600/20"}];return a.jsxs("div",{className:"",children:[a.jsx("div",{className:"mb-6 flex flex-wrap gap-2",children:Ne.map(e=>{const s=location.pathname.includes(e.key);return a.jsxs(A,{variant:s?"default":"outline",size:"sm",onClick:()=>{F(`/project-config/dashboard/module-list/${e.key}?module_name=${T}&id=${W}`)},className:L("flex items-center gap-2 transition-all hover:scale-105",s?L("bg-primary text-primary-foreground shadow-md",e.color&&"bg-opacity-100"):L("bg-background hover:bg-muted",e.color)),children:[e.icon,a.jsx("span",{className:"hidden sm:inline",children:e.label})]},e.key)})}),a.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsxs(w,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[a.jsx("div",{className:"border-b bg-muted/30 p-4",children:a.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>F("/project-config/dashboard/module-list"),className:"flex items-center gap-2 text-muted-foreground transition-all hover:bg-accent hover:text-foreground",children:[a.jsx(d,{className:"h-4 w-4"}),"Back"]}),a.jsx("div",{className:"mx-1 h-6 w-[1px] bg-border"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-foreground",children:T}),a.jsxs("div",{className:"inline-block rounded-full bg-violet-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-violet-600",children:[ge.length," Roles"]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(c,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),a.jsx("input",{type:"text",placeholder:"Search role name...",value:Z,onChange:e=>{G(e.target.value),Q(1)},className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-4 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 md:w-64"})]}),a.jsxs(A,{type:"button",onClick:()=>{te(!1),ee(!0)},className:"flex items-center gap-2 bg-primary shadow-md transition-all hover:bg-primary/90 active:scale-95",children:[a.jsx(m,{className:"h-4 w-4"}),"Add New Role"]})]})]})}),a.jsxs(y,{className:"p-0",children:[xe.isLoading?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(q,{}),a.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading user roles..."})]})}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(E,{children:[a.jsx(I,{children:a.jsxs($,{className:"border-b-2 hover:bg-transparent",children:[a.jsx(P,{className:"w-20 text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"#"}),a.jsx(P,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Role Name"}),a.jsx(P,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Status"}),a.jsx(P,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Actions"}),a.jsx(P,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Is Suspended"})]})}),a.jsx(M,{children:a.jsx(u,{children:be.map((e,s)=>a.jsxs(n.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"group/row border-b transition-all hover:bg-muted/40",children:[a.jsx(z,{className:"py-4 text-center",children:a.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-xs font-bold text-muted-foreground",children:fe+s+1})}),a.jsx(z,{className:"py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-violet-600/10 transition-colors group-hover/row:bg-violet-600/20",children:a.jsx(x,{className:"h-5 w-5 text-violet-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold leading-tight text-foreground",children:e.menu_role_name}),a.jsxs("p",{className:"mt-0.5 text-[10px] font-semibold uppercase tracking-widest text-muted-foreground",children:["ID: ",e.id]})]})]})}),a.jsx(z,{className:"py-4 text-center",children:a.jsxs("span",{className:L("inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-xs font-bold transition-colors",e.is_suspended?"border-red-500/20 bg-red-500/10 text-red-500":"border-green-500/20 bg-green-500/10 text-green-500"),children:[e.is_suspended?a.jsx(h,{className:"h-3 w-3"}):a.jsx(p,{className:"h-3 w-3"}),e.is_suspended?"Suspended":"Active"]})}),a.jsx(z,{className:"py-4",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(A,{variant:"ghost",size:"icon",onClick:()=>{re(e.id),ie(e),te(!0),ee(!0)},className:"h-9 w-9 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:a.jsx(g,{className:"h-4 w-4"})}),a.jsx(A,{variant:"ghost",size:"icon",onClick:()=>{k("Delete Role",`Are you sure you want to delete ${e.menu_role_name}?`,async()=>{var s,t,a;try{const l=await he.mutateAsync({api:C.apiRoleMasterActiveDeactive,data:{role_id:e.id}});(null==(s=null==l?void 0:l.data)?void 0:s.status)?(r.success((null==(t=null==l?void 0:l.data)?void 0:t.message)||"Action performed successfully"),xe.refetch()):r.error((null==(a=null==l?void 0:l.data)?void 0:a.message)||"Failed to perform action")}catch(l){r.error("An error occurred")}})},className:"h-9 w-9 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(j,{className:"h-4 w-4"})}),a.jsxs(A,{onClick:()=>F(`/project-config/dashboard/module-list/role-list/manage-menu?module_id=${e.module_id}&role_id=${e.id}&module_name=${T}`,{state:{role_name:null==e?void 0:e.menu_role_name}}),className:"flex items-center gap-2",children:[a.jsx(f,{className:"h-4 w-4"}),"View"]})]})}),a.jsx(z,{className:"mt-6 flex items-center justify-center",children:a.jsx(H,{checked:ve(e),onCheckedChange:()=>(e=>{var s;const t=!ve(e);ne(s=>({...s,[e.id]:t}));const a={roleId:Number(e.id),isSuspended:t?"inactive":"active"};ce(!0),ue(a),pe.mutate({api:null==(s=C)?void 0:s.apiRoleMasterActiveDeactive,data:a})})(e)})})]},e.id))})})]}),ge.length>0&&a.jsx("div",{className:"border-t p-4",children:a.jsx(B,{currentPage:J,totalItems:ge.length,itemsPerPage:U,onPageChange:e=>{Q(e)},onItemsPerPageChange:e=>{Y(e),Q(1)}})})]}),!xe.isLoading&&0===ge.length&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[a.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:a.jsx(x,{className:"h-12 w-12 text-muted-foreground/40"})}),a.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No roles found"}),a.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Configure roles for this module to manage user permissions."}),a.jsxs(A,{className:"mt-6",variant:"outline",children:[a.jsx(m,{className:"mr-2 h-4 w-4"}),"Add New Role"]})]})]})]}),a.jsx(X,{open:K,setOpen:ee,moduleId:W,edit:se,setEdit:te,id:ae,editData:le,refetch:xe.refetch})]})]})}function Z(){return a.jsx(S,{title:"Role List",subTitle:"Control all Role here",children:a.jsx(Y,{})})}export{Z as default};
