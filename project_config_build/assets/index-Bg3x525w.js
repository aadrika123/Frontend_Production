import{y as e,B as s,r as t,j as a,z as l,ad as r,m as i,c as o,E as n,Q as d,G as c,H as m,I as u,ac as x,J as h,K as g,M as p,P as f,ag as b,aa as j,ab as v,a1 as N}from"./vendor-of9_hwUT.js";import{u as w,D as y,F as k,R as S,B as R,m as _,g as C,b as L,e as A,n as E,C as D,f as I,S as M,T as P,h as $,i as z,j as q,k as B,l as O,o as F,q as T,p as V,P as G}from"./index-Caq1sqRP.js";import{c as H,a as J}from"./yup-BW00wNfM.js";import{S as K}from"./separator-Y6zLL1-4.js";import"./query-CfdbInZo.js";import"./ui-DGRyWpwx.js";import"./icons-C5eWvnai.js";import"./axios-Dos3PyFQ.js";import"./zustand-xphxtTnV.js";const Q=H().shape({menuRoleName:J().required("Role name is required")});function U({open:r,setOpen:i,title:o,edit:n,setEdit:d,id:c,moduleId:m,refetch:u,editData:x}){const h=w({}),g=e({defaultValues:{menuRoleName:""},resolver:s(Q)}),{reset:p,handleSubmit:f,formState:{isSubmitting:b}}=g;t.useEffect(()=>{r&&p(n&&x?{menuRoleName:x.menu_role_name||""}:{menuRoleName:""})},[r,n,x,p]);return a.jsx(y,{open:r,setOpen:i,title:o||(n?"Edit Role":"Add Role"),setEdit:d,edit:n,children:a.jsx("div",{className:"p-1",children:a.jsx(k,{methods:g,onSubmit:f(async e=>{var s,t,a,r,o;try{const x=n?null==(s=_)?void 0:s.editMenuList:null==(t=_)?void 0:t.addMenuList,g=n?{...e,id:c}:{...e,moduleId:Number(m)},p=await h.mutateAsync({api:x,data:g});(null==(a=null==p?void 0:p.data)?void 0:a.status)?(l.success((null==(r=null==p?void 0:p.data)?void 0:r.message)||`Role ${n?"updated":"added"} successfully`),i(!1),d&&d(!1),u&&u()):l.error((null==(o=null==p?void 0:p.data)?void 0:o.message)||"Something went wrong")}catch(x){l.error(C(x))}}),children:a.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[a.jsx("div",{className:"space-y-4",children:a.jsx(S,{label:"Role Name",name:"menuRoleName",placeholder:"Enter role name"})}),a.jsx(K,{className:"opacity-50"}),a.jsx(R,{isLoading:b,type:"submit",className:"h-12 w-full rounded-xl bg-[#7C3AED] text-sm font-bold text-white shadow-lg shadow-purple-500/20 transition-all hover:bg-[#6D28D9] active:scale-[0.98]",children:n?"Update Role":"Submit"})]})})})})}function W(){var e,s,y,k;const[S]=r(),R=i(),G=S.get("module_name"),H=S.get("id"),[J,K]=t.useState(1),[Q,W]=t.useState(10),[X,Y]=t.useState(""),[Z,ee]=t.useState(!1),[se,te]=t.useState(!1),[ae,le]=t.useState(null),[re,ie]=t.useState(null),[oe,ne]=t.useState({}),[de,ce]=t.useState(!1),[me,ue]=t.useState(null),xe=L({api:null==(e=_)?void 0:e.getMenuRoleList,key:"roleMasterList",options:{enabled:!0}}),he=w({}),ge=w({}),pe=(null==(k=null==(y=null==(s=null==xe?void 0:xe.data)?void 0:s.data)?void 0:y.filter(e=>e.module_id==Number(H)))?void 0:k.filter(e=>{var s;return null==(s=e.menu_role_name)?void 0:s.toLowerCase().includes(X.toLowerCase())}))||[],fe=J*Q,be=fe-Q,je=pe.slice(be,fe),ve=e=>void 0!==oe[e.id]?oe[e.id]:!0===e.is_suspended;o.useEffect(()=>{de&&(ge.isSuccess&&(l.success("Role status updated successfully"),xe.refetch(),ue(null),ce(!1),ge.reset()),ge.isError&&(l.error(C(ge.error)),ne(e=>{const s={...e};return me&&delete s[me.roleId],s}),ue(null),ce(!1),ge.reset()))},[ge.isSuccess,ge.isError,de,xe,me,ge]);const Ne=[{key:"menu-list",label:"Menu List",icon:a.jsx(j,{className:"h-4 w-4"}),color:"bg-blue-600/10 hover:bg-blue-600/20 text-blue-600 border-blue-600/20"},{key:"service-list",label:"Service List",icon:a.jsx(v,{className:"h-4 w-4"}),color:"bg-emerald-600/10 hover:bg-emerald-600/20 text-emerald-600 border-emerald-600/20"},{key:"role-list",label:"Role List",icon:a.jsx(x,{className:"h-4 w-4"}),color:"bg-violet-600/10 hover:bg-violet-600/20 text-violet-600 border-violet-600/20"},{key:"workflow-list",label:"Workflow Role",icon:a.jsx(N,{className:"h-4 w-4"}),color:"bg-amber-600/10 hover:bg-amber-600/20 text-amber-600 border-amber-600/20"}];return a.jsxs("div",{className:"",children:[a.jsx("div",{className:"mb-6 flex flex-wrap gap-2",children:Ne.map(e=>{const s=location.pathname.includes(e.key);return a.jsxs(A,{variant:s?"default":"outline",size:"sm",onClick:()=>{R(`/project-config/dashboard/module-list/${e.key}?module_name=${G}&id=${H}`)},className:E("flex items-center gap-2 transition-all hover:scale-105",s?E("bg-primary text-primary-foreground shadow-md",e.color&&"bg-opacity-100"):E("bg-background hover:bg-muted",e.color)),children:[e.icon,a.jsx("span",{className:"hidden sm:inline",children:e.label})]},e.key)})}),a.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsxs(D,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[a.jsx("div",{className:"border-b bg-muted/30 p-4",children:a.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>R("/project-config/dashboard/module-list"),className:"flex items-center gap-2 text-muted-foreground transition-all hover:bg-accent hover:text-foreground",children:[a.jsx(d,{className:"h-4 w-4"}),"Back"]}),a.jsx("div",{className:"mx-1 h-6 w-[1px] bg-border"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-foreground",children:G}),a.jsxs("div",{className:"inline-block rounded-full bg-violet-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-violet-600",children:[pe.length," Roles"]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(c,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),a.jsx("input",{type:"text",placeholder:"Search role name...",value:X,onChange:e=>{Y(e.target.value),K(1)},className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-4 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 md:w-64"})]}),a.jsxs(A,{type:"button",onClick:()=>{te(!1),ee(!0)},className:"flex items-center gap-2 bg-primary shadow-md transition-all hover:bg-primary/90 active:scale-95",children:[a.jsx(m,{className:"h-4 w-4"}),"Add New Role"]})]})]})}),a.jsxs(I,{className:"p-0",children:[xe.isLoading?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(M,{}),a.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading user roles..."})]})}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(P,{children:[a.jsx($,{children:a.jsxs(z,{className:"border-b-2 hover:bg-transparent",children:[a.jsx(q,{className:"w-20 text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"#"}),a.jsx(q,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Role Name"}),a.jsx(q,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Status"}),a.jsx(q,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Actions"}),a.jsx(q,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Is Suspended"})]})}),a.jsx(B,{children:a.jsx(u,{children:je.map((e,s)=>a.jsxs(n.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"group/row border-b transition-all hover:bg-muted/40",children:[a.jsx(O,{className:"py-4 text-center",children:a.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-xs font-bold text-muted-foreground",children:be+s+1})}),a.jsx(O,{className:"py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-violet-600/10 transition-colors group-hover/row:bg-violet-600/20",children:a.jsx(x,{className:"h-5 w-5 text-violet-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold leading-tight text-foreground",children:e.menu_role_name}),a.jsxs("p",{className:"mt-0.5 text-[10px] font-semibold uppercase tracking-widest text-muted-foreground",children:["ID: ",e.id]})]})]})}),a.jsx(O,{className:"py-4 text-center",children:a.jsxs("span",{className:E("inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-xs font-bold transition-colors",e.is_suspended?"border-red-500/20 bg-red-500/10 text-red-500":"border-green-500/20 bg-green-500/10 text-green-500"),children:[e.is_suspended?a.jsx(h,{className:"h-3 w-3"}):a.jsx(g,{className:"h-3 w-3"}),e.is_suspended?"Suspended":"Active"]})}),a.jsx(O,{className:"py-4",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(A,{variant:"ghost",size:"icon",onClick:()=>{le(e.id),ie(e),te(!0),ee(!0)},className:"h-9 w-9 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:a.jsx(p,{className:"h-4 w-4"})}),a.jsx(A,{variant:"ghost",size:"icon",onClick:()=>{F("Delete Role",`Are you sure you want to delete ${e.menu_role_name}?`,async()=>{var s,t,a;try{const r=await he.mutateAsync({api:_.apiRoleMasterActiveDeactive,data:{role_id:e.id}});(null==(s=null==r?void 0:r.data)?void 0:s.status)?(l.success((null==(t=null==r?void 0:r.data)?void 0:t.message)||"Action performed successfully"),xe.refetch()):l.error((null==(a=null==r?void 0:r.data)?void 0:a.message)||"Failed to perform action")}catch(r){l.error("An error occurred")}})},className:"h-9 w-9 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(f,{className:"h-4 w-4"})}),a.jsxs(A,{onClick:()=>R(`/project-config/dashboard/module-list/role-list/manage-menu?module_id=${e.module_id}&role_id=${e.id}&module_name=${G}`,{state:{role_name:null==e?void 0:e.menu_role_name}}),className:"flex items-center gap-2",children:[a.jsx(b,{className:"h-4 w-4"}),"View"]})]})}),a.jsx(O,{className:"mt-6 flex items-center justify-center",children:a.jsx(T,{checked:ve(e),onCheckedChange:()=>(e=>{var s;const t=!ve(e);ne(s=>({...s,[e.id]:t}));const a={roleId:Number(e.id),isSuspended:t?"inactive":"active"};ce(!0),ue(a),ge.mutate({api:null==(s=_)?void 0:s.apiRoleMasterActiveDeactive,data:a})})(e)})})]},e.id))})})]}),pe.length>0&&a.jsx("div",{className:"border-t p-4",children:a.jsx(V,{currentPage:J,totalItems:pe.length,itemsPerPage:Q,onPageChange:e=>{K(e)},onItemsPerPageChange:e=>{W(e),K(1)}})})]}),!xe.isLoading&&0===pe.length&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[a.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:a.jsx(x,{className:"h-12 w-12 text-muted-foreground/40"})}),a.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No roles found"}),a.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Configure roles for this module to manage user permissions."}),a.jsxs(A,{className:"mt-6",variant:"outline",children:[a.jsx(m,{className:"mr-2 h-4 w-4"}),"Add New Role"]})]})]})]}),a.jsx(U,{open:Z,setOpen:ee,moduleId:H,edit:se,setEdit:te,id:ae,editData:re,refetch:xe.refetch})]})]})}function X(){return a.jsx(G,{title:"Role List",subTitle:"Control all Role here",children:a.jsx(W,{})})}export{X as default};
