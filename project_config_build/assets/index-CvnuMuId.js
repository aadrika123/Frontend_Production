import{r as e,y as s,b4 as t,j as a,J as l,ah as r,bf as i,Z as n}from"./vendor-BYEve7Lm.js";import{C as d,a as c,D as u,e as o,f as m,g as x,P as p}from"./card-CCk4Fcj3.js";import{d as h,b as j}from"./index-D-WK3WBg.js";import{L as g}from"./label-DkEWzZ9r.js";import{I as f}from"./input-rV9H863X.js";import{S as v}from"./switch-C2b8-GuS.js";import{S as N}from"./Spinner-CCa1YHa-.js";import{u as b,a as y}from"./useCustomQuery-BqJuBb9h.js";import"./icons-Z8aKJdqm.js";import"./ui-qCrIzFQ2.js";import"./query-CJAX0F5v.js";import"./axios-Dos3PyFQ.js";import"./zustand-Dp6hMumu.js";const A={ruleName:"",ruleImage:null};function w(){var p;const[w,R]=e.useState(!1),[_,C]=e.useState(!1),[S,k]=e.useState(null),I=s({defaultValues:A}),D=b({}),L=y({api:h.api_getActRulesApiList,key:"actRulesList",options:{enabled:!0}}),F=(null==(p=null==L?void 0:L.data)?void 0:p.data)||[],P=y({api:h.api_getActRulesApiById,key:`actRulesById_${S??""}`,config:{id:S},options:{enabled:!!S&&_&&w}});e.useEffect(()=>{var e;if(!w||!_)return;const s=null==(e=null==P?void 0:P.data)?void 0:e.data;if(!s)return;const t=Array.isArray(s)?s[0]:s;t&&I.reset({ruleName:t.rule_name||"",ruleImage:null})},[w,_,null==P?void 0:P.data,I]);const z=I.handleSubmit(async e=>{var s,a,l;try{const r=new FormData;r.append("ruleName",e.ruleName),e.ruleImage&&r.append("ruleImage",e.ruleImage),_&&S&&r.append("id",S.toString());const i=await D.mutateAsync({api:_?h.api_updateActRulesApi:h.api_PostActRulesApi,data:r});(null==(s=null==i?void 0:i.data)?void 0:s.status)?(t.success((null==(a=null==i?void 0:i.data)?void 0:a.message)||(_?"Act/Rule updated successfully":"Act/Rule created successfully")),R(!1),C(!1),k(null),I.reset(A),L.refetch()):t.error((null==(l=null==i?void 0:i.data)?void 0:l.message)||"Failed to save Act/Rule")}catch(r){}});return a.jsxs("div",{children:[a.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:a.jsxs(d,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[a.jsx("div",{className:"border-b bg-muted/30 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-purple-600/10 text-purple-600",children:a.jsx(r,{className:"h-6 w-6"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Acts & Rules"}),a.jsxs("div",{className:"inline-block rounded-full bg-purple-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-purple-600",children:[F.length," Items"]})]})]}),a.jsxs(j,{type:"button",onClick:()=>{C(!1),k(null),I.reset(A),R(!0)},className:"flex items-center gap-2 bg-primary shadow-md transition-all hover:bg-primary/90 active:scale-95",children:[a.jsx(r,{className:"h-4 w-4"}),"Add Act/Rule"]})]})}),a.jsx(c,{className:"p-0",children:L.isLoading?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(N,{}),a.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading Acts & Rules..."})]})}):F.length>0?a.jsx("div",{className:"space-y-4 p-6",children:F.map(e=>a.jsx("div",{className:"rounded-lg border p-4 transition-shadow hover:shadow-md",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"mb-2 text-lg font-semibold text-foreground",children:e.rule_name}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[a.jsxs("span",{children:["Ref: ",e.reference_no]}),a.jsxs("span",{children:["Created:"," ",new Date(e.created_at).toLocaleDateString()]}),a.jsx("span",{className:"rounded-full px-2 py-1 text-xs font-medium "+(1===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:1===e.status?"Active":"Inactive"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[e.rule_image_url&&a.jsx(j,{variant:"ghost",size:"icon",onClick:()=>((e,s)=>{if(e){const t=document.createElement("a");t.href=e,t.download=s,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}})(e.rule_image_url,e.rule_name),className:"h-8 w-8 text-green-600 hover:bg-green-600/10",children:a.jsx(i,{className:"h-4 w-4"})}),a.jsx(j,{variant:"ghost",size:"icon",onClick:()=>(e=>{C(!0),k(e.id),R(!0)})(e),className:"h-8 w-8 text-blue-600 hover:bg-blue-600/10",children:a.jsx(n,{className:"h-4 w-4"})}),a.jsx(v,{checked:1===e.is_suspended,onCheckedChange:()=>(async(e,s)=>{var a,l,r;try{const i=await D.mutateAsync({api:h.api_deleteActRulesApi,data:{id:e,status:1===s?0:1}});(null==(a=null==i?void 0:i.data)?void 0:a.status)?(t.success((null==(l=null==i?void 0:i.data)?void 0:l.message)||`Act/Rule ${1===s?"deactivated":"activated"} successfully`),L.refetch()):t.error((null==(r=null==i?void 0:i.data)?void 0:r.message)||"Failed to update status")}catch(i){}})(e.id,e.is_suspended),className:"data-[state=checked]:bg-green-500"})]})]})},e.id))}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[a.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:a.jsx(r,{className:"h-12 w-12 text-muted-foreground/40"})}),a.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No Acts & Rules"}),a.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Add acts and rules to display on the citizen landing page."})]})})]})}),a.jsx(u,{open:w,onOpenChange:e=>{R(e),e||(C(!1),k(null),I.reset(A))},children:a.jsxs(o,{className:"max-h-[90vh] min-w-[50vw] overflow-y-auto",children:[a.jsx(m,{children:a.jsx(x,{className:"text-xl font-bold",children:_?"Update Act/Rule":"Add Act/Rule"})}),_&&P.isLoading?a.jsxs("div",{className:"py-10 text-center",children:[a.jsx(N,{}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Loading Act/Rule details..."})]}):a.jsxs("form",{onSubmit:z,className:"space-y-5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(g,{htmlFor:"ruleName",children:"Rule Name *"}),a.jsx(f,{id:"ruleName",...I.register("ruleName",{required:"Rule name is required"}),placeholder:"Enter rule name"}),I.formState.errors.ruleName&&a.jsx("p",{className:"text-sm text-red-500",children:I.formState.errors.ruleName.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(g,{htmlFor:"ruleImage",children:["Rule Document ",!_&&"*"]}),a.jsx(f,{id:"ruleImage",type:"file",accept:".pdf,.doc,.docx",onChange:e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];I.setValue("ruleImage",t||null)}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: PDF, DOC, DOCX"})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 border-t pt-4",children:[a.jsx(j,{type:"button",variant:"outline",onClick:()=>R(!1),children:"Cancel"}),a.jsx(j,{type:"submit",className:"min-w-[120px]",disabled:D.isPending,children:D.isPending?"Saving...":_?"Update Act/Rule":"Create Act/Rule"})]})]})]})})]})}function R(){return a.jsx(p,{title:"Act & Rules",subTitle:"Manage Acts & Rules Masters",children:a.jsx(w,{})})}export{R as default};
