import{m as e,j as a,E as t,ai as s,ac as r,aj as l,ak as i,a5 as d,al as n,r as o,am as c,an as x,ao as m,ap as u,aq as b,ar as h,M as p,as as g,at as f,I as j,y as v,B as N,z as k,au as w,av as y,aw as _,ab as C,ax as z,ay as S,H as A,G as I,P as R,a2 as W,K as $,az as M,aA as L,aB as D,aC as O,aD as U,aE as B,aF as E,aG as P,c as T,af as F,aH as q}from"./vendor-C2pSf0e_.js";import{e as Z,C as V,f as G,n as H,b as K,s as Q,t as Y,v as J,u as X,w as ee,x as ae,y as te,z as se,I as re,S as le,T as ie,h as de,i as ne,j as oe,k as ce,l as xe,q as me,g as ue,m as be,A as he,P as pe}from"./index-DHN82BNk.js";import{R as ge,H as fe}from"./icons-EVOHFWxn.js";import{C as je}from"./CreateUlbForm-u96WeN-f.js";import{T as ve,a as Ne,b as ke,c as we}from"./tabs-Bp5PGmLE.js";import{c as ye,a as _e,b as Ce}from"./yup-D2FteOaG.js";import{a8 as ze,a9 as Se,aa as Ae,ab as Ie,ac as Re,ad as We,ae as $e,af as Me,ag as Le,ah as De,ai as Oe,aj as Ue,ak as Be}from"./ui-DEgguNHf.js";import{B as Ee}from"./badge-D4bSPsJ7.js";import{c as Pe}from"./query-DWeUG8lz.js";import"./axios-Dos3PyFQ.js";import"./zustand-DirRCQQf.js";import"./RHFSelectField-BjY-eWmh.js";const Te=({ulbName:l,ulb_logo:i,globalProgress:d,moduleProgress:n,onBack:o,onRefresh:c})=>{const x=e();return a.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-slate-900 px-8 py-10 shadow-2xl dark:bg-black",children:[a.jsx("div",{className:"absolute right-0 top-0 -mr-32 -mt-32 h-64 w-64 rounded-full bg-primary/5 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 -mb-32 -ml-32 h-64 w-64 rounded-full bg-primary/5 blur-3xl"}),a.jsx("div",{className:"relative z-10 mx-auto max-w-7xl rounded-2xl",children:a.jsxs("div",{className:"mb-8 flex flex-col justify-between gap-8 md:flex-row md:items-end",children:[a.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex-1",children:[a.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[i?a.jsx("div",{className:"h-16 w-16 overflow-hidden rounded-2xl bg-white p-2 shadow-2xl ring-4 ring-white/10",children:a.jsx("img",{onClick:()=>window.open(i,"_blank"),src:i,alt:l,className:"h-full w-full object-contain cursor-pointer"})}):a.jsx("div",{className:"rounded-2xl bg-primary/10 p-3 text-primary ring-1 ring-primary/20",children:a.jsx(s,{className:"animate-spin-slow",size:24})}),a.jsx("h1",{className:"text-2xl font-black tracking-tight text-white md:text-3xl",children:l})]}),a.jsxs("div",{className:"mt-4 max-w-md",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-widest text-muted-foreground",children:"Global Setup"}),a.jsxs("span",{className:"text-[10px] font-black "+(100===d?"text-emerald-400":"text-red-400"),children:[d,"%"," ",100===d?"(Complete)":"(Incomplete)  "]})]}),a.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-800 p-[1px]",children:a.jsx(t.div,{initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"},className:"h-full rounded-full bg-primary shadow-[0_0_10px_rgba(59,130,246,0.5)]"})})]}),a.jsxs("div",{className:"mt-8 max-w-md",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-widest text-muted-foreground",children:"Module Setup"}),a.jsxs("span",{className:"text-[10px] font-black "+(100===n?"text-emerald-400":"text-red-400"),children:[n,"%"," ",100===n?"(Complete)":"(Incomplete)"]})]}),a.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-800 p-[1px]",children:a.jsx(t.div,{initial:{width:0},animate:{width:`${n}%`},transition:{duration:1,ease:"easeOut"},className:"h-full rounded-full bg-primary shadow-[0_0_10px_rgba(59,130,246,0.5)]"})})]})]}),a.jsx(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"flex gap-3",children:a.jsxs(Z,{variant:"outline",onClick:()=>x(-1),className:"border-slate-700 bg-slate-800/50 text-slate-300 backdrop-blur-sm hover:bg-slate-700 hover:text-white",children:[a.jsx(r,{className:"mr-2"}),o?"Switch ULB":"Back"]})}),a.jsx(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"flex gap-3",children:a.jsxs(Z,{variant:"outline",onClick:()=>null==c?void 0:c(),className:"border-slate-700 bg-slate-800/50 text-slate-300 backdrop-blur-sm hover:bg-slate-700 hover:text-white",children:[a.jsx(ge,{className:"mr-2 h-4"}),"Refresh"]})})]})})]})},Fe=({data:e})=>{var s;const{basic_information:r,global_setup:o}=e,c=[{label:"Municipal Code",value:r.code,icon:l},{label:"Regional Association",value:r.association_with||"N/A",icon:i},{label:"Ward Count",value:(null==(s=null==o?void 0:o.ward_count)?void 0:s.toLocaleString())||"0",icon:d},{label:"Operational Status",value:r.active_status?"active":"inactive",icon:n,isStatus:!0}];return a.jsx("div",{className:"grid grid-cols-1 gap-4 px-8 md:grid-cols-2 lg:grid-cols-4",children:c.map((e,s)=>a.jsx(t.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1*s+.3},children:a.jsx(V,{className:"group overflow-hidden border-none bg-white shadow-xl transition-all duration-300 hover:shadow-2xl dark:bg-slate-900",children:a.jsx(G,{className:"p-6",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"rounded-xl bg-slate-100 p-3 text-slate-500 transition-all duration-300 group-hover:bg-primary/10 group-hover:text-primary dark:bg-slate-800 dark:text-slate-400",children:a.jsx(e.icon,{size:20})}),a.jsxs("div",{className:"max-h-12 min-h-12",children:[a.jsx("p",{className:"mb-1 text-[10px] font-normal uppercase tracking-widest text-muted-foreground",children:e.label}),e.isStatus?a.jsxs("div",{className:H("inline-flex items-center gap-1.5 rounded-full px-2.5 py-0.5 text-[10px] font-bold uppercase tracking-wider","active"===e.value?"border border-emerald-500/20 bg-emerald-500/10 text-emerald-600":"border border-red-500/20 bg-red-500/10 text-red-500"),children:[a.jsx("div",{className:H("h-1.5 w-1.5 animate-pulse rounded-full","active"===e.value?"bg-emerald-500":"bg-red-500")}),e.value]}):a.jsx("p",{className:"text-sm font-black tracking-tight text-slate-800 dark:text-slate-200",children:e.value})]})]})})})},e.label))})},qe=({data:e,onSave:s})=>{var r,l,i;const[d,n]=o.useState(!0),[v,N]=o.useState(!1),[k,w]=o.useState(!1),[y,_]=o.useState(null),C=K({api:Q.getDistrictList,config:{stateId:16},options:{enabled:!0}}),z=[{label:"Official Name",value:e.ulb_name,icon:c,fullWidth:!0},{label:"Ulb Type",value:(null==e?void 0:e.ulb_type)||"N/A",icon:x},{label:"Pin Code",value:(null==e?void 0:e.pin_code)||"N/A",icon:m},{label:"Address",value:(null==e?void 0:e.address)||"N/A",icon:m,fullWidth:!0},{label:"Establishment Date",value:e.incorporation_date?new Date(e.incorporation_date).toLocaleDateString():"N/A",icon:u},{label:"Phone Number",value:(null==e?void 0:e.mobile_no)||"N/A",icon:b},{label:"Corporate Email",value:e.email||"N/A",icon:h,fullWidth:!0},{label:"District",value:(null==(i=null==(l=null==(r=null==C?void 0:C.data)?void 0:r.data)?void 0:l.find(a=>a.id==e.district_id))?void 0:i.district_name)||"N/A",icon:c}];return a.jsxs(a.Fragment,{children:[a.jsxs(V,{className:"mx-8 overflow-hidden border-none bg-white shadow-xl transition-all duration-500 dark:bg-slate-900 ",children:[a.jsxs(Y,{className:"flex cursor-pointer flex-row items-center justify-between border-b border-slate-100 bg-slate-50/50 p-6 transition-colors hover:bg-slate-100 dark:border-slate-800 dark:bg-slate-800/30 dark:hover:bg-slate-800/50",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"rounded-xl bg-primary/10 p-3 text-primary ring-1 ring-primary/20",children:a.jsx(c,{})}),a.jsxs("div",{children:[a.jsx(J,{className:"text-xl font-black tracking-tight text-slate-800 dark:text-slate-200",children:"Basic Configuration"}),a.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Core identification and contact matrix"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(Z,{onClick:()=>(_(e),w(!0),void N(!0)),variant:"outline",size:"sm",className:"h-9 border-slate-200 bg-white px-4 shadow-sm transition-all hover:bg-primary hover:text-white dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[a.jsx(p,{className:"mr-2"}),"Modify"]}),a.jsx("div",{onClick:()=>n(!d),className:"text-slate-400",children:d?a.jsx(g,{}):a.jsx(f,{})})]})]}),a.jsx(j,{children:d&&a.jsx(t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:a.jsx(G,{className:"p-8",children:a.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:z.map((e,t)=>a.jsxs("div",{className:H("group flex gap-4 rounded-2xl border border-slate-100 bg-slate-50 p-4 transition-all duration-300 hover:border-primary/20 hover:bg-white hover:shadow-lg dark:border-slate-800 dark:bg-slate-800/20 dark:hover:bg-slate-800",e.fullWidth&&"md:col-span-2"),children:[a.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-white text-slate-400 shadow-sm transition-all group-hover:scale-110 group-hover:text-primary dark:bg-slate-700",children:a.jsx(e.icon,{size:16})}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-1 text-[10px] font-normal uppercase tracking-widest text-muted-foreground",children:e.label}),a.jsx("p",{className:"text-sm font-bold leading-tight text-slate-800 dark:text-slate-200 ",children:e.value||"N/A"})]})]},`${e.label}-${t}`))})})})})]}),a.jsx(je,{open:v,setOpen:N,edit:k,setEdit:w,editData:y,title:k?"Update ULB Details":"Add New ULB",refetch:()=>s()})]})},Ze=ye().shape({id:Ce().nullable(),mode:_e().oneOf(["single","bulk"]).default("single"),wardNumber:_e().when("mode",{is:"single",then:e=>e.required("Ward Number is required").matches(/^\d+$/,"Must be a number"),otherwise:e=>e.notRequired()}),startWard:_e().when("mode",{is:"bulk",then:e=>e.required("Start is required").matches(/^\d+$/,"Must be a number"),otherwise:e=>e.notRequired()}),endWard:_e().when("mode",{is:"bulk",then:e=>e.required("End is required").matches(/^\d+$/,"Must be a number"),otherwise:e=>e.notRequired()})}),Ve=({open:e,onOpenChange:t,ulbId:s,onRefresh:r})=>{const[l,n]=o.useState(null),{data:c,refetch:x,isLoading:m}=K({api:Q.api_getUlbWardList,key:`wardList-${s}`,config:{ulbId:s},options:{enabled:e&&!!s}}),u=X({}),b=X({}),h=X({}),{register:g,handleSubmit:f,reset:j,setValue:w,watch:y,formState:{errors:_,isSubmitting:C}}=v({resolver:N(Ze),defaultValues:{id:null,mode:"single",wardNumber:"",startWard:"",endWard:""}}),z=y("mode"),S=(null==c?void 0:c.data)||[];return a.jsx(ee,{open:e,onOpenChange:t,children:a.jsxs(ae,{className:"max-h-[80vh] max-w-3xl overflow-hidden border-none bg-white p-0 shadow-2xl dark:bg-slate-900",children:[a.jsx(te,{className:"h-20 bg-slate-50 px-6 py-4  dark:bg-slate-800/50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(se,{className:"flex items-center gap-3 text-xl font-black tracking-tight text-slate-800 dark:text-slate-100",children:[a.jsx("div",{className:"rounded-xl bg-primary/10 p-2 text-primary",children:a.jsx(d,{})}),"Ward Matrix Configuration"]}),!l&&a.jsxs("div",{className:"mr-8 flex items-center gap-1 rounded-xl bg-slate-200/50 p-1 dark:bg-slate-800",children:[a.jsx("button",{onClick:()=>w("mode","single"),className:H("flex items-center gap-2 rounded-lg px-3 py-1.5 text-xs font-bold transition-all","single"===z?"bg-white text-primary shadow-sm dark:bg-slate-700":"text-slate-500 hover:text-slate-700"),children:"Single"}),a.jsxs("button",{onClick:()=>w("mode","bulk"),className:H("flex items-center gap-2 rounded-lg px-3 py-1.5 text-xs font-bold transition-all","bulk"===z?"bg-white text-primary shadow-sm dark:bg-slate-700":"text-slate-500 hover:text-slate-700"),children:[a.jsx(i,{size:10}),"Bulk Range"]})]})]})}),a.jsxs("div",{className:"px-6 py-4",children:[a.jsxs("form",{onSubmit:f(async e=>{var a,t,l;try{if("bulk"===e.mode){const t=parseInt(e.startWard),l=parseInt(e.endWard);if(t>l)return void k.error("Start ward cannot be greater than end ward");const d=k.loading(`Creating wards ${t} to ${l}...`);let n=0,o=0;for(let e=t;e<=l;e++)try{const t=await u.mutateAsync({api:Q.api_createUlbWard,data:{ulbId:s,wardNumber:e.toString()}});(null==(a=null==t?void 0:t.data)?void 0:a.status)?n++:o++}catch(i){o++}return k.dismiss(d),n>0&&(k.success(`Successfully created ${n} wards`),j({id:null,wardNumber:"",startWard:"",endWard:"",mode:"bulk"}),x(),r()),void(o>0&&k.error(`Failed to create ${o} wards (they might already exist)`))}const d=!!e.id,o=d?Q.api_updateUlbWard:Q.api_createUlbWard,c=d?{id:e.id,wardNumber:e.wardNumber,ulbId:s}:{ulbId:s,wardNumber:e.wardNumber},m=await(d?b:u).mutateAsync({api:o,data:c});(null==(t=null==m?void 0:m.data)?void 0:t.status)?(k.success(m.data.message||`Ward ${d?"updated":"created"} successfully`),r(),j({id:null,wardNumber:"",startWard:"",endWard:"",mode:"single"}),n(null),x()):k.error((null==(l=null==m?void 0:m.data)?void 0:l.message)||"Operation failed")}catch(d){k.error(ue(d))}}),className:"mb-6 rounded-2xl border border-slate-100 bg-slate-50/50 p-4 dark:border-slate-800 dark:bg-slate-800/20",children:[a.jsxs("div",{className:"flex items-end gap-4",children:["single"===z?a.jsxs("div",{className:"w-full max-w-sm space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:l?"Update Ward Identifier":"New Ward Identifier"}),a.jsx(re,{...g("wardNumber"),placeholder:"Enter Ward (e.g. 101)",className:"h-10 border-slate-200 bg-white font-bold text-slate-800 transition-all focus:ring-primary/20 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200"}),_.wardNumber&&a.jsx("p",{className:"text-xs font-bold text-red-500",children:_.wardNumber.message})]}):a.jsxs("div",{className:"flex max-w-sm flex-1 gap-4",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Start"}),a.jsx(re,{...g("startWard"),placeholder:"From",className:"h-10 border-slate-200 bg-white font-bold transition-all dark:border-slate-700 dark:bg-slate-800"}),_.startWard&&a.jsx("p",{className:"text-xs font-bold text-red-500",children:_.startWard.message})]}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"End"}),a.jsx(re,{...g("endWard"),placeholder:"To",className:"h-10 border-slate-200 bg-white font-bold transition-all dark:border-slate-700 dark:bg-slate-800"}),_.endWard&&a.jsx("p",{className:"text-xs font-bold text-red-500",children:_.endWard.message})]})]}),a.jsxs("div",{className:"flex gap-2",children:[l&&a.jsx(Z,{type:"button",variant:"outline",onClick:()=>{n(null),j({id:null,wardNumber:"",startWard:"",endWard:"",mode:"single"})},className:"h-10 border-slate-200 px-4 font-bold dark:border-slate-700",children:"Cancel"}),a.jsx(Z,{type:"submit",disabled:C,className:"h-10 min-w-[120px] bg-primary text-xs font-bold shadow-lg shadow-primary/20 hover:bg-primary/90 active:scale-95",children:C?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(le,{className:"h-3 w-3 text-white"}),a.jsx("span",{children:"Processing"})]}):l?"Update":"single"===z?"Add":"Run Bulk"})]})]}),"bulk"===z&&a.jsx("p",{className:"mt-3 text-[10px] font-bold italic text-slate-400",children:"* Creates a ward for every number in the specified range."})]}),a.jsx("div",{className:"max-h-[400px] overflow-y-auto rounded-2xl border border-slate-100 bg-white shadow-inner dark:border-slate-800 dark:bg-slate-900",children:a.jsxs(ie,{children:[a.jsx(de,{className:"sticky top-0 z-10 bg-slate-50 dark:bg-slate-800",children:a.jsxs(ne,{children:[a.jsx(oe,{className:"w-[100px] font-black text-slate-400",children:"ID"}),a.jsx(oe,{className:"font-black text-slate-400",children:"WARD IDENTIFIER"}),a.jsx(oe,{className:"font-black text-slate-400",children:"AVAILABILITY"}),a.jsx(oe,{className:"text-right font-black text-slate-400",children:"MANAGEMENT"})]})}),a.jsx(ce,{children:m?a.jsx(ne,{children:a.jsx(xe,{colSpan:4,className:"h-32 text-center",children:a.jsx(le,{className:"mx-auto text-primary"})})}):0===S.length?a.jsx(ne,{children:a.jsx(xe,{colSpan:4,className:"h-32 text-center font-medium text-slate-400",children:"No active wards configured."})}):[...S].reverse().map(e=>a.jsxs(ne,{className:"group border-slate-50 transition-colors hover:bg-slate-50/80 dark:border-slate-800 dark:hover:bg-slate-800/30",children:[a.jsxs(xe,{className:"font-mono text-[10px] font-black text-slate-300",children:["#",e.id]}),a.jsx(xe,{className:"font-black text-slate-700 dark:text-slate-300",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:H("h-2 w-2 rounded-full",1===e.status||!0===e.status?"bg-emerald-500":"bg-red-500")}),e.ward_name||e.ward_number||`Ward ${e.id}`]})}),a.jsx(xe,{children:a.jsx(me,{checked:1===e.status||!0===e.status,onCheckedChange:()=>(async(e,a)=>{var t,s;try{const r=a?0:1,l=await h.mutateAsync({api:Q.api_deleteUlbWard,data:{id:e,status:r}});(null==(t=null==l?void 0:l.data)?void 0:t.status)?(k.success(`Ward ${r?"activated":"deactivated"} successfully`),x()):k.error((null==(s=null==l?void 0:l.data)?void 0:s.message)||"Status update failed")}catch(r){k.error(ue(r))}})(e.id,1===e.status||!0===e.status),className:"data-[state=checked]:bg-emerald-500 data-[state=unchecked]:bg-red-500"})}),a.jsx(xe,{className:"text-right",children:a.jsx("div",{className:"flex justify-end gap-2",children:a.jsx(Z,{size:"icon",variant:"ghost",onClick:()=>(e=>{n(e.id),w("mode","single"),w("id",e.id),w("wardNumber",e.ward_name||e.ward_number)})(e),className:"h-9 w-9 rounded-xl text-slate-400 transition-colors hover:bg-primary/10 hover:text-primary",children:a.jsx(p,{size:14})})})})]},e.id))})]})})]})]})})},Ge=ye().shape({id:Ce().nullable(),zone:_e().required("Zone Name is required").min(2,"Zone Name must be at least 2 characters")}),He=({open:e,onOpenChange:t,ulbId:s,onRefresh:r})=>{const[l,d]=o.useState(null),{data:n,refetch:c,isLoading:x}=K({api:Q.zone_list_Api,key:`zoneList-${s}`,config:{ulbId:s},options:{enabled:e&&!!s}}),m=X({}),u=X({}),b=X({}),{register:h,handleSubmit:g,reset:f,setValue:j,formState:{errors:w,isSubmitting:y}}=v({resolver:N(Ge),defaultValues:{id:null,zone:""}}),_=(null==n?void 0:n.data)||[];return a.jsx(ee,{open:e,onOpenChange:t,children:a.jsxs(ae,{className:"max-w-3xl overflow-hidden border-none bg-white p-0 shadow-2xl dark:bg-slate-900",children:[a.jsx(te,{className:"bg-slate-50 px-6 py-4 dark:bg-slate-800/50",children:a.jsxs(se,{className:"flex items-center gap-3 text-xl font-black tracking-tight text-slate-800 dark:text-slate-100",children:[a.jsx("div",{className:"rounded-xl bg-primary/10 p-2 text-primary",children:a.jsx(i,{})}),"Zone Distribution Matrix"]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("form",{onSubmit:g(async e=>{var a,t;try{const l=!!e.id,i=l?Q.api_updateZoneApi:Q.api_PostZoneApi,n=l?{id:e.id,zone:e.zone,ulbId:s}:{ulbId:s,zone:e.zone},o=await(l?u:m).mutateAsync({api:i,data:n});(null==(a=null==o?void 0:o.data)?void 0:a.status)?(k.success(o.data.message||`Zone ${l?"updated":"created"} successfully`),f({id:null,zone:""}),d(null),c(),r()):k.error((null==(t=null==o?void 0:o.data)?void 0:t.message)||"Operation failed")}catch(l){k.error(ue(l))}}),className:"mb-8 flex items-end gap-4 rounded-2xl border border-slate-100 bg-slate-50/50 p-4 dark:border-slate-800 dark:bg-slate-800/20",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:l?"Update Zone Identifier":"New Zone Identifier"}),a.jsx(re,{...h("zone"),placeholder:"Enter Zone Name (e.g. North Zone)",className:"h-11 border-slate-200 bg-white font-bold text-slate-800 transition-all focus:ring-primary/20 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200"}),w.zone&&a.jsx("p",{className:"text-xs font-bold text-red-500",children:w.zone.message})]}),a.jsxs("div",{className:"flex gap-2",children:[l&&a.jsx(Z,{type:"button",variant:"outline",onClick:()=>{d(null),f({id:null,zone:""})},className:"h-11 px-6",children:"Cancel"}),a.jsx(Z,{type:"submit",disabled:y,className:"h-11 min-w-[120px] bg-primary font-bold shadow-lg shadow-primary/20 hover:bg-primary/90",children:y?a.jsx(le,{className:"h-4 w-4 text-white"}):l?"Update":"Create"})]})]}),a.jsx("div",{className:"max-h-[400px] overflow-y-auto rounded-xl border border-slate-100 bg-white dark:border-slate-800 dark:bg-slate-900",children:a.jsxs(ie,{children:[a.jsx(de,{className:"bg-slate-50 dark:bg-slate-800/50",children:a.jsxs(ne,{children:[a.jsx(oe,{className:"font-bold text-slate-500",children:"ID"}),a.jsx(oe,{className:"font-bold text-slate-500",children:"Zone Name"}),a.jsx(oe,{className:"font-bold text-slate-500",children:"ULB Name"}),a.jsx(oe,{className:"font-bold text-slate-500",children:"Status"}),a.jsx(oe,{className:"text-right font-bold text-slate-500",children:"Actions"})]})}),a.jsx(ce,{children:x?a.jsx(ne,{children:a.jsx(xe,{colSpan:5,className:"h-32 text-center",children:a.jsx(le,{className:"mx-auto text-primary"})})}):0===_.length?a.jsx(ne,{children:a.jsx(xe,{colSpan:5,className:"h-32 text-center text-slate-400",children:"No zones found. Create one above."})}):_.map(e=>a.jsxs(ne,{className:"group transition-colors hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[a.jsxs(xe,{className:"font-mono text-xs font-bold text-slate-400",children:["#",e.id]}),a.jsx(xe,{className:"font-bold text-slate-700 dark:text-slate-300",children:e.zone}),a.jsx(xe,{className:"text-xs font-medium text-slate-500",children:e.ulb_name}),a.jsx(xe,{children:a.jsx(me,{checked:e.status,onCheckedChange:()=>(async(e,a)=>{var t,s;try{const r=a?0:1,l=await b.mutateAsync({api:Q.api_deleteZoneApi,data:{id:e,status:r}});(null==(t=null==l?void 0:l.data)?void 0:t.status)?(k.success(`Zone ${r?"activated":"deactivated"} successfully`),c()):k.error((null==(s=null==l?void 0:l.data)?void 0:s.message)||"Status update failed")}catch(r){k.error(ue(r))}})(e.id,e.status),className:"data-[state=checked]:bg-emerald-500"})}),a.jsx(xe,{className:"text-right",children:a.jsx("div",{className:"flex justify-end gap-2 opacity-0 transition-opacity group-hover:opacity-100",children:a.jsx(Z,{size:"icon",variant:"ghost",type:"button",onClick:()=>(e=>{d(e.id),j("id",e.id),j("zone",e.zone_name||e.zone)})(e),className:"h-8 w-8 text-slate-400 hover:bg-primary/10 hover:text-primary",children:a.jsx(p,{size:14})})})})]},e.id))})]})})]})]})})},Ke=o.forwardRef(({className:e,children:t,...s},r)=>a.jsxs(ze,{ref:r,className:H("relative overflow-hidden",e),...s,children:[a.jsx(Se,{className:"h-full w-full rounded-[inherit]",children:t}),a.jsx(Qe,{}),a.jsx(Ae,{})]}));Ke.displayName=ze.displayName;const Qe=o.forwardRef(({className:e,orientation:t="vertical",...s},r)=>a.jsx(Ie,{ref:r,orientation:t,className:H("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...s,children:a.jsx(Re,{className:"relative flex-1 rounded-full bg-border"})}));function Ye({className:e,...t}){return a.jsx("div",{className:H("animate-pulse rounded-md bg-muted",e),...t})}function Je({tableName:e,headers:t,onSuccess:s,onCancel:r,editData:l}){const[i,d]=o.useState(l||{}),[n,c]=o.useState(!1),x=!!l,m=o.useMemo(()=>t.filter(e=>!["id","created_at","updated_at","deleted_at","property_type_code","user_id"].includes(e.toLowerCase())),[t]),u=(e,a)=>{d(t=>({...t,[e]:a}))},b=X({}),h=X({});return a.jsxs(ne,{className:"border-b-2 border-blue-500 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20",children:[a.jsx(xe,{className:"border-r bg-blue-100/50 text-center font-mono text-xs font-bold text-blue-600 dark:border-white/5 dark:bg-blue-900/30",children:x?"EDIT":"NEW"}),t.map(e=>{const t=m.includes(e),s=(e=>{const a=e.toLowerCase();return a.includes("status")||a.includes("active")?"boolean":a.includes("date")||a.includes("time")||a.includes("created")||a.includes("updated")?"date":a.includes("amount")||a.includes("price")||a.includes("count")||a.includes("number")?"number":"text"})(e);return t?a.jsx(xe,{className:"border-r px-2 py-2 dark:border-white/5",children:"boolean"===s?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{checked:i[e]||!1,onCheckedChange:a=>u(e,a),className:"data-[state=checked]:bg-green-500"}),a.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:i[e]?"Active":"Inactive"})]}):a.jsx(re,{type:s,value:i[e]||"",onChange:a=>u(e,a.target.value),required:!0,placeholder:`Enter ${e.replace(/_/g," ")}`,className:"h-8 min-w-[150px] rounded border-slate-300 bg-white text-xs shadow-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-800"})},e):a.jsx(xe,{className:"border-r px-2 py-2 dark:border-white/5",children:a.jsx("span",{className:"text-xs italic text-slate-400",children:"Auto"})},e)}),a.jsx(xe,{className:"sticky right-0 bg-blue-50/90 px-2 py-2 dark:bg-blue-900/30",children:a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx(Z,{type:"button",variant:"ghost",size:"icon",onClick:r,disabled:n,className:"h-7 w-7 text-red-500 hover:bg-red-500/10",children:a.jsx(w,{size:12})}),a.jsx(Z,{type:"button",onClick:async a=>{var t,r;a.preventDefault(),c(!0);try{const a={};m.forEach(e=>{void 0!==i[e]&&""!==i[e]&&(a[e]=i[e])});const n={tableName:e,data:a,id:null==l?void 0:l.id},o=x?h:b,c=x?be.updateDynamicTable:be.createDynamicTable,u=await o.mutateAsync({api:c,data:n});(null==(t=null==u?void 0:u.data)?void 0:t.status)?(k.success(u.data.message||`Record ${x?"updated":"created"} successfully!`),d({}),s()):k.error((null==(r=null==u?void 0:u.data)?void 0:r.message)||`Failed to ${x?"update":"create"} record`)}catch(n){k.error((null==n?void 0:n.message)||`An error occurred while ${x?"updating":"creating"} record`)}finally{c(!1)}},disabled:n,size:"icon",className:"h-7 w-7 bg-green-600 text-white hover:bg-green-700",children:n?a.jsx(y,{className:"animate-spin",size:12}):a.jsx(_,{size:12})})]})})]})}function Xe({open:e,onOpenChange:t,moduleName:s,masterName:r,originalName:l}){var i,d,n;const[c,x]=o.useState(""),[m,u]=o.useState(!1),[b,h]=o.useState(null),[g]=C(),f=g.get("ulb_id"),j=X({}),v=K({api:be.getDynamicTableStructure,key:`dynamic_table_${l}`,config:{tableName:l,ulbId:Number(f)},options:{enabled:!!l&&e}}),N=(null==(i=null==v?void 0:v.data)?void 0:i.data)||[],w=null==v?void 0:v.isLoading,y=o.useMemo(()=>0===N.length?[]:Object.keys(N[0]),[N]),_=o.useMemo(()=>c?N.filter(e=>y.some(a=>String(e[a]).toLowerCase().includes(c.toLowerCase()))):N,[N,c,y]);return a.jsx(a.Fragment,{children:a.jsx(ee,{open:e,onOpenChange:t,children:a.jsxs(ae,{className:"flex h-[95vh] w-full max-w-[95vw] flex-col overflow-auto border-none bg-[#f8f9fc] p-0 shadow-2xl dark:bg-secondary",children:[a.jsx(te,{className:"shrink-0 border-b border-white/10 bg-secondary px-8 py-4 text-muted-foreground",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg border border-blue-500/30 bg-blue-500/20 text-blue-400 backdrop-blur-md",children:a.jsx(z,{size:18})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(se,{className:"text-xl font-bold tracking-tight",children:r}),a.jsx(Ee,{variant:"outline",className:"border-blue-500/30 bg-blue-500/10 text-[10px] font-black uppercase tracking-widest text-primary",children:l})]}),a.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-muted-foreground",children:["Registry Control â€¢ ",s]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Z,{variant:"ghost",size:"icon",onClick:()=>{v.refetch()},className:"h-9 w-9 text-primary hover:bg-white/10 hover:text-primary/60",children:a.jsx(S,{className:w?"animate-spin":""})}),a.jsxs(Z,{className:"mr-6 h-9 gap-2 rounded-lg bg-blue-600 px-4 text-sm font-bold shadow-lg shadow-blue-600/20 hover:bg-blue-700",onClick:()=>{u(!0)},children:[a.jsx(A,{size:12})," Add Row"]})]})]})}),a.jsxs("div",{className:"flex shrink-0 items-center justify-between gap-4 border-b bg-white px-8 py-3 dark:border-white/5 dark:bg-[#1a1d24]",children:[a.jsxs("div",{className:"relative w-full max-w-md",children:[a.jsx(I,{className:"absolute left-3.5 top-1/2 size-3 -translate-y-1/2 text-slate-400"}),a.jsx(re,{placeholder:"Filter results...",value:c,onChange:e=>x(e.target.value),className:"h-9 rounded-lg border-slate-200 bg-slate-50 pl-10 text-xs font-medium shadow-sm ring-offset-background focus-visible:ring-1 focus-visible:ring-blue-500 dark:border-white/10 dark:bg-black/20"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"mx-2 h-6 w-[1px] bg-slate-200 dark:bg-white/10"}),a.jsxs("span",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-500",children:[_.length," Rows found"]})]})]}),a.jsx("div",{className:"relative flex-1 overflow-hidden",children:a.jsxs(Ke,{className:"h-full w-full",children:[a.jsx("div",{className:"min-w-fit",children:a.jsxs(ie,{className:"border-separate border-spacing-0",children:[a.jsx(de,{className:"sticky top-0 z-10 bg-slate-100/80 backdrop-blur-md dark:bg-white/5",children:a.jsxs(ne,{className:"border-none hover:bg-transparent",children:[a.jsx(oe,{className:"w-12 border-r text-center text-[10px] font-bold uppercase tracking-tighter text-slate-500 dark:border-white/5",children:"#"}),y.map(e=>{return a.jsx(oe,{className:"border-r px-6 text-[10px] font-black uppercase tracking-widest text-slate-600 dark:border-white/5 dark:text-slate-400",children:(t=e,t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "))},e);var t}),a.jsx(oe,{className:"sticky right-0 bg-slate-100/90 px-4 text-right text-[10px] font-black uppercase tracking-widest text-slate-600 dark:bg-black/80 dark:text-slate-400",children:"Actions"})]})}),a.jsxs(ce,{children:[m&&a.jsx(Je,{tableName:l,headers:y,onSuccess:()=>{u(!1),v.refetch()},onCancel:()=>u(!1)}),w?Array.from({length:15}).map((e,t)=>a.jsxs(ne,{children:[a.jsx(xe,{children:a.jsx(Ye,{className:"h-4 w-4"})}),y.map(e=>a.jsx(xe,{children:a.jsx(Ye,{className:"h-4 w-32"})},e)),a.jsx(xe,{children:a.jsx(Ye,{className:"h-4 w-12"})})]},t)):_.length>0?_.map((e,t)=>b&&b.id===e.id?a.jsx(Je,{tableName:l,headers:y,editData:e,onSuccess:()=>{h(null),v.refetch()},onCancel:()=>h(null)},`edit-${e.id}`):a.jsxs(ne,{className:"group border-b transition-colors hover:bg-blue-500/5 dark:border-white/5",children:[a.jsx(xe,{className:"border-r bg-slate-50/50 text-center font-mono text-[10px] text-slate-400 dark:border-white/5 dark:bg-white/5",children:t+1}),y.map(t=>a.jsx(xe,{className:"whitespace-nowrap border-r px-6 font-medium dark:border-white/5",children:"status"===t?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"size-1.5 rounded-full "+(e[t]?"animate-pulse bg-emerald-500":"bg-red-500")}),a.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest "+(e[t]?"text-emerald-500":"text-red-500"),children:e[t]?"Active":"Inactive"})]}):a.jsx("span",{className:"text-xs "+("number"==typeof e[t]?"font-mono text-blue-500":"text-slate-700 dark:text-slate-300"),children:""===e[t]?a.jsx("span",{className:"italic text-slate-400",children:"null"}):String(e[t])})},t)),a.jsx(xe,{className:"sticky right-0 px-4 text-right",children:a.jsxs("div",{className:"flex justify-end gap-1 opacity-0 transition-opacity group-hover:opacity-100",children:[a.jsx(Z,{variant:"ghost",size:"icon",onClick:()=>{h(e),u(!1)},className:"h-7 w-7 text-blue-500 hover:bg-blue-500/10",children:a.jsx(p,{size:12})}),a.jsx(Z,{variant:"ghost",size:"icon",onClick:()=>(async e=>{var a,t,s;try{const r=await j.mutateAsync({api:be.deleteDynamicTable,data:{tableName:l,id:e}});(null==(a=null==r?void 0:r.data)?void 0:a.status)?(k.success((null==(t=null==r?void 0:r.data)?void 0:t.message)||"Deleted successfully"),v.refetch()):k.error((null==(s=null==r?void 0:r.data)?void 0:s.message)||"Failed to delete")}catch(r){k.error(ue(r))}})(e.id),className:"h-7 w-7 text-red-500 hover:bg-red-500/10",children:a.jsx(R,{size:12})})]})})]},e.id||t)):a.jsx(ne,{children:a.jsx(xe,{colSpan:y.length+2,className:"h-[400px] bg-white text-center dark:bg-transparent",children:a.jsxs("div",{className:"flex flex-col items-center justify-center opacity-40",children:[a.jsx(z,{size:48,className:"mb-4 text-slate-300"}),a.jsx("p",{className:"text-sm font-bold uppercase tracking-widest",children:"No data records found"}),a.jsxs("p",{className:"text-xs",children:["The table ",l," is currently empty."]})]})})})]})]})}),a.jsx(Qe,{orientation:"horizontal"})]})}),a.jsxs("div",{className:"flex shrink-0 items-center justify-between border-t bg-slate-50 px-8 py-2 text-[10px] font-bold uppercase tracking-widest text-slate-400 dark:border-white/5 dark:bg-black/40",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{children:["Connected to: ",r," Registry"]}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsxs("span",{children:["Buffer Size: ",_.length]})]}),a.jsxs("div",{children:["Server Response:"," ",(null==(n=null==(d=null==v?void 0:v.data)?void 0:d["meta-data"])?void 0:n.responsetime)||"0","ms"]})]})]})})})}function ea(){return a.jsxs("div",{className:"w-full h-svh flex justify-center items-center",children:[a.jsx(fe,{className:"animate-spin",size:32}),a.jsx("span",{className:"sr-only",children:"loading"})]})}Qe.displayName=Ie.displayName;const aa=({module:e,index:s,onOpenMaster:r})=>{var l,i,d,n;const[c,x]=o.useState(!1),m=e.id||e.module_id,[u]=C(),b=u.get("ulb_id"),h=K({api:null==(l=be)?void 0:l.moduleRegistryList,key:`moduleMasterList_${m}`,config:{moduleId:m,ulbId:Number(b)},options:{enabled:!!m}}),p=K({api:null==(i=be)?void 0:i.moduleMasterPercentage,key:`moduleMasterPercentage${m}`,config:{moduleId:m,ulbId:Number(b)},options:{enabled:!!m}}),v=(null==(d=null==h?void 0:h.data)?void 0:d.data)||[],N=v.length>0,k=(null==(n=null==p?void 0:p.data)?void 0:n.data)||{},w=(null==k?void 0:k.completion_percentage)||0,y=100===(_=w)?{card:"border-emerald-100 bg-emerald-50/20 dark:border-emerald-900/30 dark:bg-emerald-950/10 ring-emerald-500/5",header:"bg-emerald-50/50 border-emerald-100/50 dark:bg-emerald-900/20 dark:border-emerald-800/50",icon:"bg-emerald-100 text-emerald-600 dark:bg-emerald-900/40 dark:text-emerald-400",title:"text-emerald-800 dark:text-emerald-100",subtext:"text-emerald-600/70 dark:text-emerald-400/60",badge:"bg-emerald-50 text-emerald-700 border-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-800",percentage:"text-emerald-600"}:0===_?{card:"border-red-100 bg-red-50/20 dark:border-red-900/30 dark:bg-red-950/10 ring-red-500/5",header:"bg-red-50/50 border-red-100/50 dark:bg-red-900/20 dark:border-red-800/50",icon:"bg-red-100 text-red-600 dark:bg-red-900/40 dark:text-red-400",title:"text-red-800 dark:text-red-100",subtext:"text-red-600/70 dark:text-red-400/60",badge:"bg-red-50 text-red-700 border-red-100 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800",percentage:"text-red-600"}:{card:"border-amber-100 bg-amber-50/20 dark:border-amber-900/30 dark:bg-amber-950/10 ring-amber-500/5",header:"bg-amber-50/50 border-amber-100/50 dark:bg-amber-900/20 dark:border-amber-800/50",icon:"bg-amber-100 text-amber-600 dark:bg-amber-900/40 dark:text-amber-400",title:"text-amber-800 dark:text-amber-100",subtext:"text-amber-600/70 dark:text-amber-400/60",badge:"bg-amber-50 text-amber-700 border-amber-100 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800",percentage:"text-amber-600"};var _;return a.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.06*s},children:a.jsxs(V,{className:H("group overflow-hidden border shadow-sm ring-1 transition-all duration-300 hover:-translate-y-0.5 hover:shadow-lg",y.card),children:[a.jsx("div",{className:H("border-b px-5 py-4 transition-colors duration-300",y.header),children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:H("flex h-10 w-10 items-center justify-center rounded-xl transition-colors duration-300",y.icon),children:a.jsx(L,{className:"text-lg"})}),a.jsxs("div",{children:[a.jsx("h3",{className:H("text-sm font-black uppercase tracking-wider",y.title),children:e.module_name}),a.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-[11px]",children:[a.jsxs("span",{className:H("font-bold",y.subtext),children:[(null==k?void 0:k.tables_with_data)||0,"/",(null==k?void 0:k.total_tables)||0," Tables"]}),a.jsxs("span",{className:H("text-xs font-black",y.percentage),children:[w,"%"]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:H("rounded-full px-3 py-1.5 text-[10px] font-black uppercase tracking-widest shadow-sm transition-colors duration-300",y.badge),children:[v.length," Masters"]}),N&&a.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>x(!c),className:H("h-9 w-9 rounded-xl p-0 transition-all",y.icon),children:c?a.jsx(g,{}):a.jsx(f,{})})]})]})}),a.jsx(j,{children:c&&N&&a.jsx(t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:a.jsx(G,{className:"space-y-2.5 p-5",children:v.map((t,s)=>a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200/70 bg-white p-3.5 transition-all duration-200 hover:border-primary/30 hover:bg-primary/[0.03] dark:border-slate-800 dark:bg-slate-900/50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-primary/50"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:(null==t?void 0:t.display_name)||(null==t?void 0:t.table_name)}),a.jsxs("span",{className:"text-[10px] font-medium text-slate-500 dark:text-slate-400",children:["DB: ",(null==t?void 0:t.database_name)||"N/A"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"rounded-full px-2.5 py-1 text-[10px] font-bold uppercase tracking-wider "+(t.status?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"),children:t.status?"Active":"Inactive"}),a.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>r(null==e?void 0:e.module_name,(null==t?void 0:t.display_name)||(null==t?void 0:t.name),null==t?void 0:t.original_name),className:"h-8 rounded-lg border border-transparent px-3 text-[10px] font-bold uppercase tracking-wider text-primary transition-all hover:border-primary/20 hover:bg-primary/5",children:"View"})]})]},s))})})})]})})};function ta({ulbId:t}){var s,r;const[l,d]=o.useState(!1),[n,c]=o.useState(""),[x,m]=o.useState(""),[u,b]=o.useState(""),h=e(),[p]=C(),g=p.get("ulb_name"),f=p.get("ulb_id"),j=(e,a,t)=>{c(e),m(a),b(t),d(!0)},v=K({api:null==(s=be)?void 0:s.getPermittedModule,key:"permittedModuleListByUlb",config:{ulbId:t},options:{enabled:!!t}}),N=(null==(r=null==v?void 0:v.data)?void 0:r.data)||[],k=null==v?void 0:v.isLoading;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5 rounded-2xl border border-slate-200/70 bg-white px-5 py-4 shadow-sm dark:border-slate-800 dark:bg-slate-950",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/10 text-primary",children:a.jsx(i,{className:"text-sm"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-extrabold uppercase tracking-wider text-slate-800 dark:text-slate-100",children:"Module Registry Masters"}),a.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Configure and review master tables for each permitted module"})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsxs(Z,{variant:"outline",onClick:()=>{h(`/project-config/dashboard/ulb-list/permitted-module?ulb_name=${g}&ulb_id=${f}`)},children:[a.jsx(W,{className:"mr-2"})," Configure Module"]}),a.jsxs("div",{className:"inline-flex w-fit items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1.5 text-[11px] font-semibold text-slate-600 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-300",children:[a.jsx($,{className:"text-emerald-500"}),N.length," Modules"]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:k?a.jsx("div",{className:"col-span-1 rounded-xl border border-dashed border-primary/30 bg-primary/[0.03] py-12 text-center text-xl md:col-span-2",children:a.jsx(ea,{})}):N.length>0?N.map((e,t)=>a.jsx(aa,{module:e,index:t,onOpenMaster:j},e.id||e.module_id)):a.jsxs("div",{className:"col-span-1 rounded-xl border border-dashed border-slate-300 bg-slate-50 py-12 text-center dark:border-slate-800 dark:bg-slate-900 md:col-span-2",children:[a.jsx(M,{className:"mx-auto mb-3 text-2xl text-slate-400"}),a.jsx("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400",children:"No Modules Found"})]})}),a.jsx(Xe,{open:l,onOpenChange:()=>d(!1),moduleName:n,masterName:x,originalName:u})]})}const sa=({globalMaster:e,ulbId:s,onRefresh:r})=>{const[l,n]=o.useState(!1),[c,x]=o.useState(!1),m=[{id:1,name:"Ward Management",count:(null==e?void 0:e.ward_count)||0,icon:d,description:"Geographic boundaries and civic wards",color:(null==e?void 0:e.ward_count)&&e.ward_count>0?"green":"red",action:()=>n(!0)},{id:2,name:"Zone Distribution",count:e.zone_count,icon:D,description:"Macro administrative divisions",color:e.zone_count>0?"green":"red",action:()=>x(!0)}];return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mx-8 space-y-6",children:a.jsxs(ve,{defaultValue:"basic",className:"w-full",children:[a.jsx("div",{className:"mb-6 flex items-center justify-between",children:a.jsxs(Ne,{className:"h-12 gap-4 rounded-2xl bg-slate-300/50 px-4 dark:bg-slate-700/50",children:[a.jsxs(ke,{value:"basic",className:"\r\n                relative flex items-center gap-2\r\n                rounded-2xl px-6 py-2\r\n                text-xs font-extrabold uppercase tracking-widest\r\n                text-slate-600 transition-all\r\n\r\n                duration-300 ease-out hover:scale-[1.05]\r\n                hover:text-primary data-[state=active]:scale-[1.08]\r\n\r\n                data-[state=active]:bg-white\r\n                data-[state=active]:text-primary\r\n                data-[state=active]:shadow-lg\r\n                data-[state=active]:shadow-primary/30\r\n                dark:text-slate-300\r\n\r\n                dark:data-[state=active]:bg-slate-900\r\n              ",children:[a.jsx(O,{className:"text-sm"}),"Global Masters"]}),a.jsxs(ke,{value:"module",className:"\r\n                  relative flex items-center gap-2\r\n                  rounded-2xl px-6 py-2\r\n                  text-xs font-extrabold uppercase tracking-widest\r\n                  text-slate-600 transition-all\r\n\r\n                  duration-300 ease-out hover:scale-[1.05]\r\n                  hover:text-primary data-[state=active]:scale-[1.08]\r\n\r\n                  data-[state=active]:bg-white\r\n                  data-[state=active]:text-primary\r\n                  data-[state=active]:shadow-lg\r\n                  data-[state=active]:shadow-primary/30\r\n                  dark:text-slate-300\r\n\r\n                  dark:data-[state=active]:bg-slate-900\r\n                ",children:[a.jsx(i,{className:"text-sm"}),"Module Specific"]})]})}),a.jsx(we,{value:"basic",className:"mt-0",children:a.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:m.map((e,s)=>a.jsx(t.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.05*s},children:a.jsx(V,{className:`group overflow-hidden border-none bg-white shadow-lg ring-1 ring-slate-200/50 transition-all duration-500 hover:shadow-2xl bg-${e.color}-500/20 ring-${e.color}-500/20`,children:a.jsxs(G,{className:"p-0",children:[a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"mb-6 flex items-start justify-between",children:a.jsx("div",{className:H("rounded-2xl p-4 shadow-inner transition-all duration-500 group-hover:text-white","green"===e.color?"bg-green-500/10 text-green-500 group-hover:bg-green-500":"bg-red-500/10 text-red-500 group-hover:bg-red-500"),children:a.jsx(e.icon,{size:24})})}),a.jsx("h3",{className:"mb-1 text-xl font-black tracking-tight text-slate-800 dark:text-slate-200",children:e.name}),a.jsx("p",{className:"mb-3 text-[11px] font-medium text-slate-500",children:e.description}),a.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-400",children:[a.jsx(U,{className:"text-[8px]"}),"Real-time synchronization"]})]}),a.jsxs("div",{className:"flex items-center justify-between border-t border-slate-100 bg-slate-50 px-6 py-4 dark:border-slate-800 dark:bg-slate-800/50",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-3xl font-black leading-none tracking-tighter text-slate-800 dark:text-slate-200",children:e.count}),a.jsx("span",{className:"mt-1 text-[9px] font-black uppercase tracking-widest text-slate-400 dark:text-slate-500",children:"Active Records"})]}),a.jsxs(Z,{variant:"link",onClick:e.action,className:H("h-auto p-0 text-[10px] font-black uppercase tracking-widest transition-transform group-hover:translate-x-1","green"===e.color?"text-green-500 hover:text-green-600":"text-red-500 hover:text-red-600"),children:["Manage ","->"]})]})]})})},e.id))})}),a.jsx(we,{value:"module",className:"mt-0",children:a.jsx(ta,{ulbId:s})})]})}),a.jsx(Ve,{open:l,onOpenChange:n,ulbId:s,onRefresh:r}),a.jsx(He,{open:c,onOpenChange:x,ulbId:s,onRefresh:r})]})},ra=We,la=$e,ia=o.forwardRef(({className:e,...t},s)=>a.jsx(Be,{className:H("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));ia.displayName=Be.displayName;const da=o.forwardRef(({className:e,...t},s)=>a.jsxs(la,{children:[a.jsx(ia,{}),a.jsx(Me,{ref:s,className:H("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));da.displayName=Me.displayName;const na=({className:e,...t})=>a.jsx("div",{className:H("flex flex-col space-y-2 text-center sm:text-left",e),...t});na.displayName="AlertDialogHeader";const oa=({className:e,...t})=>a.jsx("div",{className:H("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});oa.displayName="AlertDialogFooter";const ca=o.forwardRef(({className:e,...t},s)=>a.jsx(Le,{ref:s,className:H("text-lg font-semibold",e),...t}));ca.displayName=Le.displayName;const xa=o.forwardRef(({className:e,...t},s)=>a.jsx(De,{ref:s,className:H("text-sm text-muted-foreground",e),...t}));xa.displayName=De.displayName;const ma=o.forwardRef(({className:e,...t},s)=>a.jsx(Ue,{ref:s,className:H(he(),e),...t}));ma.displayName=Ue.displayName;const ua=o.forwardRef(({className:e,...t},s)=>a.jsx(Oe,{ref:s,className:H(he({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));ua.displayName=Oe.displayName;const ba=({open:e,onOpenChange:t,onConfirm:s,title:r,description:l,isSaving:i,verifyValue:d})=>{const[n,c]=o.useState("");o.useEffect(()=>{e||c("")},[e]);const x=!d||n.trim()===d.trim();return a.jsx(ra,{open:e,onOpenChange:t,children:a.jsxs(da,{className:"overflow-hidden rounded-3xl border-none bg-white p-8 shadow-2xl dark:bg-slate-900",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-48 w-48 rounded-full bg-red-500/10 blur-3xl dark:bg-red-500/5"}),a.jsxs(na,{className:"relative z-10",children:[a.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-2xl bg-red-50 text-red-600 shadow-inner ring-1 ring-red-100 dark:bg-red-950/30 dark:text-red-400 dark:ring-red-900/50",children:a.jsx(B,{size:32})}),a.jsx(ca,{className:"text-center text-3xl font-black tracking-tight text-slate-800 dark:text-slate-100",children:r}),a.jsx(xa,{className:"text-center text-base font-medium leading-relaxed text-slate-500 dark:text-slate-400 md:px-6",children:l})]}),d&&a.jsxs("div",{className:"relative z-10 mt-6 space-y-4 rounded-2xl bg-slate-50 p-6 dark:bg-slate-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-400",children:[a.jsx(E,{size:12,className:"text-red-500"}),"Identity Verification"]}),a.jsxs("p",{className:"text-xs font-bold text-slate-600 dark:text-slate-300",children:["Please type"," ",a.jsxs("span",{className:"text-red-500 underline decoration-red-500/30 underline-offset-4",children:['"',d,'"']})," ","to confirm this critical change."]}),a.jsx(re,{value:n,onChange:e=>c(e.target.value),placeholder:"Enter ULB Name...",className:"h-12 border-slate-200 bg-white text-sm font-bold transition-all focus:ring-2 focus:ring-red-500/20 dark:border-slate-700 dark:bg-slate-900"})]}),a.jsxs(oa,{className:"relative z-10 mt-8 flex-col-reverse gap-3 sm:flex-row",children:[a.jsx(ua,{disabled:i,className:"h-12 flex-1 rounded-xl border-none bg-slate-100 text-[10px] font-black uppercase tracking-widest text-slate-500 transition-all hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-400 dark:hover:bg-slate-700",children:"Abort"}),a.jsx(ma,{onClick:e=>{e.preventDefault(),x&&s()},disabled:i||!x,className:"h-12 flex-1 rounded-xl bg-red-600 text-[10px] font-black uppercase tracking-widest text-white shadow-lg shadow-red-600/20 transition-all hover:bg-red-700 active:scale-95 disabled:opacity-50 dark:bg-red-600 dark:hover:bg-red-700",children:i?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P,{className:"animate-spin text-[10px]"}),"Processing"]}):"Confirm Changes"})]})]})})},ha={"hide-citizen":"is_hidden_from_citizen","hide-admin":"is_hidden_from_admin","disable-login":"is_disabled_login",deactivate:"is_deactivated"},pa=({actions:e,ulb_actions:s,ulbId:r,ulbName:l})=>{const i=Pe(),d=X({}),[o,c]=T.useState(!1),[x,m]=T.useState(null);return a.jsxs(a.Fragment,{children:[a.jsxs(V,{className:"mx-8 overflow-hidden border border-primary/10 bg-white shadow-xl transition-all duration-500 dark:bg-slate-900",children:[a.jsx(Y,{className:"border-b border-slate-100 bg-red-50/20 p-6 dark:border-slate-800 dark:bg-red-950/20",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"rounded-xl bg-red-100 p-3 text-red-600 ring-1 ring-red-200 dark:bg-red-900/40 dark:text-red-400 dark:ring-red-800",children:a.jsx(n,{})}),a.jsxs("div",{children:[a.jsx(J,{className:"text-xl font-black tracking-tight text-slate-800 dark:text-slate-200",children:"Administrative Controls (Danger Zone)"}),a.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Critical system overrides and security protocols"})]})]})}),a.jsx(G,{className:"p-8",children:a.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:e.map((e,r)=>{const l=ha[e.id]||"",i=(null==s?void 0:s[l])??0,d=0===Number(i);return a.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1+.05*r},children:a.jsxs("div",{className:H("group relative flex w-full items-center justify-between gap-4 overflow-hidden rounded-2xl border-2 p-6 transition-all duration-300",d?"border-emerald-500/10 bg-emerald-500/[0.02] hover:border-emerald-500/30":"border-red-500/10 bg-red-500/[0.02] hover:border-red-500/30"),children:[a.jsx("div",{className:H("absolute -inset-2 opacity-0 blur-2xl transition-opacity duration-300 group-hover:opacity-20",d?"bg-emerald-500":"bg-red-500")}),a.jsxs("div",{className:"relative flex items-start gap-5",children:[a.jsx("div",{className:H("flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl shadow-sm transition-all duration-300 group-hover:scale-110",d?"bg-emerald-500/20 text-emerald-600":"bg-red-500/20 text-red-600"),children:a.jsx(e.icon,{size:28})}),a.jsxs("div",{className:"text-left",children:[a.jsx("h4",{className:"mb-1.5 text-[17px] font-black tracking-tight text-foreground",children:e.title}),a.jsx("p",{className:"line-clamp-2 text-xs font-bold leading-relaxed text-muted-foreground/80",children:e.description})]})]}),a.jsxs("div",{className:"relative flex flex-col items-end gap-3",children:[a.jsxs("div",{className:H("inline-flex items-center gap-1.5 rounded-full border px-3 py-1 transition-all duration-300",d?"border-emerald-500/20 bg-emerald-500/10 text-emerald-600 shadow-sm shadow-emerald-500/10":"border-red-500/20 bg-red-500/10 text-red-600 shadow-sm shadow-red-500/10"),children:[a.jsx("div",{className:H("h-1.5 w-1.5 rounded-full",d?"animate-pulse bg-emerald-500":"bg-red-500")}),a.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:d?"Enabled":"Disabled"})]}),a.jsx(me,{checked:d,onCheckedChange:a=>((e,a,t)=>{m({fieldKey:e,title:a,targetState:t}),c(!0)})(ha[e.id],e.title,a),className:H("transition-transform duration-300 hover:scale-110",d?"data-[state=checked]:bg-emerald-600":"data-[state=unchecked]:bg-red-500"),"aria-label":`${e.title} toggle`})]})]})},e.id)})})})]}),a.jsx(ba,{open:o,onOpenChange:e=>!e&&c(!1),onConfirm:()=>{if(!x)return;const e={ulbId:r,action:x.fieldKey};d.mutate({api:Q.toggleUlbAction,data:e},{onSuccess:()=>{k.success(`${x.title} updated successfully`),i.invalidateQueries({queryKey:[`ulbConfig-${r}`]}),c(!1),m(null)},onError:e=>{k.error(ue(e)),c(!1),m(null)}})},verifyValue:l,title:x?`${x.targetState?"Restore":"Restrict"} ${x.title}`:"Confirm Action",description:x?`Are you sure you want to ${x.targetState?"enable":"disable"} "${x.title}" for this ULB? This is a sensitive administrative override.`:"Are you sure?",isSaving:"pending"===d.status})]})},ga=()=>{var e,s,r;const[l,i]=o.useState(null),[d,x]=o.useState(!1),[m]=C(),u=m.get("ulb_id"),b=m.get("ulb_name"),h=K({api:be.ulbConfigurationList,key:`ulbConfig-${u}`,config:{ulbId:u},options:{enabled:!!u}}),p=(null==(e=null==h?void 0:h.data)?void 0:e.data)||null,g=e=>{i(e)},f=[{id:"hide-citizen",title:"Show on Citizen Portal",description:"Make this ULB visible to the public on the citizen gateway",icon:F,color:"success",action:()=>g({id:"hide-citizen",title:"Show on Citizen Portal",description:"Visible to Citizens",icon:F,color:"success"})},{id:"hide-admin",title:"Show on Admin Panel",description:"Display this ULB in administrative lists and dashboards",icon:I,color:"success",action:()=>g({id:"hide-admin",title:"Show on Admin Panel",description:"Visible in Admin panel",icon:I,color:"success"})},{id:"disable-login",title:"Allow Official Login",description:"Authorize employees to sign in to this municipal account",icon:q,color:"success",action:()=>g({id:"disable-login",title:"Allow Official Login",description:"Login Access Granted",icon:q,color:"success"})},{id:"deactivate",title:"Active ULB Status",description:"Global master switch for all ULB operations and access",icon:n,color:"success",action:()=>g({id:"deactivate",title:"Active ULB Status",description:"Account Operating Normally",icon:n,color:"success"})}];return h.isLoading||!p?a.jsxs("div",{className:"flex h-screen w-full flex-col items-center justify-center gap-6 bg-slate-50 dark:bg-[#0a0a0a]",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"h-24 w-24 animate-spin rounded-full border-4 border-slate-200 border-t-primary"}),a.jsx(c,{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-primary",size:24})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-black tracking-tight text-slate-800 dark:text-white",children:"Configuring Municipal Data"}),a.jsx("p",{className:"text-xs font-bold uppercase tracking-[0.3em] text-slate-400",children:"Matrix Initializing..."})]})]}):a.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen overflow-x-hidden rounded-2xl bg-slate-50 pb-20 transition-colors duration-500 dark:bg-[#0a0a0a]",children:[a.jsx(Te,{ulbName:p.basic_information.ulb_name,ulb_logo:p.basic_information.ulb_logo,globalProgress:null==(s=p.global_setup)?void 0:s.percentage,moduleProgress:null==(r=p.module_setup)?void 0:r.percentage,onRefresh:()=>h.refetch()}),a.jsxs("main",{className:"relative z-20 -mt-10 space-y-8",children:[a.jsx(Fe,{data:p}),a.jsxs("div",{className:"mx-auto flex max-w-7xl flex-col gap-10",children:[a.jsx(qe,{data:p.basic_information,onSave:()=>h.refetch()}),a.jsx(sa,{globalMaster:p.global_setup,ulbId:p.basic_information.id,onRefresh:()=>h.refetch()}),a.jsx(pa,{actions:f,ulb_actions:p.ulb_action,ulbId:p.basic_information.id,ulbName:b||""})]})]}),a.jsx(ba,{open:!!l,onOpenChange:e=>!e&&i(null),onConfirm:()=>{l&&(x(!0),setTimeout(()=>{x(!1),i(null),k.success(`${l.title} executed successfully!`,{icon:"ðŸš€",style:{borderRadius:"15px",background:"#1e293b",color:"#fff",fontWeight:"bold",fontSize:"12px"}})},2e3))},title:(null==l?void 0:l.title)||"Confirm Action",description:`Are you absolutely sure you want to perform "${null==l?void 0:l.title}"? This is an administrative operation that may affect production data and user access.`,isSaving:d})]})};function fa(){return a.jsx(pe,{title:"ULB Master Data",subTitle:"Control all ULB Master Data here",children:a.jsx(ga,{})})}export{fa as default};
