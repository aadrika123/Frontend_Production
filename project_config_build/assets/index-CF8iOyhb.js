import{y as e,A as a,r as s,j as l,H as t,z as i,J as r,W as o,X as d,Y as n,ad as c,Z as u,$ as m,C as x,D as f,a1 as h,ag as p,S as g,b0 as j,b1 as v,b2 as b,a2 as w}from"./vendor-C4evAtTJ.js";import{C as N,b as y,P as k}from"./card-DiAP098P.js";import{T as _,a as S,b as R,c as L}from"./tabs-grpV6Gkc.js";import{T as C,a as D,b as F,c as I,d as W,e as B}from"./table-BMiE1PKG.js";import{m as z,w as U,B as A,d as q}from"./index-nOKeclHv.js";import{S as E}from"./Spinner-V_xsUq7L.js";import{P}from"./index-DtmLDMmO.js";import{u as V,a as M}from"./useCustomQuery-776SQh42.js";import{g as O}from"./services-Bn_cfjy0.js";import{c as $,d as H,a as T,b as Y}from"./yup-CKFt8x4I.js";import{F as G,R as J,B as Q}from"./datetime-picker-C5RqqAbw.js";import{R as X}from"./RHFSelectField-9wNhWjPg.js";import"./input-BmuDym1d.js";import"./switch-DiVucjTg.js";import"./label-DG1IsmQj.js";import{D as Z}from"./index-h9tpnovL.js";import{R as K}from"./RHFSwitch-BOUMZGD1.js";import"./select-BMZmzcxe.js";import"./icons-s1CkBPDV.js";import"./ui-BtaoVrnA.js";import"./query-CtA7BnhH.js";import"./axios-Dos3PyFQ.js";import"./zustand-DzHKdda2.js";const ee=$().shape({id:H().nullable(),workflowName:T().required("Workflow Name is required"),moduleId:H().typeError("Module is required").required("Module is required")});function ae({open:r,setOpen:o,edit:d,setEdit:n,editData:c,refetch:u}){var m,x;const f=V({}),h=M({api:z.userManagementModuleList,key:"userManagementModuleList",options:{enabled:r}}),p=e({defaultValues:{id:void 0,workflowName:"",moduleId:void 0},resolver:a(ee)}),{reset:g,handleSubmit:j,formState:{isSubmitting:v}}=p;s.useEffect(()=>{r&&g(d&&c?{id:c.id,workflowName:c.workflow_name,moduleId:c.module_id}:{id:void 0,workflowName:"",moduleId:void 0})},[r,d,c,g]);const b=(null==(x=null==(m=null==h?void 0:h.data)?void 0:m.data)?void 0:x.map(e=>({value:e.id.toString(),label:e.module_name})))||[];return l.jsx(Z,{open:r,setOpen:o,title:d?"Update Workflow":"Add New Workflow",setEdit:n,edit:d,children:l.jsx("div",{className:"p-1",children:l.jsx(G,{methods:p,onSubmit:j(async e=>{var a,s,l;try{const t=d?U.workflowUpdate:U.workflowAdd,r=await f.mutateAsync({api:t,data:e});(null==(a=null==r?void 0:r.data)?void 0:a.status)?(i.success((null==(s=null==r?void 0:r.data)?void 0:s.message)||`Workflow ${d?"updated":"added"} successfully`),o(!1),n&&n(!1),u()):i.error((null==(l=null==r?void 0:r.data)?void 0:l.message)||"Something went wrong")}catch(t){i.error(O(t))}}),children:l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"flex items-center gap-3 rounded-xl bg-primary/5 p-4 text-primary",children:[l.jsx(t,{size:20}),l.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider",children:"Workflow Configuration"})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[l.jsx(J,{label:"Workflow Name",name:"workflowName",placeholder:"e.g. RIG MACHINE"}),l.jsx(X,{label:"Assign to Module",name:"moduleId",data:b})]})]}),l.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:l.jsx(Q,{isLoading:v,type:"submit",className:"h-11 rounded-xl bg-primary px-8 text-sm font-bold text-primary-foreground shadow-lg shadow-primary/20 transition-all hover:shadow-xl active:scale-95",children:d?"Update Workflow":"Create Workflow"})})]})})})})}function se(){var e,a;const[x,f]=s.useState(1),[h,p]=s.useState(10),[g,j]=s.useState(""),v=s.useRef(null),[b,w]=s.useState(!1),[k,_]=s.useState(!1),[S,R]=s.useState(null),L=M({api:U.workflowList,key:"workflowList",options:{enabled:!0}}),z=V({}),q=(null==(a=null==(e=null==L?void 0:L.data)?void 0:e.data)?void 0:a.filter(e=>{var a,s;return(null==(a=null==e?void 0:e.workflow_name)?void 0:a.toLowerCase().includes(g.toLowerCase()))||(null==(s=null==e?void 0:e.module_name)?void 0:s.toLowerCase().includes(g.toLowerCase()))}))||[],$=x*h,H=$-h,T=null==q?void 0:q.slice(H,$);return l.jsxs("div",{className:"mt-4",children:[l.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:l.jsxs(N,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[l.jsx("div",{className:"border-b bg-muted/30 p-4",children:l.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10 text-primary",children:l.jsx(t,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Workflow Master"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Define and manage system-wide workflow processes"})]})]}),l.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 lg:w-auto",children:[l.jsxs("div",{className:"relative flex-1 lg:min-w-[300px]",children:[l.jsx(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),l.jsx("input",{ref:v,type:"text",placeholder:"Search workflow or module (Alt+S)...",className:"h-10 w-full rounded-xl border border-input bg-background pl-10 pr-4 text-sm ring-offset-background transition-all focus:outline-none focus:ring-2 focus:ring-primary/20",value:g,onChange:e=>j(e.target.value)})]}),l.jsxs(A,{onClick:()=>{R(null),_(!1),w(!0)},className:"h-10 gap-2 rounded-xl bg-primary px-4 font-semibold text-primary-foreground shadow-lg shadow-primary/20 transition-all hover:shadow-xl active:scale-95",children:[l.jsx(d,{size:14}),l.jsx("span",{children:"Add Workflow"})]})]})]})}),l.jsx("div",{className:"relative",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(C,{children:[l.jsx(D,{className:"bg-muted/50",children:l.jsxs(F,{className:"hover:bg-transparent",children:[l.jsx(I,{className:"w-[80px] font-bold",children:"SL. No."}),l.jsx(I,{className:"font-bold",children:"Workflow Name"}),l.jsx(I,{className:"font-bold",children:"Module Name"}),l.jsx(I,{className:"text-center font-bold",children:"Created At"}),l.jsx(I,{className:"text-right font-bold",children:"Actions"})]})}),l.jsx(W,{className:"px-4",children:l.jsx(n,{mode:"wait",children:(null==L?void 0:L.isLoading)?l.jsx(F,{children:l.jsx(B,{colSpan:5,className:"h-48 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[l.jsx(E,{}),l.jsx("p",{className:"animate-pulse text-sm text-muted-foreground",children:"Loading workflows..."})]})})}):0===T.length?l.jsx(F,{children:l.jsx(B,{colSpan:5,className:"h-48 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 opacity-50",children:[l.jsx(t,{size:50,className:"text-muted-foreground"}),l.jsx("p",{className:"font-medium text-muted-foreground",children:"No workflows found"})]})})}):T.map((e,a)=>l.jsxs(r.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.05*a},className:"group border-b transition-colors hover:bg-muted/30",children:[l.jsx(B,{className:"font-medium p-4",children:(x-1)*h+a+1}),l.jsx(B,{children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-bold text-foreground",children:e.workflow_name}),l.jsxs("span",{className:"text-[10px] uppercase tracking-wider text-muted-foreground",children:["ID: #",e.id]})]})}),l.jsx(B,{children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-lg bg-blue-100/50 text-blue-600 dark:bg-blue-900/20",children:l.jsx(c,{size:12})}),l.jsx("span",{className:"font-semibold",children:e.module_name})]})}),l.jsx(B,{className:"text-center text-sm italic text-muted-foreground",children:e.created_at||"N/A"}),l.jsx(B,{className:"text-right",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(e=>{R(e),_(!0),w(!0)})(e),className:"h-8 w-8 rounded-lg text-blue-600 hover:bg-blue-50 hover:text-blue-700 dark:hover:bg-blue-900/30",title:"Edit",children:l.jsx(u,{size:14})}),l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(async e=>{y("Are you sure?","Do you want to delete this workflow?",async()=>{var a,s,l;try{const t=await z.mutateAsync({api:U.workflowDelete,data:{id:e}});(null==(a=null==t?void 0:t.data)?void 0:a.status)?(i.success((null==(s=null==t?void 0:t.data)?void 0:s.message)||"Workflow deleted successfully"),L.refetch()):i.error((null==(l=null==t?void 0:t.data)?void 0:l.message)||"Failed to delete workflow")}catch(t){i.error(O(t))}})})(e.id),className:"h-8 w-8 rounded-lg text-red-600 hover:bg-red-50 hover:text-red-700 dark:hover:bg-red-900/30",title:"Delete",children:l.jsx(m,{size:14})})]})})]},e.id))})})]})})}),!(null==L?void 0:L.isLoading)&&q.length>0&&l.jsx("div",{className:"border-t bg-muted/10 p-4",children:l.jsx(P,{currentPage:x,onPageChange:e=>{f(e)},itemsPerPage:h,onItemsPerPageChange:e=>{p(e),f(1)},totalItems:q.length})})]})}),l.jsx(ae,{open:b,setOpen:w,edit:k,setEdit:_,editData:S,refetch:L.refetch})]})}const le=$().shape({id:H().nullable(),ulbId:H().typeError("ULB is required").required("ULB is required"),wfMasterId:H().typeError("Workflow is required").required("Workflow is required"),altName:T().nullable(),initiatorRoleId:H().typeError("Initiator Role is required").required("Initiator Role is required"),finisherRoleId:H().typeError("Finisher Role is required").required("Finisher Role is required"),isDocRequired:Y().nullable()});function te({open:t,setOpen:r,edit:o,setEdit:d,editData:n,refetch:c}){var u,m,f,h,p,g;const j=V({}),v=M({api:q.api_getUlbList,key:"api_getUlbList",options:{enabled:t}}),b=M({api:U.workflowList,key:"workflowList",options:{enabled:t}}),w=M({api:U.allRole,key:"allRoleList",options:{enabled:t}}),N=e({defaultValues:{id:void 0,ulbId:void 0,wfMasterId:void 0,altName:"",initiatorRoleId:void 0,finisherRoleId:void 0,isDocRequired:!1},resolver:a(le)}),{reset:y,handleSubmit:k,control:_,formState:{isSubmitting:S}}=N;s.useEffect(()=>{t&&y(o&&n?{id:n.id,ulbId:n.ulb_id,wfMasterId:n.wf_master_id,altName:n.alt_name||"",initiatorRoleId:n.initiator_role_id,finisherRoleId:n.finisher_role_id,isDocRequired:Boolean(n.is_doc_required)}:{id:void 0,ulbId:void 0,wfMasterId:void 0,altName:"",initiatorRoleId:void 0,finisherRoleId:void 0,isDocRequired:!1})},[t,o,n,y]);const R=(null==(m=null==(u=null==v?void 0:v.data)?void 0:u.data)?void 0:m.map(e=>({value:e.id.toString(),label:e.ulb_name})))||[],L=(null==(h=null==(f=null==b?void 0:b.data)?void 0:f.data)?void 0:h.map(e=>({value:e.id.toString(),label:e.workflow_name})))||[],C=(null==(g=null==(p=null==w?void 0:w.data)?void 0:p.data)?void 0:g.map(e=>({value:e.id.toString(),label:e.role_name})))||[];return l.jsx(Z,{open:t,setOpen:r,title:o?"Edit ULB Workflow":"Add ULB Workflow",setEdit:d,edit:o,children:l.jsx("div",{className:"p-2",children:l.jsx(G,{methods:N,onSubmit:k(async e=>{var a,s,l;try{const t=o?U.ulbWfUpdate:U.ulbWfAdd,n={...e,isDocRequired:e.isDocRequired?"true":"false"},u=await j.mutateAsync({api:t,data:n});(null==(a=null==u?void 0:u.data)?void 0:a.status)?(i.success((null==(s=null==u?void 0:u.data)?void 0:s.message)||`ULB Workflow ${o?"updated":"added"} successfully`),r(!1),d&&d(!1),c()):i.error((null==(l=null==u?void 0:u.data)?void 0:l.message)||"Something went wrong")}catch(t){i.error(O(t))}}),children:l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[l.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:[l.jsx(X,{label:"ULB Name",name:"ulbId",data:R}),l.jsx(X,{label:"Workflow Name",name:"wfMasterId",data:L})]}),l.jsx(J,{label:"Alternate Name (Optional)",name:"altName",placeholder:"Enter alternate name if any..."}),l.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:[l.jsx(X,{label:"Initiator Role Name",name:"initiatorRoleId",data:C}),l.jsx(X,{label:"Finisher Role Name",name:"finisherRoleId",data:C})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"Is Document Required?"}),l.jsx(x,{name:"isDocRequired",control:_,render:({field:e})=>l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("label",{className:"group flex cursor-pointer items-center gap-2",children:[l.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full border-2 transition-all "+(!0===e.value?"border-primary bg-primary shadow-lg shadow-primary/20":"border-slate-300 dark:border-slate-600"),children:!0===e.value&&l.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-white"})}),l.jsx("input",{type:"radio",className:"hidden",checked:!0===e.value,onChange:()=>e.onChange(!0)}),l.jsx("span",{className:"text-sm font-bold "+(!0===e.value?"text-primary":"text-muted-foreground"),children:"Yes"})]}),l.jsxs("label",{className:"group flex cursor-pointer items-center gap-2",children:[l.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full border-2 transition-all "+(!1===e.value?"border-slate-700 bg-slate-700 dark:border-slate-300 dark:bg-slate-300":"border-slate-300 dark:border-slate-600"),children:!1===e.value&&l.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-white dark:bg-slate-900"})}),l.jsx("input",{type:"radio",className:"hidden",checked:!1===e.value,onChange:()=>e.onChange(!1)}),l.jsx("span",{className:"text-sm font-bold "+(!1===e.value?"text-slate-800 dark:text-slate-200":"text-muted-foreground"),children:"No"})]})]})})]})]})}),l.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-5",children:l.jsx(Q,{isLoading:S,type:"submit",className:"h-12 rounded-2xl bg-primary px-10 text-sm font-black uppercase tracking-widest text-primary-foreground shadow-xl shadow-primary/20 transition-all hover:bg-primary/90 active:scale-[0.98]",children:o?"Update Assignment":"Assign Workflow"})})]})})})})}function ie(){var e,a;const[t,c]=s.useState(1),[x,g]=s.useState(10),[j,v]=s.useState(""),b=s.useRef(null),[w,k]=s.useState(!1),[_,S]=s.useState(!1),[R,L]=s.useState(null),z=M({api:U.ulbWfList,key:"ulbWfList",options:{enabled:!0}}),q=V({}),$=(null==(a=null==(e=null==z?void 0:z.data)?void 0:e.data)?void 0:a.filter(e=>{var a,s,l;return(null==(a=null==e?void 0:e.workflow_name)?void 0:a.toLowerCase().includes(j.toLowerCase()))||(null==(s=null==e?void 0:e.ulb_name)?void 0:s.toLowerCase().includes(j.toLowerCase()))||(null==(l=null==e?void 0:e.alt_name)?void 0:l.toLowerCase().includes(j.toLowerCase()))}))||[],H=t*x,T=H-x,Y=null==$?void 0:$.slice(T,H);return l.jsxs("div",{className:"mt-4",children:[l.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:l.jsxs(N,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[l.jsx("div",{className:"border-b bg-muted/30 p-4",children:l.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-blue-600/10 text-blue-600",children:l.jsx(f,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-foreground",children:"ULB Workflow Management"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Assign and customize workflows for specific ULBs"})]})]}),l.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 lg:w-auto",children:[l.jsxs("div",{className:"relative flex-1 lg:min-w-[300px]",children:[l.jsx(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),l.jsx("input",{ref:b,type:"text",placeholder:"Search workflow, ULB or alt name...",className:"h-10 w-full rounded-xl border border-input bg-background pl-10 pr-4 text-sm ring-offset-background transition-all focus:outline-none focus:ring-2 focus:ring-primary/20",value:j,onChange:e=>v(e.target.value)})]}),l.jsxs(A,{onClick:()=>{L(null),S(!1),k(!0)},className:"h-10 gap-2 rounded-xl bg-primary px-4 font-semibold text-white shadow-lg shadow-primary/20 transition-all hover:bg-primary/90 active:scale-95",children:[l.jsx(d,{size:14}),l.jsx("span",{children:"Add ULB Workflow"})]})]})]})}),l.jsx("div",{className:"relative",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(C,{children:[l.jsx(D,{className:"bg-muted/40",children:l.jsxs(F,{className:"border-b text-center hover:bg-transparent",children:[l.jsx(I,{className:"w-[80px] px-6 py-4 text-center text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"SL."}),l.jsx(I,{className:"px-6 py-4 text-left text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"ULB & Workflow"}),l.jsx(I,{className:"px-6 py-4 text-left text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"Alternate Name"}),l.jsx(I,{className:"px-6 py-4 text-center text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"Roles (Init/Fin)"}),l.jsx(I,{className:"px-6 py-4 text-center text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"Doc Required"}),l.jsx(I,{className:"px-6 py-4 text-right text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"Actions"})]})}),l.jsx(W,{children:l.jsx(n,{mode:"wait",children:(null==z?void 0:z.isLoading)?l.jsx(F,{children:l.jsx(B,{colSpan:6,className:"h-64 border-none text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[l.jsx(E,{}),l.jsx("p",{className:"animate-pulse text-sm font-medium text-muted-foreground",children:"Fetching ULB workflows..."})]})})}):0===Y.length?l.jsx(F,{children:l.jsx(B,{colSpan:6,className:"h-64 border-none text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 opacity-40",children:[l.jsx(f,{size:48,className:"text-muted-foreground"}),l.jsx("p",{className:"text-lg font-semibold text-muted-foreground",children:"No ULB workflows found"})]})})}):Y.map((e,a)=>l.jsxs(r.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.98},transition:{delay:.04*a,duration:.2},className:"group border-b transition-all last:border-0 hover:bg-muted/40",children:[l.jsx(B,{className:"px-6 py-5 text-center font-semibold text-muted-foreground",children:(t-1)*x+a+1}),l.jsx(B,{className:"px-6 py-5",children:l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"rounded bg-blue-100 px-1.5 py-0.5 text-[10px] font-bold uppercase text-blue-600",children:"ULB"}),l.jsx("span",{className:"text-sm font-bold text-foreground",children:e.ulb_name})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[10px] font-bold uppercase text-slate-600",children:"WF"}),l.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:e.workflow_name})]})]})}),l.jsx(B,{className:"px-6 py-5",children:l.jsx("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:e.alt_name||"-"})}),l.jsx(B,{className:"px-6 py-5 text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-3",children:[l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-emerald-100 text-emerald-600 shadow-sm",title:`Initiator: ${e.initiator_role_name}`,children:l.jsx(h,{size:12})}),l.jsx("span",{className:"max-w-[80px] truncate text-[9px] font-black uppercase tracking-tighter text-muted-foreground",children:e.initiator_role_name||"--"})]}),l.jsx("div",{className:"h-4 w-[1px] rotate-12 bg-border"}),l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-violet-100 text-violet-600 shadow-sm",title:`Finisher: ${e.finisher_role_name}`,children:l.jsx(h,{size:12})}),l.jsx("span",{className:"max-w-[90px] truncate text-[9px] font-black uppercase tracking-tighter text-muted-foreground",children:e.finisher_role_name||"--"})]})]})}),l.jsx(B,{className:"px-6 py-5 text-center",children:l.jsx("div",{className:"inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-bold "+(e.is_doc_required?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-slate-100 text-slate-600 dark:bg-slate-800"),children:e.is_doc_required?l.jsxs(l.Fragment,{children:[l.jsx(p,{size:10}),l.jsx("span",{children:"Yes"})]}):l.jsx("span",{children:"No"})})}),l.jsx(B,{className:"px-6 py-5 text-right",children:l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(e=>{L(e),S(!0),k(!0)})(e),className:"h-9 w-9 rounded-xl border border-blue-100 bg-blue-50 text-blue-600 shadow-sm transition-all hover:bg-blue-600 hover:text-white active:scale-90 dark:border-blue-900/30 dark:bg-blue-900/20",title:"Edit",children:l.jsx(u,{size:14})}),l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(async e=>{y("Are you sure?","Do you want to delete this ULB workflow?",async()=>{var a,s,l;try{const t=await q.mutateAsync({api:U.ulbWfDelete,data:{id:e}});(null==(a=null==t?void 0:t.data)?void 0:a.status)?(i.success((null==(s=null==t?void 0:t.data)?void 0:s.message)||"ULB Workflow deleted successfully"),z.refetch()):i.error((null==(l=null==t?void 0:t.data)?void 0:l.message)||"Failed to delete ULB workflow")}catch(t){i.error(O(t))}})})(e.id),className:"h-9 w-9 rounded-xl border border-red-100 bg-red-50 text-red-600 shadow-sm transition-all hover:bg-red-600 hover:text-white active:scale-90 dark:border-red-900/30 dark:bg-red-900/20",title:"Delete",children:l.jsx(m,{size:14})})]})})]},e.id))})})]})})}),!(null==z?void 0:z.isLoading)&&$.length>0&&l.jsx("div",{className:"border-t bg-muted/10 p-4",children:l.jsx(P,{currentPage:t,onPageChange:e=>{c(e)},itemsPerPage:x,onItemsPerPageChange:e=>{g(e),c(1)},totalItems:$.length})})]})}),l.jsx(te,{open:w,setOpen:k,edit:_,setEdit:S,editData:R,refetch:z.refetch})]})}const re=$().shape({id:H().nullable(),workflowName:T().required("Workflow Name is required"),roleName:T().required("Role Name is required"),fdRoleName:T().nullable(),bdRoleName:T().nullable(),isInitiator:Y().default(!1),isFinisher:Y().default(!1),isBtc:Y().default(!1),canViewDocument:Y().default(!1),canUploadDocument:Y().default(!1),canVerifyDocument:Y().default(!1),allowFreeCommunication:Y().default(!1),allowFullList:Y().default(!1),canEscalate:Y().default(!1),canForward:Y().default(!1),canBackward:Y().default(!1),isPseudo:Y().default(!1),showFieldVerification:Y().default(!1),serialNo:H().typeError("Serial No must be a number").required("Serial No is required")});function oe({open:t,setOpen:r,edit:o,setEdit:d,editData:n,refetch:c}){var u,m,x,f;const h=V({}),p=M({api:U.workflowList,key:"workflowList",options:{enabled:t}}),g=M({api:U.allRole,key:"roleList",options:{enabled:t}}),j=e({defaultValues:{id:void 0,workflowName:"",roleName:"",fdRoleName:"",bdRoleName:"",isInitiator:!1,isFinisher:!1,isBtc:!1,canViewDocument:!1,canUploadDocument:!1,canVerifyDocument:!1,allowFreeCommunication:!1,allowFullList:!1,canEscalate:!1,canForward:!1,canBackward:!1,isPseudo:!1,showFieldVerification:!1,serialNo:0},resolver:a(re)}),{reset:v,handleSubmit:b,formState:{isSubmitting:w}}=j;s.useEffect(()=>{var e,a,s,l;t&&v(o&&n?{id:n.id,workflowName:null==(e=n.workflow_id)?void 0:e.toString(),roleName:null==(a=n.wf_role_id)?void 0:a.toString(),fdRoleName:(null==(s=n.forward_role_id)?void 0:s.toString())||"",bdRoleName:(null==(l=n.backward_role_id)?void 0:l.toString())||"",isInitiator:n.is_initiator,isFinisher:n.is_finisher,isBtc:n.is_btc,canViewDocument:n.can_view_document,canUploadDocument:n.can_upload_document,canVerifyDocument:n.can_verify_document,allowFreeCommunication:n.allow_free_communication,allowFullList:n.allow_full_list,canEscalate:n.can_escalate,canForward:n.can_forward,canBackward:n.can_backward,isPseudo:n.is_pseudo,showFieldVerification:n.show_field_verification,serialNo:n.serial_no}:{id:void 0,workflowName:"",roleName:"",fdRoleName:"",bdRoleName:"",isInitiator:!1,isFinisher:!1,isBtc:!1,canViewDocument:!1,canUploadDocument:!1,canVerifyDocument:!1,allowFreeCommunication:!1,allowFullList:!1,canEscalate:!1,canForward:!1,canBackward:!1,isPseudo:!1,showFieldVerification:!1,serialNo:0})},[t,o,n,v]);const N=(null==(m=null==(u=null==p?void 0:p.data)?void 0:u.data)?void 0:m.map(e=>({value:e.id.toString(),label:e.workflow_name})))||[],y=(null==(f=null==(x=null==g?void 0:g.data)?void 0:x.data)?void 0:f.map(e=>({value:e.id.toString(),label:e.role_name})))||[];return l.jsx(Z,{open:t,setOpen:r,title:o?"Update Role Map":"Add New Role Map",setEdit:d,edit:o,children:l.jsx("div",{className:"p-1",children:l.jsx(G,{methods:j,onSubmit:b(async e=>{var a,s,l;try{const t=o?U.wfRoleUpdate:U.wfRoleAdd,n={id:o?e.id:void 0,workflowId:Number(e.workflowName),wfRoleId:Number(e.roleName),forwardRoleId:e.fdRoleName?Number(e.fdRoleName):null,backwardRoleId:e.bdRoleName?Number(e.bdRoleName):null,isInitiator:e.isInitiator,isFinisher:e.isFinisher,isBtc:e.isBtc,canViewDocument:e.canViewDocument,canUploadDocument:e.canUploadDocument,canVerifyDocument:e.canVerifyDocument,allowFreeCommunication:e.allowFreeCommunication,allowFullList:e.allowFullList,canEscalate:e.canEscalate,canForward:e.canForward,canBackward:e.canBackward,isPseudo:e.isPseudo,showFieldVerification:e.showFieldVerification,serialNo:Number(e.serialNo)},u=await h.mutateAsync({api:t,data:n});(null==(a=null==u?void 0:u.data)?void 0:a.status)?(i.success((null==(s=null==u?void 0:u.data)?void 0:s.message)||`Workflow Map ${o?"updated":"added"} successfully`),r(!1),d&&d(!1),c()):i.error((null==(l=null==u?void 0:u.data)?void 0:l.message)||"Something went wrong")}catch(t){i.error(O(t))}}),children:l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:[l.jsx(X,{label:"Workflow",name:"workflowName",data:N}),l.jsx(X,{label:"Role",name:"roleName",data:y}),l.jsx(X,{label:"Forward Role",name:"fdRoleName",data:y}),l.jsx(X,{label:"Backward Role",name:"bdRoleName",data:y}),l.jsx(J,{label:"Serial No",name:"serialNo",type:"number",placeholder:"e.g. 1"})]}),l.jsxs("div",{className:"rounded-xl bg-muted/30 p-4",children:[l.jsx("p",{className:"mb-4 text-xs font-bold uppercase tracking-wider text-muted-foreground",children:"Permissions & Controls"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4",children:[l.jsx(K,{label:"Is Initiator",name:"isInitiator"}),l.jsx(K,{label:"Is Finisher",name:"isFinisher"}),l.jsx(K,{label:"Is BTC",name:"isBtc"}),l.jsx(K,{label:"Is Pseudo",name:"isPseudo"}),l.jsx(K,{label:"Can View Docs",name:"canViewDocument"}),l.jsx(K,{label:"Can Upload Docs",name:"canUploadDocument"}),l.jsx(K,{label:"Can Verify Docs",name:"canVerifyDocument"}),l.jsx(K,{label:"Can Forward",name:"canForward"}),l.jsx(K,{label:"Can Backward",name:"canBackward"}),l.jsx(K,{label:"Can Escalate",name:"canEscalate"}),l.jsx(K,{label:"Free Comm.",name:"allowFreeCommunication"}),l.jsx(K,{label:"Full List",name:"allowFullList"}),l.jsx(K,{label:"Show Field Verif.",name:"showFieldVerification"})]})]}),l.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:l.jsx(Q,{isLoading:w,type:"submit",className:"h-11 rounded-xl bg-violet-600 px-8 text-sm font-bold text-white shadow-lg shadow-violet-600/20 transition-all hover:bg-violet-700 active:scale-95",children:o?"Update Map":"Create Map"})})]})})})})}function de(){var e,a;const[t,c]=s.useState(1),[x,f]=s.useState(10),[h,p]=s.useState(""),v=s.useRef(null),[b,w]=s.useState(!1),[k,_]=s.useState(!1),[S,R]=s.useState(null),L=M({api:U.wfRoleList,key:"wfRoleList",options:{enabled:!0}}),z=V({}),q=(null==(a=null==(e=null==L?void 0:L.data)?void 0:e.data)?void 0:a.filter(e=>{var a,s,l;return(null==(a=null==e?void 0:e.role_name)?void 0:a.toLowerCase().includes(h.toLowerCase()))||(null==(s=null==e?void 0:e.workflow_name)?void 0:s.toLowerCase().includes(h.toLowerCase()))||(null==(l=null==e?void 0:e.ulb_name)?void 0:l.toLowerCase().includes(h.toLowerCase()))}))||[],$=t*x,H=$-x,T=null==q?void 0:q.slice(H,$);return l.jsxs("div",{className:"mt-4",children:[l.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:l.jsxs(N,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[l.jsx("div",{className:"border-b bg-muted/30 p-4",children:l.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-violet-100 text-violet-600 dark:bg-violet-900/20",children:l.jsx(g,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Workflow Role Mapping"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Define workflow steps and role permissions"})]})]}),l.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 lg:w-auto",children:[l.jsxs("div",{className:"relative flex-1 lg:min-w-[300px]",children:[l.jsx(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),l.jsx("input",{ref:v,type:"text",placeholder:"Search role, workflow or ULB...",className:"h-10 w-full rounded-xl border border-input bg-background pl-10 pr-4 text-sm ring-offset-background transition-all focus:outline-none focus:ring-2 focus:ring-violet-500/20",value:h,onChange:e=>p(e.target.value)})]}),l.jsxs(A,{onClick:()=>{R(null),_(!1),w(!0)},className:"h-10 gap-2 rounded-xl bg-violet-600 px-4 font-semibold text-white shadow-lg shadow-violet-600/20 transition-all hover:bg-violet-700 active:scale-95",children:[l.jsx(d,{size:14}),l.jsx("span",{children:"Add Role Map"})]})]})]})}),l.jsx("div",{className:"relative",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(C,{children:[l.jsx(D,{className:"bg-muted/50",children:l.jsxs(F,{className:"hover:bg-transparent",children:[l.jsx(I,{className:"w-[80px] font-bold",children:"SL. No."}),l.jsx(I,{className:"font-bold",children:"Role Name"}),l.jsx(I,{className:"font-bold",children:"Workflow & ULB"}),l.jsx(I,{className:"font-bold",children:"Direction"}),l.jsx(I,{className:"min-w-[600px] text-center font-bold",children:"Permissions"}),l.jsx(I,{className:"text-right font-bold",children:"Actions"})]})}),l.jsx(W,{className:"px-4",children:l.jsx(n,{mode:"wait",children:(null==L?void 0:L.isLoading)?l.jsx(F,{children:l.jsx(B,{colSpan:6,className:"h-48 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[l.jsx(E,{}),l.jsx("p",{className:"animate-pulse text-sm text-muted-foreground",children:"Loading role maps..."})]})})}):0===T.length?l.jsx(F,{children:l.jsx(B,{colSpan:6,className:"h-48 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 opacity-50",children:[l.jsx(g,{size:50,className:"text-muted-foreground"}),l.jsx("p",{className:"font-medium text-muted-foreground",children:"No role maps found"})]})})}):T.map((e,a)=>l.jsxs(r.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.05*a},className:"group border-b transition-colors hover:bg-muted/30",children:[l.jsx(B,{className:"p-4 font-medium",children:(t-1)*x+a+1}),l.jsx(B,{children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-bold text-foreground",children:e.role_name}),l.jsxs("span",{className:"text-[10px] uppercase tracking-wider text-muted-foreground",children:["Step: #",e.serial_no]})]})}),l.jsx(B,{children:l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(j,{className:"text-violet-500",size:12}),l.jsx("span",{className:"text-xs font-semibold",children:e.workflow_name})]}),l.jsx("span",{className:"text-[10px] text-muted-foreground",children:e.ulb_name})]})}),l.jsx(B,{children:l.jsxs("div",{className:"flex flex-col gap-1 text-[11px] font-medium",children:[e.forward_role_name&&l.jsxs("div",{className:"flex items-center gap-1 text-emerald-600",children:[l.jsx("span",{className:"rounded bg-emerald-100 px-1 py-0.5 dark:bg-emerald-900/30",children:"FWD:"}),e.forward_role_name]}),e.backward_role_name&&l.jsxs("div",{className:"flex items-center gap-1 text-rose-600",children:[l.jsx("span",{className:"rounded bg-rose-100 px-1 py-0.5 dark:bg-rose-900/30",children:"BWD:"}),e.backward_role_name]})]})}),l.jsx(B,{children:l.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 sm:grid-cols-3 md:grid-cols-4",children:[{label:"Is Initiator",value:e.is_initiator},{label:"Is Finisher",value:e.is_finisher},{label:"Is BTC",value:e.is_btc},{label:"View Document",value:e.can_view_document},{label:"Upload Document",value:e.can_upload_document},{label:"Verify Document",value:e.can_verify_document},{label:"Free Comm.",value:e.allow_free_communication},{label:"Full List",value:e.allow_full_list},{label:"Can Escalate",value:e.can_escalate},{label:"Pseudo User",value:e.is_pseudo},{label:"Can Forward",value:e.can_forward},{label:"Can Backward",value:e.can_backward},{label:"Field Verif.",value:e.show_field_verification}].map((e,a)=>l.jsxs("div",{className:"flex items-center justify-between gap-2 rounded border bg-background px-2 py-1 text-[10px]",children:[l.jsx("span",{className:"whitespace-nowrap font-medium text-muted-foreground",children:e.label}),l.jsx("span",{className:"font-bold "+(e.value?"text-green-600":"text-red-500"),children:e.value?"Yes":"No"})]},a))})}),l.jsx(B,{className:"text-right",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(e=>{R(e),_(!0),w(!0)})(e),className:"h-8 w-8 rounded-lg text-blue-600 hover:bg-blue-50 hover:text-blue-700 dark:hover:bg-blue-900/30",title:"Edit",children:l.jsx(u,{size:14})}),l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(async e=>{y("Are you sure?","Do you want to delete this role map?",async()=>{var a,s,l;try{const t=await z.mutateAsync({api:U.wfRoleDelete,data:{id:e}});(null==(a=null==t?void 0:t.data)?void 0:a.status)?(i.success((null==(s=null==t?void 0:t.data)?void 0:s.message)||"Role map deleted successfully"),L.refetch()):i.error((null==(l=null==t?void 0:t.data)?void 0:l.message)||"Failed to delete role map")}catch(t){i.error(O(t))}})})(e.id),className:"h-8 w-8 rounded-lg text-red-600 hover:bg-red-50 hover:text-red-700 dark:hover:bg-red-900/30",title:"Delete",children:l.jsx(m,{size:14})})]})})]},e.id))})})]})})}),!(null==L?void 0:L.isLoading)&&q.length>0&&l.jsx("div",{className:"border-t bg-muted/10 p-4",children:l.jsx(P,{currentPage:t,onPageChange:e=>{c(e)},itemsPerPage:x,onItemsPerPageChange:e=>{f(e),c(1)},totalItems:q.length})})]})}),l.jsx(oe,{open:b,setOpen:w,edit:k,setEdit:_,editData:S,refetch:L.refetch})]})}const ne=$().shape({id:H().nullable(),roleName:T().required("Role Name is required"),isSuspended:Y().default(!1)});function ce({open:t,setOpen:r,edit:o,setEdit:d,editData:n,refetch:c}){const u=V({}),m=e({defaultValues:{id:void 0,roleName:"",isSuspended:!1},resolver:a(ne)}),{reset:x,handleSubmit:f,formState:{isSubmitting:h}}=m;s.useEffect(()=>{t&&x(o&&n?{id:n.id,roleName:n.role_name,isSuspended:n.is_suspended}:{id:void 0,roleName:"",isSuspended:!1})},[t,o,n,x]);return l.jsx(Z,{open:t,setOpen:r,title:o?"Update Workflow Role":"Add New Workflow Role",setEdit:d,edit:o,children:l.jsx("div",{className:"p-1",children:l.jsx(G,{methods:m,onSubmit:f(async e=>{var a,s,l;try{const t=o?q.api_updateWorkflowRole:q.api_PostWorkflowRole,n={id:o?e.id:void 0,roleName:e.roleName,isSuspended:e.isSuspended},m=await u.mutateAsync({api:t,data:n});(null==(a=null==m?void 0:m.data)?void 0:a.status)?(i.success((null==(s=null==m?void 0:m.data)?void 0:s.message)||`Workflow Role ${o?"updated":"added"} successfully`),r(!1),d&&d(!1),c()):i.error((null==(l=null==m?void 0:m.data)?void 0:l.message)||"Something went wrong")}catch(t){i.error(O(t))}}),children:l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"flex items-center gap-3 rounded-xl bg-orange-100 p-4 text-orange-600 dark:bg-orange-900/20",children:[l.jsx(v,{size:20}),l.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider",children:"Role Configuration"})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[l.jsx(J,{label:"Role Name",name:"roleName",placeholder:"e.g. Developer"}),l.jsx(K,{label:"Is Suspended",name:"isSuspended"})]})]}),l.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:l.jsx(Q,{isLoading:h,type:"submit",className:"h-11 rounded-xl bg-violet-600 px-8 text-sm font-bold text-white shadow-lg shadow-violet-600/20 transition-all hover:bg-violet-700 active:scale-95",children:o?"Update Role":"Create Role"})})]})})})})}function ue(){var e,a;const[t,c]=s.useState(1),[x,f]=s.useState(10),[h,p]=s.useState(""),g=s.useRef(null),[j,w]=s.useState(!1),[k,_]=s.useState(!1),[S,R]=s.useState(null),L=M({api:q.getWorkflowRole,key:"getWorkflowRole",options:{enabled:!0}}),z=V({}),U=(null==(a=null==(e=null==L?void 0:L.data)?void 0:e.data)?void 0:a.filter(e=>{var a;return null==(a=null==e?void 0:e.role_name)?void 0:a.toLowerCase().includes(h.toLowerCase())}))||[],$=t*x,H=$-x,T=null==U?void 0:U.slice(H,$);return l.jsxs("div",{className:"mt-4",children:[l.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:l.jsxs(N,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[l.jsx("div",{className:"border-b bg-muted/30 p-4",children:l.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-orange-100 text-orange-600 dark:bg-orange-900/20",children:l.jsx(b,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Workflow Roles"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage roles for workflow assignments"})]})]}),l.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 lg:w-auto",children:[l.jsxs("div",{className:"relative flex-1 lg:min-w-[300px]",children:[l.jsx(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),l.jsx("input",{ref:g,type:"text",placeholder:"Search roles...",className:"h-10 w-full rounded-xl border border-input bg-background pl-10 pr-4 text-sm ring-offset-background transition-all focus:outline-none focus:ring-2 focus:ring-orange-500/20",value:h,onChange:e=>p(e.target.value)})]}),l.jsxs(A,{onClick:()=>{R(null),_(!1),w(!0)},className:"h-10 gap-2 rounded-xl bg-orange-600 px-4 font-semibold text-white shadow-lg shadow-orange-600/20 transition-all hover:bg-orange-700 active:scale-95",children:[l.jsx(d,{size:14}),l.jsx("span",{children:"Add Role"})]})]})]})}),l.jsx("div",{className:"relative",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(C,{children:[l.jsx(D,{className:"bg-muted/50",children:l.jsxs(F,{className:"hover:bg-transparent",children:[l.jsx(I,{className:"w-[80px] font-bold",children:"SL. No."}),l.jsx(I,{className:"font-bold",children:"Role Name"}),l.jsx(I,{className:"font-bold",children:"Created By"}),l.jsx(I,{className:"text-center font-bold",children:"Status"}),l.jsx(I,{className:"text-right font-bold",children:"Actions"})]})}),l.jsx(W,{className:"px-4",children:l.jsx(n,{mode:"wait",children:(null==L?void 0:L.isLoading)?l.jsx(F,{children:l.jsx(B,{colSpan:5,className:"h-48 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[l.jsx(E,{}),l.jsx("p",{className:"animate-pulse text-sm text-muted-foreground",children:"Loading roles..."})]})})}):0===T.length?l.jsx(F,{children:l.jsx(B,{colSpan:5,className:"h-48 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 opacity-50",children:[l.jsx(v,{size:50,className:"text-muted-foreground"}),l.jsx("p",{className:"font-medium text-muted-foreground",children:"No workflow roles found"})]})})}):T.map((e,a)=>l.jsxs(r.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.05*a},className:"group border-b transition-colors hover:bg-muted/30",children:[l.jsx(B,{className:"p-4 font-medium",children:(t-1)*x+a+1}),l.jsx(B,{children:l.jsx("span",{className:"font-bold text-foreground",children:e.role_name})}),l.jsx(B,{children:l.jsx("span",{className:"text-sm text-muted-foreground",children:e.created_by})}),l.jsx(B,{className:"text-center",children:l.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium "+(e.is_suspended?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"),children:e.is_suspended?"Suspended":"Active"})}),l.jsx(B,{className:"text-right",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(e=>{R(e),_(!0),w(!0)})(e),className:"h-8 w-8 rounded-lg text-blue-600 hover:bg-blue-50 hover:text-blue-700 dark:hover:bg-blue-900/30",title:"Edit",children:l.jsx(u,{size:14})}),l.jsx(A,{variant:"ghost",size:"icon",onClick:()=>(async e=>{y("Are you sure?","Do you want to delete this role?",async()=>{var a,s,l;try{const t=await z.mutateAsync({api:q.api_deleteWorkflowRole,data:{id:e}});(null==(a=null==t?void 0:t.data)?void 0:a.status)?(i.success((null==(s=null==t?void 0:t.data)?void 0:s.message)||"Role deleted successfully"),L.refetch()):i.error((null==(l=null==t?void 0:t.data)?void 0:l.message)||"Failed to delete role")}catch(t){i.error(O(t))}})})(e.id),className:"h-8 w-8 rounded-lg text-red-600 hover:bg-red-50 hover:text-red-700 dark:hover:bg-red-900/30",title:"Delete",children:l.jsx(m,{size:14})})]})})]},e.id))})})]})})}),!(null==L?void 0:L.isLoading)&&U.length>0&&l.jsx("div",{className:"border-t bg-muted/10 p-4",children:l.jsx(P,{currentPage:t,onPageChange:e=>{c(e)},itemsPerPage:x,onItemsPerPageChange:e=>{f(e),c(1)},totalItems:U.length})})]})}),l.jsx(ce,{open:j,setOpen:w,edit:k,setEdit:_,editData:S,refetch:L.refetch})]})}function me(){const[e,a]=w(),s=e.get("tab")||"workflow-master",i=[{id:"workflow-master",label:"Workflow Master",icon:l.jsx(t,{size:14}),content:l.jsx(se,{})},{id:"ulb-workflow",label:"Ulb Workflow",icon:l.jsx(f,{size:14}),content:l.jsx(ie,{})},{id:"workflow-rolemap",label:"Workflow Rolemap",icon:l.jsx(g,{size:14}),content:l.jsx(de,{})},{id:"workflow-role",label:"Workflow Role",icon:l.jsx(v,{size:14}),content:l.jsx(ue,{})}];return l.jsx("div",{className:"flex flex-col gap-6 p-1",children:l.jsx(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:l.jsxs(_,{value:s,onValueChange:e=>{a({tab:e})},className:"w-full",children:[l.jsx(S,{className:" inline-flex h-12 items-center justify-start rounded-2xl bg-muted/30 p-1",children:i.map(e=>l.jsxs(R,{value:e.id,className:"flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-semibold transition-all data-[state=active]:bg-background data-[state=active]:text-primary data-[state=active]:shadow-md",children:[e.icon,l.jsx("span",{children:e.label})]},e.id))}),i.map(e=>l.jsx(L,{value:e.id,className:"focus:outline-none",children:e.content},e.id))]})})})}function xe(){return l.jsx(k,{title:"Manage All Workflow Here.",children:l.jsx(me,{})})}export{xe as default};
