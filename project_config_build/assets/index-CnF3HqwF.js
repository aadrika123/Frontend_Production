import{y as e,B as s,r as l,j as t,z as a,m as r,E as i,aa as d,G as n,H as o,I as c,M as u,P as m,ab as x,ac as p,a1 as h}from"./vendor-of9_hwUT.js";import{u as g,D as j,F as f,R as v,B as b,m as y,g as N,b as w,C as k,e as M,f as S,S as A,T as L,h as E,i as I,j as R,k as C,l as D,n as V,o as q,P as T}from"./index-Caq1sqRP.js";import{c as z,d as _,a as F}from"./yup-BW00wNfM.js";import{R as P}from"./RHFSwitch-B7NI4H31.js";import{S as $}from"./separator-Y6zLL1-4.js";import"./query-CfdbInZo.js";import"./ui-DGRyWpwx.js";import"./icons-C5eWvnai.js";import"./axios-Dos3PyFQ.js";import"./zustand-xphxtTnV.js";const O=z().shape({moduleName:F().required("Module Name is required"),title:F().required("Title is required"),url:F().required("URL is required"),image:F().optional(),duesApi:F().optional(),canView:_().default(!0)});function B({open:r,setOpen:i,title:d,edit:n,setEdit:o,moduleList:c,id:u}){const m=g({}),x=e({defaultValues:{moduleName:"",title:"",url:"",image:"",duesApi:"",canView:!0},resolver:s(O)}),{reset:p}=x;l.useEffect(()=>{var e,s;if(r)if(n&&u){const l=null==(s=null==(e=null==c?void 0:c.data)?void 0:e.data)?void 0:s.find(e=>e.id==u);l&&p({moduleName:l.module_name||"",title:l.title||"",url:l.url||"",image:l.image||"",duesApi:l.duesApi||"",canView:l.canView??!0})}else p({moduleName:"",title:"",url:"",image:"",duesApi:"",canView:!0})},[r,n,u,c,p]);return t.jsx(j,{open:r,setOpen:i,title:d,setEdit:o,edit:n,children:t.jsx(f,{methods:x,onSubmit:x.handleSubmit(async e=>{var s,l,t;try{const r=n?y.updateModule:y.addModule,d=n?{id:u,...e}:e,x=await m.mutateAsync({api:r,data:d});(null==(s=null==x?void 0:x.data)?void 0:s.status)?(a.success((null==(l=null==x?void 0:x.data)?void 0:l.message)||"Module updated successfully"),i(!1),o(!1),c.refetch()):a.error((null==(t=null==x?void 0:x.data)?void 0:t.message)||"Something went wrong")}catch(r){a.error(N(r))}}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[t.jsx("div",{children:t.jsx(v,{label:"Module Name",name:"moduleName",placeholder:"Enter module name"})}),t.jsx("div",{children:t.jsx(v,{label:"Title",name:"title",placeholder:"Enter title"})}),t.jsx("div",{children:t.jsx(v,{label:"Module URL",name:"url",placeholder:"Enter module url"})}),t.jsx("div",{children:t.jsx(v,{label:"Image Name",name:"image",placeholder:"Enter image name (e.g. property.png)"})}),t.jsx("div",{children:t.jsx(v,{label:"Dues API",name:"duesApi",placeholder:"Enter dues api path"})}),t.jsx("div",{children:t.jsx(P,{label:"Show in Dashboard",name:"canView"})}),t.jsx($,{}),t.jsx("div",{children:t.jsx(b,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const H=z().shape({ulbId:F(),moduleId:F(),complaintRefNo:F()}),U=()=>{var j,f;const v=r(),[b,N]=l.useState(!1),[T,z]=l.useState(""),[_,F]=l.useState(!1),[P,$]=l.useState(""),[O,U]=l.useState(""),G=l.useRef(null),K=g({});e({resolver:s(H),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}});const W=w({api:null==(j=y)?void 0:j.userManagementModuleList,key:"moduleMasterList",options:{enabled:!0}});l.useEffect(()=>{const e=e=>{var s;!e.altKey||"s"!==e.key&&"S"!==e.key||(e.preventDefault(),e.stopPropagation(),null==(s=G.current)||s.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[]);const J=l.useMemo(()=>{var e,s;return(null==(s=null==(e=null==W?void 0:W.data)?void 0:e.data)?void 0:s.filter(e=>{var s;return null==(s=e.module_name)?void 0:s.toLowerCase().includes(O.toLowerCase())}))||[]},[null==(f=null==W?void 0:W.data)?void 0:f.data,O]),Q=[{key:"menu-list",label:"Menu List",icon:t.jsx(d,{className:"h-4 w-4"}),color:"bg-blue-600/10 hover:bg-blue-600/20 text-blue-600 border-blue-600/20"},{key:"service-list",label:"Service List",icon:t.jsx(x,{className:"h-4 w-4"}),color:"bg-emerald-600/10 hover:bg-emerald-600/20 text-emerald-600 border-emerald-600/20"},{key:"role-list",label:"Role List",icon:t.jsx(p,{className:"h-4 w-4"}),color:"bg-violet-600/10 hover:bg-violet-600/20 text-violet-600 border-violet-600/20"},{key:"workflow-list",label:"Workflow Role",icon:t.jsx(h,{className:"h-4 w-4"}),color:"bg-amber-600/10 hover:bg-amber-600/20 text-amber-600 border-amber-600/20"}];return t.jsx("div",{className:" ",children:t.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[t.jsxs(k,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[t.jsx("div",{className:"border-b bg-muted/30 p-4",children:t.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/10 text-primary",children:t.jsx(d,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Module Management"}),t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-primary/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-primary",children:[J.length," Modules Found"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx(n,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),t.jsx("input",{ref:G,type:"text",placeholder:"Search modules...",value:O,onChange:e=>U(e.target.value),className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-20 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 md:w-64"}),t.jsx("div",{className:"absolute right-2.5 hidden items-center gap-1 sm:flex",children:t.jsxs("kbd",{className:"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-white/10 px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[t.jsx("span",{className:"text-xs",children:"Alt"}),"S"]})})]}),t.jsxs(M,{type:"button",className:"flex items-center gap-2 bg-primary hover:bg-primary/90",onClick:()=>{z(""),F(!1),N(!0)},children:[t.jsx(o,{className:"h-4 w-4"}),"Add New Module"]})]})]})}),t.jsx(S,{className:"p-0",children:W.isLoading?t.jsx("div",{className:"flex h-64 items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(A,{}),t.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Syncing modules..."})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(L,{children:[t.jsx(E,{children:t.jsxs(I,{className:"border-b-2 hover:bg-transparent",children:[t.jsx(R,{className:"w-20 text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"#"}),t.jsx(R,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Module Name"}),t.jsx(R,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Status"}),t.jsx(R,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Actions"})]})}),t.jsx(C,{children:t.jsx(c,{children:null==J?void 0:J.map((e,s)=>t.jsxs(i.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"group/row border-b transition-all hover:bg-muted/40",children:[t.jsx(D,{className:"py-4 text-center",children:t.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-primary/10 font-medium text-primary",children:s+1})}),t.jsx(D,{className:"py-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/10 transition-colors group-hover/row:bg-primary/20",children:t.jsx(d,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold text-foreground",children:null==e?void 0:e.module_name}),t.jsxs("p",{className:"text-xs font-semibold text-muted-foreground",children:["ID: ",null==e?void 0:e.id]})]})]})}),t.jsx(D,{className:"py-4 text-center",children:t.jsx("span",{className:"inline-flex items-center rounded-full border border-green-500/20 bg-green-500/10 px-2.5 py-0.5 text-xs font-bold text-green-500",children:"Active"})}),t.jsx(D,{className:"py-4",children:t.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[Q.map(s=>t.jsxs(M,{variant:"outline",size:"sm",onClick:()=>{v(`/project-config/dashboard/module-list/${s.key}?module_name=${null==e?void 0:e.module_name}&id=${null==e?void 0:e.id}`)},className:V("flex items-center gap-2 border-0 transition-all hover:scale-105",s.color),children:[s.icon,t.jsx("span",{className:"hidden sm:inline",children:s.label})]},s.key)),t.jsxs("div",{className:"ml-2 flex items-center gap-2 border-l border-border pl-2",children:[t.jsx(M,{variant:"ghost",size:"icon",className:"h-9 w-9 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>{z(null==e?void 0:e.id),F(!0),N(!0)},children:t.jsx(u,{className:"h-4 w-4"})}),t.jsx(M,{variant:"ghost",size:"icon",className:"h-9 w-9 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{q("Delete Module",`Are you sure you want to delete ${null==e?void 0:e.module_name}?`,async()=>{var s,l,t;try{const r=await K.mutateAsync({api:y.deleteModule,data:{id:null==e?void 0:e.id,isSuspended:!0}});(null==(s=null==r?void 0:r.data)?void 0:s.status)?(a.success((null==(l=null==r?void 0:r.data)?void 0:l.message)||"Module deleted successfully"),W.refetch()):a.error((null==(t=null==r?void 0:r.data)?void 0:t.message)||"Failed to delete module")}catch(r){a.error("An error occurred")}})},children:t.jsx(m,{className:"h-4 w-4"})})]})]})})]},null==e?void 0:e.id))})})]})}),(!J||0===J.length)&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[t.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:t.jsx(d,{className:"h-12 w-12 text-muted-foreground/40"})}),t.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No modules found"}),t.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Start by adding your first module to organize system components"})]})]})})]}),t.jsx(B,{open:b,setOpen:N,title:_?"Edit Module":"Add New Module",id:T,edit:_,setEdit:F,moduleList:W})]})})};function G(){return t.jsx(T,{title:"Module List",subTitle:"Control all Module here",children:t.jsx(U,{})})}export{G as default};
