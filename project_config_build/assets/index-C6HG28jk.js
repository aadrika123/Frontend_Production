import{r as e,y as a,j as s,B as t,z as l,m as i,ad as r,E as n,Q as d,ac as o,G as c,H as m,I as u,ap as x,aL as p,as as h,aM as b,K as g,J as f,M as v}from"./vendor-of9_hwUT.js";import{u as j,D as N,F as y,R as w,B as A,m as k,g as S,b as C,C as E,e as L,f as M,S as P,T as F,h as I,i as q,j as U,k as D,l as T,I as V,n as B,q as R,p as z,P as H}from"./index-CVblQ-Zi.js";import{c as O,e as $,a as K}from"./yup-BW00wNfM.js";import{R as _}from"./RHFUploadFiled-DZfEjBR6.js";import"./query-CfdbInZo.js";import"./ui-DGRyWpwx.js";import"./icons-C5eWvnai.js";import"./axios-Dos3PyFQ.js";import"./zustand-xphxtTnV.js";const G=O().shape({name:K().required("Full Name is required"),mobile:K().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:K().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:K().email("Enter a valid email").required("Email is required"),address:K().required("Address is required"),photo:$().nullable()});function J({open:i,setOpen:r,title:n,edit:d,setEdit:o,adminListFun:c,id:m,ulbId:u,adminListData:x}){const p=j({}),h=e.useRef(null),[b,g]=e.useState(null),f=a({defaultValues:{name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:t(G)}),{reset:v}=f;e.useEffect(()=>{if(i){if(d&&m){const e=null==x?void 0:x.find(e=>e.id==m);e&&(g(e.documentUrl||null),v({name:e.name||"",mobile:e.mobile||"",altMobile:e.alternateMobile||"",email:e.email||"",address:e.address||"",photo:null}))}else g(null),v({name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});f.setValue("photo",""),h.current&&(h.current.value="")}},[i,d,m,x,v]);return s.jsx(N,{open:i,setOpen:r,title:n,setEdit:o,edit:d,children:s.jsx("div",{className:"p-1",children:s.jsx(y,{methods:f,onSubmit:f.handleSubmit(async e=>{var a,s,t,i,n;try{const x=d?null==(a=k)?void 0:a.updateAdmin:null==(s=k)?void 0:s.createAdmin,h=d&&m?{...e,id:m}:{...e,ulbId:u},b=new FormData;b.append("name",h.name),b.append("mobile",h.mobile),b.append("altMobile",h.altMobile),b.append("email",h.email),b.append("address",h.address),b.append("userType","Admin");const g=f.watch("photo");if(g)b.append("photo",g);else if(!d)return void l.error("User Image is required");d&&m&&b.append("id",m),b.append("ulbId",u||"");const v=await p.mutateAsync({api:x,data:b});(null==(t=null==v?void 0:v.data)?void 0:t.status)?(l.success(null==(i=null==v?void 0:v.data)?void 0:i.message),r(!1),o(!1),c.refetch()):l.error(null==(n=null==v?void 0:v.data)?void 0:n.message)}catch(x){l.error(S(x))}}),children:s.jsxs("div",{className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"relative",children:s.jsx(w,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter full name"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(w,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter mobile"}),s.jsx(w,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter alternate"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(w,{label:"Email Address",name:"email",inputValidation:["email"],placeholder:"Enter email"}),s.jsx(w,{label:"Physical Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter permanent address"})]})]}),s.jsxs("div",{className:"rounded-xl border border-dashed border-primary/20 bg-primary/5 p-4",children:[d&&b&&!f.watch("photo")&&s.jsxs("div",{className:"mb-3 flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-muted-foreground",children:"Current Profile Image"}),s.jsx("img",{src:b,alt:"Current profile",className:"h-20 w-20 rounded-lg border-2 border-primary/20 object-cover shadow-sm"})]}),s.jsx(_,{label:d&&b?"Update Profile Image":"User Profile Image",name:"photo"},i?"open":"closed")]}),s.jsx("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:s.jsx(A,{isLoading:f.formState.isSubmitting,type:"submit",className:"h-11 rounded-xl bg-primary px-8 text-sm font-bold text-primary-foreground shadow-lg shadow-primary/20 transition-all hover:shadow-xl active:scale-95",children:d?"Update Admin Account":"Create Admin Account"})})]})})})})}function Q(){var a,t,N,y,w,A,H,O,$,K,_,G,Q,W,X,Y,Z,ee;const ae=i(),[se]=r(),te=se.get("ulb_id"),le=se.get("ulb_name"),ie=e.useRef(null),[re,ne]=e.useState(1),[de,oe]=e.useState(10),ce=j({}),[me,ue]=e.useState(!1),[xe,pe]=e.useState(""),[he,be]=e.useState(!1),[ge,fe]=e.useState("name"),[ve,je]=e.useState(""),[Ne,ye]=e.useState("");e.useEffect(()=>{const e=setTimeout(()=>{ye(ve)},700);return()=>clearTimeout(e)},[ve]),e.useEffect(()=>{const e=e=>{var a;!e.altKey||"s"!==e.key&&"S"!==e.key||(e.preventDefault(),e.stopPropagation(),null==(a=ie.current)||a.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[]);const we=C({api:null==(a=k)?void 0:a.adminList,key:"adminListFun",config:{ulbId:te,page:re,perPage:de,parameter:Ne||"",filterBy:ge||""},value:[re,de,ge,Ne],options:{enabled:!!te}});e.useEffect(()=>{Ne?(ne(1),we.refetch()):we.refetch()},[Ne]);return s.jsxs("div",{className:"",children:[s.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:s.jsxs(E,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[s.jsx("div",{className:"border-b bg-muted/30 p-4",children:s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>ae(-1),className:"flex h-10 items-center gap-2 text-muted-foreground transition-all hover:bg-accent hover:text-foreground",children:[s.jsx(d,{className:"h-4 w-4"}),"Back"]}),s.jsx("div",{className:"mx-1 h-6 w-[1px] bg-border"}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-amber-500/10 text-amber-500",children:s.jsx(o,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-foreground",children:le||"Admin List"}),s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-blue-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-blue-600",children:[(null==(N=null==(t=null==we?void 0:we.data)?void 0:t.data)?void 0:N.total)||0," Registered Admins"]})]})]}),s.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 lg:w-auto",children:[s.jsxs("div",{className:"relative flex flex-1 items-center md:min-w-[350px]",children:[s.jsx(c,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),s.jsx("input",{ref:ie,type:"text",value:ve,onChange:e=>{je(e.target.value)},placeholder:`Search admins by ${ge}...`,className:"h-11 w-full rounded-xl border border-border bg-background pl-10 pr-24 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20",maxLength:"mobile"==ge?10:void 0}),s.jsxs("div",{className:"absolute right-2.5 flex items-center gap-1.5",children:[s.jsx("div",{className:"hidden items-center gap-1 sm:flex",children:s.jsxs("kbd",{className:"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[s.jsx("span",{className:"text-xs",children:"Alt"}),"S"]})}),s.jsx("div",{className:"mx-1 h-4 w-[1px] bg-border"}),s.jsxs("select",{value:ge,onChange:e=>{return a=e.target.value,void fe(a);var a},className:"h-8 cursor-pointer rounded-lg border-none bg-transparent px-2 py-0 text-xs font-semibold outline-none transition-all hover:bg-muted/50 focus:ring-0",children:[s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"email",children:"Email"}),s.jsx("option",{value:"mobile",children:"Mobile"})]})]})]}),s.jsxs(L,{type:"button",onClick:()=>{pe(""),be(!1),ue(!0)},className:"flex items-center gap-2 bg-primary shadow-md transition-all hover:bg-primary/90 active:scale-95",children:[s.jsx(m,{className:"h-4 w-4"}),"Create Admin"]})]})]})}),s.jsxs(M,{className:"p-0",children:[we.isLoading?s.jsx("div",{className:"flex h-64 items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(P,{}),s.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading admins..."})]})}):s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs(F,{children:[s.jsx(I,{children:s.jsxs(q,{className:"border-b-2 hover:bg-transparent",children:[s.jsx(U,{className:"w-20 text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"#"}),s.jsx(U,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Admin Profile"}),s.jsx(U,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Contact Details"}),s.jsx(U,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Status"}),s.jsx(U,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Actions"})]})}),s.jsx(D,{children:s.jsx(u,{children:(null==(A=null==(w=null==(y=null==we?void 0:we.data)?void 0:y.data)?void 0:w.data)?void 0:A.length)>0?null==($=null==(O=null==(H=null==we?void 0:we.data)?void 0:H.data)?void 0:O.data)?void 0:$.map((e,a)=>s.jsxs(n.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"group/row border-b transition-all hover:bg-muted/40",children:[s.jsx(T,{className:"py-4 text-center",children:s.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-xs font-bold text-muted-foreground",children:re*de-de+a+1})}),s.jsx(T,{className:"py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx(V,{src:e.documentUrl,alt:e.name,onClick:()=>window.open(null==e?void 0:e.documentUrl),className:"h-12 w-12 cursor-pointer rounded-xl border-2 border-background object-cover shadow-sm"}),s.jsx("div",{className:B("absolute -right-1 -top-1 h-3.5 w-3.5 rounded-full border-2 border-background",e.suspended?"bg-red-500":"bg-green-500")})]}),s.jsxs("div",{children:[s.jsx("p",{className:B("font-bold leading-tight text-foreground",e.suspended&&"text-muted-foreground line-through opacity-60"),children:null==e?void 0:e.name}),s.jsxs("div",{className:"mt-1 flex items-center gap-1.5",children:[s.jsx(x,{className:"h-2.5 w-2.5 text-muted-foreground"}),s.jsx("p",{className:"max-w-[150px] truncate text-[10px] font-semibold uppercase tracking-widest text-muted-foreground",children:(null==e?void 0:e.address)||"No Address"})]})]})]})}),s.jsx(T,{className:"py-4",children:s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-foreground/80",children:[s.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-md bg-blue-600/10 text-blue-600",children:s.jsx(p,{className:"h-2.5 w-2.5"})}),null==e?void 0:e.mobile,(null==e?void 0:e.alternateMobile)&&s.jsxs("span",{className:"text-muted-foreground",children:["/ ",e.alternateMobile]})]}),s.jsxs("div",{className:"group/email flex items-center gap-2 text-[11px] font-medium text-muted-foreground",children:[s.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-md bg-emerald-600/10 text-emerald-600",children:s.jsx(h,{className:"h-2.5 w-2.5"})}),s.jsxs("span",{className:"truncate flex items-center gap-2",children:[null==e?void 0:e.email," ",s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(null==e?void 0:e.email),l.success("Email copied to clipboard")},className:"ml-auto opacity-0 transition-opacity hover:text-foreground group-hover/email:opacity-100",title:"Copy Email",children:s.jsx(b,{className:"h-3.5 w-3.5"})})]})]})]})}),s.jsx(T,{className:"py-4 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(R,{checked:!(null==e?void 0:e.suspended),onCheckedChange:()=>(async(e,a)=>{var s,t,i,r;try{const n={id:e,isSuspended:a},d=await ce.mutateAsync({api:null==(s=k)?void 0:s.enableDisableUserByModule,data:n});(null==(t=null==d?void 0:d.data)?void 0:t.status)?(l.success((null==(i=null==d?void 0:d.data)?void 0:i.message)||"Permission updated successfully"),we.refetch()):l.error((null==(r=null==d?void 0:d.data)?void 0:r.message)||"Failed to update permission")}catch(n){l.error(S(n))}})(e.id,!e.suspended)}),s.jsx("span",{className:B("inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[9px] font-bold uppercase tracking-tighter",e.suspended?"bg-red-500/10 text-red-500":"bg-green-500/10 text-green-500"),children:e.suspended?s.jsxs(s.Fragment,{children:[s.jsx(f,{className:"h-2 w-2"})," ","Suspended"]}):s.jsxs(s.Fragment,{children:[s.jsx(g,{className:"h-2 w-2"})," ","Active"]})})]})}),s.jsx(T,{className:"py-4",children:s.jsx("div",{className:"flex items-center justify-center gap-2",children:s.jsx(L,{variant:"outline",size:"sm",onClick:()=>{pe(null==e?void 0:e.id),be(!0),ue(!0)},className:"h-9 w-9 border-amber-600/20 bg-amber-600/10 p-0 text-amber-600 transition-all hover:bg-amber-600 hover:text-white",children:s.jsx(v,{className:"h-4 w-4"})})})})]},null==e?void 0:e.id)):s.jsx(q,{children:s.jsx(T,{colSpan:6,className:"h-24 text-center text-xl font-thin italic text-muted-foreground",children:"No data available."})})})})]}),(null==(_=null==(K=null==we?void 0:we.data)?void 0:K.data)?void 0:_.total)>0&&s.jsx("div",{className:"border-t p-4",children:s.jsx(z,{currentPage:re,totalItems:(null==(Q=null==(G=null==we?void 0:we.data)?void 0:G.data)?void 0:Q.total)||0,itemsPerPage:de,onPageChange:e=>ne(e),onItemsPerPageChange:e=>{oe(e),ne(1)}})})]}),!we.isLoading&&0===(null==(Y=null==(X=null==(W=null==we?void 0:we.data)?void 0:W.data)?void 0:X.data)?void 0:Y.length)&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[s.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:s.jsx(o,{className:"h-12 w-12 text-muted-foreground/40"})}),s.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No admins found"}),s.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:ve?"Try adjusting your search criteria":"No admins have been registered in this ULB yet."})]})]})]})}),s.jsx(J,{open:me,setOpen:ue,title:he?"Update Admin Account":"Create Admin Account",id:xe,edit:he,setEdit:be,ulbId:te,adminListFun:we,adminListData:null==(ee=null==(Z=null==we?void 0:we.data)?void 0:Z.data)?void 0:ee.data})]})}function W(){return s.jsx(H,{title:"Admin List",subTitle:"Manage All Admins Here.",children:s.jsx(Q,{})})}export{W as default};
