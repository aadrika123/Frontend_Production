import{y as e,A as s,r as l,j as t,z as a,m as r,E as i,K as d,H as n,I as o,J as c,Q as u,S as m,T as x,U as p,V as h}from"./vendor-BG1zmfZX.js";import{u as g,D as j,F as f,R as v,f as b,S as y,B as N,m as w,g as k,b as M,C as S,e as A,h as L,i as E,T as I,j as C,k as V,l as q,n as D,o as R,p as T,q as z,P as _}from"./index-CcUHWA1p.js";import{c as F,a as $,b as O}from"./yup-gplMljTp.js";import"./query-C7fL_BCZ.js";import"./ui-CvOZa0iY.js";import"./icons-BpXMRjmw.js";import"./axios-Dos3PyFQ.js";import"./zustand-CnCUipgd.js";const P=F().shape({moduleName:O().required("Module Name is required"),title:O().required("Title is required"),url:O().required("URL is required"),image:O().optional(),duesApi:O().optional(),canView:$().default(!0)});function U({open:r,setOpen:i,title:d,edit:n,setEdit:o,moduleList:c,id:u}){const m=g({}),x=e({defaultValues:{moduleName:"",title:"",url:"",image:"",duesApi:"",canView:!0},resolver:s(P)}),{reset:p}=x;l.useEffect(()=>{var e,s;if(r)if(n&&u){const l=null==(s=null==(e=null==c?void 0:c.data)?void 0:e.data)?void 0:s.find(e=>e.id==u);l&&p({moduleName:l.module_name||"",title:l.title||"",url:l.url||"",image:l.image||"",duesApi:l.duesApi||"",canView:l.canView??!0})}else p({moduleName:"",title:"",url:"",image:"",duesApi:"",canView:!0})},[r,n,u,c,p]);return t.jsx(j,{open:r,setOpen:i,title:d,setEdit:o,edit:n,children:t.jsx(f,{methods:x,onSubmit:x.handleSubmit(async e=>{var s,l,t;try{const r=n?w.updateModule:w.addModule,d=n?{id:u,...e}:e,x=await m.mutateAsync({api:r,data:d});(null==(s=null==x?void 0:x.data)?void 0:s.status)?(a.success((null==(l=null==x?void 0:x.data)?void 0:l.message)||"Module updated successfully"),i(!1),o(!1),c.refetch()):a.error((null==(t=null==x?void 0:x.data)?void 0:t.message)||"Something went wrong")}catch(r){a.error(k(r))}}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[t.jsx("div",{children:t.jsx(v,{label:"Module Name",name:"moduleName",placeholder:"Enter module name"})}),t.jsx("div",{children:t.jsx(v,{label:"Title",name:"title",placeholder:"Enter title"})}),t.jsx("div",{children:t.jsx(v,{label:"Module URL",name:"url",placeholder:"Enter module url"})}),t.jsx("div",{children:t.jsx(v,{label:"Image Name",name:"image",placeholder:"Enter image name (e.g. property.png)"})}),t.jsx("div",{children:t.jsx(v,{label:"Dues API",name:"duesApi",placeholder:"Enter dues api path"})}),t.jsx("div",{children:t.jsx(b,{label:"Show in Dashboard",name:"canView"})}),t.jsx(y,{}),t.jsx("div",{children:t.jsx(N,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const K=F().shape({ulbId:O(),moduleId:O(),complaintRefNo:O()}),B=()=>{var j,f;const v=r(),[b,y]=l.useState(!1),[N,k]=l.useState(""),[_,F]=l.useState(!1),[$,O]=l.useState(""),[P,B]=l.useState(""),H=l.useRef(null),J=g({});e({resolver:s(K),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}});const Q=M({api:null==(j=w)?void 0:j.userManagementModuleList,key:"moduleMasterList",options:{enabled:!0}});l.useEffect(()=>{const e=e=>{var s;!e.altKey||"s"!==e.key&&"S"!==e.key||(e.preventDefault(),e.stopPropagation(),null==(s=H.current)||s.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[]);const W=l.useMemo(()=>{var e,s;return(null==(s=null==(e=null==Q?void 0:Q.data)?void 0:e.data)?void 0:s.filter(e=>{var s;return null==(s=e.module_name)?void 0:s.toLowerCase().includes(P.toLowerCase())}))||[]},[null==(f=null==Q?void 0:Q.data)?void 0:f.data,P]),G=[{key:"menu-list",label:"Menu List",icon:t.jsx(d,{className:"h-4 w-4"}),color:"bg-blue-600/10 hover:bg-blue-600/20 text-blue-600 border-blue-600/20"},{key:"service-list",label:"Service List",icon:t.jsx(x,{className:"h-4 w-4"}),color:"bg-emerald-600/10 hover:bg-emerald-600/20 text-emerald-600 border-emerald-600/20"},{key:"role-list",label:"Role List",icon:t.jsx(p,{className:"h-4 w-4"}),color:"bg-violet-600/10 hover:bg-violet-600/20 text-violet-600 border-violet-600/20"},{key:"workflow-list",label:"Workflow Role",icon:t.jsx(h,{className:"h-4 w-4"}),color:"bg-amber-600/10 hover:bg-amber-600/20 text-amber-600 border-amber-600/20"}];return t.jsx("div",{className:" ",children:t.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[t.jsxs(S,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[t.jsx("div",{className:"border-b bg-muted/30 p-4",children:t.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/10 text-primary",children:t.jsx(d,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Module Management"}),t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-primary/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-primary",children:[W.length," Modules Found"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx(n,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),t.jsx("input",{ref:H,type:"text",placeholder:"Search modules...",value:P,onChange:e=>B(e.target.value),className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-20 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 md:w-64"}),t.jsx("div",{className:"absolute right-2.5 hidden items-center gap-1 sm:flex",children:t.jsxs("kbd",{className:"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-white/10 px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[t.jsx("span",{className:"text-xs",children:"Alt"}),"S"]})})]}),t.jsxs(A,{type:"button",className:"flex items-center gap-2 bg-primary hover:bg-primary/90",onClick:()=>{k(""),F(!1),y(!0)},children:[t.jsx(o,{className:"h-4 w-4"}),"Add New Module"]})]})]})}),t.jsx(L,{className:"p-0",children:Q.isLoading?t.jsx("div",{className:"flex h-64 items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(E,{}),t.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Syncing modules..."})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(I,{children:[t.jsx(C,{children:t.jsxs(V,{className:"border-b-2 hover:bg-transparent",children:[t.jsx(q,{className:"w-20 text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"#"}),t.jsx(q,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Module Name"}),t.jsx(q,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Status"}),t.jsx(q,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Actions"})]})}),t.jsx(D,{children:t.jsx(c,{children:null==W?void 0:W.map((e,s)=>t.jsxs(i.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"group/row border-b transition-all hover:bg-muted/40",children:[t.jsx(R,{className:"py-4 text-center",children:t.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-primary/10 font-medium text-primary",children:s+1})}),t.jsx(R,{className:"py-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/10 transition-colors group-hover/row:bg-primary/20",children:t.jsx(d,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold text-foreground",children:null==e?void 0:e.module_name}),t.jsxs("p",{className:"text-xs font-semibold text-muted-foreground",children:["ID: ",null==e?void 0:e.id]})]})]})}),t.jsx(R,{className:"py-4 text-center",children:t.jsx("span",{className:"inline-flex items-center rounded-full border border-green-500/20 bg-green-500/10 px-2.5 py-0.5 text-xs font-bold text-green-500",children:"Active"})}),t.jsx(R,{className:"py-4",children:t.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[G.map(s=>t.jsxs(A,{variant:"outline",size:"sm",onClick:()=>{v(`/project-config/dashboard/module-list/${s.key}?module_name=${null==e?void 0:e.module_name}&id=${null==e?void 0:e.id}`)},className:T("flex items-center gap-2 border-0 transition-all hover:scale-105",s.color),children:[s.icon,t.jsx("span",{className:"hidden sm:inline",children:s.label})]},s.key)),t.jsxs("div",{className:"ml-2 flex items-center gap-2 border-l border-border pl-2",children:[t.jsx(A,{variant:"ghost",size:"icon",className:"h-9 w-9 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>{k(null==e?void 0:e.id),F(!0),y(!0)},children:t.jsx(u,{className:"h-4 w-4"})}),t.jsx(A,{variant:"ghost",size:"icon",className:"h-9 w-9 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{z("Delete Module",`Are you sure you want to delete ${null==e?void 0:e.module_name}?`,async()=>{var s,l,t;try{const r=await J.mutateAsync({api:w.deleteModule,data:{id:null==e?void 0:e.id,isSuspended:!0}});(null==(s=null==r?void 0:r.data)?void 0:s.status)?(a.success((null==(l=null==r?void 0:r.data)?void 0:l.message)||"Module deleted successfully"),Q.refetch()):a.error((null==(t=null==r?void 0:r.data)?void 0:t.message)||"Failed to delete module")}catch(r){a.error("An error occurred")}})},children:t.jsx(m,{className:"h-4 w-4"})})]})]})})]},null==e?void 0:e.id))})})]})}),(!W||0===W.length)&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[t.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:t.jsx(d,{className:"h-12 w-12 text-muted-foreground/40"})}),t.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No modules found"}),t.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Start by adding your first module to organize system components"})]})]})})]}),t.jsx(U,{open:b,setOpen:y,title:_?"Edit Module":"Add New Module",id:N,edit:_,setEdit:F,moduleList:Q})]})})};function H(){return t.jsx(_,{title:"Module List",subTitle:"Control all Module here",children:t.jsx(B,{})})}export{H as default};
