import{r as e,y as s,b4 as t,j as a,E as l,ao as r,bf as n,M as d}from"./vendor-of9_hwUT.js";import{u as i,b as c,s as u,C as o,r as m,f as x,S as p,q as h,w as g,x as j,y as f,z as v,U as N,A as y,P as b}from"./index-Caq1sqRP.js";import"./query-CfdbInZo.js";import"./ui-DGRyWpwx.js";import"./icons-C5eWvnai.js";import"./axios-Dos3PyFQ.js";import"./zustand-xphxtTnV.js";import"./yup-BW00wNfM.js";const A={ruleName:"",ruleImage:null};function w(){var b;const[w,R]=e.useState(!1),[_,C]=e.useState(!1),[k,I]=e.useState(null),S=s({defaultValues:A}),D=i({}),L=c({api:u.api_getActRulesApiList,key:"actRulesList",options:{enabled:!0}}),F=(null==(b=null==L?void 0:L.data)?void 0:b.data)||[],z=c({api:u.api_getActRulesApiById,key:`actRulesById_${k??""}`,config:{id:k},options:{enabled:!!k&&_&&w}});e.useEffect(()=>{var e;if(!w||!_)return;const s=null==(e=null==z?void 0:z.data)?void 0:e.data;if(!s)return;const t=Array.isArray(s)?s[0]:s;t&&S.reset({ruleName:t.rule_name||"",ruleImage:null})},[w,_,null==z?void 0:z.data,S]);const P=S.handleSubmit(async e=>{var s,a,l;try{const r=new FormData;r.append("ruleName",e.ruleName),e.ruleImage&&r.append("ruleImage",e.ruleImage),_&&k&&r.append("id",k.toString());const n=await D.mutateAsync({api:_?u.api_updateActRulesApi:u.api_PostActRulesApi,data:r});(null==(s=null==n?void 0:n.data)?void 0:s.status)?(t.success((null==(a=null==n?void 0:n.data)?void 0:a.message)||(_?"Act/Rule updated successfully":"Act/Rule created successfully")),R(!1),C(!1),I(null),S.reset(A),L.refetch()):t.error((null==(l=null==n?void 0:n.data)?void 0:l.message)||"Failed to save Act/Rule")}catch(r){}});return a.jsxs("div",{children:[a.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:a.jsxs(o,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[a.jsx("div",{className:"border-b bg-muted/30 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-purple-600/10 text-purple-600",children:a.jsx(r,{className:"h-6 w-6"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Acts & Rules"}),a.jsxs("div",{className:"inline-block rounded-full bg-purple-600/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-purple-600",children:[F.length," Items"]})]})]}),a.jsxs(m,{type:"button",onClick:()=>{C(!1),I(null),S.reset(A),R(!0)},className:"flex items-center gap-2 bg-primary shadow-md transition-all hover:bg-primary/90 active:scale-95",children:[a.jsx(r,{className:"h-4 w-4"}),"Add Act/Rule"]})]})}),a.jsx(x,{className:"p-0",children:L.isLoading?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(p,{}),a.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Loading Acts & Rules..."})]})}):F.length>0?a.jsx("div",{className:"space-y-4 p-6",children:F.map(e=>a.jsx("div",{className:"rounded-lg border p-4 transition-shadow hover:shadow-md",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"mb-2 text-lg font-semibold text-foreground",children:e.rule_name}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[a.jsxs("span",{children:["Ref: ",e.reference_no]}),a.jsxs("span",{children:["Created:"," ",new Date(e.created_at).toLocaleDateString()]}),a.jsx("span",{className:"rounded-full px-2 py-1 text-xs font-medium "+(1===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:1===e.status?"Active":"Inactive"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[e.rule_image_url&&a.jsx(m,{variant:"ghost",size:"icon",onClick:()=>((e,s)=>{if(e){const t=document.createElement("a");t.href=e,t.download=s,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}})(e.rule_image_url,e.rule_name),className:"h-8 w-8 text-green-600 hover:bg-green-600/10",children:a.jsx(n,{className:"h-4 w-4"})}),a.jsx(m,{variant:"ghost",size:"icon",onClick:()=>(e=>{C(!0),I(e.id),R(!0)})(e),className:"h-8 w-8 text-blue-600 hover:bg-blue-600/10",children:a.jsx(d,{className:"h-4 w-4"})}),a.jsx(h,{checked:1===e.is_suspended,onCheckedChange:()=>(async(e,s)=>{var a,l,r;try{const n=await D.mutateAsync({api:u.api_deleteActRulesApi,data:{id:e,status:1===s?0:1}});(null==(a=null==n?void 0:n.data)?void 0:a.status)?(t.success((null==(l=null==n?void 0:n.data)?void 0:l.message)||`Act/Rule ${1===s?"deactivated":"activated"} successfully`),L.refetch()):t.error((null==(r=null==n?void 0:n.data)?void 0:r.message)||"Failed to update status")}catch(n){}})(e.id,e.is_suspended),className:"data-[state=checked]:bg-green-500"})]})]})},e.id))}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[a.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:a.jsx(r,{className:"h-12 w-12 text-muted-foreground/40"})}),a.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No Acts & Rules"}),a.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Add acts and rules to display on the citizen landing page."})]})})]})}),a.jsx(g,{open:w,onOpenChange:e=>{R(e),e||(C(!1),I(null),S.reset(A))},children:a.jsxs(j,{className:"max-h-[90vh] min-w-[50vw] overflow-y-auto",children:[a.jsx(f,{children:a.jsx(v,{className:"text-xl font-bold",children:_?"Update Act/Rule":"Add Act/Rule"})}),_&&z.isLoading?a.jsxs("div",{className:"py-10 text-center",children:[a.jsx(p,{}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Loading Act/Rule details..."})]}):a.jsxs("form",{onSubmit:P,className:"space-y-5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{htmlFor:"ruleName",children:"Rule Name *"}),a.jsx(y,{id:"ruleName",...S.register("ruleName",{required:"Rule name is required"}),placeholder:"Enter rule name"}),S.formState.errors.ruleName&&a.jsx("p",{className:"text-sm text-red-500",children:S.formState.errors.ruleName.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(N,{htmlFor:"ruleImage",children:["Rule Document ",!_&&"*"]}),a.jsx(y,{id:"ruleImage",type:"file",accept:".pdf,.doc,.docx",onChange:e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];S.setValue("ruleImage",t||null)}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: PDF, DOC, DOCX"})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 border-t pt-4",children:[a.jsx(m,{type:"button",variant:"outline",onClick:()=>R(!1),children:"Cancel"}),a.jsx(m,{type:"submit",className:"min-w-[120px]",disabled:D.isPending,children:D.isPending?"Saving...":_?"Update Act/Rule":"Create Act/Rule"})]})]})]})})]})}function R(){return a.jsx(b,{title:"Act & Rules",subTitle:"Manage Acts & Rules Masters",children:a.jsx(w,{})})}export{R as default};
