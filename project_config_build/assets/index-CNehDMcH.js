import{y as e,A as s,r as t,j as l,z as r,m as a,J as i,V as d,W as o,X as n,Y as c,Z as m,$ as u,a0 as x,a1 as p,H as h}from"./vendor-BYEve7Lm.js";import{C as j,a as f,b as g,P as b}from"./card-CCk4Fcj3.js";import{u as v,a as y}from"./useCustomQuery-BqJuBb9h.js";import{m as N,B as w,c as k}from"./index-D-WK3WBg.js";import{T as S,a as M,b as A,c as L,d as E,e as I}from"./table-Cm0Oq01X.js";import{c as C,b as R,a as V}from"./yup-rnfMwIpx.js";import{F as D,R as q,B as T}from"./datetime-picker-CVy54M0Q.js";import{g as z}from"./services-Bn_cfjy0.js";import"./select-64z5B__J.js";import"./input-rV9H863X.js";import{R as _}from"./RHFSwitch-d2ea0Gtb.js";import"./label-DkEWzZ9r.js";import{S as F}from"./separator-CizOF37e.js";import{D as $}from"./index-CQ_yaZx1.js";import{S as O}from"./Spinner-CCa1YHa-.js";import"./icons-Z8aKJdqm.js";import"./ui-qCrIzFQ2.js";import"./query-CJAX0F5v.js";import"./axios-Dos3PyFQ.js";import"./zustand-Dp6hMumu.js";import"./switch-C2b8-GuS.js";const P=C().shape({moduleName:V().required("Module Name is required"),title:V().required("Title is required"),url:V().required("URL is required"),image:V().optional(),duesApi:V().optional(),canView:R().default(!0)});function B({open:a,setOpen:i,title:d,edit:o,setEdit:n,moduleList:c,id:m}){const u=v({}),x=e({defaultValues:{moduleName:"",title:"",url:"",image:"",duesApi:"",canView:!0},resolver:s(P)}),{reset:p}=x;t.useEffect(()=>{var e,s;if(a)if(o&&m){const t=null==(s=null==(e=null==c?void 0:c.data)?void 0:e.data)?void 0:s.find(e=>e.id==m);t&&p({moduleName:t.module_name||"",title:t.title||"",url:t.url||"",image:t.image||"",duesApi:t.duesApi||"",canView:t.canView??!0})}else p({moduleName:"",title:"",url:"",image:"",duesApi:"",canView:!0})},[a,o,m,c,p]);return l.jsx($,{open:a,setOpen:i,title:d,setEdit:n,edit:o,children:l.jsx(D,{methods:x,onSubmit:x.handleSubmit(async e=>{var s,t,l;try{const a=o?N.updateModule:N.addModule,d=o?{id:m,...e}:e,x=await u.mutateAsync({api:a,data:d});(null==(s=null==x?void 0:x.data)?void 0:s.status)?(r.success((null==(t=null==x?void 0:x.data)?void 0:t.message)||"Module updated successfully"),i(!1),n(!1),c.refetch()):r.error((null==(l=null==x?void 0:x.data)?void 0:l.message)||"Something went wrong")}catch(a){r.error(z(a))}}),children:l.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[l.jsx("div",{children:l.jsx(q,{label:"Module Name",name:"moduleName",placeholder:"Enter module name"})}),l.jsx("div",{children:l.jsx(q,{label:"Title",name:"title",placeholder:"Enter title"})}),l.jsx("div",{children:l.jsx(q,{label:"Module URL",name:"url",placeholder:"Enter module url"})}),l.jsx("div",{children:l.jsx(q,{label:"Image Name",name:"image",placeholder:"Enter image name (e.g. property.png)"})}),l.jsx("div",{children:l.jsx(q,{label:"Dues API",name:"duesApi",placeholder:"Enter dues api path"})}),l.jsx("div",{children:l.jsx(_,{label:"Show in Dashboard",name:"canView"})}),l.jsx(F,{}),l.jsx("div",{children:l.jsx(T,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const H=C().shape({ulbId:V(),moduleId:V(),complaintRefNo:V()}),U=()=>{var b,C;const R=a(),[V,D]=t.useState(!1),[q,T]=t.useState(""),[z,_]=t.useState(!1),[F,$]=t.useState(""),[P,U]=t.useState(""),W=t.useRef(null),J=v({});e({resolver:s(H),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}});const K=y({api:null==(b=N)?void 0:b.userManagementModuleList,key:"moduleMasterList",options:{enabled:!0}});t.useEffect(()=>{const e=e=>{var s;!e.altKey||"s"!==e.key&&"S"!==e.key||(e.preventDefault(),e.stopPropagation(),null==(s=W.current)||s.focus())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[]);const Q=t.useMemo(()=>{var e,s;return(null==(s=null==(e=null==K?void 0:K.data)?void 0:e.data)?void 0:s.filter(e=>{var s;return null==(s=e.module_name)?void 0:s.toLowerCase().includes(P.toLowerCase())}))||[]},[null==(C=null==K?void 0:K.data)?void 0:C.data,P]),X=[{key:"menu-list",label:"Menu List",icon:l.jsx(d,{className:"h-4 w-4"}),color:"bg-blue-600/10 hover:bg-blue-600/20 text-blue-600 border-blue-600/20"},{key:"service-list",label:"Service List",icon:l.jsx(x,{className:"h-4 w-4"}),color:"bg-emerald-600/10 hover:bg-emerald-600/20 text-emerald-600 border-emerald-600/20"},{key:"role-list",label:"Role List",icon:l.jsx(p,{className:"h-4 w-4"}),color:"bg-violet-600/10 hover:bg-violet-600/20 text-violet-600 border-violet-600/20"},{key:"workflow-list",label:"Workflow Role",icon:l.jsx(h,{className:"h-4 w-4"}),color:"bg-amber-600/10 hover:bg-amber-600/20 text-amber-600 border-amber-600/20"}];return l.jsx("div",{className:" ",children:l.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[l.jsxs(j,{className:"overflow-hidden rounded-2xl border bg-card shadow-lg",children:[l.jsx("div",{className:"border-b bg-muted/30 p-4",children:l.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/10 text-primary",children:l.jsx(d,{className:"h-6 w-6"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Module Management"}),l.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-primary/10 px-3 py-0.5 text-[10px] font-bold uppercase tracking-wider text-primary",children:[Q.length," Modules Found"]})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"relative flex items-center",children:[l.jsx(o,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),l.jsx("input",{ref:W,type:"text",placeholder:"Search modules...",value:P,onChange:e=>U(e.target.value),className:"h-10 w-full rounded-xl border border-border bg-background pl-10 pr-20 text-sm outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 md:w-64"}),l.jsx("div",{className:"absolute right-2.5 hidden items-center gap-1 sm:flex",children:l.jsxs("kbd",{className:"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-white/10 px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[l.jsx("span",{className:"text-xs",children:"Alt"}),"S"]})})]}),l.jsxs(w,{type:"button",className:"flex items-center gap-2 bg-primary hover:bg-primary/90",onClick:()=>{T(""),_(!1),D(!0)},children:[l.jsx(n,{className:"h-4 w-4"}),"Add New Module"]})]})]})}),l.jsx(f,{className:"p-0",children:K.isLoading?l.jsx("div",{className:"flex h-64 items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(O,{}),l.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Syncing modules..."})]})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(S,{children:[l.jsx(M,{children:l.jsxs(A,{className:"border-b-2 hover:bg-transparent",children:[l.jsx(L,{className:"w-20 text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"#"}),l.jsx(L,{className:"text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Module Name"}),l.jsx(L,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Status"}),l.jsx(L,{className:"text-center text-xs font-bold uppercase tracking-wider text-foreground/70",children:"Actions"})]})}),l.jsx(E,{children:l.jsx(c,{children:null==Q?void 0:Q.map((e,s)=>l.jsxs(i.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"group/row border-b transition-all hover:bg-muted/40",children:[l.jsx(I,{className:"py-4 text-center",children:l.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-primary/10 font-medium text-primary",children:s+1})}),l.jsx(I,{className:"py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/10 transition-colors group-hover/row:bg-primary/20",children:l.jsx(d,{className:"h-5 w-5 text-primary"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:null==e?void 0:e.module_name}),l.jsxs("p",{className:"text-xs font-semibold text-muted-foreground",children:["ID: ",null==e?void 0:e.id]})]})]})}),l.jsx(I,{className:"py-4 text-center",children:l.jsx("span",{className:"inline-flex items-center rounded-full border border-green-500/20 bg-green-500/10 px-2.5 py-0.5 text-xs font-bold text-green-500",children:"Active"})}),l.jsx(I,{className:"py-4",children:l.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[X.map(s=>l.jsxs(w,{variant:"outline",size:"sm",onClick:()=>{R(`/project-config/dashboard/module-list/${s.key}?module_name=${null==e?void 0:e.module_name}&id=${null==e?void 0:e.id}`)},className:k("flex items-center gap-2 border-0 transition-all hover:scale-105",s.color),children:[s.icon,l.jsx("span",{className:"hidden sm:inline",children:s.label})]},s.key)),l.jsxs("div",{className:"ml-2 flex items-center gap-2 border-l border-border pl-2",children:[l.jsx(w,{variant:"ghost",size:"icon",className:"h-9 w-9 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>{T(null==e?void 0:e.id),_(!0),D(!0)},children:l.jsx(m,{className:"h-4 w-4"})}),l.jsx(w,{variant:"ghost",size:"icon",className:"h-9 w-9 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{g("Delete Module",`Are you sure you want to delete ${null==e?void 0:e.module_name}?`,async()=>{var s,t,l;try{const a=await J.mutateAsync({api:N.deleteModule,data:{id:null==e?void 0:e.id,isSuspended:!0}});(null==(s=null==a?void 0:a.data)?void 0:s.status)?(r.success((null==(t=null==a?void 0:a.data)?void 0:t.message)||"Module deleted successfully"),K.refetch()):r.error((null==(l=null==a?void 0:a.data)?void 0:l.message)||"Failed to delete module")}catch(a){r.error("An error occurred")}})},children:l.jsx(u,{className:"h-4 w-4"})})]})]})})]},null==e?void 0:e.id))})})]})}),(!Q||0===Q.length)&&l.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[l.jsx("div",{className:"mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted/50",children:l.jsx(d,{className:"h-12 w-12 text-muted-foreground/40"})}),l.jsx("h3",{className:"mb-2 text-xl font-bold text-foreground",children:"No modules found"}),l.jsx("p",{className:"max-w-sm text-sm text-muted-foreground",children:"Start by adding your first module to organize system components"})]})]})})]}),l.jsx(B,{open:V,setOpen:D,title:z?"Edit Module":"Add New Module",id:q,edit:z,setEdit:_,moduleList:K})]})})};function W(){return l.jsx(b,{title:"Module List",subTitle:"Control all Module here",children:l.jsx(U,{})})}export{W as default};
