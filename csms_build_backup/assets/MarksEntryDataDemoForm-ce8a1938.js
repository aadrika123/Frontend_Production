import{r as m,u as J,m as U,A as x,a as f,j as t,b as Y}from"./index-f916f929.js";import{u as z}from"./formik.esm-2de3563d.js";import{c as G,a as H}from"./index.esm-b3999377.js";import{a as w}from"./PowerupFunctions-6790304d.js";import{B as Q}from"./BarLoader-858f75dd.js";import{B as W}from"./BottomErrorCard-20c0353c.js";import{T as X}from"./Tabs-02c9d570.js";import"./hoist-non-react-statics.cjs-fb57390d.js";function ne(){var v,N,k;const[E,j]=m.useState(!1),[F,M]=m.useState(null),[I,o]=m.useState(!1),[b,S]=m.useState([]),[g,C]=m.useState([]);m.useState([]),m.useState([]),m.useState([]);const{api_getactiveSubjectData:Z,api_getactiveClassData:_,api_finance_year:$,api_mapsectionData:y,api_getMarksEntryByID:V,api_postMarksEntryData:B,api_editMarksEntryData:D,api_getMarksEntryData:ee}=Y(),p=J(),{id:u}=U(),L=G({classId:H().required("Select Class")}),l=z({enableReinitialize:!0,initialValues:{classId:"",sectionData:[],marksEntries:[]},onSubmit:(e,s)=>{var r;console.log("at submit ",e);const n={marksEntries:[...(r=e==null?void 0:e.marksEntries)==null?void 0:r.map(i=>({classId:e==null?void 0:e.classId,sectionId:i==null?void 0:i.sectionId,subjectId:i==null?void 0:i.subjectId,isMainSubject:(i==null?void 0:i.mainoptional)=="main"?1:0,isOptionalSubject:(i==null?void 0:i.mainoptional)=="main"?0:1,fullMarks:i==null?void 0:i.fullMarks,passMarks:i==null?void 0:i.passMarks}))]};console.log("submitDataForm",n),P(n)},validationSchema:L}),P=e=>{o(!0);let s,a,n={marksEntries:e.marksEntries};u!==void 0?(s=D,a=n,a.id=u):(s=B,a=n),x.post(s,a,f()).then(function(r){var i,h,c;console.log("view discount group master..",(i=r==null?void 0:r.data)==null?void 0:i.data),(h=r==null?void 0:r.data)!=null&&h.status?p("/marks-entry-demo"):d(!0,`${(c=r==null?void 0:r.data)==null?void 0:c.message}`),o(!1)}).catch(function(r){console.log("==2 error list...",r),d(!0,"Error occured in submitting form."),o(!1)})},A=()=>{o(!0);let e={id:u};x.post(V,e,f()).then(function(s){var a,n,r,i;console.log("fetch edit data response..",(a=s==null?void 0:s.data)==null?void 0:a.data),(n=s==null?void 0:s.data)!=null&&n.status?DiscountGroupEdit((r=s==null?void 0:s.data)==null?void 0:r.data):d(!0,`${(i=s==null?void 0:s.data)==null?void 0:i.message}`),o(!1)}).catch(function(s){console.log("= edit data error...",s),j(!0),o(!1)})},q=()=>{o(!0),x.post($,{},f()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),S(e==null?void 0:e.data)):d(!0,"Error occured while fetching data."),o(!1)}).catch(function(e){console.log("==2 error list...",e),d(!0,"Error occured while fetching data."),o(!1)})},K=()=>{o(!0),x.post(_,{},f()).then(function(e){var s,a,n;((s=e==null?void 0:e.data)==null?void 0:s.status)===!0?(console.log(e==null?void 0:e.data),C((a=e==null?void 0:e.data)==null?void 0:a.data)):d(!0,`${(n=e==null?void 0:e.data)==null?void 0:n.message}`),o(!1)}).catch(function(e){console.log("==2 error list...",e),d(!0,"Error occured while fetching data."),o(!1)})},O=e=>{o(!0),x.post(y,{classId:e},f()).then(function(s){var a,n,r;((a=s==null?void 0:s.data)==null?void 0:a.status)===!0?(console.log(s==null?void 0:s.data),l.setFieldValue("sectionData",(r=(n=s==null?void 0:s.data)==null?void 0:n.data)==null?void 0:r.section.map(i=>({sectionName:i==null?void 0:i.sectionData,value:!0})))):d(!0,"Error occured while fetching data."),o(!1)}).catch(function(s){console.log("==2 error list...",s),d(!0,"Error occured while fetching data."),o(!1)})},R=e=>{o(!0),x.post(y,{classId:e},f()).then(function(s){var a,n,r,i,h;((a=s==null?void 0:s.data)==null?void 0:a.status)===!0?(console.log((n=s==null?void 0:s.data)==null?void 0:n.data),console.log((r=s==null?void 0:s.data)==null?void 0:r.data),l.setFieldValue("marksEntries",(h=(i=s==null?void 0:s.data)==null?void 0:i.data)==null?void 0:h.subject.map(c=>({className:c==null?void 0:c.class_name,sectionName:c==null?void 0:c.section_name,classId:c==null?void 0:c.class_id,sectionId:c==null?void 0:c.section_group_map_id,subjectId:c==null?void 0:c.id,subjectName:c==null?void 0:c.subject_name,fullMarks:100,passMarks:30,mainoptional:!1,optData:0})))):d(!0,"Error occured while fetching datas."),o(!1)}).catch(function(s){console.log("==2 error list...",s),d(!0,"Error occured while fetching dataes."),o(!1)})};console.log(l.values.sectionData),m.useEffect(()=>{l.values.classId!=""&&O(parseInt(l.values.classId))},[l.values.classId]),m.useEffect(()=>{l.values.classId!=""&&R(parseInt(l.values.classId))},[l.values.classId,l.values.sectionData.length>=0]),m.useEffect(()=>{q(),K(),u!==void 0&&A()},[]);const T=e=>{let s=e.target.name,a=e.target.value;s=="fullMarks"&&l.setFieldValue("fullMarks",w(a.trim(),l.values.fullMarks,3)),s=="passMarks"&&l.setFieldValue("passMarks",w(a.trim(),l.values.passMarks,3))},d=(e,s)=>{M(s),j(e)};return console.log(l.values.sectionData),m.useEffect(()=>{l.values.marksEntries.map((e,s)=>{(e==null?void 0:e.mainoptional)=="main"?l.setFieldValue(`marksEntries.${s}.optData`,0):l.setFieldValue(`marksEntries.${s}.optData`,1)})},[(v=l==null?void 0:l.values)==null?void 0:v.marksEntries]),t.jsx(t.Fragment,{children:t.jsx("div",{className:"main-div",children:t.jsxs("div",{className:"main-inner-div",children:[I&&t.jsx(Q,{}),E&&t.jsx(W,{activateBottomErrorCard:d,errorTitle:F}),t.jsxs("div",{className:"main-sub-div",children:[t.jsx("div",{className:"main-sub-inner-div",children:t.jsxs("div",{className:"text-div",children:[t.jsx("div",{className:"big-text",children:"Marks Entry Master Form"}),t.jsx("div",{className:"common-header-smalltext",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]})}),u===void 0?t.jsx("div",{className:"tab-div",children:t.jsx("div",{className:"add-button-master-div",children:t.jsxs("button",{onClick:()=>p("/marks-entry-demo-form"),type:"submit",className:" add-button-master bg-[#0F766E] hover:bg-[#0F766E]",children:["Add"," "]})})}):null]}),t.jsx(X,{listRoute:"/marks-entry-demo",formRoute:"/marks-entry-demo-form"}),t.jsx("div",{className:"details-div",children:t.jsx("span",{className:"detailes text-[#0F766E]",children:"Marks Entry Form"})}),t.jsx("div",{className:"form-div",children:t.jsx("form",{onSubmit:l.handleSubmit,onChange:T,children:t.jsxs("div",{className:"form",children:[t.jsxs("div",{className:"col-span-4 grid grid-cols-12",children:[t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4 relative",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-teal-900 text-sm font-semibold",children:["Academic Year",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsx("select",{...l==null?void 0:l.getFieldProps("fy"),type:"number",className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 h-10 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select class",children:b==null?void 0:b.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.fy,children:e==null?void 0:e.fy}))}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.fy&&l.errors.fy?l.errors.fy:null})]}),t.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-2 md:pr-4",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-teal-900 text-sm font-semibold",children:["Class",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsxs("select",{...l.getFieldProps("classId"),type:"number",className:"form-control h-10 block bg-white w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Select Class",children:[t.jsx("option",{value:"",children:"Select"}),g==null?void 0:g.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.class_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:l.touched.classId&&l.errors.classId?l.errors.classId:null})]})]}),l.values.classId&&t.jsx("div",{className:"col-span-12 mt-4",children:t.jsx("div",{className:" pt-4 ",children:t.jsx("div",{className:"w-full flex items-center  justify-center border border-teal-300 ",children:t.jsxs("div",{className:"w-full h-[15vh] md:h-[8vh] flex relative",children:[t.jsxs("div",{className:"absolute",children:[" ",t.jsxs("h1",{className:" bg-white items-start justify-start px-2 mt-[-10px] ml-2 ",children:[" ","Section"," ",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]}),t.jsxs("div",{className:"mt-3 ml-5",children:[((N=l.values.sectionData)==null?void 0:N.length)==0?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"  ml-[10px]  text-[#6b7280]   flex justify-center text-xl items-center font-bold mt-2",children:["No existing section for selected class !!!!"," "]})}):null,l.values.sectionData&&l.values.sectionData.map((e,s)=>t.jsxs(t.Fragment,{children:[t.jsx("input",{name:"value",value:e==null?void 0:e.sectionName,checked:l.values.sectionData[s].value===!0,disabled:!0,onChange:()=>l.setFieldValue(`sectionData.${s}.value`,!(e!=null&&e.value)),type:"checkbox",className:"text-slat-500  ml-[8vh]  text-[#6b7280] w-5 h-5 font-bold mt-2   "})," ",t.jsx("span",{className:"ml-2 -mt-6",children:e.sectionName})]}))]})]})})})}),((k=l.values.sectionData)==null?void 0:k.length)!==0&&t.jsx("div",{className:"col-span-12 mt-4",children:t.jsx("div",{className:"overflow-x-auto pt-4 ",children:t.jsx("div",{className:"w-full flex items-center  justify-center border border-teal-300 p-4",children:t.jsxs("div",{className:"w-full block",children:[t.jsx("div",{className:"w-full items-start justify-start bg-white px-2 relative",children:t.jsxs("h1",{className:"absolute bg-white items-start justify-start px-2 mt-[-25px] ",children:[" ","Subject"," ",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})}),t.jsx("div",{children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 max-[820px]:w-[820px]",children:[t.jsx("thead",{className:"bg-[#E7EFFC] ",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Class Name"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Section Name"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Subject Name"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Full Marks"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Passing Marks"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Main"}),t.jsx("th",{className:"px-6 py-3  text-sm font-bold   tracking-wider",children:"Optional"})]})}),t.jsx("tbody",{className:" divide-y divide-gray-200 ",children:l.values.marksEntries&&l.values.marksEntries.map((e,s)=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e==null?void 0:e.className}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e==null?void 0:e.sectionName}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e==null?void 0:e.subjectName}),t.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:t.jsx("input",{...l.getFieldProps(`marksEntries.${s}.fullMarks`),type:"number",onChange:a=>l.setFieldValue(`marksEntries.${s}.fullMarks`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),className:"  text-center form-control h-10  w-1/2 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})}),t.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:t.jsx("input",{...l.getFieldProps(`marksEntries.${s}.passMarks`),type:"number",onChange:a=>l.setFieldValue(`marksEntries.${s}.passMarks`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),className:"text-center form-control h-10  w-1/2 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})}),t.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:t.jsx("input",{...l.getFieldProps(`marksEntries.${s}.mainoptional`),type:"checkbox",value:"main",onChange:a=>l.setFieldValue(`marksEntries.${s}.mainoptional`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),checked:(e==null?void 0:e.mainoptional)=="main",className:"text-center form-control  h-5  w-5 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})}),t.jsxs("td",{className:"px-6 py-3 whitespace-nowrap",children:[t.jsx("input",{...l.getFieldProps(`marksEntries.${s}.mainoptional`),type:"checkbox",value:"optional",onChange:a=>l.setFieldValue(`marksEntries.${s}.mainoptional`,a.target.value),onKeyDown:a=>["e","E","+","-"].includes(a.key)&&a.preventDefault(),checked:(e==null?void 0:e.mainoptional)=="optional",className:"text-center form-control h-5 w-5 px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),t.jsx("input",{type:"hidden",name:`marksEntries.${s}.optData`,value:(e==null?void 0:e.mainoptional)=="optional"?0:1})]})]}))})]})})]})})})}),t.jsxs("div",{className:"cancel-button-div",children:[t.jsx("div",{className:"    ",children:t.jsx("button",{onClick:()=>p("/marks-entry-demo"),type:"button",className:"deactivate-button-master py-2 bg-red-500 text-white",children:"Back to List"})}),t.jsx("div",{className:"submit-button-div",children:t.jsx("button",{type:"submit",className:" save-button",children:u!==void 0?"Update":"Save"})})]})]})})})]})})})}export{ne as default};
