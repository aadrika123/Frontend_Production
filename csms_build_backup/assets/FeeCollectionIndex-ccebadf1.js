import{r as n,u as Z,A as f,a as N,Q as y,j as e,b as U}from"./index-f916f929.js";import{u as H}from"./formik.esm-2de3563d.js";import{B as _}from"./BottomErrorCard-20c0353c.js";import{B as q}from"./BarLoader-858f75dd.js";import{c as $,a as ee}from"./index.esm-b3999377.js";import"./hoist-non-react-statics.cjs-fb57390d.js";const ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFIElEQVR4nO1aW2hcRRie8dJo1bZpkp3ZNLaltUUC3thk5/83i3moQvCKD0W0giASFNtaNTlnEx/ikxpUJFLFC3iplwexBGoJ1iptzWUmYYs+2IdoS+yDWuOlNEbwgl2Zs6e5bC67s9nuOWfdD/6XmTPf/893/vl3Zs4SkgMsIXfboFI5mVATtpCfdERVPSkQNJcF8oDDnWMcOuZC+Se2kN05CzBlctIWMl4A33GHy9S/kN2kcEhRW8inTIOwQJ5pbxxuyHvyUXWdJdRv5uKrni6SuoAUGpaQOy2Q/xpmws/5LIdE4/BmC9QpQ19nLVAWOZ9oh6FtNsi/zdJRfZ9oGNmQqw+7KbnWFvKkUbYJ9Y+N6gFSDLTj8BaTguSuyZN6Ytm4O2FojQXyhGm9SQh5CykmEjjSaAk1blgTRjuEZAtxPh5JVlsgjxlm168WDsaIF2iLDWy0hTpuKMJXiXh/ZSZXV1StsEAlDSf/XQcOXk28RGckGdaTMluvcqir+dDlU5OPJJdbQh4xFPLYkw0jVxI/4NHmL1fZIL8wLFoHd7T0VejxFqgOszWv+ufLIk+xo6WvwgL1kWFh7O1qPnRRayR5sS3kxzkKt09nDPEjtm798EIb1Otmqaze1ZuWrvqvl+ktdJal844Wi/gbqXx2jS/rkfrN6vRe4JkezU2CAgvUdqNdo5BP63F2JLnSFurodJ88a0VVm9fzKSNv1MEaEopvyMv02MCCi4cpg3HKMbUkYzBOODxEAoUQ3OsG/ydl2E85HszLGA44HBxThIm7SVBAOQw5QYehaclkYRFPi4kDxHcI4RYSxtZMoxx+pxwmpp+DayiH3aQOVmflrIpd4Txbizeca9JcmnM+X04MnoCJ9VnW7umpCTB4Lp3GcHt2XrzNfeMvzBh/ejFfpFpsIkVHbex6N4BvKIdnZ5mz9qcFIBxvpAz7SDhSnZWXx2sox09nLh9HAKcWZPhxfGNKx0I8E4BBb2aXG/C0AEvEQnzat/cCcByjDF6bbfhX2jLb87UF+LRvHwiQ8to8FgAGSQhu8sK0b1/WgGLBHzWAlQXoNRavvn4ZCcM2yvElbYTH7nPa/hcZUC02UYajczdOOEpqGzeXtgB1cCnl+K1bPD/XhyYSwnsoh8/ctuP6mdIVIAQPumMO6Phn9FC9U0wfoLC1ZAWgHN9yAg6JO+Z0MrzV5dtTugIw2OMEzKFlTmdI3Owugw9KVgDCcOdCk6QM33PFeax0BaiMrKQcf3Sr/tvOia8GY5TDm+6vwSmyrnlV6QqgwSBKOfw0791fqAmIAYIpgIa+GWKYoBz3aSMh6CS1jVXEEMEVoEAIngDs2st0tScc7p9zt6fb9CkvHFleegJc1VJBOXZThn9k/w6gn4Fn9JjSEGBd8yWUwRF3gpPpn7vMu72pO7730zfKjhCHs4kQCAEowxfdCR0lNbGNWXmrYrWU47DL/XywBVgbr3Tu8vQ3AibW58wdEoxyPKNvghfbF/hfgDDc5b79V03pKcc30ueG2J3BFYDB9vT2Fp8w5ufYlv6Ygo8EV4Aw7EofcWGXMX8OYwMjAGX4C+VwwsicMYEXQMTPfd7Oz2BisS/M/hfgPKMsACtnQK8vlwDl0OMWssP6Dw+z2vI1hq8EJgMoh/1uIRubIcD+pf1ZCvcGRoBioSwAK2dAry+XAF1qwSuhIpgqmJWL4Fz4NgOKhbIAzA8ZwHGy4AUvZ9O+vRJgdXQF5fBDwYuduY3pWPKdx3/lUsB8H5IGuQAAAABJRU5ErkJggg==",re=()=>{var w,S;let u=new Date().toISOString().slice(0,10);console.log(u),n.useState("");const[F,E]=n.useState(!1),[M,I]=n.useState(null),[C,p]=n.useState(!1),[se,P]=n.useState([]),{api_master_fee_collection_search:B,api_payment_mode_active_all:O,api_fee_collection_store:k,api_fetch_fee_collection:D}=U(),[j,W]=n.useState([]),[c,g]=n.useState([]),[b,Q]=n.useState(0),[o,X]=n.useState(),[v,z]=n.useState([]),[A,J]=n.useState(!1),L=$({admissionNo:ee().required("Admission number is required feild")}),G=Z(),d=H({initialValues:{admissionNo:"",paymentModeId:"1"},onSubmit:async a=>{console.log("at submit ",a),await T(a),J(!A)},validationSchema:L}),K=async()=>{var a,t;try{const s=await f.post(O,{},N());console.log("paymentMode",s==null?void 0:s.data),((a=s==null?void 0:s.data)==null?void 0:a.status)===!0&&W((t=s==null?void 0:s.data)==null?void 0:t.data)}catch(s){console.log("paymentMode",s),m(!0,"Error occured in submitting form.")}},T=async a=>{var t,s,r,i,x;p(!0);try{const l=await f.post(B,{admissionNo:a.admissionNo},N());console.log("paymentMode",l==null?void 0:l.data),((t=l==null?void 0:l.data)==null?void 0:t.status)===!0?(X((r=(s=l==null?void 0:l.data)==null?void 0:s.data)==null?void 0:r.studentDetails),g((x=(i=l==null?void 0:l.data)==null?void 0:i.data)==null?void 0:x.monthly_fee.map(h=>({...h,isPaid:!1})))):(console.log("==2 error list...",error),y.warning("Error occured in submitting form"),p(!1)),p(!1)}catch(l){console.log("paymentMode",l),m(!0,"Error occured in submitting form."),p(!1)}},V=a=>{},m=(a,t)=>{I(t),E(a)};console.log(o),n.useEffect(()=>{z(c.reduce((a,t)=>{var s;return t.isPaid?[...a,{admissionNo:o==null?void 0:o.admissionNo,monthName:t==null?void 0:t.month_name,totalFee:t==null?void 0:t.total,isPaid:t!=null&&t.isPaid?1:0,paymentDate:u,paymentModeId:parseInt((s=d==null?void 0:d.values)==null?void 0:s.paymentModeId),grandTotal:b}]:a},[])),Q(c.reduce((a,t)=>t.isPaid?a+t.total:a,0))},[c,(w=d==null?void 0:d.values)==null?void 0:w.paymentModeId]);const Y=async()=>{var a,t;try{const s=await f.post(D,{admissionNo:o==null?void 0:o.admissionNo},N());console.log("fetchFeeColl",s==null?void 0:s.data),((a=s==null?void 0:s.data)==null?void 0:a.status)==!0&&(P((t=s==null?void 0:s.data)==null?void 0:t.data),g(r=>r.map(i=>{var x,l;return{...i,isPaid:(l=(x=s==null?void 0:s.data)==null?void 0:x.data)==null?void 0:l.some(h=>(h==null?void 0:h.month_name)==(i==null?void 0:i.month_name))}})))}catch(s){console.log("paymentMode",s),m(!0,"Error occured in submitting form.")}};n.useEffect(()=>{Y()},[A]);const R=async()=>{var a,t,s,r,i,x;if(console.log("submitFee",v.length),v.length<=0)y.warning("Please check at least one month");else try{const l=await f.post(k,{admissionNo:o==null?void 0:o.admissionNo,grandTotal:b,isPaid:((a=d==null?void 0:d.values)==null?void 0:a.paymentModeId)==1?1:0,paymentDate:u,paymentModeId:parseInt((t=d==null?void 0:d.values)==null?void 0:t.paymentModeId),feeCollection:v},N());console.log("paymentMode",(s=l==null?void 0:l.data)==null?void 0:s.receiptNo),(r=l==null?void 0:l.data)!=null&&r.status?(alert("Payment Done"),G("/receipt",{state:{receiptNo:(x=(i=l==null?void 0:l.data)==null?void 0:i.data)==null?void 0:x.receiptNo}})):y.warning(`${l.data.message}`)}catch(l){console.log(l),m(!0,"Error occured in submitting form.")}};return n.useEffect(()=>{K()},[(S=d==null?void 0:d.values)==null?void 0:S.paymentModeId]),e.jsxs(e.Fragment,{children:[C&&e.jsx(q,{}),F&&e.jsx(_,{activateBottomErrorCard:m,errorTitle:M}),e.jsx("form",{onSubmit:d.handleSubmit,onChange:V,children:e.jsxs("div",{className:"px-3 w-[70%] m-auto space-y-5 h-[80vh] overflow-auto",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[32px] font-semibold text-gray-700",children:"Fee Collection"}),e.jsx("p",{className:"text-teal-600",children:"Securing a Bright Future: Collecting Fees to Support Education Excellence"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg shadow-lg w-full m-auto p-5 ",children:[e.jsxs("div",{className:"flex items-center justify-center gap-14 flex-wrap ",children:[e.jsx("div",{children:e.jsx("p",{className:"text-2xl font-semibold text-teal-900",children:"Date"})}),e.jsx("div",{children:e.jsx("input",{disabled:!0,type:"text",className:"border rounded-lg shadow-md w-full h-10 px-8 block -mt-1 ",placeholder:"",value:u})}),e.jsx("div",{children:e.jsxs("p",{className:"text-2xl font-semibold text-teal-900",children:["Admission No"," ",e.jsx("small",{className:"mt-1 -ml-1 text-lg font-semibold text-red-600 inline ",children:"*"})]})}),e.jsxs("div",{children:[" ",e.jsx("input",{...d.getFieldProps("admissionNo"),type:"text",className:"border rounded-lg shadow-md w-full h-10 px-8 block -mt-1 ",placeholder:"Enter admission no"})]}),e.jsxs("div",{children:[" ",e.jsx("button",{type:"submit",className:"text-white bg-[#0F766E] w-full px-10 mr-9 rounded-lg font-semibold py-2",children:"Search"})]})]}),e.jsx("span",{className:"text-red-600 ml-[45vh]  text-sm mt-2",children:d.touched.admissionNo&&d.errors.admissionNo?d.errors.admissionNo:null})]}),c.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("p",{className:"ml-5 text-gray-700 font-bold text-xl",children:["Name - ",o==null?void 0:o.fullName]}),e.jsxs("div",{className:"flex justify-between rounded-lg shadow-lg border border-gray-200 p-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Admission No"}),e.jsx("p",{className:"text-[18px] font-medium text-gray-500",children:o==null?void 0:o.admissionNo})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Class"}),e.jsx("p",{className:"text-[18px] font-medium text-gray-500 text-center",children:o==null?void 0:o.className})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Sec"}),e.jsx("p",{className:"text-[18px] font-medium text-gray-500 text-center",children:o==null?void 0:o.sectionName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Status"}),e.jsx("p",{className:"text-[18px] font-medium text-green-500 text-center",children:o==null?void 0:o.status})]}),e.jsx("div",{children:e.jsx("img",{src:ae,alt:"Id Card",className:"opacity-80 h-12"})})]}),e.jsxs("div",{className:"m-auto mt-5 overflow-auto",children:[e.jsxs("div",{className:"grid grid-cols-12 font-semibold text-lg text-gray-700",children:[e.jsx("div",{className:"col-span-3 ml-5",children:"Months"}),e.jsx("div",{className:"col-span-3 ml-3",children:"Fees"}),e.jsx("div",{className:"col-span-2",children:"Amount"}),e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-2 mx-auto flex justify-start items-center",children:e.jsx("input",{type:"checkbox",className:"w-6 h-6",onChange:a=>{const t=c.map(s=>({...s,isPaid:a.target.checked}));g(t)},checked:(c==null?void 0:c.filter(a=>(a==null?void 0:a.isPaid)==!0).length)==(c==null?void 0:c.length)})})]}),e.jsxs("div",{className:" rounded-lg shadow-lg border border-gray-200 px-5",children:[c&&c.map((a,t)=>{var s;return e.jsxs("div",{className:"grid grid-cols-12 text-gray-600 border-b py-2",children:[e.jsx("div",{className:"col-span-3 ",children:a.month_name}),e.jsxs("div",{className:"col-span-3",children:[a.fee.map(r=>e.jsx(e.Fragment,{children:e.jsx("div",{children:r.fee_head})})),e.jsx("div",{className:"font-bold text-black",children:"Total "})]}),e.jsxs("div",{className:"col-span-2",children:[a.fee.map(r=>e.jsxs("p",{children:["₹ ",r.amount]})),e.jsxs("p",{className:" text-black font-bold w-full px-10",children:["₹ ",a.total]})]}),e.jsx("div",{className:"col-span-1 border-r-2 border-gray-200 my-2"}),e.jsx("div",{className:"col-span-2 m-auto text-center",children:e.jsx("input",{type:"checkbox",onChange:r=>{const i=c.map((x,l)=>l==t?{...x,isPaid:r.target.checked}:l>t?{...x,isPaid:!1}:x);g(i)},checked:a==null?void 0:a.isPaid,className:"w-6 h-6  content-center",disabled:t==0?!1:!((s=c[t-1])!=null&&s.isPaid)})})]},t)}),e.jsxs("div",{className:"grid grid-cols-12 mt-4 mb-4",children:[e.jsx("div",{className:"col-span-6",children:e.jsxs("p",{className:"font-bold text-lg text-black",children:[" ","Sub Total"," "]})}),e.jsx("div",{className:"col-span-4",children:e.jsxs("p",{className:" px-3 w-1/2  font-bold text-black",children:["₹ ",b]})})]})]})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg shadow-xl w-full m-auto p-5 ",children:[e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-x-5",children:[e.jsx("div",{children:e.jsx("p",{className:"font-bold text-lg text-gray-700",children:"Payment Mode"})}),e.jsx("div",{children:e.jsx("select",{className:"border rounded-lg shadow-md w-full h-10 px-8 ",...d==null?void 0:d.getFieldProps("paymentModeId"),children:j==null?void 0:j.map(a=>e.jsx("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.payment_mode_name}))})})]}),e.jsx("div",{className:"mt-3 ",children:e.jsx("div",{className:"flex justify-center py-5",children:e.jsx("button",{type:"button",className:"bg-green-700 px-3 py-1 text-white font-semibold rounded shadow",onClick:()=>R(),children:"Pay Now"})})})]})]}):e.jsx("span",{children:"No record found"})]})})]})};export{re as default};
